import{l as Rn,a as fa,b as we,c as ye,e as yt,s as ca,r as Ot,d as M,_ as se,f as Oi,o as el,g as Ci,h as tl,k as nl,n as ke,P as rl,i as At,p as Mi,q as il,t as Ut,u as Zn,T as ol,j as al,C as sl}from"./index-L3ozMu8u.js";import{P as Li,T as ll}from"./solanaProvider.esm-NGEjt1Cg.js";import{d as dl}from"./index-mW-rGalf.js";import{B as ul}from"./baseSolanaAdapter.esm-PuQFH4iL.js";const fl=Rn.getLogger("http-helpers");fl.setLevel(fa.levels.INFO);var ha={exports:{}},Qn={exports:{}},oe={ArrayIsArray(e){return Array.isArray(e)},ArrayPrototypeIncludes(e,t){return e.includes(t)},ArrayPrototypeIndexOf(e,t){return e.indexOf(t)},ArrayPrototypeJoin(e,t){return e.join(t)},ArrayPrototypeMap(e,t){return e.map(t)},ArrayPrototypePop(e,t){return e.pop(t)},ArrayPrototypePush(e,t){return e.push(t)},ArrayPrototypeSlice(e,t,n){return e.slice(t,n)},Error,FunctionPrototypeCall(e,t,...n){return e.call(t,...n)},FunctionPrototypeSymbolHasInstance(e,t){return Function.prototype[Symbol.hasInstance].call(e,t)},MathFloor:Math.floor,Number,NumberIsInteger:Number.isInteger,NumberIsNaN:Number.isNaN,NumberMAX_SAFE_INTEGER:Number.MAX_SAFE_INTEGER,NumberMIN_SAFE_INTEGER:Number.MIN_SAFE_INTEGER,NumberParseInt:Number.parseInt,ObjectDefineProperties(e,t){return Object.defineProperties(e,t)},ObjectDefineProperty(e,t,n){return Object.defineProperty(e,t,n)},ObjectGetOwnPropertyDescriptor(e,t){return Object.getOwnPropertyDescriptor(e,t)},ObjectKeys(e){return Object.keys(e)},ObjectSetPrototypeOf(e,t){return Object.setPrototypeOf(e,t)},Promise,PromisePrototypeCatch(e,t){return e.catch(t)},PromisePrototypeThen(e,t,n){return e.then(t,n)},PromiseReject(e){return Promise.reject(e)},ReflectApply:Reflect.apply,RegExpPrototypeTest(e,t){return e.test(t)},SafeSet:Set,String,StringPrototypeSlice(e,t,n){return e.slice(t,n)},StringPrototypeToLowerCase(e){return e.toLowerCase()},StringPrototypeToUpperCase(e){return e.toUpperCase()},StringPrototypeTrim(e){return e.trim()},Symbol,SymbolFor:Symbol.for,SymbolAsyncIterator:Symbol.asyncIterator,SymbolHasInstance:Symbol.hasInstance,SymbolIterator:Symbol.iterator,TypedArrayPrototypeSet(e,t,n){return e.set(t,n)},Uint8Array},ba={exports:{}};(function(e){const t=we,n=Object.getPrototypeOf(async function(){}).constructor,r=globalThis.Blob||t.Blob,a=typeof r<"u"?function(c){return c instanceof r}:function(c){return!1};class s extends Error{constructor(c){if(!Array.isArray(c))throw new TypeError(`Expected input to be an Array, got ${typeof c}`);let b="";for(let f=0;f<c.length;f++)b+=`    ${c[f].stack}
`;super(b),this.name="AggregateError",this.errors=c}}e.exports={AggregateError:s,kEmptyObject:Object.freeze({}),once(l){let c=!1;return function(...b){c||(c=!0,l.apply(this,b))}},createDeferredPromise:function(){let l,c;return{promise:new Promise((f,h)=>{l=f,c=h}),resolve:l,reject:c}},promisify(l){return new Promise((c,b)=>{l((f,...h)=>f?b(f):c(...h))})},debuglog(){return function(){}},format(l,...c){return l.replace(/%([sdifj])/g,function(...[b,f]){const h=c.shift();return f==="f"?h.toFixed(6):f==="j"?JSON.stringify(h):f==="s"&&typeof h=="object"?`${h.constructor!==Object?h.constructor.name:""} {}`.trim():h.toString()})},inspect(l){switch(typeof l){case"string":if(l.includes("'"))if(l.includes('"')){if(!l.includes("`")&&!l.includes("${"))return`\`${l}\``}else return`"${l}"`;return`'${l}'`;case"number":return isNaN(l)?"NaN":Object.is(l,-0)?String(l):l;case"bigint":return`${String(l)}n`;case"boolean":case"undefined":return String(l);case"object":return"{}"}},types:{isAsyncFunction(l){return l instanceof n},isArrayBufferView(l){return ArrayBuffer.isView(l)}},isBlob:a},e.exports.promisify.custom=Symbol.for("nodejs.util.promisify.custom")})(ba);var Je=ba.exports,ri={};const{format:cl,inspect:pn,AggregateError:hl}=Je,bl=globalThis.AggregateError||hl,gl=Symbol("kIsNodeError"),pl=["string","function","number","object","Function","Object","boolean","bigint","symbol"],_l=/^([A-Z][a-z0-9]*)+$/,wl="__node_internal_",An={};function gt(e,t){if(!e)throw new An.ERR_INTERNAL_ASSERTION(t)}function Di(e){let t="",n=e.length;const r=e[0]==="-"?1:0;for(;n>=r+4;n-=3)t=`_${e.slice(n-3,n)}${t}`;return`${e.slice(0,n)}${t}`}function yl(e,t,n){if(typeof t=="function")return gt(t.length<=n.length,`Code: ${e}; The provided arguments length (${n.length}) does not match the required ones (${t.length}).`),t(...n);const r=(t.match(/%[dfijoOs]/g)||[]).length;return gt(r===n.length,`Code: ${e}; The provided arguments length (${n.length}) does not match the required ones (${r}).`),n.length===0?t:cl(t,...n)}function de(e,t,n){n||(n=Error);class r extends n{constructor(...s){super(yl(e,t,s))}toString(){return`${this.name} [${e}]: ${this.message}`}}Object.defineProperties(r.prototype,{name:{value:n.name,writable:!0,enumerable:!1,configurable:!0},toString:{value(){return`${this.name} [${e}]: ${this.message}`},writable:!0,enumerable:!1,configurable:!0}}),r.prototype.code=e,r.prototype[gl]=!0,An[e]=r}function ki(e){const t=wl+e.name;return Object.defineProperty(e,"name",{value:t}),e}function ml(e,t){if(e&&t&&e!==t){if(Array.isArray(t.errors))return t.errors.push(e),t;const n=new bl([t,e],t.message);return n.code=t.code,n}return e||t}let Sl=class extends Error{constructor(t="The operation was aborted",n=void 0){if(n!==void 0&&typeof n!="object")throw new An.ERR_INVALID_ARG_TYPE("options","Object",n);super(t,n),this.code="ABORT_ERR",this.name="AbortError"}};de("ERR_ASSERTION","%s",Error);de("ERR_INVALID_ARG_TYPE",(e,t,n)=>{gt(typeof e=="string","'name' must be a string"),Array.isArray(t)||(t=[t]);let r="The ";e.endsWith(" argument")?r+=`${e} `:r+=`"${e}" ${e.includes(".")?"property":"argument"} `,r+="must be ";const a=[],s=[],l=[];for(const b of t)gt(typeof b=="string","All expected entries have to be of type string"),pl.includes(b)?a.push(b.toLowerCase()):_l.test(b)?s.push(b):(gt(b!=="object",'The value "object" should be written as "Object"'),l.push(b));if(s.length>0){const b=a.indexOf("object");b!==-1&&(a.splice(a,b,1),s.push("Object"))}if(a.length>0){switch(a.length){case 1:r+=`of type ${a[0]}`;break;case 2:r+=`one of type ${a[0]} or ${a[1]}`;break;default:{const b=a.pop();r+=`one of type ${a.join(", ")}, or ${b}`}}(s.length>0||l.length>0)&&(r+=" or ")}if(s.length>0){switch(s.length){case 1:r+=`an instance of ${s[0]}`;break;case 2:r+=`an instance of ${s[0]} or ${s[1]}`;break;default:{const b=s.pop();r+=`an instance of ${s.join(", ")}, or ${b}`}}l.length>0&&(r+=" or ")}switch(l.length){case 0:break;case 1:l[0].toLowerCase()!==l[0]&&(r+="an "),r+=`${l[0]}`;break;case 2:r+=`one of ${l[0]} or ${l[1]}`;break;default:{const b=l.pop();r+=`one of ${l.join(", ")}, or ${b}`}}if(n==null)r+=`. Received ${n}`;else if(typeof n=="function"&&n.name)r+=`. Received function ${n.name}`;else if(typeof n=="object"){var c;if((c=n.constructor)!==null&&c!==void 0&&c.name)r+=`. Received an instance of ${n.constructor.name}`;else{const b=pn(n,{depth:-1});r+=`. Received ${b}`}}else{let b=pn(n,{colors:!1});b.length>25&&(b=`${b.slice(0,25)}...`),r+=`. Received type ${typeof n} (${b})`}return r},TypeError);de("ERR_INVALID_ARG_VALUE",(e,t,n="is invalid")=>{let r=pn(t);return r.length>128&&(r=r.slice(0,128)+"..."),`The ${e.includes(".")?"property":"argument"} '${e}' ${n}. Received ${r}`},TypeError);de("ERR_INVALID_RETURN_VALUE",(e,t,n)=>{var r;const a=n!=null&&(r=n.constructor)!==null&&r!==void 0&&r.name?`instance of ${n.constructor.name}`:`type ${typeof n}`;return`Expected ${e} to be returned from the "${t}" function but got ${a}.`},TypeError);de("ERR_MISSING_ARGS",(...e)=>{gt(e.length>0,"At least one arg needs to be specified");let t;const n=e.length;switch(e=(Array.isArray(e)?e:[e]).map(r=>`"${r}"`).join(" or "),n){case 1:t+=`The ${e[0]} argument`;break;case 2:t+=`The ${e[0]} and ${e[1]} arguments`;break;default:{const r=e.pop();t+=`The ${e.join(", ")}, and ${r} arguments`}break}return`${t} must be specified`},TypeError);de("ERR_OUT_OF_RANGE",(e,t,n)=>{gt(t,'Missing "range" argument');let r;return Number.isInteger(n)&&Math.abs(n)>2**32?r=Di(String(n)):typeof n=="bigint"?(r=String(n),(n>2n**32n||n<-(2n**32n))&&(r=Di(r)),r+="n"):r=pn(n),`The value of "${e}" is out of range. It must be ${t}. Received ${r}`},RangeError);de("ERR_MULTIPLE_CALLBACK","Callback called multiple times",Error);de("ERR_METHOD_NOT_IMPLEMENTED","The %s method is not implemented",Error);de("ERR_STREAM_ALREADY_FINISHED","Cannot call %s after a stream was finished",Error);de("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable",Error);de("ERR_STREAM_DESTROYED","Cannot call %s after a stream was destroyed",Error);de("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError);de("ERR_STREAM_PREMATURE_CLOSE","Premature close",Error);de("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF",Error);de("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event",Error);de("ERR_STREAM_WRITE_AFTER_END","write after end",Error);de("ERR_UNKNOWN_ENCODING","Unknown encoding: %s",TypeError);var me={AbortError:Sl,aggregateTwoErrors:ki(ml),hideStackFrames:ki,codes:An};const{ArrayIsArray:ii,ArrayPrototypeIncludes:ga,ArrayPrototypeJoin:pa,ArrayPrototypeMap:El,NumberIsInteger:oi,NumberIsNaN:Rl,NumberMAX_SAFE_INTEGER:Al,NumberMIN_SAFE_INTEGER:Il,NumberParseInt:Tl,ObjectPrototypeHasOwnProperty:$l,RegExpPrototypeExec:_a,String:vl,StringPrototypeToUpperCase:Nl,StringPrototypeTrim:Pl}=oe,{hideStackFrames:Te,codes:{ERR_SOCKET_BAD_PORT:Ol,ERR_INVALID_ARG_TYPE:pe,ERR_INVALID_ARG_VALUE:Ct,ERR_OUT_OF_RANGE:_t,ERR_UNKNOWN_SIGNAL:xi}}=me,{normalizeEncoding:Cl}=Je,{isAsyncFunction:Ml,isArrayBufferView:Ll}=Je.types,Wi={};function Dl(e){return e===(e|0)}function kl(e){return e===e>>>0}const xl=/^[0-7]+$/,Wl="must be a 32-bit unsigned integer or an octal string";function Fl(e,t,n){if(typeof e>"u"&&(e=n),typeof e=="string"){if(_a(xl,e)===null)throw new Ct(t,e,Wl);e=Tl(e,8)}return wa(e,t),e}const jl=Te((e,t,n=Il,r=Al)=>{if(typeof e!="number")throw new pe(t,"number",e);if(!oi(e))throw new _t(t,"an integer",e);if(e<n||e>r)throw new _t(t,`>= ${n} && <= ${r}`,e)}),Ul=Te((e,t,n=-2147483648,r=2147483647)=>{if(typeof e!="number")throw new pe(t,"number",e);if(!oi(e))throw new _t(t,"an integer",e);if(e<n||e>r)throw new _t(t,`>= ${n} && <= ${r}`,e)}),wa=Te((e,t,n=!1)=>{if(typeof e!="number")throw new pe(t,"number",e);if(!oi(e))throw new _t(t,"an integer",e);const r=n?1:0,a=4294967295;if(e<r||e>a)throw new _t(t,`>= ${r} && <= ${a}`,e)});function ai(e,t){if(typeof e!="string")throw new pe(t,"string",e)}function Bl(e,t,n=void 0,r){if(typeof e!="number")throw new pe(t,"number",e);if(n!=null&&e<n||r!=null&&e>r||(n!=null||r!=null)&&Rl(e))throw new _t(t,`${n!=null?`>= ${n}`:""}${n!=null&&r!=null?" && ":""}${r!=null?`<= ${r}`:""}`,e)}const ql=Te((e,t,n)=>{if(!ga(n,e)){const a="must be one of: "+pa(El(n,s=>typeof s=="string"?`'${s}'`:vl(s)),", ");throw new Ct(t,e,a)}});function ya(e,t){if(typeof e!="boolean")throw new pe(t,"boolean",e)}function er(e,t,n){return e==null||!$l(e,t)?n:e[t]}const Gl=Te((e,t,n=null)=>{const r=er(n,"allowArray",!1),a=er(n,"allowFunction",!1);if(!er(n,"nullable",!1)&&e===null||!r&&ii(e)||typeof e!="object"&&(!a||typeof e!="function"))throw new pe(t,"Object",e)}),Hl=Te((e,t)=>{if(e!=null&&typeof e!="object"&&typeof e!="function")throw new pe(t,"a dictionary",e)}),si=Te((e,t,n=0)=>{if(!ii(e))throw new pe(t,"Array",e);if(e.length<n){const r=`must be longer than ${n}`;throw new Ct(t,e,r)}});function Vl(e,t){si(e,t);for(let n=0;n<e.length;n++)ai(e[n],`${t}[${n}]`)}function Kl(e,t){si(e,t);for(let n=0;n<e.length;n++)ya(e[n],`${t}[${n}]`)}function zl(e,t="signal"){if(ai(e,t),Wi[e]===void 0)throw Wi[Nl(e)]!==void 0?new xi(e+" (signals must use all capital letters)"):new xi(e)}const Yl=Te((e,t="buffer")=>{if(!Ll(e))throw new pe(t,["Buffer","TypedArray","DataView"],e)});function Jl(e,t){const n=Cl(t),r=e.length;if(n==="hex"&&r%2!==0)throw new Ct("encoding",t,`is invalid for data of length ${r}`)}function Xl(e,t="Port",n=!0){if(typeof e!="number"&&typeof e!="string"||typeof e=="string"&&Pl(e).length===0||+e!==+e>>>0||e>65535||e===0&&!n)throw new Ol(t,e,n);return e|0}const Zl=Te((e,t)=>{if(e!==void 0&&(e===null||typeof e!="object"||!("aborted"in e)))throw new pe(t,"AbortSignal",e)}),Ql=Te((e,t)=>{if(typeof e!="function")throw new pe(t,"Function",e)}),ed=Te((e,t)=>{if(typeof e!="function"||Ml(e))throw new pe(t,"Function",e)}),td=Te((e,t)=>{if(e!==void 0)throw new pe(t,"undefined",e)});function nd(e,t,n){if(!ga(n,e))throw new pe(t,`('${pa(n,"|")}')`,e)}const rd=/^(?:<[^>]*>)(?:\s*;\s*[^;"\s]+(?:=(")?[^;"\s]*\1)?)*$/;function Fi(e,t){if(typeof e>"u"||!_a(rd,e))throw new Ct(t,e,'must be an array or string of format "</styles.css>; rel=preload; as=style"')}function id(e){if(typeof e=="string")return Fi(e,"hints"),e;if(ii(e)){const t=e.length;let n="";if(t===0)return n;for(let r=0;r<t;r++){const a=e[r];Fi(a,"hints"),n+=a,r!==t-1&&(n+=", ")}return n}throw new Ct("hints",e,'must be an array or string of format "</styles.css>; rel=preload; as=style"')}var In={isInt32:Dl,isUint32:kl,parseFileMode:Fl,validateArray:si,validateStringArray:Vl,validateBooleanArray:Kl,validateBoolean:ya,validateBuffer:Yl,validateDictionary:Hl,validateEncoding:Jl,validateFunction:Ql,validateInt32:Ul,validateInteger:jl,validateNumber:Bl,validateObject:Gl,validateOneOf:ql,validatePlainFunction:ed,validatePort:Xl,validateSignalName:zl,validateString:ai,validateUint32:wa,validateUndefined:td,validateUnion:nd,validateAbortSignal:Zl,validateLinkHeaderValue:id},li={exports:{}};const{Symbol:Tn,SymbolAsyncIterator:ji,SymbolIterator:Ui,SymbolFor:ma}=oe,Sa=Tn("kDestroyed"),Ea=Tn("kIsErrored"),kr=Tn("kIsReadable"),Ra=Tn("kIsDisturbed"),od=ma("nodejs.webstream.isClosedPromise"),ad=ma("nodejs.webstream.controllerErrorFunction");function $n(e,t=!1){var n;return!!(e&&typeof e.pipe=="function"&&typeof e.on=="function"&&(!t||typeof e.pause=="function"&&typeof e.resume=="function")&&(!e._writableState||((n=e._readableState)===null||n===void 0?void 0:n.readable)!==!1)&&(!e._writableState||e._readableState))}function vn(e){var t;return!!(e&&typeof e.write=="function"&&typeof e.on=="function"&&(!e._readableState||((t=e._writableState)===null||t===void 0?void 0:t.writable)!==!1))}function sd(e){return!!(e&&typeof e.pipe=="function"&&e._readableState&&typeof e.on=="function"&&typeof e.write=="function")}function Be(e){return e&&(e._readableState||e._writableState||typeof e.write=="function"&&typeof e.on=="function"||typeof e.pipe=="function"&&typeof e.on=="function")}function Aa(e){return!!(e&&!Be(e)&&typeof e.pipeThrough=="function"&&typeof e.getReader=="function"&&typeof e.cancel=="function")}function Ia(e){return!!(e&&!Be(e)&&typeof e.getWriter=="function"&&typeof e.abort=="function")}function Ta(e){return!!(e&&!Be(e)&&typeof e.readable=="object"&&typeof e.writable=="object")}function ld(e){return Aa(e)||Ia(e)||Ta(e)}function dd(e,t){return e==null?!1:t===!0?typeof e[ji]=="function":t===!1?typeof e[Ui]=="function":typeof e[ji]=="function"||typeof e[Ui]=="function"}function Nn(e){if(!Be(e))return null;const t=e._writableState,n=e._readableState,r=t||n;return!!(e.destroyed||e[Sa]||r!=null&&r.destroyed)}function $a(e){if(!vn(e))return null;if(e.writableEnded===!0)return!0;const t=e._writableState;return t!=null&&t.errored?!1:typeof(t==null?void 0:t.ended)!="boolean"?null:t.ended}function ud(e,t){if(!vn(e))return null;if(e.writableFinished===!0)return!0;const n=e._writableState;return n!=null&&n.errored?!1:typeof(n==null?void 0:n.finished)!="boolean"?null:!!(n.finished||t===!1&&n.ended===!0&&n.length===0)}function fd(e){if(!$n(e))return null;if(e.readableEnded===!0)return!0;const t=e._readableState;return!t||t.errored?!1:typeof(t==null?void 0:t.ended)!="boolean"?null:t.ended}function va(e,t){if(!$n(e))return null;const n=e._readableState;return n!=null&&n.errored?!1:typeof(n==null?void 0:n.endEmitted)!="boolean"?null:!!(n.endEmitted||t===!1&&n.ended===!0&&n.length===0)}function Na(e){return e&&e[kr]!=null?e[kr]:typeof(e==null?void 0:e.readable)!="boolean"?null:Nn(e)?!1:$n(e)&&e.readable&&!va(e)}function Pa(e){return typeof(e==null?void 0:e.writable)!="boolean"?null:Nn(e)?!1:vn(e)&&e.writable&&!$a(e)}function cd(e,t){return Be(e)?Nn(e)?!0:!((t==null?void 0:t.readable)!==!1&&Na(e)||(t==null?void 0:t.writable)!==!1&&Pa(e)):null}function hd(e){var t,n;return Be(e)?e.writableErrored?e.writableErrored:(t=(n=e._writableState)===null||n===void 0?void 0:n.errored)!==null&&t!==void 0?t:null:null}function bd(e){var t,n;return Be(e)?e.readableErrored?e.readableErrored:(t=(n=e._readableState)===null||n===void 0?void 0:n.errored)!==null&&t!==void 0?t:null:null}function gd(e){if(!Be(e))return null;if(typeof e.closed=="boolean")return e.closed;const t=e._writableState,n=e._readableState;return typeof(t==null?void 0:t.closed)=="boolean"||typeof(n==null?void 0:n.closed)=="boolean"?(t==null?void 0:t.closed)||(n==null?void 0:n.closed):typeof e._closed=="boolean"&&Oa(e)?e._closed:null}function Oa(e){return typeof e._closed=="boolean"&&typeof e._defaultKeepAlive=="boolean"&&typeof e._removedConnection=="boolean"&&typeof e._removedContLen=="boolean"}function Ca(e){return typeof e._sent100=="boolean"&&Oa(e)}function pd(e){var t;return typeof e._consuming=="boolean"&&typeof e._dumped=="boolean"&&((t=e.req)===null||t===void 0?void 0:t.upgradeOrConnect)===void 0}function _d(e){if(!Be(e))return null;const t=e._writableState,n=e._readableState,r=t||n;return!r&&Ca(e)||!!(r&&r.autoDestroy&&r.emitClose&&r.closed===!1)}function wd(e){var t;return!!(e&&((t=e[Ra])!==null&&t!==void 0?t:e.readableDidRead||e.readableAborted))}function yd(e){var t,n,r,a,s,l,c,b,f,h;return!!(e&&((t=(n=(r=(a=(s=(l=e[Ea])!==null&&l!==void 0?l:e.readableErrored)!==null&&s!==void 0?s:e.writableErrored)!==null&&a!==void 0?a:(c=e._readableState)===null||c===void 0?void 0:c.errorEmitted)!==null&&r!==void 0?r:(b=e._writableState)===null||b===void 0?void 0:b.errorEmitted)!==null&&n!==void 0?n:(f=e._readableState)===null||f===void 0?void 0:f.errored)!==null&&t!==void 0?t:!((h=e._writableState)===null||h===void 0)&&h.errored))}var Xe={kDestroyed:Sa,isDisturbed:wd,kIsDisturbed:Ra,isErrored:yd,kIsErrored:Ea,isReadable:Na,kIsReadable:kr,kIsClosedPromise:od,kControllerErrorFunction:ad,isClosed:gd,isDestroyed:Nn,isDuplexNodeStream:sd,isFinished:cd,isIterable:dd,isReadableNodeStream:$n,isReadableStream:Aa,isReadableEnded:fd,isReadableFinished:va,isReadableErrored:bd,isNodeStream:Be,isWebStream:ld,isWritable:Pa,isWritableNodeStream:vn,isWritableStream:Ia,isWritableEnded:$a,isWritableFinished:ud,isWritableErrored:hd,isServerRequest:pd,isServerResponse:Ca,willEmitClose:_d,isTransformStream:Ta};const et=ye,{AbortError:Ma,codes:md}=me,{ERR_INVALID_ARG_TYPE:Sd,ERR_STREAM_PREMATURE_CLOSE:Bi}=md,{kEmptyObject:xr,once:Wr}=Je,{validateAbortSignal:Ed,validateFunction:Rd,validateObject:Ad,validateBoolean:Id}=In,{Promise:Td,PromisePrototypeThen:$d}=oe,{isClosed:vd,isReadable:qi,isReadableNodeStream:tr,isReadableStream:Nd,isReadableFinished:Gi,isReadableErrored:Hi,isWritable:Vi,isWritableNodeStream:Ki,isWritableStream:Pd,isWritableFinished:zi,isWritableErrored:Yi,isNodeStream:Od,willEmitClose:Cd,kIsClosedPromise:Md}=Xe;function Ld(e){return e.setHeader&&typeof e.abort=="function"}const Fr=()=>{};function La(e,t,n){var r,a;if(arguments.length===2?(n=t,t=xr):t==null?t=xr:Ad(t,"options"),Rd(n,"callback"),Ed(t.signal,"options.signal"),n=Wr(n),Nd(e)||Pd(e))return Dd(e,t,n);if(!Od(e))throw new Sd("stream",["ReadableStream","WritableStream","Stream"],e);const s=(r=t.readable)!==null&&r!==void 0?r:tr(e),l=(a=t.writable)!==null&&a!==void 0?a:Ki(e),c=e._writableState,b=e._readableState,f=()=>{e.writable||E()};let h=Cd(e)&&tr(e)===s&&Ki(e)===l,A=zi(e,!1);const E=()=>{A=!0,e.destroyed&&(h=!1),!(h&&(!e.readable||s))&&(!s||_)&&n.call(e)};let _=Gi(e,!1);const g=()=>{_=!0,e.destroyed&&(h=!1),!(h&&(!e.writable||l))&&(!l||A)&&n.call(e)},L=C=>{n.call(e,C)};let P=vd(e);const I=()=>{P=!0;const C=Yi(e)||Hi(e);if(C&&typeof C!="boolean")return n.call(e,C);if(s&&!_&&tr(e,!0)&&!Gi(e,!1))return n.call(e,new Bi);if(l&&!A&&!zi(e,!1))return n.call(e,new Bi);n.call(e)},w=()=>{P=!0;const C=Yi(e)||Hi(e);if(C&&typeof C!="boolean")return n.call(e,C);n.call(e)},O=()=>{e.req.on("finish",E)};Ld(e)?(e.on("complete",E),h||e.on("abort",I),e.req?O():e.on("request",O)):l&&!c&&(e.on("end",f),e.on("close",f)),!h&&typeof e.aborted=="boolean"&&e.on("aborted",I),e.on("end",g),e.on("finish",E),t.error!==!1&&e.on("error",L),e.on("close",I),P?et.nextTick(I):c!=null&&c.errorEmitted||b!=null&&b.errorEmitted?h||et.nextTick(w):(!s&&(!h||qi(e))&&(A||Vi(e)===!1)||!l&&(!h||Vi(e))&&(_||qi(e)===!1)||b&&e.req&&e.aborted)&&et.nextTick(w);const B=()=>{n=Fr,e.removeListener("aborted",I),e.removeListener("complete",E),e.removeListener("abort",I),e.removeListener("request",O),e.req&&e.req.removeListener("finish",E),e.removeListener("end",f),e.removeListener("close",f),e.removeListener("finish",E),e.removeListener("end",g),e.removeListener("error",L),e.removeListener("close",I)};if(t.signal&&!P){const C=()=>{const H=n;B(),H.call(e,new Ma(void 0,{cause:t.signal.reason}))};if(t.signal.aborted)et.nextTick(C);else{const H=n;n=Wr((...q)=>{t.signal.removeEventListener("abort",C),H.apply(e,q)}),t.signal.addEventListener("abort",C)}}return B}function Dd(e,t,n){let r=!1,a=Fr;if(t.signal)if(a=()=>{r=!0,n.call(e,new Ma(void 0,{cause:t.signal.reason}))},t.signal.aborted)et.nextTick(a);else{const l=n;n=Wr((...c)=>{t.signal.removeEventListener("abort",a),l.apply(e,c)}),t.signal.addEventListener("abort",a)}const s=(...l)=>{r||et.nextTick(()=>n.apply(e,l))};return $d(e[Md].promise,s,s),Fr}function kd(e,t){var n;let r=!1;return t===null&&(t=xr),(n=t)!==null&&n!==void 0&&n.cleanup&&(Id(t.cleanup,"cleanup"),r=t.cleanup),new Td((a,s)=>{const l=La(e,t,c=>{r&&l(),c?s(c):a()})})}li.exports=La;li.exports.finished=kd;var it=li.exports;const We=ye,{aggregateTwoErrors:xd,codes:{ERR_MULTIPLE_CALLBACK:Wd},AbortError:Fd}=me,{Symbol:Da}=oe,{kDestroyed:jd,isDestroyed:Ud,isFinished:Bd,isServerRequest:qd}=Xe,ka=Da("kDestroy"),jr=Da("kConstruct");function xa(e,t,n){e&&(e.stack,t&&!t.errored&&(t.errored=e),n&&!n.errored&&(n.errored=e))}function Gd(e,t){const n=this._readableState,r=this._writableState,a=r||n;return r!=null&&r.destroyed||n!=null&&n.destroyed?(typeof t=="function"&&t(),this):(xa(e,r,n),r&&(r.destroyed=!0),n&&(n.destroyed=!0),a.constructed?Ji(this,e,t):this.once(ka,function(s){Ji(this,xd(s,e),t)}),this)}function Ji(e,t,n){let r=!1;function a(s){if(r)return;r=!0;const l=e._readableState,c=e._writableState;xa(s,c,l),c&&(c.closed=!0),l&&(l.closed=!0),typeof n=="function"&&n(s),s?We.nextTick(Hd,e,s):We.nextTick(Wa,e)}try{e._destroy(t||null,a)}catch(s){a(s)}}function Hd(e,t){Ur(e,t),Wa(e)}function Wa(e){const t=e._readableState,n=e._writableState;n&&(n.closeEmitted=!0),t&&(t.closeEmitted=!0),(n!=null&&n.emitClose||t!=null&&t.emitClose)&&e.emit("close")}function Ur(e,t){const n=e._readableState,r=e._writableState;r!=null&&r.errorEmitted||n!=null&&n.errorEmitted||(r&&(r.errorEmitted=!0),n&&(n.errorEmitted=!0),e.emit("error",t))}function Vd(){const e=this._readableState,t=this._writableState;e&&(e.constructed=!0,e.closed=!1,e.closeEmitted=!1,e.destroyed=!1,e.errored=null,e.errorEmitted=!1,e.reading=!1,e.ended=e.readable===!1,e.endEmitted=e.readable===!1),t&&(t.constructed=!0,t.destroyed=!1,t.closed=!1,t.closeEmitted=!1,t.errored=null,t.errorEmitted=!1,t.finalCalled=!1,t.prefinished=!1,t.ended=t.writable===!1,t.ending=t.writable===!1,t.finished=t.writable===!1)}function Br(e,t,n){const r=e._readableState,a=e._writableState;if(a!=null&&a.destroyed||r!=null&&r.destroyed)return this;r!=null&&r.autoDestroy||a!=null&&a.autoDestroy?e.destroy(t):t&&(t.stack,a&&!a.errored&&(a.errored=t),r&&!r.errored&&(r.errored=t),n?We.nextTick(Ur,e,t):Ur(e,t))}function Kd(e,t){if(typeof e._construct!="function")return;const n=e._readableState,r=e._writableState;n&&(n.constructed=!1),r&&(r.constructed=!1),e.once(jr,t),!(e.listenerCount(jr)>1)&&We.nextTick(zd,e)}function zd(e){let t=!1;function n(r){if(t){Br(e,r??new Wd);return}t=!0;const a=e._readableState,s=e._writableState,l=s||a;a&&(a.constructed=!0),s&&(s.constructed=!0),l.destroyed?e.emit(ka,r):r?Br(e,r,!0):We.nextTick(Yd,e)}try{e._construct(r=>{We.nextTick(n,r)})}catch(r){We.nextTick(n,r)}}function Yd(e){e.emit(jr)}function Xi(e){return(e==null?void 0:e.setHeader)&&typeof e.abort=="function"}function Fa(e){e.emit("close")}function Jd(e,t){e.emit("error",t),We.nextTick(Fa,e)}function Xd(e,t){!e||Ud(e)||(!t&&!Bd(e)&&(t=new Fd),qd(e)?(e.socket=null,e.destroy(t)):Xi(e)?e.abort():Xi(e.req)?e.req.abort():typeof e.destroy=="function"?e.destroy(t):typeof e.close=="function"?e.close():t?We.nextTick(Jd,e,t):We.nextTick(Fa,e),e.destroyed||(e[jd]=!0))}var Mt={construct:Kd,destroyer:Xd,destroy:Gd,undestroy:Vd,errorOrDestroy:Br};const{ArrayIsArray:Zd,ObjectSetPrototypeOf:ja}=oe,{EventEmitter:Pn}=yt;function On(e){Pn.call(this,e)}ja(On.prototype,Pn.prototype);ja(On,Pn);On.prototype.pipe=function(e,t){const n=this;function r(h){e.writable&&e.write(h)===!1&&n.pause&&n.pause()}n.on("data",r);function a(){n.readable&&n.resume&&n.resume()}e.on("drain",a),!e._isStdio&&(!t||t.end!==!1)&&(n.on("end",l),n.on("close",c));let s=!1;function l(){s||(s=!0,e.end())}function c(){s||(s=!0,typeof e.destroy=="function"&&e.destroy())}function b(h){f(),Pn.listenerCount(this,"error")===0&&this.emit("error",h)}qr(n,"error",b),qr(e,"error",b);function f(){n.removeListener("data",r),e.removeListener("drain",a),n.removeListener("end",l),n.removeListener("close",c),n.removeListener("error",b),e.removeListener("error",b),n.removeListener("end",f),n.removeListener("close",f),e.removeListener("close",f)}return n.on("end",f),n.on("close",f),e.on("close",f),e.emit("pipe",n),e};function qr(e,t,n){if(typeof e.prependListener=="function")return e.prependListener(t,n);!e._events||!e._events[t]?e.on(t,n):Zd(e._events[t])?e._events[t].unshift(n):e._events[t]=[n,e._events[t]]}var di={Stream:On,prependListener:qr},Ua={exports:{}};(function(e){const{AbortError:t,codes:n}=me,{isNodeStream:r,isWebStream:a,kControllerErrorFunction:s}=Xe,l=it,{ERR_INVALID_ARG_TYPE:c}=n,b=(f,h)=>{if(typeof f!="object"||!("aborted"in f))throw new c(h,"AbortSignal",f)};e.exports.addAbortSignal=function(h,A){if(b(h,"signal"),!r(A)&&!a(A))throw new c("stream",["ReadableStream","WritableStream","Stream"],A);return e.exports.addAbortSignalNoValidate(h,A)},e.exports.addAbortSignalNoValidate=function(f,h){if(typeof f!="object"||!("aborted"in f))return h;const A=r(h)?()=>{h.destroy(new t(void 0,{cause:f.reason}))}:()=>{h[s](new t(void 0,{cause:f.reason}))};return f.aborted?A():(f.addEventListener("abort",A),l(h,()=>f.removeEventListener("abort",A))),h}})(Ua);var Cn=Ua.exports;const{StringPrototypeSlice:Zi,SymbolIterator:Qd,TypedArrayPrototypeSet:Qt,Uint8Array:eu}=oe,{Buffer:nr}=we,{inspect:tu}=Je;var nu=class{constructor(){this.head=null,this.tail=null,this.length=0}push(t){const n={data:t,next:null};this.length>0?this.tail.next=n:this.head=n,this.tail=n,++this.length}unshift(t){const n={data:t,next:this.head};this.length===0&&(this.tail=n),this.head=n,++this.length}shift(){if(this.length===0)return;const t=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,t}clear(){this.head=this.tail=null,this.length=0}join(t){if(this.length===0)return"";let n=this.head,r=""+n.data;for(;(n=n.next)!==null;)r+=t+n.data;return r}concat(t){if(this.length===0)return nr.alloc(0);const n=nr.allocUnsafe(t>>>0);let r=this.head,a=0;for(;r;)Qt(n,r.data,a),a+=r.data.length,r=r.next;return n}consume(t,n){const r=this.head.data;if(t<r.length){const a=r.slice(0,t);return this.head.data=r.slice(t),a}return t===r.length?this.shift():n?this._getString(t):this._getBuffer(t)}first(){return this.head.data}*[Qd](){for(let t=this.head;t;t=t.next)yield t.data}_getString(t){let n="",r=this.head,a=0;do{const s=r.data;if(t>s.length)n+=s,t-=s.length;else{t===s.length?(n+=s,++a,r.next?this.head=r.next:this.head=this.tail=null):(n+=Zi(s,0,t),this.head=r,r.data=Zi(s,t));break}++a}while((r=r.next)!==null);return this.length-=a,n}_getBuffer(t){const n=nr.allocUnsafe(t),r=t;let a=this.head,s=0;do{const l=a.data;if(t>l.length)Qt(n,l,r-t),t-=l.length;else{t===l.length?(Qt(n,l,r-t),++s,a.next?this.head=a.next:this.head=this.tail=null):(Qt(n,new eu(l.buffer,l.byteOffset,t),r-t),this.head=a,a.data=l.slice(t));break}++s}while((a=a.next)!==null);return this.length-=s,n}[Symbol.for("nodejs.util.inspect.custom")](t,n){return tu(this,{...n,depth:0,customInspect:!1})}};const{MathFloor:ru,NumberIsInteger:iu}=oe,{ERR_INVALID_ARG_VALUE:ou}=me.codes;function au(e,t,n){return e.highWaterMark!=null?e.highWaterMark:t?e[n]:null}function Ba(e){return e?16:16*1024}function su(e,t,n,r){const a=au(t,r,n);if(a!=null){if(!iu(a)||a<0){const s=r?`options.${n}`:"options.highWaterMark";throw new ou(s,a)}return ru(a)}return Ba(e.objectMode)}var ui={getHighWaterMark:su,getDefaultHighWaterMark:Ba};const Qi=ye,{PromisePrototypeThen:lu,SymbolAsyncIterator:eo,SymbolIterator:to}=oe,{Buffer:du}=we,{ERR_INVALID_ARG_TYPE:uu,ERR_STREAM_NULL_VALUES:fu}=me.codes;function cu(e,t,n){let r;if(typeof t=="string"||t instanceof du)return new e({objectMode:!0,...n,read(){this.push(t),this.push(null)}});let a;if(t&&t[eo])a=!0,r=t[eo]();else if(t&&t[to])a=!1,r=t[to]();else throw new uu("iterable",["Iterable"],t);const s=new e({objectMode:!0,highWaterMark:1,...n});let l=!1;s._read=function(){l||(l=!0,b())},s._destroy=function(f,h){lu(c(f),()=>Qi.nextTick(h,f),A=>Qi.nextTick(h,A||f))};async function c(f){const h=f!=null,A=typeof r.throw=="function";if(h&&A){const{value:E,done:_}=await r.throw(f);if(await E,_)return}if(typeof r.return=="function"){const{value:E}=await r.return();await E}}async function b(){for(;;){try{const{value:f,done:h}=a?await r.next():r.next();if(h)s.push(null);else{const A=f&&typeof f.then=="function"?await f:f;if(A===null)throw l=!1,new fu;if(s.push(A))continue;l=!1}}catch(f){s.destroy(f)}break}}return s}var qa=cu,rr,no;function Mn(){if(no)return rr;no=1;const e=ye,{ArrayPrototypeIndexOf:t,NumberIsInteger:n,NumberIsNaN:r,NumberParseInt:a,ObjectDefineProperties:s,ObjectKeys:l,ObjectSetPrototypeOf:c,Promise:b,SafeSet:f,SymbolAsyncIterator:h,Symbol:A}=oe;rr=m,m.ReadableState=Q;const{EventEmitter:E}=yt,{Stream:_,prependListener:g}=di,{Buffer:L}=we,{addAbortSignal:P}=Cn,I=it;let w=Je.debuglog("stream",i=>{w=i});const O=nu,B=Mt,{getHighWaterMark:C,getDefaultHighWaterMark:H}=ui,{aggregateTwoErrors:q,codes:{ERR_INVALID_ARG_TYPE:V,ERR_METHOD_NOT_IMPLEMENTED:U,ERR_OUT_OF_RANGE:y,ERR_STREAM_PUSH_AFTER_EOF:D,ERR_STREAM_UNSHIFT_AFTER_END_EVENT:K}}=me,{validateObject:k}=In,x=A("kPaused"),{StringDecoder:N}=ca,G=qa;c(m.prototype,_.prototype),c(m,_);const z=()=>{},{errorOrDestroy:W}=B;function Q(i,o,S){typeof S!="boolean"&&(S=o instanceof Ve()),this.objectMode=!!(i&&i.objectMode),S&&(this.objectMode=this.objectMode||!!(i&&i.readableObjectMode)),this.highWaterMark=i?C(this,i,"readableHighWaterMark",S):H(!1),this.buffer=new O,this.length=0,this.pipes=[],this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.constructed=!0,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this[x]=null,this.errorEmitted=!1,this.emitClose=!i||i.emitClose!==!1,this.autoDestroy=!i||i.autoDestroy!==!1,this.destroyed=!1,this.errored=null,this.closed=!1,this.closeEmitted=!1,this.defaultEncoding=i&&i.defaultEncoding||"utf8",this.awaitDrainWriters=null,this.multiAwaitDrain=!1,this.readingMore=!1,this.dataEmitted=!1,this.decoder=null,this.encoding=null,i&&i.encoding&&(this.decoder=new N(i.encoding),this.encoding=i.encoding)}function m(i){if(!(this instanceof m))return new m(i);const o=this instanceof Ve();this._readableState=new Q(i,this,o),i&&(typeof i.read=="function"&&(this._read=i.read),typeof i.destroy=="function"&&(this._destroy=i.destroy),typeof i.construct=="function"&&(this._construct=i.construct),i.signal&&!o&&P(i.signal,this)),_.call(this,i),B.construct(this,()=>{this._readableState.needReadable&&le(this,this._readableState)})}m.prototype.destroy=B.destroy,m.prototype._undestroy=B.undestroy,m.prototype._destroy=function(i,o){o(i)},m.prototype[E.captureRejectionSymbol]=function(i){this.destroy(i)},m.prototype.push=function(i,o){return J(this,i,o,!1)},m.prototype.unshift=function(i,o){return J(this,i,o,!0)};function J(i,o,S,R){w("readableAddChunk",o);const T=i._readableState;let Y;if(T.objectMode||(typeof o=="string"?(S=S||T.defaultEncoding,T.encoding!==S&&(R&&T.encoding?o=L.from(o,S).toString(T.encoding):(o=L.from(o,S),S=""))):o instanceof L?S="":_._isUint8Array(o)?(o=_._uint8ArrayToBuffer(o),S=""):o!=null&&(Y=new V("chunk",["string","Buffer","Uint8Array"],o))),Y)W(i,Y);else if(o===null)T.reading=!1,at(i,T);else if(T.objectMode||o&&o.length>0)if(R)if(T.endEmitted)W(i,new K);else{if(T.destroyed||T.errored)return!1;ne(i,T,o,!0)}else if(T.ended)W(i,new D);else{if(T.destroyed||T.errored)return!1;T.reading=!1,T.decoder&&!S?(o=T.decoder.write(o),T.objectMode||o.length!==0?ne(i,T,o,!1):le(i,T)):ne(i,T,o,!1)}else R||(T.reading=!1,le(i,T));return!T.ended&&(T.length<T.highWaterMark||T.length===0)}function ne(i,o,S,R){o.flowing&&o.length===0&&!o.sync&&i.listenerCount("data")>0?(o.multiAwaitDrain?o.awaitDrainWriters.clear():o.awaitDrainWriters=null,o.dataEmitted=!0,i.emit("data",S)):(o.length+=o.objectMode?1:S.length,R?o.buffer.unshift(S):o.buffer.push(S),o.needReadable&&Ee(i)),le(i,o)}m.prototype.isPaused=function(){const i=this._readableState;return i[x]===!0||i.flowing===!1},m.prototype.setEncoding=function(i){const o=new N(i);this._readableState.decoder=o,this._readableState.encoding=this._readableState.decoder.encoding;const S=this._readableState.buffer;let R="";for(const T of S)R+=o.write(T);return S.clear(),R!==""&&S.push(R),this._readableState.length=R.length,this};const ve=1073741824;function Ne(i){if(i>ve)throw new y("size","<= 1GiB",i);return i--,i|=i>>>1,i|=i>>>2,i|=i>>>4,i|=i>>>8,i|=i>>>16,i++,i}function ce(i,o){return i<=0||o.length===0&&o.ended?0:o.objectMode?1:r(i)?o.flowing&&o.length?o.buffer.first().length:o.length:i<=o.length?i:o.ended?o.length:0}m.prototype.read=function(i){w("read",i),i===void 0?i=NaN:n(i)||(i=a(i,10));const o=this._readableState,S=i;if(i>o.highWaterMark&&(o.highWaterMark=Ne(i)),i!==0&&(o.emittedReadable=!1),i===0&&o.needReadable&&((o.highWaterMark!==0?o.length>=o.highWaterMark:o.length>0)||o.ended))return w("read: emitReadable",o.length,o.ended),o.length===0&&o.ended?ee(this):Ee(this),null;if(i=ce(i,o),i===0&&o.ended)return o.length===0&&ee(this),null;let R=o.needReadable;if(w("need readable",R),(o.length===0||o.length-i<o.highWaterMark)&&(R=!0,w("length less than watermark",R)),o.ended||o.reading||o.destroyed||o.errored||!o.constructed)R=!1,w("reading, ended or constructing",R);else if(R){w("do read"),o.reading=!0,o.sync=!0,o.length===0&&(o.needReadable=!0);try{this._read(o.highWaterMark)}catch(Y){W(this,Y)}o.sync=!1,o.reading||(i=ce(S,o))}let T;return i>0?T=j(i,o):T=null,T===null?(o.needReadable=o.length<=o.highWaterMark,i=0):(o.length-=i,o.multiAwaitDrain?o.awaitDrainWriters.clear():o.awaitDrainWriters=null),o.length===0&&(o.ended||(o.needReadable=!0),S!==i&&o.ended&&ee(this)),T!==null&&!o.errorEmitted&&!o.closeEmitted&&(o.dataEmitted=!0,this.emit("data",T)),T};function at(i,o){if(w("onEofChunk"),!o.ended){if(o.decoder){const S=o.decoder.end();S&&S.length&&(o.buffer.push(S),o.length+=o.objectMode?1:S.length)}o.ended=!0,o.sync?Ee(i):(o.needReadable=!1,o.emittedReadable=!0,Re(i))}}function Ee(i){const o=i._readableState;w("emitReadable",o.needReadable,o.emittedReadable),o.needReadable=!1,o.emittedReadable||(w("emitReadable",o.flowing),o.emittedReadable=!0,e.nextTick(Re,i))}function Re(i){const o=i._readableState;w("emitReadable_",o.destroyed,o.length,o.ended),!o.destroyed&&!o.errored&&(o.length||o.ended)&&(i.emit("readable"),o.emittedReadable=!1),o.needReadable=!o.flowing&&!o.ended&&o.length<=o.highWaterMark,$(i)}function le(i,o){!o.readingMore&&o.constructed&&(o.readingMore=!0,e.nextTick(st,i,o))}function st(i,o){for(;!o.reading&&!o.ended&&(o.length<o.highWaterMark||o.flowing&&o.length===0);){const S=o.length;if(w("maybeReadMore read 0"),i.read(0),S===o.length)break}o.readingMore=!1}m.prototype._read=function(i){throw new U("_read()")},m.prototype.pipe=function(i,o){const S=this,R=this._readableState;R.pipes.length===1&&(R.multiAwaitDrain||(R.multiAwaitDrain=!0,R.awaitDrainWriters=new f(R.awaitDrainWriters?[R.awaitDrainWriters]:[]))),R.pipes.push(i),w("pipe count=%d opts=%j",R.pipes.length,o);const Y=(!o||o.end!==!1)&&i!==e.stdout&&i!==e.stderr?xt:Me;R.endEmitted?e.nextTick(Y):S.once("end",Y),i.on("unpipe",Z);function Z(be,ie){w("onunpipe"),be===S&&ie&&ie.hasUnpiped===!1&&(ie.hasUnpiped=!0,Xn())}function xt(){w("onend"),i.end()}let he,Wt=!1;function Xn(){w("cleanup"),i.removeListener("close",dt),i.removeListener("finish",ut),he&&i.removeListener("drain",he),i.removeListener("error",lt),i.removeListener("unpipe",Z),S.removeListener("end",xt),S.removeListener("end",Me),S.removeListener("data",jt),Wt=!0,he&&R.awaitDrainWriters&&(!i._writableState||i._writableState.needDrain)&&he()}function Ft(){Wt||(R.pipes.length===1&&R.pipes[0]===i?(w("false write response, pause",0),R.awaitDrainWriters=i,R.multiAwaitDrain=!1):R.pipes.length>1&&R.pipes.includes(i)&&(w("false write response, pause",R.awaitDrainWriters.size),R.awaitDrainWriters.add(i)),S.pause()),he||(he=Pe(S,i),i.on("drain",he))}S.on("data",jt);function jt(be){w("ondata");const ie=i.write(be);w("dest.write",ie),ie===!1&&Ft()}function lt(be){if(w("onerror",be),Me(),i.removeListener("error",lt),i.listenerCount("error")===0){const ie=i._writableState||i._readableState;ie&&!ie.errorEmitted?W(i,be):i.emit("error",be)}}g(i,"error",lt);function dt(){i.removeListener("finish",ut),Me()}i.once("close",dt);function ut(){w("onfinish"),i.removeListener("close",dt),Me()}i.once("finish",ut);function Me(){w("unpipe"),S.unpipe(i)}return i.emit("pipe",S),i.writableNeedDrain===!0?R.flowing&&Ft():R.flowing||(w("pipe resume"),S.resume()),i};function Pe(i,o){return function(){const R=i._readableState;R.awaitDrainWriters===o?(w("pipeOnDrain",1),R.awaitDrainWriters=null):R.multiAwaitDrain&&(w("pipeOnDrain",R.awaitDrainWriters.size),R.awaitDrainWriters.delete(o)),(!R.awaitDrainWriters||R.awaitDrainWriters.size===0)&&i.listenerCount("data")&&i.resume()}}m.prototype.unpipe=function(i){const o=this._readableState,S={hasUnpiped:!1};if(o.pipes.length===0)return this;if(!i){const T=o.pipes;o.pipes=[],this.pause();for(let Y=0;Y<T.length;Y++)T[Y].emit("unpipe",this,{hasUnpiped:!1});return this}const R=t(o.pipes,i);return R===-1?this:(o.pipes.splice(R,1),o.pipes.length===0&&this.pause(),i.emit("unpipe",this,S),this)},m.prototype.on=function(i,o){const S=_.prototype.on.call(this,i,o),R=this._readableState;return i==="data"?(R.readableListening=this.listenerCount("readable")>0,R.flowing!==!1&&this.resume()):i==="readable"&&!R.endEmitted&&!R.readableListening&&(R.readableListening=R.needReadable=!0,R.flowing=!1,R.emittedReadable=!1,w("on readable",R.length,R.reading),R.length?Ee(this):R.reading||e.nextTick(d,this)),S},m.prototype.addListener=m.prototype.on,m.prototype.removeListener=function(i,o){const S=_.prototype.removeListener.call(this,i,o);return i==="readable"&&e.nextTick(Oe,this),S},m.prototype.off=m.prototype.removeListener,m.prototype.removeAllListeners=function(i){const o=_.prototype.removeAllListeners.apply(this,arguments);return(i==="readable"||i===void 0)&&e.nextTick(Oe,this),o};function Oe(i){const o=i._readableState;o.readableListening=i.listenerCount("readable")>0,o.resumeScheduled&&o[x]===!1?o.flowing=!0:i.listenerCount("data")>0?i.resume():o.readableListening||(o.flowing=null)}function d(i){w("readable nexttick read 0"),i.read(0)}m.prototype.resume=function(){const i=this._readableState;return i.flowing||(w("resume"),i.flowing=!i.readableListening,u(this,i)),i[x]=!1,this};function u(i,o){o.resumeScheduled||(o.resumeScheduled=!0,e.nextTick(p,i,o))}function p(i,o){w("resume",o.reading),o.reading||i.read(0),o.resumeScheduled=!1,i.emit("resume"),$(i),o.flowing&&!o.reading&&i.read(0)}m.prototype.pause=function(){return w("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(w("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState[x]=!0,this};function $(i){const o=i._readableState;for(w("flow",o.flowing);o.flowing&&i.read()!==null;);}m.prototype.wrap=function(i){let o=!1;i.on("data",R=>{!this.push(R)&&i.pause&&(o=!0,i.pause())}),i.on("end",()=>{this.push(null)}),i.on("error",R=>{W(this,R)}),i.on("close",()=>{this.destroy()}),i.on("destroy",()=>{this.destroy()}),this._read=()=>{o&&i.resume&&(o=!1,i.resume())};const S=l(i);for(let R=1;R<S.length;R++){const T=S[R];this[T]===void 0&&typeof i[T]=="function"&&(this[T]=i[T].bind(i))}return this},m.prototype[h]=function(){return v(this)},m.prototype.iterator=function(i){return i!==void 0&&k(i,"options"),v(this,i)};function v(i,o){typeof i.read!="function"&&(i=m.wrap(i,{objectMode:!0}));const S=F(i,o);return S.stream=i,S}async function*F(i,o){let S=z;function R(Z){this===i?(S(),S=z):S=Z}i.on("readable",R);let T;const Y=I(i,{writable:!1},Z=>{T=Z?q(T,Z):null,S(),S=z});try{for(;;){const Z=i.destroyed?null:i.read();if(Z!==null)yield Z;else{if(T)throw T;if(T===null)return;await new b(R)}}}catch(Z){throw T=q(T,Z),T}finally{(T||(o==null?void 0:o.destroyOnReturn)!==!1)&&(T===void 0||i._readableState.autoDestroy)?B.destroyer(i,null):(i.off("readable",R),Y())}}s(m.prototype,{readable:{__proto__:null,get(){const i=this._readableState;return!!i&&i.readable!==!1&&!i.destroyed&&!i.errorEmitted&&!i.endEmitted},set(i){this._readableState&&(this._readableState.readable=!!i)}},readableDidRead:{__proto__:null,enumerable:!1,get:function(){return this._readableState.dataEmitted}},readableAborted:{__proto__:null,enumerable:!1,get:function(){return!!(this._readableState.readable!==!1&&(this._readableState.destroyed||this._readableState.errored)&&!this._readableState.endEmitted)}},readableHighWaterMark:{__proto__:null,enumerable:!1,get:function(){return this._readableState.highWaterMark}},readableBuffer:{__proto__:null,enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}},readableFlowing:{__proto__:null,enumerable:!1,get:function(){return this._readableState.flowing},set:function(i){this._readableState&&(this._readableState.flowing=i)}},readableLength:{__proto__:null,enumerable:!1,get(){return this._readableState.length}},readableObjectMode:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.objectMode:!1}},readableEncoding:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.encoding:null}},errored:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.errored:null}},closed:{__proto__:null,get(){return this._readableState?this._readableState.closed:!1}},destroyed:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.destroyed:!1},set(i){this._readableState&&(this._readableState.destroyed=i)}},readableEnded:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.endEmitted:!1}}}),s(Q.prototype,{pipesCount:{__proto__:null,get(){return this.pipes.length}},paused:{__proto__:null,get(){return this[x]!==!1},set(i){this[x]=!!i}}}),m._fromList=j;function j(i,o){if(o.length===0)return null;let S;return o.objectMode?S=o.buffer.shift():!i||i>=o.length?(o.decoder?S=o.buffer.join(""):o.buffer.length===1?S=o.buffer.first():S=o.buffer.concat(o.length),o.buffer.clear()):S=o.buffer.consume(i,o.decoder),S}function ee(i){const o=i._readableState;w("endReadable",o.endEmitted),o.endEmitted||(o.ended=!0,e.nextTick(Ae,o,i))}function Ae(i,o){if(w("endReadableNT",i.endEmitted,i.length),!i.errored&&!i.closeEmitted&&!i.endEmitted&&i.length===0){if(i.endEmitted=!0,o.emit("end"),o.writable&&o.allowHalfOpen===!1)e.nextTick(Ce,o);else if(i.autoDestroy){const S=o._writableState;(!S||S.autoDestroy&&(S.finished||S.writable===!1))&&o.destroy()}}}function Ce(i){i.writable&&!i.writableEnded&&!i.destroyed&&i.end()}m.from=function(i,o){return G(m,i,o)};let re;function kt(){return re===void 0&&(re={}),re}return m.fromWeb=function(i,o){return kt().newStreamReadableFromReadableStream(i,o)},m.toWeb=function(i,o){return kt().newReadableStreamFromStreamReadable(i,o)},m.wrap=function(i,o){var S,R;return new m({objectMode:(S=(R=i.readableObjectMode)!==null&&R!==void 0?R:i.objectMode)!==null&&S!==void 0?S:!0,...o,destroy(T,Y){B.destroyer(i,T),Y(T)}}).wrap(i)},rr}var ir,ro;function Ga(){if(ro)return ir;ro=1;const e=ye,{ArrayPrototypeSlice:t,Error:n,FunctionPrototypeSymbolHasInstance:r,ObjectDefineProperty:a,ObjectDefineProperties:s,ObjectSetPrototypeOf:l,StringPrototypeToLowerCase:c,Symbol:b,SymbolHasInstance:f}=oe;ir=N,N.WritableState=k;const{EventEmitter:h}=yt,A=di.Stream,{Buffer:E}=we,_=Mt,{addAbortSignal:g}=Cn,{getHighWaterMark:L,getDefaultHighWaterMark:P}=ui,{ERR_INVALID_ARG_TYPE:I,ERR_METHOD_NOT_IMPLEMENTED:w,ERR_MULTIPLE_CALLBACK:O,ERR_STREAM_CANNOT_PIPE:B,ERR_STREAM_DESTROYED:C,ERR_STREAM_ALREADY_FINISHED:H,ERR_STREAM_NULL_VALUES:q,ERR_STREAM_WRITE_AFTER_END:V,ERR_UNKNOWN_ENCODING:U}=me.codes,{errorOrDestroy:y}=_;l(N.prototype,A.prototype),l(N,A);function D(){}const K=b("kOnFinished");function k(d,u,p){typeof p!="boolean"&&(p=u instanceof Ve()),this.objectMode=!!(d&&d.objectMode),p&&(this.objectMode=this.objectMode||!!(d&&d.writableObjectMode)),this.highWaterMark=d?L(this,d,"writableHighWaterMark",p):P(!1),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;const $=!!(d&&d.decodeStrings===!1);this.decodeStrings=!$,this.defaultEncoding=d&&d.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=m.bind(void 0,u),this.writecb=null,this.writelen=0,this.afterWriteTickInfo=null,x(this),this.pendingcb=0,this.constructed=!0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!d||d.emitClose!==!1,this.autoDestroy=!d||d.autoDestroy!==!1,this.errored=null,this.closed=!1,this.closeEmitted=!1,this[K]=[]}function x(d){d.buffered=[],d.bufferedIndex=0,d.allBuffers=!0,d.allNoop=!0}k.prototype.getBuffer=function(){return t(this.buffered,this.bufferedIndex)},a(k.prototype,"bufferedRequestCount",{__proto__:null,get(){return this.buffered.length-this.bufferedIndex}});function N(d){const u=this instanceof Ve();if(!u&&!r(N,this))return new N(d);this._writableState=new k(d,this,u),d&&(typeof d.write=="function"&&(this._write=d.write),typeof d.writev=="function"&&(this._writev=d.writev),typeof d.destroy=="function"&&(this._destroy=d.destroy),typeof d.final=="function"&&(this._final=d.final),typeof d.construct=="function"&&(this._construct=d.construct),d.signal&&g(d.signal,this)),A.call(this,d),_.construct(this,()=>{const p=this._writableState;p.writing||Ne(this,p),Re(this,p)})}a(N,f,{__proto__:null,value:function(d){return r(this,d)?!0:this!==N?!1:d&&d._writableState instanceof k}}),N.prototype.pipe=function(){y(this,new B)};function G(d,u,p,$){const v=d._writableState;if(typeof p=="function")$=p,p=v.defaultEncoding;else{if(!p)p=v.defaultEncoding;else if(p!=="buffer"&&!E.isEncoding(p))throw new U(p);typeof $!="function"&&($=D)}if(u===null)throw new q;if(!v.objectMode)if(typeof u=="string")v.decodeStrings!==!1&&(u=E.from(u,p),p="buffer");else if(u instanceof E)p="buffer";else if(A._isUint8Array(u))u=A._uint8ArrayToBuffer(u),p="buffer";else throw new I("chunk",["string","Buffer","Uint8Array"],u);let F;return v.ending?F=new V:v.destroyed&&(F=new C("write")),F?(e.nextTick($,F),y(d,F,!0),F):(v.pendingcb++,z(d,v,u,p,$))}N.prototype.write=function(d,u,p){return G(this,d,u,p)===!0},N.prototype.cork=function(){this._writableState.corked++},N.prototype.uncork=function(){const d=this._writableState;d.corked&&(d.corked--,d.writing||Ne(this,d))},N.prototype.setDefaultEncoding=function(u){if(typeof u=="string"&&(u=c(u)),!E.isEncoding(u))throw new U(u);return this._writableState.defaultEncoding=u,this};function z(d,u,p,$,v){const F=u.objectMode?1:p.length;u.length+=F;const j=u.length<u.highWaterMark;return j||(u.needDrain=!0),u.writing||u.corked||u.errored||!u.constructed?(u.buffered.push({chunk:p,encoding:$,callback:v}),u.allBuffers&&$!=="buffer"&&(u.allBuffers=!1),u.allNoop&&v!==D&&(u.allNoop=!1)):(u.writelen=F,u.writecb=v,u.writing=!0,u.sync=!0,d._write(p,$,u.onwrite),u.sync=!1),j&&!u.errored&&!u.destroyed}function W(d,u,p,$,v,F,j){u.writelen=$,u.writecb=j,u.writing=!0,u.sync=!0,u.destroyed?u.onwrite(new C("write")):p?d._writev(v,u.onwrite):d._write(v,F,u.onwrite),u.sync=!1}function Q(d,u,p,$){--u.pendingcb,$(p),ve(u),y(d,p)}function m(d,u){const p=d._writableState,$=p.sync,v=p.writecb;if(typeof v!="function"){y(d,new O);return}p.writing=!1,p.writecb=null,p.length-=p.writelen,p.writelen=0,u?(u.stack,p.errored||(p.errored=u),d._readableState&&!d._readableState.errored&&(d._readableState.errored=u),$?e.nextTick(Q,d,p,u,v):Q(d,p,u,v)):(p.buffered.length>p.bufferedIndex&&Ne(d,p),$?p.afterWriteTickInfo!==null&&p.afterWriteTickInfo.cb===v?p.afterWriteTickInfo.count++:(p.afterWriteTickInfo={count:1,cb:v,stream:d,state:p},e.nextTick(J,p.afterWriteTickInfo)):ne(d,p,1,v))}function J({stream:d,state:u,count:p,cb:$}){return u.afterWriteTickInfo=null,ne(d,u,p,$)}function ne(d,u,p,$){for(!u.ending&&!d.destroyed&&u.length===0&&u.needDrain&&(u.needDrain=!1,d.emit("drain"));p-- >0;)u.pendingcb--,$();u.destroyed&&ve(u),Re(d,u)}function ve(d){if(d.writing)return;for(let v=d.bufferedIndex;v<d.buffered.length;++v){var u;const{chunk:F,callback:j}=d.buffered[v],ee=d.objectMode?1:F.length;d.length-=ee,j((u=d.errored)!==null&&u!==void 0?u:new C("write"))}const p=d[K].splice(0);for(let v=0;v<p.length;v++){var $;p[v](($=d.errored)!==null&&$!==void 0?$:new C("end"))}x(d)}function Ne(d,u){if(u.corked||u.bufferProcessing||u.destroyed||!u.constructed)return;const{buffered:p,bufferedIndex:$,objectMode:v}=u,F=p.length-$;if(!F)return;let j=$;if(u.bufferProcessing=!0,F>1&&d._writev){u.pendingcb-=F-1;const ee=u.allNoop?D:Ce=>{for(let re=j;re<p.length;++re)p[re].callback(Ce)},Ae=u.allNoop&&j===0?p:t(p,j);Ae.allBuffers=u.allBuffers,W(d,u,!0,u.length,Ae,"",ee),x(u)}else{do{const{chunk:ee,encoding:Ae,callback:Ce}=p[j];p[j++]=null;const re=v?1:ee.length;W(d,u,!1,re,ee,Ae,Ce)}while(j<p.length&&!u.writing);j===p.length?x(u):j>256?(p.splice(0,j),u.bufferedIndex=0):u.bufferedIndex=j}u.bufferProcessing=!1}N.prototype._write=function(d,u,p){if(this._writev)this._writev([{chunk:d,encoding:u}],p);else throw new w("_write()")},N.prototype._writev=null,N.prototype.end=function(d,u,p){const $=this._writableState;typeof d=="function"?(p=d,d=null,u=null):typeof u=="function"&&(p=u,u=null);let v;if(d!=null){const F=G(this,d,u);F instanceof n&&(v=F)}return $.corked&&($.corked=1,this.uncork()),v||(!$.errored&&!$.ending?($.ending=!0,Re(this,$,!0),$.ended=!0):$.finished?v=new H("end"):$.destroyed&&(v=new C("end"))),typeof p=="function"&&(v||$.finished?e.nextTick(p,v):$[K].push(p)),this};function ce(d){return d.ending&&!d.destroyed&&d.constructed&&d.length===0&&!d.errored&&d.buffered.length===0&&!d.finished&&!d.writing&&!d.errorEmitted&&!d.closeEmitted}function at(d,u){let p=!1;function $(v){if(p){y(d,v??O());return}if(p=!0,u.pendingcb--,v){const F=u[K].splice(0);for(let j=0;j<F.length;j++)F[j](v);y(d,v,u.sync)}else ce(u)&&(u.prefinished=!0,d.emit("prefinish"),u.pendingcb++,e.nextTick(le,d,u))}u.sync=!0,u.pendingcb++;try{d._final($)}catch(v){$(v)}u.sync=!1}function Ee(d,u){!u.prefinished&&!u.finalCalled&&(typeof d._final=="function"&&!u.destroyed?(u.finalCalled=!0,at(d,u)):(u.prefinished=!0,d.emit("prefinish")))}function Re(d,u,p){ce(u)&&(Ee(d,u),u.pendingcb===0&&(p?(u.pendingcb++,e.nextTick(($,v)=>{ce(v)?le($,v):v.pendingcb--},d,u)):ce(u)&&(u.pendingcb++,le(d,u))))}function le(d,u){u.pendingcb--,u.finished=!0;const p=u[K].splice(0);for(let $=0;$<p.length;$++)p[$]();if(d.emit("finish"),u.autoDestroy){const $=d._readableState;(!$||$.autoDestroy&&($.endEmitted||$.readable===!1))&&d.destroy()}}s(N.prototype,{closed:{__proto__:null,get(){return this._writableState?this._writableState.closed:!1}},destroyed:{__proto__:null,get(){return this._writableState?this._writableState.destroyed:!1},set(d){this._writableState&&(this._writableState.destroyed=d)}},writable:{__proto__:null,get(){const d=this._writableState;return!!d&&d.writable!==!1&&!d.destroyed&&!d.errored&&!d.ending&&!d.ended},set(d){this._writableState&&(this._writableState.writable=!!d)}},writableFinished:{__proto__:null,get(){return this._writableState?this._writableState.finished:!1}},writableObjectMode:{__proto__:null,get(){return this._writableState?this._writableState.objectMode:!1}},writableBuffer:{__proto__:null,get(){return this._writableState&&this._writableState.getBuffer()}},writableEnded:{__proto__:null,get(){return this._writableState?this._writableState.ending:!1}},writableNeedDrain:{__proto__:null,get(){const d=this._writableState;return d?!d.destroyed&&!d.ending&&d.needDrain:!1}},writableHighWaterMark:{__proto__:null,get(){return this._writableState&&this._writableState.highWaterMark}},writableCorked:{__proto__:null,get(){return this._writableState?this._writableState.corked:0}},writableLength:{__proto__:null,get(){return this._writableState&&this._writableState.length}},errored:{__proto__:null,enumerable:!1,get(){return this._writableState?this._writableState.errored:null}},writableAborted:{__proto__:null,enumerable:!1,get:function(){return!!(this._writableState.writable!==!1&&(this._writableState.destroyed||this._writableState.errored)&&!this._writableState.finished)}}});const st=_.destroy;N.prototype.destroy=function(d,u){const p=this._writableState;return!p.destroyed&&(p.bufferedIndex<p.buffered.length||p[K].length)&&e.nextTick(ve,p),st.call(this,d,u),this},N.prototype._undestroy=_.undestroy,N.prototype._destroy=function(d,u){u(d)},N.prototype[h.captureRejectionSymbol]=function(d){this.destroy(d)};let Pe;function Oe(){return Pe===void 0&&(Pe={}),Pe}return N.fromWeb=function(d,u){return Oe().newStreamWritableFromWritableStream(d,u)},N.toWeb=function(d){return Oe().newWritableStreamFromStreamWritable(d)},ir}var or,io;function hu(){if(io)return or;io=1;const e=ye,t=we,{isReadable:n,isWritable:r,isIterable:a,isNodeStream:s,isReadableNodeStream:l,isWritableNodeStream:c,isDuplexNodeStream:b}=Xe,f=it,{AbortError:h,codes:{ERR_INVALID_ARG_TYPE:A,ERR_INVALID_RETURN_VALUE:E}}=me,{destroyer:_}=Mt,g=Ve(),L=Mn(),{createDeferredPromise:P}=Je,I=qa,w=globalThis.Blob||t.Blob,O=typeof w<"u"?function(y){return y instanceof w}:function(y){return!1},B=globalThis.AbortController||Ot().AbortController,{FunctionPrototypeCall:C}=oe;class H extends g{constructor(y){super(y),(y==null?void 0:y.readable)===!1&&(this._readableState.readable=!1,this._readableState.ended=!0,this._readableState.endEmitted=!0),(y==null?void 0:y.writable)===!1&&(this._writableState.writable=!1,this._writableState.ending=!0,this._writableState.ended=!0,this._writableState.finished=!0)}}or=function U(y,D){if(b(y))return y;if(l(y))return V({readable:y});if(c(y))return V({writable:y});if(s(y))return V({writable:!1,readable:!1});if(typeof y=="function"){const{value:k,write:x,final:N,destroy:G}=q(y);if(a(k))return I(H,k,{objectMode:!0,write:x,final:N,destroy:G});const z=k==null?void 0:k.then;if(typeof z=="function"){let W;const Q=C(z,k,m=>{if(m!=null)throw new E("nully","body",m)},m=>{_(W,m)});return W=new H({objectMode:!0,readable:!1,write:x,final(m){N(async()=>{try{await Q,e.nextTick(m,null)}catch(J){e.nextTick(m,J)}})},destroy:G})}throw new E("Iterable, AsyncIterable or AsyncFunction",D,k)}if(O(y))return U(y.arrayBuffer());if(a(y))return I(H,y,{objectMode:!0,writable:!1});if(typeof(y==null?void 0:y.writable)=="object"||typeof(y==null?void 0:y.readable)=="object"){const k=y!=null&&y.readable?l(y==null?void 0:y.readable)?y==null?void 0:y.readable:U(y.readable):void 0,x=y!=null&&y.writable?c(y==null?void 0:y.writable)?y==null?void 0:y.writable:U(y.writable):void 0;return V({readable:k,writable:x})}const K=y==null?void 0:y.then;if(typeof K=="function"){let k;return C(K,y,x=>{x!=null&&k.push(x),k.push(null)},x=>{_(k,x)}),k=new H({objectMode:!0,writable:!1,read(){}})}throw new A(D,["Blob","ReadableStream","WritableStream","Stream","Iterable","AsyncIterable","Function","{ readable, writable } pair","Promise"],y)};function q(U){let{promise:y,resolve:D}=P();const K=new B,k=K.signal;return{value:U(async function*(){for(;;){const N=y;y=null;const{chunk:G,done:z,cb:W}=await N;if(e.nextTick(W),z)return;if(k.aborted)throw new h(void 0,{cause:k.reason});({promise:y,resolve:D}=P()),yield G}}(),{signal:k}),write(N,G,z){const W=D;D=null,W({chunk:N,done:!1,cb:z})},final(N){const G=D;D=null,G({done:!0,cb:N})},destroy(N,G){K.abort(),G(N)}}}function V(U){const y=U.readable&&typeof U.readable.read!="function"?L.wrap(U.readable):U.readable,D=U.writable;let K=!!n(y),k=!!r(D),x,N,G,z,W;function Q(m){const J=z;z=null,J?J(m):m&&W.destroy(m)}return W=new H({readableObjectMode:!!(y!=null&&y.readableObjectMode),writableObjectMode:!!(D!=null&&D.writableObjectMode),readable:K,writable:k}),k&&(f(D,m=>{k=!1,m&&_(y,m),Q(m)}),W._write=function(m,J,ne){D.write(m,J)?ne():x=ne},W._final=function(m){D.end(),N=m},D.on("drain",function(){if(x){const m=x;x=null,m()}}),D.on("finish",function(){if(N){const m=N;N=null,m()}})),K&&(f(y,m=>{K=!1,m&&_(y,m),Q(m)}),y.on("readable",function(){if(G){const m=G;G=null,m()}}),y.on("end",function(){W.push(null)}),W._read=function(){for(;;){const m=y.read();if(m===null){G=W._read;return}if(!W.push(m))return}}),W._destroy=function(m,J){!m&&z!==null&&(m=new h),G=null,x=null,N=null,z===null?J(m):(z=J,_(D,m),_(y,m))},W}return or}var ar,oo;function Ve(){if(oo)return ar;oo=1;const{ObjectDefineProperties:e,ObjectGetOwnPropertyDescriptor:t,ObjectKeys:n,ObjectSetPrototypeOf:r}=oe;ar=l;const a=Mn(),s=Ga();r(l.prototype,a.prototype),r(l,a);{const h=n(s.prototype);for(let A=0;A<h.length;A++){const E=h[A];l.prototype[E]||(l.prototype[E]=s.prototype[E])}}function l(h){if(!(this instanceof l))return new l(h);a.call(this,h),s.call(this,h),h?(this.allowHalfOpen=h.allowHalfOpen!==!1,h.readable===!1&&(this._readableState.readable=!1,this._readableState.ended=!0,this._readableState.endEmitted=!0),h.writable===!1&&(this._writableState.writable=!1,this._writableState.ending=!0,this._writableState.ended=!0,this._writableState.finished=!0)):this.allowHalfOpen=!0}e(l.prototype,{writable:{__proto__:null,...t(s.prototype,"writable")},writableHighWaterMark:{__proto__:null,...t(s.prototype,"writableHighWaterMark")},writableObjectMode:{__proto__:null,...t(s.prototype,"writableObjectMode")},writableBuffer:{__proto__:null,...t(s.prototype,"writableBuffer")},writableLength:{__proto__:null,...t(s.prototype,"writableLength")},writableFinished:{__proto__:null,...t(s.prototype,"writableFinished")},writableCorked:{__proto__:null,...t(s.prototype,"writableCorked")},writableEnded:{__proto__:null,...t(s.prototype,"writableEnded")},writableNeedDrain:{__proto__:null,...t(s.prototype,"writableNeedDrain")},destroyed:{__proto__:null,get(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set(h){this._readableState&&this._writableState&&(this._readableState.destroyed=h,this._writableState.destroyed=h)}}});let c;function b(){return c===void 0&&(c={}),c}l.fromWeb=function(h,A){return b().newStreamDuplexFromReadableWritablePair(h,A)},l.toWeb=function(h){return b().newReadableWritablePairFromDuplex(h)};let f;return l.from=function(h){return f||(f=hu()),f(h,"body")},ar}const{ObjectSetPrototypeOf:Ha,Symbol:bu}=oe;var Va=Ke;const{ERR_METHOD_NOT_IMPLEMENTED:gu}=me.codes,fi=Ve(),{getHighWaterMark:pu}=ui;Ha(Ke.prototype,fi.prototype);Ha(Ke,fi);const zt=bu("kCallback");function Ke(e){if(!(this instanceof Ke))return new Ke(e);const t=e?pu(this,e,"readableHighWaterMark",!0):null;t===0&&(e={...e,highWaterMark:null,readableHighWaterMark:t,writableHighWaterMark:e.writableHighWaterMark||0}),fi.call(this,e),this._readableState.sync=!1,this[zt]=null,e&&(typeof e.transform=="function"&&(this._transform=e.transform),typeof e.flush=="function"&&(this._flush=e.flush)),this.on("prefinish",_u)}function Gr(e){typeof this._flush=="function"&&!this.destroyed?this._flush((t,n)=>{if(t){e?e(t):this.destroy(t);return}n!=null&&this.push(n),this.push(null),e&&e()}):(this.push(null),e&&e())}function _u(){this._final!==Gr&&Gr.call(this)}Ke.prototype._final=Gr;Ke.prototype._transform=function(e,t,n){throw new gu("_transform()")};Ke.prototype._write=function(e,t,n){const r=this._readableState,a=this._writableState,s=r.length;this._transform(e,t,(l,c)=>{if(l){n(l);return}c!=null&&this.push(c),a.ended||s===r.length||r.length<r.highWaterMark?n():this[zt]=n})};Ke.prototype._read=function(){if(this[zt]){const e=this[zt];this[zt]=null,e()}};const{ObjectSetPrototypeOf:Ka}=oe;var za=vt;const ci=Va;Ka(vt.prototype,ci.prototype);Ka(vt,ci);function vt(e){if(!(this instanceof vt))return new vt(e);ci.call(this,e)}vt.prototype._transform=function(e,t,n){n(null,e)};const Gt=ye,{ArrayIsArray:wu,Promise:yu,SymbolAsyncIterator:mu}=oe,_n=it,{once:Su}=Je,Eu=Mt,ao=Ve(),{aggregateTwoErrors:Ru,codes:{ERR_INVALID_ARG_TYPE:Hr,ERR_INVALID_RETURN_VALUE:sr,ERR_MISSING_ARGS:Au,ERR_STREAM_DESTROYED:Iu,ERR_STREAM_PREMATURE_CLOSE:Tu},AbortError:$u}=me,{validateFunction:vu,validateAbortSignal:Nu}=In,{isIterable:ht,isReadable:lr,isReadableNodeStream:hn,isNodeStream:so,isTransformStream:It,isWebStream:Pu,isReadableStream:dr,isReadableEnded:Ou}=Xe,Cu=globalThis.AbortController||Ot().AbortController;let ur,fr;function lo(e,t,n){let r=!1;e.on("close",()=>{r=!0});const a=_n(e,{readable:t,writable:n},s=>{r=!s});return{destroy:s=>{r||(r=!0,Eu.destroyer(e,s||new Iu("pipe")))},cleanup:a}}function Mu(e){return vu(e[e.length-1],"streams[stream.length - 1]"),e.pop()}function cr(e){if(ht(e))return e;if(hn(e))return Lu(e);throw new Hr("val",["Readable","Iterable","AsyncIterable"],e)}async function*Lu(e){fr||(fr=Mn()),yield*fr.prototype[mu].call(e)}async function en(e,t,n,{end:r}){let a,s=null;const l=f=>{if(f&&(a=f),s){const h=s;s=null,h()}},c=()=>new yu((f,h)=>{a?h(a):s=()=>{a?h(a):f()}});t.on("drain",l);const b=_n(t,{readable:!1},l);try{t.writableNeedDrain&&await c();for await(const f of e)t.write(f)||await c();r&&t.end(),await c(),n()}catch(f){n(a!==f?Ru(a,f):f)}finally{b(),t.off("drain",l)}}async function hr(e,t,n,{end:r}){It(t)&&(t=t.writable);const a=t.getWriter();try{for await(const s of e)await a.ready,a.write(s).catch(()=>{});await a.ready,r&&await a.close(),n()}catch(s){try{await a.abort(s),n(s)}catch(l){n(l)}}}function Du(...e){return Ya(e,Su(Mu(e)))}function Ya(e,t,n){if(e.length===1&&wu(e[0])&&(e=e[0]),e.length<2)throw new Au("streams");const r=new Cu,a=r.signal,s=n==null?void 0:n.signal,l=[];Nu(s,"options.signal");function c(){_(new $u)}s==null||s.addEventListener("abort",c);let b,f;const h=[];let A=0;function E(I){_(I,--A===0)}function _(I,w){if(I&&(!b||b.code==="ERR_STREAM_PREMATURE_CLOSE")&&(b=I),!(!b&&!w)){for(;h.length;)h.shift()(b);s==null||s.removeEventListener("abort",c),r.abort(),w&&(b||l.forEach(O=>O()),Gt.nextTick(t,b,f))}}let g;for(let I=0;I<e.length;I++){const w=e[I],O=I<e.length-1,B=I>0,C=O||(n==null?void 0:n.end)!==!1,H=I===e.length-1;if(so(w)){let q=function(V){V&&V.name!=="AbortError"&&V.code!=="ERR_STREAM_PREMATURE_CLOSE"&&E(V)};if(C){const{destroy:V,cleanup:U}=lo(w,O,B);h.push(V),lr(w)&&H&&l.push(U)}w.on("error",q),lr(w)&&H&&l.push(()=>{w.removeListener("error",q)})}if(I===0)if(typeof w=="function"){if(g=w({signal:a}),!ht(g))throw new sr("Iterable, AsyncIterable or Stream","source",g)}else ht(w)||hn(w)||It(w)?g=w:g=ao.from(w);else if(typeof w=="function"){if(It(g)){var L;g=cr((L=g)===null||L===void 0?void 0:L.readable)}else g=cr(g);if(g=w(g,{signal:a}),O){if(!ht(g,!0))throw new sr("AsyncIterable",`transform[${I-1}]`,g)}else{var P;ur||(ur=za);const q=new ur({objectMode:!0}),V=(P=g)===null||P===void 0?void 0:P.then;if(typeof V=="function")A++,V.call(g,D=>{f=D,D!=null&&q.write(D),C&&q.end(),Gt.nextTick(E)},D=>{q.destroy(D),Gt.nextTick(E,D)});else if(ht(g,!0))A++,en(g,q,E,{end:C});else if(dr(g)||It(g)){const D=g.readable||g;A++,en(D,q,E,{end:C})}else throw new sr("AsyncIterable or Promise","destination",g);g=q;const{destroy:U,cleanup:y}=lo(g,!1,!0);h.push(U),H&&l.push(y)}}else if(so(w)){if(hn(g)){A+=2;const q=ku(g,w,E,{end:C});lr(w)&&H&&l.push(q)}else if(It(g)||dr(g)){const q=g.readable||g;A++,en(q,w,E,{end:C})}else if(ht(g))A++,en(g,w,E,{end:C});else throw new Hr("val",["Readable","Iterable","AsyncIterable","ReadableStream","TransformStream"],g);g=w}else if(Pu(w)){if(hn(g))A++,hr(cr(g),w,E,{end:C});else if(dr(g)||ht(g))A++,hr(g,w,E,{end:C});else if(It(g))A++,hr(g.readable,w,E,{end:C});else throw new Hr("val",["Readable","Iterable","AsyncIterable","ReadableStream","TransformStream"],g);g=w}else g=ao.from(w)}return(a!=null&&a.aborted||s!=null&&s.aborted)&&Gt.nextTick(c),g}function ku(e,t,n,{end:r}){let a=!1;if(t.on("close",()=>{a||n(new Tu)}),e.pipe(t,{end:!1}),r){let s=function(){a=!0,t.end()};Ou(e)?Gt.nextTick(s):e.once("end",s)}else n();return _n(e,{readable:!0,writable:!1},s=>{const l=e._readableState;s&&s.code==="ERR_STREAM_PREMATURE_CLOSE"&&l&&l.ended&&!l.errored&&!l.errorEmitted?e.once("end",n).once("error",n):n(s)}),_n(t,{readable:!1,writable:!0},n)}var hi={pipelineImpl:Ya,pipeline:Du};const{pipeline:xu}=hi,tn=Ve(),{destroyer:Wu}=Mt,{isNodeStream:nn,isReadable:uo,isWritable:fo,isWebStream:br,isTransformStream:ft,isWritableStream:co,isReadableStream:ho}=Xe,{AbortError:Fu,codes:{ERR_INVALID_ARG_VALUE:bo,ERR_MISSING_ARGS:ju}}=me,Uu=it;var Ja=function(...t){if(t.length===0)throw new ju("streams");if(t.length===1)return tn.from(t[0]);const n=[...t];if(typeof t[0]=="function"&&(t[0]=tn.from(t[0])),typeof t[t.length-1]=="function"){const _=t.length-1;t[_]=tn.from(t[_])}for(let _=0;_<t.length;++_)if(!(!nn(t[_])&&!br(t[_]))){if(_<t.length-1&&!(uo(t[_])||ho(t[_])||ft(t[_])))throw new bo(`streams[${_}]`,n[_],"must be readable");if(_>0&&!(fo(t[_])||co(t[_])||ft(t[_])))throw new bo(`streams[${_}]`,n[_],"must be writable")}let r,a,s,l,c;function b(_){const g=l;l=null,g?g(_):_?c.destroy(_):!E&&!A&&c.destroy()}const f=t[0],h=xu(t,b),A=!!(fo(f)||co(f)||ft(f)),E=!!(uo(h)||ho(h)||ft(h));if(c=new tn({writableObjectMode:!!(f!=null&&f.writableObjectMode),readableObjectMode:!!(h!=null&&h.writableObjectMode),writable:A,readable:E}),A){if(nn(f))c._write=function(g,L,P){f.write(g,L)?P():r=P},c._final=function(g){f.end(),a=g},f.on("drain",function(){if(r){const g=r;r=null,g()}});else if(br(f)){const L=(ft(f)?f.writable:f).getWriter();c._write=async function(P,I,w){try{await L.ready,L.write(P).catch(()=>{}),w()}catch(O){w(O)}},c._final=async function(P){try{await L.ready,L.close().catch(()=>{}),a=P}catch(I){P(I)}}}const _=ft(h)?h.readable:h;Uu(_,()=>{if(a){const g=a;a=null,g()}})}if(E){if(nn(h))h.on("readable",function(){if(s){const _=s;s=null,_()}}),h.on("end",function(){c.push(null)}),c._read=function(){for(;;){const _=h.read();if(_===null){s=c._read;return}if(!c.push(_))return}};else if(br(h)){const g=(ft(h)?h.readable:h).getReader();c._read=async function(){for(;;)try{const{value:L,done:P}=await g.read();if(!c.push(L))return;if(P){c.push(null);return}}catch{return}}}}return c._destroy=function(_,g){!_&&l!==null&&(_=new Fu),s=null,r=null,a=null,l===null?g(_):(l=g,nn(h)&&Wu(h,_))},c};const Xa=globalThis.AbortController||Ot().AbortController,{codes:{ERR_INVALID_ARG_VALUE:Bu,ERR_INVALID_ARG_TYPE:Xt,ERR_MISSING_ARGS:qu,ERR_OUT_OF_RANGE:Gu},AbortError:je}=me,{validateAbortSignal:mt,validateInteger:Hu,validateObject:St}=In,Vu=oe.Symbol("kWeak"),{finished:Ku}=it,zu=Ja,{addAbortSignalNoValidate:Yu}=Cn,{isWritable:Ju,isNodeStream:Xu}=Xe,{ArrayPrototypePush:Zu,MathFloor:Qu,Number:ef,NumberIsNaN:tf,Promise:go,PromiseReject:po,PromisePrototypeThen:nf,Symbol:Za}=oe,wn=Za("kEmpty"),_o=Za("kEof");function rf(e,t){if(t!=null&&St(t,"options"),(t==null?void 0:t.signal)!=null&&mt(t.signal,"options.signal"),Xu(e)&&!Ju(e))throw new Bu("stream",e,"must be writable");const n=zu(this,e);return t!=null&&t.signal&&Yu(t.signal,n),n}function Ln(e,t){if(typeof e!="function")throw new Xt("fn",["Function","AsyncFunction"],e);t!=null&&St(t,"options"),(t==null?void 0:t.signal)!=null&&mt(t.signal,"options.signal");let n=1;return(t==null?void 0:t.concurrency)!=null&&(n=Qu(t.concurrency)),Hu(n,"concurrency",1),(async function*(){var a,s;const l=new Xa,c=this,b=[],f=l.signal,h={signal:f},A=()=>l.abort();t!=null&&(a=t.signal)!==null&&a!==void 0&&a.aborted&&A(),t==null||(s=t.signal)===null||s===void 0||s.addEventListener("abort",A);let E,_,g=!1;function L(){g=!0}async function P(){try{for await(let O of c){var I;if(g)return;if(f.aborted)throw new je;try{O=e(O,h)}catch(B){O=po(B)}O!==wn&&(typeof((I=O)===null||I===void 0?void 0:I.catch)=="function"&&O.catch(L),b.push(O),E&&(E(),E=null),!g&&b.length&&b.length>=n&&await new go(B=>{_=B}))}b.push(_o)}catch(O){const B=po(O);nf(B,void 0,L),b.push(B)}finally{var w;g=!0,E&&(E(),E=null),t==null||(w=t.signal)===null||w===void 0||w.removeEventListener("abort",A)}}P();try{for(;;){for(;b.length>0;){const I=await b[0];if(I===_o)return;if(f.aborted)throw new je;I!==wn&&(yield I),b.shift(),_&&(_(),_=null)}await new go(I=>{E=I})}}finally{l.abort(),g=!0,_&&(_(),_=null)}}).call(this)}function of(e=void 0){return e!=null&&St(e,"options"),(e==null?void 0:e.signal)!=null&&mt(e.signal,"options.signal"),(async function*(){let n=0;for await(const a of this){var r;if(e!=null&&(r=e.signal)!==null&&r!==void 0&&r.aborted)throw new je({cause:e.signal.reason});yield[n++,a]}}).call(this)}async function Qa(e,t=void 0){for await(const n of bi.call(this,e,t))return!0;return!1}async function af(e,t=void 0){if(typeof e!="function")throw new Xt("fn",["Function","AsyncFunction"],e);return!await Qa.call(this,async(...n)=>!await e(...n),t)}async function sf(e,t){for await(const n of bi.call(this,e,t))return n}async function lf(e,t){if(typeof e!="function")throw new Xt("fn",["Function","AsyncFunction"],e);async function n(r,a){return await e(r,a),wn}for await(const r of Ln.call(this,n,t));}function bi(e,t){if(typeof e!="function")throw new Xt("fn",["Function","AsyncFunction"],e);async function n(r,a){return await e(r,a)?r:wn}return Ln.call(this,n,t)}let df=class extends qu{constructor(){super("reduce"),this.message="Reduce of an empty stream requires an initial value"}};async function uf(e,t,n){var r;if(typeof e!="function")throw new Xt("reducer",["Function","AsyncFunction"],e);n!=null&&St(n,"options"),(n==null?void 0:n.signal)!=null&&mt(n.signal,"options.signal");let a=arguments.length>1;if(n!=null&&(r=n.signal)!==null&&r!==void 0&&r.aborted){const f=new je(void 0,{cause:n.signal.reason});throw this.once("error",()=>{}),await Ku(this.destroy(f)),f}const s=new Xa,l=s.signal;if(n!=null&&n.signal){const f={once:!0,[Vu]:this};n.signal.addEventListener("abort",()=>s.abort(),f)}let c=!1;try{for await(const f of this){var b;if(c=!0,n!=null&&(b=n.signal)!==null&&b!==void 0&&b.aborted)throw new je;a?t=await e(t,f,{signal:l}):(t=f,a=!0)}if(!c&&!a)throw new df}finally{s.abort()}return t}async function ff(e){e!=null&&St(e,"options"),(e==null?void 0:e.signal)!=null&&mt(e.signal,"options.signal");const t=[];for await(const r of this){var n;if(e!=null&&(n=e.signal)!==null&&n!==void 0&&n.aborted)throw new je(void 0,{cause:e.signal.reason});Zu(t,r)}return t}function cf(e,t){const n=Ln.call(this,e,t);return(async function*(){for await(const a of n)yield*a}).call(this)}function es(e){if(e=ef(e),tf(e))return 0;if(e<0)throw new Gu("number",">= 0",e);return e}function hf(e,t=void 0){return t!=null&&St(t,"options"),(t==null?void 0:t.signal)!=null&&mt(t.signal,"options.signal"),e=es(e),(async function*(){var r;if(t!=null&&(r=t.signal)!==null&&r!==void 0&&r.aborted)throw new je;for await(const s of this){var a;if(t!=null&&(a=t.signal)!==null&&a!==void 0&&a.aborted)throw new je;e--<=0&&(yield s)}}).call(this)}function bf(e,t=void 0){return t!=null&&St(t,"options"),(t==null?void 0:t.signal)!=null&&mt(t.signal,"options.signal"),e=es(e),(async function*(){var r;if(t!=null&&(r=t.signal)!==null&&r!==void 0&&r.aborted)throw new je;for await(const s of this){var a;if(t!=null&&(a=t.signal)!==null&&a!==void 0&&a.aborted)throw new je;if(e-- >0)yield s;else return}}).call(this)}ri.streamReturningOperators={asIndexedPairs:of,drop:hf,filter:bi,flatMap:cf,map:Ln,take:bf,compose:rf};ri.promiseReturningOperators={every:af,forEach:lf,reduce:uf,toArray:ff,some:Qa,find:sf};var gr,wo;function ts(){if(wo)return gr;wo=1;const{ArrayPrototypePop:e,Promise:t}=oe,{isIterable:n,isNodeStream:r,isWebStream:a}=Xe,{pipelineImpl:s}=hi,{finished:l}=it;ns();function c(...b){return new t((f,h)=>{let A,E;const _=b[b.length-1];if(_&&typeof _=="object"&&!r(_)&&!n(_)&&!a(_)){const g=e(b);A=g.signal,E=g.end}s(b,(g,L)=>{g?h(g):f(L)},{signal:A,end:E})})}return gr={finished:l,pipeline:c},gr}var yo;function ns(){if(yo)return Qn.exports;yo=1;const{Buffer:e}=we,{ObjectDefineProperty:t,ObjectKeys:n,ReflectApply:r}=oe,{promisify:{custom:a}}=Je,{streamReturningOperators:s,promiseReturningOperators:l}=ri,{codes:{ERR_ILLEGAL_CONSTRUCTOR:c}}=me,b=Ja,{pipeline:f}=hi,{destroyer:h}=Mt,A=it,E=ts(),_=Xe,g=Qn.exports=di.Stream;g.isDisturbed=_.isDisturbed,g.isErrored=_.isErrored,g.isReadable=_.isReadable,g.Readable=Mn();for(const P of n(s)){let w=function(...O){if(new.target)throw c();return g.Readable.from(r(I,this,O))};const I=s[P];t(w,"name",{__proto__:null,value:I.name}),t(w,"length",{__proto__:null,value:I.length}),t(g.Readable.prototype,P,{__proto__:null,value:w,enumerable:!1,configurable:!0,writable:!0})}for(const P of n(l)){let w=function(...O){if(new.target)throw c();return r(I,this,O)};const I=l[P];t(w,"name",{__proto__:null,value:I.name}),t(w,"length",{__proto__:null,value:I.length}),t(g.Readable.prototype,P,{__proto__:null,value:w,enumerable:!1,configurable:!0,writable:!0})}g.Writable=Ga(),g.Duplex=Ve(),g.Transform=Va,g.PassThrough=za,g.pipeline=f;const{addAbortSignal:L}=Cn;return g.addAbortSignal=L,g.finished=A,g.destroy=h,g.compose=b,t(g,"promises",{__proto__:null,configurable:!0,enumerable:!0,get(){return E}}),t(f,a,{__proto__:null,enumerable:!0,get(){return E.pipeline}}),t(A,a,{__proto__:null,enumerable:!0,get(){return E.finished}}),g.Stream=g,g._isUint8Array=function(I){return I instanceof Uint8Array},g._uint8ArrayToBuffer=function(I){return e.from(I.buffer,I.byteOffset,I.byteLength)},Qn.exports}(function(e){const t=ns(),n=ts(),r=t.Readable.destroy;e.exports=t.Readable,e.exports._uint8ArrayToBuffer=t._uint8ArrayToBuffer,e.exports._isUint8Array=t._isUint8Array,e.exports.isDisturbed=t.isDisturbed,e.exports.isErrored=t.isErrored,e.exports.isReadable=t.isReadable,e.exports.Readable=t.Readable,e.exports.Writable=t.Writable,e.exports.Duplex=t.Duplex,e.exports.Transform=t.Transform,e.exports.PassThrough=t.PassThrough,e.exports.addAbortSignal=t.addAbortSignal,e.exports.finished=t.finished,e.exports.destroy=t.destroy,e.exports.destroy=r,e.exports.pipeline=t.pipeline,e.exports.compose=t.compose,Object.defineProperty(t,"promises",{configurable:!0,enumerable:!0,get(){return n}}),e.exports.Stream=t.Stream,e.exports.default=e.exports})(ha);var Dn=ha.exports;function rn(){}const mo="SYN",pr="ACK",So="BRK";class Eo extends Dn.Duplex{constructor(t){let{name:n,target:r,targetWindow:a=window,targetOrigin:s="*"}=t;if(super({objectMode:!0}),M(this,"_init",void 0),M(this,"_haveSyn",void 0),M(this,"_name",void 0),M(this,"_target",void 0),M(this,"_targetWindow",void 0),M(this,"_targetOrigin",void 0),M(this,"_onMessage",void 0),M(this,"_synIntervalId",void 0),!n||!r)throw new Error("Invalid input.");this._init=!1,this._haveSyn=!1,this._name=n,this._target=r,this._targetWindow=a,this._targetOrigin=s,this._onMessage=this.onMessage.bind(this),this._synIntervalId=null,window.addEventListener("message",this._onMessage,!1),this._handShake()}_break(){this.cork(),this._write(So,null,rn),this._haveSyn=!1,this._init=!1}_handShake(){this._write(mo,null,rn),this.cork()}_onData(t){if(!this._init)t===mo?(this._haveSyn=!0,this._write(pr,null,rn)):t===pr&&(this._init=!0,this._haveSyn||this._write(pr,null,rn),this.uncork());else if(t===So)this._break();else try{this.push(t)}catch(n){this.emit("error",n)}}_postMessage(t){const n=this._targetOrigin;this._targetWindow.postMessage({target:this._target,data:t},n)}onMessage(t){const n=t.data;this._targetOrigin!=="*"&&t.origin!==this._targetOrigin||t.source!==this._targetWindow||typeof n!="object"||n.target!==this._name||!n.data||this._onData(n.data)}_read(){}_write(t,n,r){this._postMessage(t),r()}_destroy(){window.removeEventListener("message",this._onMessage,!1)}}function Ro(e,t,n){try{Reflect.apply(e,t,n)}catch(r){setTimeout(()=>{throw r})}}function gf(e){const t=e.length,n=new Array(t);for(let r=0;r<t;r+=1)n[r]=e[r];return n}class kn extends yt.EventEmitter{emit(t){let n=t==="error";const r=this._events;if(r!==void 0)n=n&&r.error===void 0;else if(!n)return!1;for(var a=arguments.length,s=new Array(a>1?a-1:0),l=1;l<a;l++)s[l-1]=arguments[l];if(n){let b;if(s.length>0&&([b]=s),b instanceof Error)throw b;const f=new Error(`Unhandled error.${b?` (${b.message})`:""}`);throw f.context=b,f}const c=r[t];if(c===void 0)return!1;if(typeof c=="function")Ro(c,this,s);else{const b=c.length,f=gf(c);for(let h=0;h<b;h+=1)Ro(f[h],this,s)}return!0}}class Bt extends Error{constructor(t){let{code:n,message:r,data:a}=t;if(!Number.isInteger(n))throw new Error("code must be an integer");if(!r||typeof r!="string")throw new Error("message must be string");super(r),M(this,"code",void 0),M(this,"data",void 0),this.code=n,a!==void 0&&(this.data=a)}toString(){return tl({code:this.code,message:this.message,data:this.data,stack:this.stack})}}const Vr=function(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;return(r,a)=>{r||a.error?t(r||a.error):!n||Array.isArray(a)?e(a):e(a.result)}};function pf(){const e={};function t(){return!1}const n=new kn;function r(b){const f=e[b.id];if(!f)throw new Error(`StreamMiddleware - Unknown response id "${b.id}"`);delete e[b.id],Object.assign(f.res,b),setTimeout(f.end)}function a(b){n.emit("notification",b)}function s(b,f,h){let A;try{!b.id?a(b):r(b)}catch(E){A=E}h(A)}const l=new Dn.Duplex({objectMode:!0,read:t,write:s});return{events:n,middleware:(b,f,h,A)=>{l.push(b),e[b.id]={req:b,res:f,next:h,end:A}},stream:l}}function _f(){return(e,t,n,r)=>{const a=e.id,s=Math.random().toString(36).slice(2);e.id=s,t.id=s,n(l=>{e.id=a,t.id=a,l()})}}class Ge extends kn{constructor(){super(),M(this,"_middleware",void 0),this._middleware=[]}static async _runAllMiddleware(t,n,r){const a=[];let s=null,l=!1;for(const c of r)if([s,l]=await Ge._runMiddleware(t,n,c,a),l)break;return[s,l,a.reverse()]}static _runMiddleware(t,n,r,a){return new Promise(s=>{const l=b=>{const f=b||n.error;f&&(n.error=Oi.serializeError(f)),s([f,!0])},c=b=>{n.error?l(n.error):(b&&(typeof b!="function"&&l(new Bt({code:-32603,message:"JRPCEngine: 'next' return handlers must be functions"})),a.push(b)),s([null,!1]))};try{r(t,n,c,l)}catch(b){l(b)}})}static async _runReturnHandlers(t){for(const n of t)await new Promise((r,a)=>{n(s=>s?a(s):r())})}static _checkForCompletion(t,n,r){if(!("result"in n)&&!("error"in n))throw new Bt({code:-32603,message:"Response has no error or result for request"});if(!r)throw new Bt({code:-32603,message:"Nothing ended request"})}push(t){this._middleware.push(t)}handle(t,n){if(n&&typeof n!="function")throw new Error('"callback" must be a function if provided.');return Array.isArray(t)?n?this._handleBatch(t,n):this._handleBatch(t):n?this._handle(t,n):this._promiseHandle(t)}asMiddleware(){return async(t,n,r,a)=>{try{const[s,l,c]=await Ge._runAllMiddleware(t,n,this._middleware);return l?(await Ge._runReturnHandlers(c),a(s)):r(async b=>{try{await Ge._runReturnHandlers(c)}catch(f){return b(f)}return b()})}catch(s){return a(s)}}}async _handleBatch(t,n){try{const r=await Promise.all(t.map(this._promiseHandle.bind(this)));return n?n(null,r):r}catch(r){if(n)return n(r);throw r}}_promiseHandle(t){return new Promise(n=>{this._handle(t,(r,a)=>{n(a)})})}async _handle(t,n){if(!t||Array.isArray(t)||typeof t!="object"){const l=new Bt({code:-32603,message:"request must be plain object"});return n(l,{id:void 0,jsonrpc:"2.0",error:l})}if(typeof t.method!="string"){const l=new Bt({code:-32603,message:"method must be string"});return n(l,{id:t.id,jsonrpc:"2.0",error:l})}const r=se({},t),a={id:r.id,jsonrpc:r.jsonrpc};let s=null;try{await this._processRequest(r,a)}catch(l){s=l}return s&&(delete a.result,a.error||(a.error=Oi.serializeError(s))),n(s,a)}async _processRequest(t,n){const[r,a,s]=await Ge._runAllMiddleware(t,n,this._middleware);if(Ge._checkForCompletion(t,n,a),await Ge._runReturnHandlers(s),r)throw r}}class wf extends Dn.Duplex{constructor(t){let{parent:n,name:r}=t;super({objectMode:!0}),M(this,"_parent",void 0),M(this,"_name",void 0),this._parent=n,this._name=r}_read(){}_write(t,n,r){this._parent.push({name:this._name,data:t}),r()}}const Ao=Symbol("IGNORE_SUBSTREAM");class yf extends Dn.Duplex{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};super(se(se({},t),{},{objectMode:!0})),M(this,"_substreams",void 0),M(this,"getStream",void 0),this._substreams={}}createStream(t){if(!t)throw new Error("ObjectMultiplex - name must not be empty");if(this._substreams[t])throw new Error(`ObjectMultiplex - Substream for name "${t}" already exists`);const n=new wf({parent:this,name:t});return this._substreams[t]=n,mf(this,r=>n.destroy(r||void 0)),n}ignoreStream(t){if(!t)throw new Error("ObjectMultiplex - name must not be empty");if(this._substreams[t])throw new Error(`ObjectMultiplex - Substream for name "${t}" already exists`);this._substreams[t]=Ao}_read(){}_write(t,n,r){const{name:a,data:s}=t;if(!a)return window.console.warn(`ObjectMultiplex - malformed chunk without name "${t}"`),r();const l=this._substreams[a];return l?(l!==Ao&&l.push(s),r()):(window.console.warn(`ObjectMultiplex - orphaned data for stream "${a}"`),r())}}function mf(e,t){const n=el(t);Ci(e,{readable:!1},n),Ci(e,{writable:!1},n)}var He={},nt={};Object.defineProperty(nt,"__esModule",{value:!0});nt.EthereumProviderError=nt.EthereumRpcError=void 0;const Sf=nl;class rs extends Error{constructor(t,n,r){if(!Number.isInteger(t))throw new Error('"code" must be an integer.');if(!n||typeof n!="string")throw new Error('"message" must be a nonempty string.');super(n),this.code=t,r!==void 0&&(this.data=r)}serialize(){const t={code:this.code,message:this.message};return this.data!==void 0&&(t.data=this.data),this.stack&&(t.stack=this.stack),t}toString(){return Sf.default(this.serialize(),Af,2)}}nt.EthereumRpcError=rs;class Ef extends rs{constructor(t,n,r){if(!Rf(t))throw new Error('"code" must be an integer such that: 1000 <= code <= 4999');super(t,n,r)}}nt.EthereumProviderError=Ef;function Rf(e){return Number.isInteger(e)&&e>=1e3&&e<=4999}function Af(e,t){if(t!=="[Circular]")return t}var gi={},rt={};Object.defineProperty(rt,"__esModule",{value:!0});rt.errorValues=rt.errorCodes=void 0;rt.errorCodes={rpc:{invalidInput:-32e3,resourceNotFound:-32001,resourceUnavailable:-32002,transactionRejected:-32003,methodNotSupported:-32004,limitExceeded:-32005,parse:-32700,invalidRequest:-32600,methodNotFound:-32601,invalidParams:-32602,internal:-32603},provider:{userRejectedRequest:4001,unauthorized:4100,unsupportedMethod:4200,disconnected:4900,chainDisconnected:4901}};rt.errorValues={"-32700":{standard:"JSON RPC 2.0",message:"Invalid JSON was received by the server. An error occurred on the server while parsing the JSON text."},"-32600":{standard:"JSON RPC 2.0",message:"The JSON sent is not a valid Request object."},"-32601":{standard:"JSON RPC 2.0",message:"The method does not exist / is not available."},"-32602":{standard:"JSON RPC 2.0",message:"Invalid method parameter(s)."},"-32603":{standard:"JSON RPC 2.0",message:"Internal JSON-RPC error."},"-32000":{standard:"EIP-1474",message:"Invalid input."},"-32001":{standard:"EIP-1474",message:"Resource not found."},"-32002":{standard:"EIP-1474",message:"Resource unavailable."},"-32003":{standard:"EIP-1474",message:"Transaction rejected."},"-32004":{standard:"EIP-1474",message:"Method not supported."},"-32005":{standard:"EIP-1474",message:"Request limit exceeded."},4001:{standard:"EIP-1193",message:"User rejected the request."},4100:{standard:"EIP-1193",message:"The requested account and/or method has not been authorized by the user."},4200:{standard:"EIP-1193",message:"The requested method is not supported by this Ethereum provider."},4900:{standard:"EIP-1193",message:"The provider is disconnected from all chains."},4901:{standard:"EIP-1193",message:"The provider is disconnected from the specified chain."}};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.serializeError=e.isValidCode=e.getMessageFromCode=e.JSON_RPC_SERVER_ERROR_MESSAGE=void 0;const t=rt,n=nt,r=t.errorCodes.rpc.internal,a="Unspecified error message. This is a bug, please report it.",s={code:r,message:l(r)};e.JSON_RPC_SERVER_ERROR_MESSAGE="Unspecified server error.";function l(E,_=a){if(Number.isInteger(E)){const g=E.toString();if(A(t.errorValues,g))return t.errorValues[g].message;if(f(E))return e.JSON_RPC_SERVER_ERROR_MESSAGE}return _}e.getMessageFromCode=l;function c(E){if(!Number.isInteger(E))return!1;const _=E.toString();return!!(t.errorValues[_]||f(E))}e.isValidCode=c;function b(E,{fallbackError:_=s,shouldIncludeStack:g=!1}={}){var L,P;if(!_||!Number.isInteger(_.code)||typeof _.message!="string")throw new Error("Must provide fallback error with integer number code and string message.");if(E instanceof n.EthereumRpcError)return E.serialize();const I={};if(E&&typeof E=="object"&&!Array.isArray(E)&&A(E,"code")&&c(E.code)){const O=E;I.code=O.code,O.message&&typeof O.message=="string"?(I.message=O.message,A(O,"data")&&(I.data=O.data)):(I.message=l(I.code),I.data={originalError:h(E)})}else{I.code=_.code;const O=(L=E)===null||L===void 0?void 0:L.message;I.message=O&&typeof O=="string"?O:_.message,I.data={originalError:h(E)}}const w=(P=E)===null||P===void 0?void 0:P.stack;return g&&E&&w&&typeof w=="string"&&(I.stack=w),I}e.serializeError=b;function f(E){return E>=-32099&&E<=-32e3}function h(E){return E&&typeof E=="object"&&!Array.isArray(E)?Object.assign({},E):E}function A(E,_){return Object.prototype.hasOwnProperty.call(E,_)}})(gi);var xn={};Object.defineProperty(xn,"__esModule",{value:!0});xn.ethErrors=void 0;const pi=nt,is=gi,fe=rt;xn.ethErrors={rpc:{parse:e=>Ie(fe.errorCodes.rpc.parse,e),invalidRequest:e=>Ie(fe.errorCodes.rpc.invalidRequest,e),invalidParams:e=>Ie(fe.errorCodes.rpc.invalidParams,e),methodNotFound:e=>Ie(fe.errorCodes.rpc.methodNotFound,e),internal:e=>Ie(fe.errorCodes.rpc.internal,e),server:e=>{if(!e||typeof e!="object"||Array.isArray(e))throw new Error("Ethereum RPC Server errors must provide single object argument.");const{code:t}=e;if(!Number.isInteger(t)||t>-32005||t<-32099)throw new Error('"code" must be an integer such that: -32099 <= code <= -32005');return Ie(t,e)},invalidInput:e=>Ie(fe.errorCodes.rpc.invalidInput,e),resourceNotFound:e=>Ie(fe.errorCodes.rpc.resourceNotFound,e),resourceUnavailable:e=>Ie(fe.errorCodes.rpc.resourceUnavailable,e),transactionRejected:e=>Ie(fe.errorCodes.rpc.transactionRejected,e),methodNotSupported:e=>Ie(fe.errorCodes.rpc.methodNotSupported,e),limitExceeded:e=>Ie(fe.errorCodes.rpc.limitExceeded,e)},provider:{userRejectedRequest:e=>qt(fe.errorCodes.provider.userRejectedRequest,e),unauthorized:e=>qt(fe.errorCodes.provider.unauthorized,e),unsupportedMethod:e=>qt(fe.errorCodes.provider.unsupportedMethod,e),disconnected:e=>qt(fe.errorCodes.provider.disconnected,e),chainDisconnected:e=>qt(fe.errorCodes.provider.chainDisconnected,e),custom:e=>{if(!e||typeof e!="object"||Array.isArray(e))throw new Error("Ethereum Provider custom errors must provide single object argument.");const{code:t,message:n,data:r}=e;if(!n||typeof n!="string")throw new Error('"message" must be a nonempty string');return new pi.EthereumProviderError(t,n,r)}}};function Ie(e,t){const[n,r]=os(t);return new pi.EthereumRpcError(e,n||is.getMessageFromCode(e),r)}function qt(e,t){const[n,r]=os(t);return new pi.EthereumProviderError(e,n||is.getMessageFromCode(e),r)}function os(e){if(e){if(typeof e=="string")return[e];if(typeof e=="object"&&!Array.isArray(e)){const{message:t,data:n}=e;if(t&&typeof t!="string")throw new Error("Must specify string message.");return[t||void 0,n]}}return[]}(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.getMessageFromCode=e.serializeError=e.EthereumProviderError=e.EthereumRpcError=e.ethErrors=e.errorCodes=void 0;const t=nt;Object.defineProperty(e,"EthereumRpcError",{enumerable:!0,get:function(){return t.EthereumRpcError}}),Object.defineProperty(e,"EthereumProviderError",{enumerable:!0,get:function(){return t.EthereumProviderError}});const n=gi;Object.defineProperty(e,"serializeError",{enumerable:!0,get:function(){return n.serializeError}}),Object.defineProperty(e,"getMessageFromCode",{enumerable:!0,get:function(){return n.getMessageFromCode}});const r=xn;Object.defineProperty(e,"ethErrors",{enumerable:!0,get:function(){return r.ethErrors}});const a=rt;Object.defineProperty(e,"errorCodes",{enumerable:!0,get:function(){return a.errorCodes}})})(He);var If="2.0.0";function as(e){return e!==null&&typeof e=="object"&&typeof e.pipe=="function"}function Tf(e){return as(e)&&e.writable!==!1&&typeof e._write=="function"&&typeof e._writableState=="object"}function $f(e){return as(e)&&e.readable!==!1&&typeof e._read=="function"&&typeof e._readableState=="object"}function vf(e){return Tf(e)&&$f(e)}var xe={errors:{disconnected:()=>"Torus: Lost connection to Torus.",permanentlyDisconnected:()=>"Torus: Disconnected from iframe. Page reload required.",unsupportedSync:e=>`Torus: The Torus Ethereum provider does not support synchronous methods like ${e} without a callback parameter.`,invalidDuplexStream:()=>"Must provide a Node.js-style duplex stream.",invalidOptions:e=>`Invalid options. Received: { maxEventListeners: ${e}}`,invalidRequestArgs:()=>"Expected a single, non-array, object argument.",invalidRequestMethod:()=>"'args.method' must be a non-empty string.",invalidRequestParams:()=>"'args.params' must be an object or array if provided.",invalidLoggerObject:()=>"'args.logger' must be an object if provided.",invalidLoggerMethod:e=>`'args.logger' must include required method '${e}'.`},info:{connected:e=>`Torus: Connected to chain with ID "${e}".`},warnings:{}};const Nf={PRODUCTION:"production",DEVELOPMENT:"development",TESTING:"testing"},Ht={BOTTOM_LEFT:"bottom-left",TOP_LEFT:"top-left",BOTTOM_RIGHT:"bottom-right",TOP_RIGHT:"top-right"},_r={GOOGLE:"google",FACEBOOK:"facebook",REDDIT:"reddit",DISCORD:"discord",TWITCH:"twitch",APPLE:"apple",LINE:"line",GITHUB:"github",KAKAO:"kakao",LINKEDIN:"linkedin",TWITTER:"twitter",WEIBO:"weibo",WECHAT:"wechat",EMAIL_PASSWORDLESS:"email_passwordless"},Pf={en:{embed:{continue:"Continue",actionRequired:"Authorization required",pendingAction:"Click continue to proceed with your request in a popup",cookiesRequired:"Cookies Required",enableCookies:"Please enable cookies in your browser preferences to access Torus",clickHere:"More Info"}},de:{embed:{continue:"Fortsetzen",actionRequired:"Autorisierung erforderlich",pendingAction:"Klicken Sie in einem Popup auf Weiter, um mit Ihrer Anfrage fortzufahren",cookiesRequired:"Cookies bentigt",enableCookies:"Bitte aktivieren Sie Cookies in Ihren Browsereinstellungen, um auf Torus zuzugreifen",clickHere:"Mehr Info"}},ja:{embed:{continue:"",actionRequired:"",pendingAction:"",cookiesRequired:"",enableCookies:"TorusCookie",clickHere:""}},ko:{embed:{continue:"",actionRequired:" ",pendingAction:"    .",cookiesRequired:" ",enableCookies:"     Torus .",clickHere:"  "}},zh:{embed:{continue:"",actionRequired:"",pendingAction:"",cookiesRequired:"Cookie",enableCookies:"cookieTorus",clickHere:""}}};var _i={supportedVerifierList:[_r.GOOGLE,_r.REDDIT,_r.DISCORD],api:"https://api.tor.us",translations:Pf,prodTorusUrl:"",localStorageKeyPrefix:"torus-"},X=Rn.getLogger("solana-embed");function Of(){return(e,t,n)=>{(typeof e.method!="string"||!e.method)&&(t.error=He.ethErrors.rpc.invalidRequest({message:"The request 'method' must be a non-empty string.",data:e})),n(r=>{const{error:a}=t;return a&&X.error(`Torus - RPC Error: ${a.message}`,a),r()})}}function Cf(e,t,n){let r=`Torus: Lost connection to "${e}".`;t!=null&&t.stack&&(r+=`
${t.stack}`),X.warn(r),n&&n.listenerCount("error")>0&&n.emit("error",r)}const on=()=>Math.random().toString(36).slice(2),ss=async e=>{let t,n;switch(e){case"testing":t="https://solana-testing.tor.us",n="debug";break;case"development":t="http://localhost:8080",n="debug";break;default:t="https://solana.tor.us",n="error";break}return{torusUrl:t,logLevel:n}},Mf=()=>{let e=window.navigator.language||"en-US";const t=e.split("-");return e=Object.prototype.hasOwnProperty.call(_i.translations,t[0])?t[0]:"en",e},Lf={height:660,width:375},Df={height:740,width:1315},kf={height:700,width:1200},ls={height:600,width:400};function xf(e){let t;try{t=window[e];const n="__storage_test__";return t.setItem(n,n),t.removeItem(n),!0}catch(n){const r=n;return r&&(r.code===22||r.code===1014||r.name==="QuotaExceededError"||r.name==="NS_ERROR_DOM_QUOTA_REACHED")&&t&&t.length!==0}}function Yt(e){let{width:t,height:n}=e;const r=window.screenLeft!==void 0?window.screenLeft:window.screenX,a=window.screenTop!==void 0?window.screenTop:window.screenY,s=window.innerWidth?window.innerWidth:document.documentElement.clientWidth?document.documentElement.clientWidth:window.screen.width,l=window.innerHeight?window.innerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:window.screen.height,c=1,b=Math.abs((s-t)/2/c+r),f=Math.abs((l-n)/2/c+a);return`titlebar=0,toolbar=0,status=0,location=0,menubar=0,height=${n/c},width=${t/c},top=${f},left=${b}`}class ds extends kn{constructor(t,n){let{maxEventListeners:r=100,jsonRpcStreamName:a="provider"}=n;if(super(),M(this,"isTorus",void 0),M(this,"_rpcEngine",void 0),M(this,"jsonRpcConnectionEvents",void 0),M(this,"_state",void 0),!vf(t))throw new Error(xe.errors.invalidDuplexStream());this.isTorus=!0,this.setMaxListeners(r),this._handleConnect=this._handleConnect.bind(this),this._handleDisconnect=this._handleDisconnect.bind(this),this._handleStreamDisconnect=this._handleStreamDisconnect.bind(this),this._rpcRequest=this._rpcRequest.bind(this),this._initializeState=this._initializeState.bind(this),this.request=this.request.bind(this),this.sendAsync=this.sendAsync.bind(this);const s=new yf;Mi(t,s,t,this._handleStreamDisconnect.bind(this,"Torus")),s.ignoreStream("phishing");const l=pf();Mi(l.stream,s.createStream(a),l.stream,this._handleStreamDisconnect.bind(this,"Torus RpcProvider"));const c=new Ge;c.push(_f()),c.push(Of()),c.push(il({origin:location.origin})),c.push(l.middleware),this._rpcEngine=c,this.jsonRpcConnectionEvents=l.events}async request(t){if(!t||typeof t!="object"||Array.isArray(t))throw He.ethErrors.rpc.invalidRequest({message:xe.errors.invalidRequestArgs(),data:t});const{method:n,params:r}=t;if(typeof n!="string"||n.length===0)throw He.ethErrors.rpc.invalidRequest({message:xe.errors.invalidRequestMethod(),data:t});if(r!==void 0&&!Array.isArray(r)&&(typeof r!="object"||r===null))throw He.ethErrors.rpc.invalidRequest({message:xe.errors.invalidRequestParams(),data:t});return new Promise((a,s)=>{this._rpcRequest({method:n,params:r},Vr(a,s))})}send(t,n){this._rpcRequest(t,n)}sendAsync(t){return new Promise((n,r)=>{this._rpcRequest(t,Vr(n,r))})}_handleStreamDisconnect(t,n){Cf(t,n,this),this._handleDisconnect(!1,n?n.message:void 0)}}const $t=e=>{const t=window.document.createElement("template"),n=e.trim();return t.innerHTML=n,t.content.firstChild};function an(e){return e.version===void 0}class us extends kn{constructor(t){let{url:n,target:r,features:a,timeout:s=3e4}=t;super(),M(this,"url",void 0),M(this,"target",void 0),M(this,"features",void 0),M(this,"window",void 0),M(this,"windowTimer",void 0),M(this,"iClosedWindow",void 0),M(this,"timeout",void 0),this.url=n,this.target=r||"_blank",this.features=a||Yt(kf),this.window=void 0,this.windowTimer=void 0,this.iClosedWindow=!1,this.timeout=s,this._setupTimer()}_setupTimer(){this.windowTimer=Number(setInterval(()=>{this.window&&this.window.closed&&(clearInterval(this.windowTimer),setTimeout(()=>{this.iClosedWindow||this.emit("close"),this.iClosedWindow=!1,this.window=void 0},this.timeout)),this.window===void 0&&clearInterval(this.windowTimer)},500))}open(){var t;return this.window=window.open(this.url.href,this.target,this.features),(t=this.window)!=null&&t.focus&&this.window.focus(),Promise.resolve()}close(){this.iClosedWindow=!0,this.window&&this.window.close()}redirect(t){t?window.location.replace(this.url.href):window.location.href=this.url.href}}class Wn extends ds{constructor(t,n){let{maxEventListeners:r=100,jsonRpcStreamName:a="provider"}=n;super(t,{maxEventListeners:r,jsonRpcStreamName:a}),M(this,"embedTranslations",void 0),M(this,"torusUrl",void 0),M(this,"dappStorageKey",void 0),M(this,"windowRefs",void 0),M(this,"tryWindowHandle",void 0),M(this,"torusAlertContainer",void 0),M(this,"torusIframe",void 0),this._state=se({},Wn._defaultState),this.torusUrl="",this.dappStorageKey="";const s=_i.translations[Mf()];this.embedTranslations=s.embed,this.windowRefs={},this.on("connect",()=>{this._state.isConnected=!0});const l=c=>{const{method:b,params:f}=c;if(b===Ut.IFRAME_STATUS){const{isFullScreen:h,rid:A}=f;this._displayIframe({isFull:h,rid:A})}else if(b===Ut.CREATE_WINDOW){const{windowId:h,url:A}=f;this._createPopupBlockAlert(h,A)}else if(b===Ut.CLOSE_WINDOW)this._handleCloseWindow(f);else if(b===Ut.USER_LOGGED_IN){const{currentLoginProvider:h}=f;this._state.isLoggedIn=!0,this._state.currentLoginProvider=h}else b===Ut.USER_LOGGED_OUT&&(this._state.isLoggedIn=!1,this._state.currentLoginProvider=null,this._displayIframe())};this.jsonRpcConnectionEvents.on("notification",l)}get isLoggedIn(){return this._state.isLoggedIn}get isIFrameFullScreen(){return this._state.isIFrameFullScreen}isConnected(){return this._state.isConnected}async _initializeState(t){try{const{torusUrl:n,dappStorageKey:r,torusAlertContainer:a,torusIframe:s}=t;this.torusUrl=n,this.dappStorageKey=r,this.torusAlertContainer=a,this.torusIframe=s,this.torusIframe.addEventListener("load",()=>{this._state.isIFrameFullScreen||this._displayIframe()});const{currentLoginProvider:l,isLoggedIn:c}=await this.request({method:ke.GET_PROVIDER_STATE,params:[]});this._handleConnect(l,c)}catch(n){X.error("Torus: Failed to get initial state. Please report this bug.",n)}finally{X.info("initialized communication state"),this._state.initialized=!0,this.emit("_initialized")}}_handleWindow(t){let{url:n,target:r,features:a}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const s=new URL(n||`${this.torusUrl}/redirect?windowId=${t}`);this.dappStorageKey&&(s.hash?s.hash+=`&dappStorageKey=${this.dappStorageKey}`:s.hash=`#dappStorageKey=${this.dappStorageKey}`);const l=new us({url:s,target:r,features:a});if(l.open(),!l.window){this._createPopupBlockAlert(t,s.href);return}this.windowRefs[t]=l,this.request({method:ke.OPENED_WINDOW,params:{windowId:t}}),l.once("close",()=>{delete this.windowRefs[t],this.request({method:ke.CLOSED_WINDOW,params:{windowId:t}})})}_displayIframe(){let{isFull:t=!1,rid:n=""}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const r={};if(t)r.display="block",r.width="100%",r.height="100%",r.top="0px",r.right="0px",r.left="0px",r.bottom="0px";else switch(r.display=this._state.torusWidgetVisibility?"block":"none",r.height="70px",r.width="70px",this._state.buttonPosition){case Ht.TOP_LEFT:r.top="0px",r.left="0px",r.right="auto",r.bottom="auto";break;case Ht.TOP_RIGHT:r.top="0px",r.right="0px",r.left="auto",r.bottom="auto";break;case Ht.BOTTOM_RIGHT:r.bottom="0px",r.right="0px",r.top="auto",r.left="auto";break;case Ht.BOTTOM_LEFT:default:r.bottom="0px",r.left="0px",r.top="auto",r.right="auto";break}Object.assign(this.torusIframe.style,r),this._state.isIFrameFullScreen=t,this.request({method:ke.IFRAME_STATUS,params:{isIFrameFullScreen:t,rid:n}})}hideTorusButton(){this._state.torusWidgetVisibility=!1,this._displayIframe()}showTorusButton(){this._state.torusWidgetVisibility=!0,this._displayIframe()}_rpcRequest(t,n){const r=n,a=t;Array.isArray(a)||a.jsonrpc||(a.jsonrpc="2.0"),this.tryWindowHandle(a,r)}_handleConnect(t,n){this._state.isConnected||(this._state.isConnected=!0,this.emit("connect",{currentLoginProvider:t,isLoggedIn:n}),X.debug(xe.info.connected(t)))}_handleDisconnect(t,n){if(this._state.isConnected||!this._state.isPermanentlyDisconnected&&!t){this._state.isConnected=!1;let r;t?(r=new He.EthereumRpcError(1013,n||xe.errors.disconnected()),X.debug(r)):(r=new He.EthereumRpcError(1011,n||xe.errors.permanentlyDisconnected()),X.error(r),this._state.currentLoginProvider=null,this._state.isLoggedIn=!1,this._state.torusWidgetVisibility=!1,this._state.isIFrameFullScreen=!1,this._state.isPermanentlyDisconnected=!0),this.emit("disconnect",r)}}_handleCloseWindow(t){const{windowId:n}=t;this.windowRefs[n]&&(this.windowRefs[n].close(),delete this.windowRefs[n])}async _createPopupBlockAlert(t,n){const r=this.getLogoUrl(),a=$t(`<div id="torusAlert" class="torus-alert--v2"><div id="torusAlert__logo"><img src="${r}" /></div><div><h1 id="torusAlert__title">${this.embedTranslations.actionRequired}</h1><p id="torusAlert__desc">${this.embedTranslations.pendingAction}</p></div></div>`),s=$t(`<div><a id="torusAlert__btn">${this.embedTranslations.continue}</a></div>`),l=$t('<div id="torusAlert__btn-container"></div>');l.appendChild(s),a.appendChild(l);const c=()=>{s.addEventListener("click",()=>{this._handleWindow(t,{url:n,target:"_blank",features:Yt(ls)}),a.remove(),this.torusAlertContainer.children.length===0&&(this.torusAlertContainer.style.display="none")})};(()=>{this.torusAlertContainer.appendChild(a)})(),c(),this.torusAlertContainer.style.display="block"}getLogoUrl(){return`${this.torusUrl}/images/torus_icon-blue.svg`}}M(Wn,"_defaultState",{buttonPosition:"bottom-left",currentLoginProvider:null,isIFrameFullScreen:!1,hasEmittedConnection:!1,torusWidgetVisibility:!1,initialized:!1,isLoggedIn:!1,isPermanentlyDisconnected:!1,isConnected:!1});class Fn extends ds{constructor(t,n){let{maxEventListeners:r=100,jsonRpcStreamName:a="provider"}=n;super(t,{maxEventListeners:r,jsonRpcStreamName:a}),M(this,"chainId",void 0),M(this,"selectedAddress",void 0),M(this,"tryWindowHandle",void 0),this._state=se({},Fn._defaultState),this.selectedAddress=null,this.chainId=null,this._handleAccountsChanged=this._handleAccountsChanged.bind(this),this._handleChainChanged=this._handleChainChanged.bind(this),this._handleUnlockStateChanged=this._handleUnlockStateChanged.bind(this),this.on("connect",()=>{this._state.isConnected=!0});const s=l=>{const{method:c,params:b}=l;c===Zn.ACCOUNTS_CHANGED?this._handleAccountsChanged(b):c===Zn.UNLOCK_STATE_CHANGED?this._handleUnlockStateChanged(b):c===Zn.CHAIN_CHANGED&&this._handleChainChanged(b)};this.jsonRpcConnectionEvents.on("notification",s)}isConnected(){return this._state.isConnected}async _initializeState(){try{const{accounts:t,chainId:n,isUnlocked:r}=await this.request({method:rl.GET_PROVIDER_STATE,params:[]});this.emit("connect",{chainId:n}),this._handleChainChanged({chainId:n}),this._handleUnlockStateChanged({accounts:t,isUnlocked:r}),this._handleAccountsChanged(t)}catch(t){X.error("Torus: Failed to get initial state. Please report this bug.",t)}finally{X.info("initialized provider state"),this._state.initialized=!0,this.emit("_initialized")}}_rpcRequest(t,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,a=n;const s=t;if(!Array.isArray(s)){if(s.jsonrpc||(s.jsonrpc="2.0"),s.method==="solana_accounts"||s.method==="solana_requestAccounts")a=(l,c)=>{this._handleAccountsChanged(c.result||[],s.method==="solana_accounts",r),n(l,c)};else if(s.method==="wallet_getProviderState"){this._rpcEngine.handle(t,a);return}}this.tryWindowHandle(s,a)}_handleConnect(t){this._state.isConnected||(this._state.isConnected=!0,this.emit("connect",{chainId:t}),X.debug(xe.info.connected(t)))}_handleDisconnect(t,n){if(this._state.isConnected||!this._state.isPermanentlyDisconnected&&!t){this._state.isConnected=!1;let r;t?(r=new He.EthereumRpcError(1013,n||xe.errors.disconnected()),X.debug(r)):(r=new He.EthereumRpcError(1011,n||xe.errors.permanentlyDisconnected()),X.error(r),this.chainId=null,this._state.accounts=null,this.selectedAddress=null,this._state.isUnlocked=!1,this._state.isPermanentlyDisconnected=!0),this.emit("disconnect",r)}}_handleAccountsChanged(t){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,a=t;Array.isArray(a)||(X.error("Torus: Received non-array accounts parameter. Please report this bug.",a),a=[]);for(const s of t)if(typeof s!="string"){X.error("Torus: Received non-string account. Please report this bug.",t),a=[];break}dl(this._state.accounts,a)||(n&&Array.isArray(this._state.accounts)&&this._state.accounts.length>0&&!r&&X.error('Torus: "solana_accounts" unexpectedly updated accounts. Please report this bug.',a),this._state.accounts=a,this.emit("accountsChanged",a)),this.selectedAddress!==a[0]&&(this.selectedAddress=a[0]||null)}_handleChainChanged(){let{chainId:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!t){X.error("Torus: Received invalid network parameters. Please report this bug.",{chainId:t});return}t==="loading"?this._handleDisconnect(!0):(this._handleConnect(t),t!==this.chainId&&(this.chainId=t,this._state.initialized&&this.emit("chainChanged",this.chainId)))}_handleUnlockStateChanged(){let{accounts:t,isUnlocked:n}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(typeof n!="boolean"){X.error("Torus: Received invalid isUnlocked parameter. Please report this bug.",{isUnlocked:n});return}n!==this._state.isUnlocked&&(this._state.isUnlocked=n,this._handleAccountsChanged(t||[]))}}M(Fn,"_defaultState",{accounts:null,isConnected:!1,isUnlocked:!1,initialized:!1,isPermanentlyDisconnected:!1,hasEmittedConnection:!1});function Io(e){return new Promise((t,n)=>{try{const r=document.createElement("img");r.onload=()=>t(!0),r.onerror=()=>t(!1),r.src=e}catch(r){n(r)}})}const Wf=e=>{const{document:t}=e,n=t.querySelector('head > meta[property="og:site_name"]');if(n)return n.content;const r=t.querySelector('head > meta[name="title"]');return r?r.content:t.title&&t.title.length>0?t.title:e.location.hostname};async function Ff(e){try{const{document:t}=e;let n=t.querySelector('head > link[rel="shortcut icon"]');return n&&await Io(n.href)||(n=Array.from(t.querySelectorAll('head > link[rel="icon"]')).find(r=>!!r.href),n&&await Io(n.href))?n.href:""}catch{return""}}const jf=async()=>({name:Wf(window),icon:await Ff(window)}),Uf=["send_transaction","sign_transaction","sign_all_transactions","sign_message","connect"],Bf=[ke.SET_PROVIDER],qf=xf("localStorage");(async function(){try{if(typeof document>"u")return;const t=document.createElement("link"),{torusUrl:n}=await ss("production");t.href=`${n}/frame`,t.crossOrigin="anonymous",t.type="text/html",t.rel="prefetch",t.relList&&t.relList.supports&&t.relList.supports("prefetch")&&document.head.appendChild(t)}catch(t){X.warn(t)}})();class Gf{constructor(){let{modalZIndex:t=99999}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};M(this,"isInitialized",void 0),M(this,"torusAlert",void 0),M(this,"modalZIndex",void 0),M(this,"alertZIndex",void 0),M(this,"requestedLoginProvider",void 0),M(this,"provider",void 0),M(this,"communicationProvider",void 0),M(this,"dappStorageKey",void 0),M(this,"isTopupHidden",!1),M(this,"torusAlertContainer",void 0),M(this,"torusUrl",void 0),M(this,"torusIframe",void 0),M(this,"styleLink",void 0),this.torusUrl="",this.isInitialized=!1,this.requestedLoginProvider=null,this.modalZIndex=t,this.alertZIndex=t+1e3,this.dappStorageKey=""}get isLoggedIn(){return this.communicationProvider?this.communicationProvider.isLoggedIn:!1}async init(){let{buildEnv:t=Nf.PRODUCTION,enableLogging:n=!1,network:r,showTorusButton:a=!1,useLocalStorage:s=!1,buttonPosition:l=Ht.BOTTOM_LEFT,apiKey:c="torus-default",extraParams:b={},whiteLabel:f}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(this.isInitialized)throw new Error("Already initialized");const{torusUrl:h,logLevel:A}=await ss(t);X.enableAll(),X.info(h,"url loaded"),X.info(`Solana Embed Version :${If}`),this.torusUrl=h,X.setDefaultLevel(A),n?X.enableAll():X.disableAll();const E=this.handleDappStorageKey(s),_=new URL(h);_.pathname.endsWith("/")?_.pathname+="frame":_.pathname+="/frame";const g=new URLSearchParams;return E&&g.append("dappStorageKey",E),g.append("origin",window.location.origin),_.hash=g.toString(),this.torusIframe=$t(`<iframe
        id="torusIframe"
        class="torusIframe"
        src="${_.href}"
        style="display: none; position: fixed; top: 0; right: 0; width: 100%;
        height: 100%; border: none; border-radius: 0; z-index: ${this.modalZIndex.toString()}"
      ></iframe>`),this.torusAlertContainer=$t(`<div id="torusAlertContainer" style="display:none; z-index: ${this.alertZIndex.toString()}"></div>`),this.styleLink=$t(`<link href="${h}/css/widget.css" rel="stylesheet" type="text/css">`),new Promise((L,P)=>{try{this.torusIframe.addEventListener("load",async()=>{const I=await jf();this.torusIframe.contentWindow.postMessage({buttonPosition:l,apiKey:c,network:r,dappMetadata:I,extraParams:b,whiteLabel:f},_.origin),await this._setupWeb3({torusUrl:h}),a&&this.showTorusButton(),f!=null&&f.topupHide?this.isTopupHidden=f.topupHide:this.hideTorusButton(),this.isInitialized=!0,window.torus=this,L()}),window.document.head.appendChild(this.styleLink),window.document.body.appendChild(this.torusIframe),window.document.body.appendChild(this.torusAlertContainer)}catch(I){P(I)}})}async login(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!this.isInitialized)throw new Error("Call init() first");try{this.requestedLoginProvider=t.loginProvider||null,this.requestedLoginProvider||this.communicationProvider._displayIframe({isFull:!0});const n=await new Promise((r,a)=>{this.provider._rpcRequest({method:"solana_requestAccounts",params:[this.requestedLoginProvider,t.login_hint]},Vr(r,a))});if(Array.isArray(n)&&n.length>0)return n;throw new Error("Login failed")}catch(n){throw X.error("login failed",n),n}finally{this.communicationProvider.isIFrameFullScreen&&this.communicationProvider._displayIframe()}}async loginWithPrivateKey(t){if(!this.isInitialized)throw new Error("Call init() first");const{privateKey:n,userInfo:r}=t,{success:a}=await this.communicationProvider.request({method:"login_with_private_key",params:{privateKey:n,userInfo:r}});if(!a)throw new Error("Login Failed")}async logout(){if(!this.communicationProvider.isLoggedIn)throw new Error("Not logged in");await this.communicationProvider.request({method:ke.LOGOUT,params:[]}),this.requestedLoginProvider=null}async cleanUp(){this.communicationProvider.isLoggedIn&&await this.logout(),this.clearInit()}clearInit(){function t(n){return n instanceof Element||n instanceof Document}t(this.styleLink)&&window.document.body.contains(this.styleLink)&&(this.styleLink.remove(),this.styleLink=void 0),t(this.torusIframe)&&window.document.body.contains(this.torusIframe)&&(this.torusIframe.remove(),this.torusIframe=void 0),t(this.torusAlertContainer)&&window.document.body.contains(this.torusAlertContainer)&&(this.torusAlert=void 0,this.torusAlertContainer.remove(),this.torusAlertContainer=void 0),this.isInitialized=!1}hideTorusButton(){this.communicationProvider.hideTorusButton()}showTorusButton(){this.communicationProvider.showTorusButton()}async setProvider(t){await this.communicationProvider.request({method:ke.SET_PROVIDER,params:se({},t)})}async showWallet(t){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r=await this.communicationProvider.request({method:ke.WALLET_INSTANCE_ID,params:[]}),a=t?`/${t}`:"",s=new URL(`${this.torusUrl}/wallet${a}`);s.searchParams.append("instanceId",r),Object.keys(n).forEach(c=>{s.searchParams.append(c,n[c])}),this.dappStorageKey&&(s.hash=`#dappStorageKey=${this.dappStorageKey}`),new us({url:s,features:Yt(Df)}).open()}async getUserInfo(){return await this.communicationProvider.request({method:ke.USER_INFO,params:[]})}async initiateTopup(t,n){if(!this.isInitialized)throw new Error("Torus is not initialized");const r=on();return this.communicationProvider._handleWindow(r),await this.communicationProvider.request({method:ke.TOPUP,params:{provider:t,params:n,windowId:r}})}async getAccounts(){return await this.provider.request({method:"getAccounts",params:[]})}async sendTransaction(t){const n=an(t),r=n?t.serialize({requireAllSignatures:!1}).toString("hex"):At.Buffer.from(t.serialize()).toString("hex");return await this.provider.request({method:"send_transaction",params:{message:r,isLegacyTransaction:n}})}async signAndSendTransaction(t,n){const r=an(t),a=r?t.serialize({requireAllSignatures:!1}).toString("hex"):At.Buffer.from(t.serialize()).toString("hex");return{signature:await this.provider.request({method:"send_transaction",params:{message:a,options:n,isLegacyTransaction:r}})}}async signTransaction(t){const n=an(t),r=n?t.serializeMessage().toString("hex"):At.Buffer.from(t.message.serialize()).toString("hex"),a=await this.provider.request({method:"sign_transaction",params:{message:r,messageOnly:!0,isLegacyTransaction:n}}),s=JSON.parse(a),l={publicKey:new Li(s.publicKey),signature:At.Buffer.from(s.signature,"hex")};return t.addSignature(l.publicKey,l.signature),t}async signAllTransactions(t){let n;const r=t.map(l=>(n=an(l),n?l.serializeMessage().toString("hex"):At.Buffer.from(l.message.serialize()).toString("hex"))),s=(await this.provider.request({method:"sign_all_transactions",params:{message:r,messageOnly:!0,isLegacyTransaction:n}})).map(l=>{const c=JSON.parse(l);return{publicKey:new Li(c.publicKey),signature:At.Buffer.from(c.signature,"hex")}});return t.forEach((l,c)=>(l.addSignature(s[c].publicKey,s[c].signature),l)),t}async signMessage(t){return await this.provider.request({method:"sign_message",params:{data:t}})}async getGaslessPublicKey(){return await this.provider.request({method:"get_gasless_public_key",params:[]})}handleDappStorageKey(t){const n=`${_i.localStorageKeyPrefix}${window.location.hostname}`;let r="";if(qf&&t){const a=window.localStorage.getItem(n);if(a)r=a;else{const s=`torus-app-${on()}`;window.localStorage.setItem(n,s),r=s}}return this.dappStorageKey=r,r}async _setupWeb3(t){X.info("setupWeb3 running");const n=new Eo({name:"embed_torus",target:"iframe_torus",targetWindow:this.torusIframe.contentWindow}),r=new Eo({name:"embed_communication",target:"iframe_communication",targetWindow:this.torusIframe.contentWindow}),a=new Fn(n,{}),s=new Wn(r,{});a.tryWindowHandle=(f,h)=>{const A=f;if(!Array.isArray(A)&&Uf.includes(A.method)){if(!this.communicationProvider.isLoggedIn)throw new Error("User Not Logged In");const E=on();s._handleWindow(E,{target:"_blank",features:Yt(ls)}),A.windowId=E}a._rpcEngine.handle(A,h)},s.tryWindowHandle=(f,h)=>{const A=f;if(!Array.isArray(A)&&Bf.includes(A.method)){const E=on();s._handleWindow(E,{target:"_blank",features:Yt(Lf)}),A.params.windowId=E}s._rpcEngine.handle(A,h)};const l=f=>{const h=a[f],A=this;a[f]=function(_,g){const{method:L,params:P=[]}=_;if(L==="solana_requestAccounts"){if(!g)return A.login({loginProvider:P[0]});A.login({loginProvider:P[0]}).then(I=>g(null,I)).catch(I=>g(I))}return h.apply(this,[_,g])}};l("request"),l("sendAsync"),l("send");const c=new Proxy(a,{deleteProperty:()=>!0}),b=new Proxy(s,{deleteProperty:()=>!0});this.provider=c,this.communicationProvider=b,await Promise.all([a._initializeState(),s._initializeState(se(se({},t),{},{dappStorageKey:this.dappStorageKey,torusAlertContainer:this.torusAlertContainer,torusIframe:this.torusIframe}))]),X.debug("Torus - injected provider")}}var Hf={exports:{}},wr={exports:{}},ae={ArrayIsArray(e){return Array.isArray(e)},ArrayPrototypeIncludes(e,t){return e.includes(t)},ArrayPrototypeIndexOf(e,t){return e.indexOf(t)},ArrayPrototypeJoin(e,t){return e.join(t)},ArrayPrototypeMap(e,t){return e.map(t)},ArrayPrototypePop(e,t){return e.pop(t)},ArrayPrototypePush(e,t){return e.push(t)},ArrayPrototypeSlice(e,t,n){return e.slice(t,n)},Error,FunctionPrototypeCall(e,t,...n){return e.call(t,...n)},FunctionPrototypeSymbolHasInstance(e,t){return Function.prototype[Symbol.hasInstance].call(e,t)},MathFloor:Math.floor,Number,NumberIsInteger:Number.isInteger,NumberIsNaN:Number.isNaN,NumberMAX_SAFE_INTEGER:Number.MAX_SAFE_INTEGER,NumberMIN_SAFE_INTEGER:Number.MIN_SAFE_INTEGER,NumberParseInt:Number.parseInt,ObjectDefineProperties(e,t){return Object.defineProperties(e,t)},ObjectDefineProperty(e,t,n){return Object.defineProperty(e,t,n)},ObjectGetOwnPropertyDescriptor(e,t){return Object.getOwnPropertyDescriptor(e,t)},ObjectKeys(e){return Object.keys(e)},ObjectSetPrototypeOf(e,t){return Object.setPrototypeOf(e,t)},Promise,PromisePrototypeCatch(e,t){return e.catch(t)},PromisePrototypeThen(e,t,n){return e.then(t,n)},PromiseReject(e){return Promise.reject(e)},ReflectApply:Reflect.apply,RegExpPrototypeTest(e,t){return e.test(t)},SafeSet:Set,String,StringPrototypeSlice(e,t,n){return e.slice(t,n)},StringPrototypeToLowerCase(e){return e.toLowerCase()},StringPrototypeToUpperCase(e){return e.toUpperCase()},StringPrototypeTrim(e){return e.trim()},Symbol,SymbolFor:Symbol.for,SymbolAsyncIterator:Symbol.asyncIterator,SymbolHasInstance:Symbol.hasInstance,SymbolIterator:Symbol.iterator,TypedArrayPrototypeSet(e,t,n){return e.set(t,n)},Uint8Array},fs={exports:{}};(function(e){const t=we,n=Object.getPrototypeOf(async function(){}).constructor,r=globalThis.Blob||t.Blob,a=typeof r<"u"?function(c){return c instanceof r}:function(c){return!1};class s extends Error{constructor(c){if(!Array.isArray(c))throw new TypeError(`Expected input to be an Array, got ${typeof c}`);let b="";for(let f=0;f<c.length;f++)b+=`    ${c[f].stack}
`;super(b),this.name="AggregateError",this.errors=c}}e.exports={AggregateError:s,kEmptyObject:Object.freeze({}),once(l){let c=!1;return function(...b){c||(c=!0,l.apply(this,b))}},createDeferredPromise:function(){let l,c;return{promise:new Promise((f,h)=>{l=f,c=h}),resolve:l,reject:c}},promisify(l){return new Promise((c,b)=>{l((f,...h)=>f?b(f):c(...h))})},debuglog(){return function(){}},format(l,...c){return l.replace(/%([sdifj])/g,function(...[b,f]){const h=c.shift();return f==="f"?h.toFixed(6):f==="j"?JSON.stringify(h):f==="s"&&typeof h=="object"?`${h.constructor!==Object?h.constructor.name:""} {}`.trim():h.toString()})},inspect(l){switch(typeof l){case"string":if(l.includes("'"))if(l.includes('"')){if(!l.includes("`")&&!l.includes("${"))return`\`${l}\``}else return`"${l}"`;return`'${l}'`;case"number":return isNaN(l)?"NaN":Object.is(l,-0)?String(l):l;case"bigint":return`${String(l)}n`;case"boolean":case"undefined":return String(l);case"object":return"{}"}},types:{isAsyncFunction(l){return l instanceof n},isArrayBufferView(l){return ArrayBuffer.isView(l)}},isBlob:a},e.exports.promisify.custom=Symbol.for("nodejs.util.promisify.custom")})(fs);var Ze=fs.exports,wi={};const{format:Vf,inspect:yn,AggregateError:Kf}=Ze,zf=globalThis.AggregateError||Kf,Yf=Symbol("kIsNodeError"),Jf=["string","function","number","object","Function","Object","boolean","bigint","symbol"],Xf=/^([A-Z][a-z0-9]*)+$/,Zf="__node_internal_",jn={};function pt(e,t){if(!e)throw new jn.ERR_INTERNAL_ASSERTION(t)}function To(e){let t="",n=e.length;const r=e[0]==="-"?1:0;for(;n>=r+4;n-=3)t=`_${e.slice(n-3,n)}${t}`;return`${e.slice(0,n)}${t}`}function Qf(e,t,n){if(typeof t=="function")return pt(t.length<=n.length,`Code: ${e}; The provided arguments length (${n.length}) does not match the required ones (${t.length}).`),t(...n);const r=(t.match(/%[dfijoOs]/g)||[]).length;return pt(r===n.length,`Code: ${e}; The provided arguments length (${n.length}) does not match the required ones (${r}).`),n.length===0?t:Vf(t,...n)}function ue(e,t,n){n||(n=Error);class r extends n{constructor(...s){super(Qf(e,t,s))}toString(){return`${this.name} [${e}]: ${this.message}`}}Object.defineProperties(r.prototype,{name:{value:n.name,writable:!0,enumerable:!1,configurable:!0},toString:{value(){return`${this.name} [${e}]: ${this.message}`},writable:!0,enumerable:!1,configurable:!0}}),r.prototype.code=e,r.prototype[Yf]=!0,jn[e]=r}function $o(e){const t=Zf+e.name;return Object.defineProperty(e,"name",{value:t}),e}function ec(e,t){if(e&&t&&e!==t){if(Array.isArray(t.errors))return t.errors.push(e),t;const n=new zf([t,e],t.message);return n.code=t.code,n}return e||t}let tc=class extends Error{constructor(t="The operation was aborted",n=void 0){if(n!==void 0&&typeof n!="object")throw new jn.ERR_INVALID_ARG_TYPE("options","Object",n);super(t,n),this.code="ABORT_ERR",this.name="AbortError"}};ue("ERR_ASSERTION","%s",Error);ue("ERR_INVALID_ARG_TYPE",(e,t,n)=>{pt(typeof e=="string","'name' must be a string"),Array.isArray(t)||(t=[t]);let r="The ";e.endsWith(" argument")?r+=`${e} `:r+=`"${e}" ${e.includes(".")?"property":"argument"} `,r+="must be ";const a=[],s=[],l=[];for(const b of t)pt(typeof b=="string","All expected entries have to be of type string"),Jf.includes(b)?a.push(b.toLowerCase()):Xf.test(b)?s.push(b):(pt(b!=="object",'The value "object" should be written as "Object"'),l.push(b));if(s.length>0){const b=a.indexOf("object");b!==-1&&(a.splice(a,b,1),s.push("Object"))}if(a.length>0){switch(a.length){case 1:r+=`of type ${a[0]}`;break;case 2:r+=`one of type ${a[0]} or ${a[1]}`;break;default:{const b=a.pop();r+=`one of type ${a.join(", ")}, or ${b}`}}(s.length>0||l.length>0)&&(r+=" or ")}if(s.length>0){switch(s.length){case 1:r+=`an instance of ${s[0]}`;break;case 2:r+=`an instance of ${s[0]} or ${s[1]}`;break;default:{const b=s.pop();r+=`an instance of ${s.join(", ")}, or ${b}`}}l.length>0&&(r+=" or ")}switch(l.length){case 0:break;case 1:l[0].toLowerCase()!==l[0]&&(r+="an "),r+=`${l[0]}`;break;case 2:r+=`one of ${l[0]} or ${l[1]}`;break;default:{const b=l.pop();r+=`one of ${l.join(", ")}, or ${b}`}}if(n==null)r+=`. Received ${n}`;else if(typeof n=="function"&&n.name)r+=`. Received function ${n.name}`;else if(typeof n=="object"){var c;if((c=n.constructor)!==null&&c!==void 0&&c.name)r+=`. Received an instance of ${n.constructor.name}`;else{const b=yn(n,{depth:-1});r+=`. Received ${b}`}}else{let b=yn(n,{colors:!1});b.length>25&&(b=`${b.slice(0,25)}...`),r+=`. Received type ${typeof n} (${b})`}return r},TypeError);ue("ERR_INVALID_ARG_VALUE",(e,t,n="is invalid")=>{let r=yn(t);return r.length>128&&(r=r.slice(0,128)+"..."),`The ${e.includes(".")?"property":"argument"} '${e}' ${n}. Received ${r}`},TypeError);ue("ERR_INVALID_RETURN_VALUE",(e,t,n)=>{var r;const a=n!=null&&(r=n.constructor)!==null&&r!==void 0&&r.name?`instance of ${n.constructor.name}`:`type ${typeof n}`;return`Expected ${e} to be returned from the "${t}" function but got ${a}.`},TypeError);ue("ERR_MISSING_ARGS",(...e)=>{pt(e.length>0,"At least one arg needs to be specified");let t;const n=e.length;switch(e=(Array.isArray(e)?e:[e]).map(r=>`"${r}"`).join(" or "),n){case 1:t+=`The ${e[0]} argument`;break;case 2:t+=`The ${e[0]} and ${e[1]} arguments`;break;default:{const r=e.pop();t+=`The ${e.join(", ")}, and ${r} arguments`}break}return`${t} must be specified`},TypeError);ue("ERR_OUT_OF_RANGE",(e,t,n)=>{pt(t,'Missing "range" argument');let r;return Number.isInteger(n)&&Math.abs(n)>2**32?r=To(String(n)):typeof n=="bigint"?(r=String(n),(n>2n**32n||n<-(2n**32n))&&(r=To(r)),r+="n"):r=yn(n),`The value of "${e}" is out of range. It must be ${t}. Received ${r}`},RangeError);ue("ERR_MULTIPLE_CALLBACK","Callback called multiple times",Error);ue("ERR_METHOD_NOT_IMPLEMENTED","The %s method is not implemented",Error);ue("ERR_STREAM_ALREADY_FINISHED","Cannot call %s after a stream was finished",Error);ue("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable",Error);ue("ERR_STREAM_DESTROYED","Cannot call %s after a stream was destroyed",Error);ue("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError);ue("ERR_STREAM_PREMATURE_CLOSE","Premature close",Error);ue("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF",Error);ue("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event",Error);ue("ERR_STREAM_WRITE_AFTER_END","write after end",Error);ue("ERR_UNKNOWN_ENCODING","Unknown encoding: %s",TypeError);var Se={AbortError:tc,aggregateTwoErrors:$o(ec),hideStackFrames:$o,codes:jn};const{ArrayIsArray:yi,ArrayPrototypeIncludes:cs,ArrayPrototypeJoin:hs,ArrayPrototypeMap:nc,NumberIsInteger:mi,NumberIsNaN:rc,NumberMAX_SAFE_INTEGER:ic,NumberMIN_SAFE_INTEGER:oc,NumberParseInt:ac,ObjectPrototypeHasOwnProperty:sc,RegExpPrototypeExec:bs,String:lc,StringPrototypeToUpperCase:dc,StringPrototypeTrim:uc}=ae,{hideStackFrames:$e,codes:{ERR_SOCKET_BAD_PORT:fc,ERR_INVALID_ARG_TYPE:_e,ERR_INVALID_ARG_VALUE:Lt,ERR_OUT_OF_RANGE:wt,ERR_UNKNOWN_SIGNAL:vo}}=Se,{normalizeEncoding:cc}=Ze,{isAsyncFunction:hc,isArrayBufferView:bc}=Ze.types,No={};function gc(e){return e===(e|0)}function pc(e){return e===e>>>0}const _c=/^[0-7]+$/,wc="must be a 32-bit unsigned integer or an octal string";function yc(e,t,n){if(typeof e>"u"&&(e=n),typeof e=="string"){if(bs(_c,e)===null)throw new Lt(t,e,wc);e=ac(e,8)}return gs(e,t),e}const mc=$e((e,t,n=oc,r=ic)=>{if(typeof e!="number")throw new _e(t,"number",e);if(!mi(e))throw new wt(t,"an integer",e);if(e<n||e>r)throw new wt(t,`>= ${n} && <= ${r}`,e)}),Sc=$e((e,t,n=-2147483648,r=2147483647)=>{if(typeof e!="number")throw new _e(t,"number",e);if(!mi(e))throw new wt(t,"an integer",e);if(e<n||e>r)throw new wt(t,`>= ${n} && <= ${r}`,e)}),gs=$e((e,t,n=!1)=>{if(typeof e!="number")throw new _e(t,"number",e);if(!mi(e))throw new wt(t,"an integer",e);const r=n?1:0,a=4294967295;if(e<r||e>a)throw new wt(t,`>= ${r} && <= ${a}`,e)});function Si(e,t){if(typeof e!="string")throw new _e(t,"string",e)}function Ec(e,t,n=void 0,r){if(typeof e!="number")throw new _e(t,"number",e);if(n!=null&&e<n||r!=null&&e>r||(n!=null||r!=null)&&rc(e))throw new wt(t,`${n!=null?`>= ${n}`:""}${n!=null&&r!=null?" && ":""}${r!=null?`<= ${r}`:""}`,e)}const Rc=$e((e,t,n)=>{if(!cs(n,e)){const a="must be one of: "+hs(nc(n,s=>typeof s=="string"?`'${s}'`:lc(s)),", ");throw new Lt(t,e,a)}});function ps(e,t){if(typeof e!="boolean")throw new _e(t,"boolean",e)}function yr(e,t,n){return e==null||!sc(e,t)?n:e[t]}const Ac=$e((e,t,n=null)=>{const r=yr(n,"allowArray",!1),a=yr(n,"allowFunction",!1);if(!yr(n,"nullable",!1)&&e===null||!r&&yi(e)||typeof e!="object"&&(!a||typeof e!="function"))throw new _e(t,"Object",e)}),Ic=$e((e,t)=>{if(e!=null&&typeof e!="object"&&typeof e!="function")throw new _e(t,"a dictionary",e)}),Ei=$e((e,t,n=0)=>{if(!yi(e))throw new _e(t,"Array",e);if(e.length<n){const r=`must be longer than ${n}`;throw new Lt(t,e,r)}});function Tc(e,t){Ei(e,t);for(let n=0;n<e.length;n++)Si(e[n],`${t}[${n}]`)}function $c(e,t){Ei(e,t);for(let n=0;n<e.length;n++)ps(e[n],`${t}[${n}]`)}function vc(e,t="signal"){if(Si(e,t),No[e]===void 0)throw No[dc(e)]!==void 0?new vo(e+" (signals must use all capital letters)"):new vo(e)}const Nc=$e((e,t="buffer")=>{if(!bc(e))throw new _e(t,["Buffer","TypedArray","DataView"],e)});function Pc(e,t){const n=cc(t),r=e.length;if(n==="hex"&&r%2!==0)throw new Lt("encoding",t,`is invalid for data of length ${r}`)}function Oc(e,t="Port",n=!0){if(typeof e!="number"&&typeof e!="string"||typeof e=="string"&&uc(e).length===0||+e!==+e>>>0||e>65535||e===0&&!n)throw new fc(t,e,n);return e|0}const Cc=$e((e,t)=>{if(e!==void 0&&(e===null||typeof e!="object"||!("aborted"in e)))throw new _e(t,"AbortSignal",e)}),Mc=$e((e,t)=>{if(typeof e!="function")throw new _e(t,"Function",e)}),Lc=$e((e,t)=>{if(typeof e!="function"||hc(e))throw new _e(t,"Function",e)}),Dc=$e((e,t)=>{if(e!==void 0)throw new _e(t,"undefined",e)});function kc(e,t,n){if(!cs(n,e))throw new _e(t,`('${hs(n,"|")}')`,e)}const xc=/^(?:<[^>]*>)(?:\s*;\s*[^;"\s]+(?:=(")?[^;"\s]*\1)?)*$/;function Po(e,t){if(typeof e>"u"||!bs(xc,e))throw new Lt(t,e,'must be an array or string of format "</styles.css>; rel=preload; as=style"')}function Wc(e){if(typeof e=="string")return Po(e,"hints"),e;if(yi(e)){const t=e.length;let n="";if(t===0)return n;for(let r=0;r<t;r++){const a=e[r];Po(a,"hints"),n+=a,r!==t-1&&(n+=", ")}return n}throw new Lt("hints",e,'must be an array or string of format "</styles.css>; rel=preload; as=style"')}var Un={isInt32:gc,isUint32:pc,parseFileMode:yc,validateArray:Ei,validateStringArray:Tc,validateBooleanArray:$c,validateBoolean:ps,validateBuffer:Nc,validateDictionary:Ic,validateEncoding:Pc,validateFunction:Mc,validateInt32:Sc,validateInteger:mc,validateNumber:Ec,validateObject:Ac,validateOneOf:Rc,validatePlainFunction:Lc,validatePort:Oc,validateSignalName:vc,validateString:Si,validateUint32:gs,validateUndefined:Dc,validateUnion:kc,validateAbortSignal:Cc,validateLinkHeaderValue:Wc},Ri={exports:{}};const{Symbol:Bn,SymbolAsyncIterator:Oo,SymbolIterator:Co,SymbolFor:_s}=ae,ws=Bn("kDestroyed"),ys=Bn("kIsErrored"),Kr=Bn("kIsReadable"),ms=Bn("kIsDisturbed"),Fc=_s("nodejs.webstream.isClosedPromise"),jc=_s("nodejs.webstream.controllerErrorFunction");function qn(e,t=!1){var n;return!!(e&&typeof e.pipe=="function"&&typeof e.on=="function"&&(!t||typeof e.pause=="function"&&typeof e.resume=="function")&&(!e._writableState||((n=e._readableState)===null||n===void 0?void 0:n.readable)!==!1)&&(!e._writableState||e._readableState))}function Gn(e){var t;return!!(e&&typeof e.write=="function"&&typeof e.on=="function"&&(!e._readableState||((t=e._writableState)===null||t===void 0?void 0:t.writable)!==!1))}function Uc(e){return!!(e&&typeof e.pipe=="function"&&e._readableState&&typeof e.on=="function"&&typeof e.write=="function")}function qe(e){return e&&(e._readableState||e._writableState||typeof e.write=="function"&&typeof e.on=="function"||typeof e.pipe=="function"&&typeof e.on=="function")}function Ss(e){return!!(e&&!qe(e)&&typeof e.pipeThrough=="function"&&typeof e.getReader=="function"&&typeof e.cancel=="function")}function Es(e){return!!(e&&!qe(e)&&typeof e.getWriter=="function"&&typeof e.abort=="function")}function Rs(e){return!!(e&&!qe(e)&&typeof e.readable=="object"&&typeof e.writable=="object")}function Bc(e){return Ss(e)||Es(e)||Rs(e)}function qc(e,t){return e==null?!1:t===!0?typeof e[Oo]=="function":t===!1?typeof e[Co]=="function":typeof e[Oo]=="function"||typeof e[Co]=="function"}function Hn(e){if(!qe(e))return null;const t=e._writableState,n=e._readableState,r=t||n;return!!(e.destroyed||e[ws]||r!=null&&r.destroyed)}function As(e){if(!Gn(e))return null;if(e.writableEnded===!0)return!0;const t=e._writableState;return t!=null&&t.errored?!1:typeof(t==null?void 0:t.ended)!="boolean"?null:t.ended}function Gc(e,t){if(!Gn(e))return null;if(e.writableFinished===!0)return!0;const n=e._writableState;return n!=null&&n.errored?!1:typeof(n==null?void 0:n.finished)!="boolean"?null:!!(n.finished||t===!1&&n.ended===!0&&n.length===0)}function Hc(e){if(!qn(e))return null;if(e.readableEnded===!0)return!0;const t=e._readableState;return!t||t.errored?!1:typeof(t==null?void 0:t.ended)!="boolean"?null:t.ended}function Is(e,t){if(!qn(e))return null;const n=e._readableState;return n!=null&&n.errored?!1:typeof(n==null?void 0:n.endEmitted)!="boolean"?null:!!(n.endEmitted||t===!1&&n.ended===!0&&n.length===0)}function Ts(e){return e&&e[Kr]!=null?e[Kr]:typeof(e==null?void 0:e.readable)!="boolean"?null:Hn(e)?!1:qn(e)&&e.readable&&!Is(e)}function $s(e){return typeof(e==null?void 0:e.writable)!="boolean"?null:Hn(e)?!1:Gn(e)&&e.writable&&!As(e)}function Vc(e,t){return qe(e)?Hn(e)?!0:!((t==null?void 0:t.readable)!==!1&&Ts(e)||(t==null?void 0:t.writable)!==!1&&$s(e)):null}function Kc(e){var t,n;return qe(e)?e.writableErrored?e.writableErrored:(t=(n=e._writableState)===null||n===void 0?void 0:n.errored)!==null&&t!==void 0?t:null:null}function zc(e){var t,n;return qe(e)?e.readableErrored?e.readableErrored:(t=(n=e._readableState)===null||n===void 0?void 0:n.errored)!==null&&t!==void 0?t:null:null}function Yc(e){if(!qe(e))return null;if(typeof e.closed=="boolean")return e.closed;const t=e._writableState,n=e._readableState;return typeof(t==null?void 0:t.closed)=="boolean"||typeof(n==null?void 0:n.closed)=="boolean"?(t==null?void 0:t.closed)||(n==null?void 0:n.closed):typeof e._closed=="boolean"&&vs(e)?e._closed:null}function vs(e){return typeof e._closed=="boolean"&&typeof e._defaultKeepAlive=="boolean"&&typeof e._removedConnection=="boolean"&&typeof e._removedContLen=="boolean"}function Ns(e){return typeof e._sent100=="boolean"&&vs(e)}function Jc(e){var t;return typeof e._consuming=="boolean"&&typeof e._dumped=="boolean"&&((t=e.req)===null||t===void 0?void 0:t.upgradeOrConnect)===void 0}function Xc(e){if(!qe(e))return null;const t=e._writableState,n=e._readableState,r=t||n;return!r&&Ns(e)||!!(r&&r.autoDestroy&&r.emitClose&&r.closed===!1)}function Zc(e){var t;return!!(e&&((t=e[ms])!==null&&t!==void 0?t:e.readableDidRead||e.readableAborted))}function Qc(e){var t,n,r,a,s,l,c,b,f,h;return!!(e&&((t=(n=(r=(a=(s=(l=e[ys])!==null&&l!==void 0?l:e.readableErrored)!==null&&s!==void 0?s:e.writableErrored)!==null&&a!==void 0?a:(c=e._readableState)===null||c===void 0?void 0:c.errorEmitted)!==null&&r!==void 0?r:(b=e._writableState)===null||b===void 0?void 0:b.errorEmitted)!==null&&n!==void 0?n:(f=e._readableState)===null||f===void 0?void 0:f.errored)!==null&&t!==void 0?t:!((h=e._writableState)===null||h===void 0)&&h.errored))}var Qe={kDestroyed:ws,isDisturbed:Zc,kIsDisturbed:ms,isErrored:Qc,kIsErrored:ys,isReadable:Ts,kIsReadable:Kr,kIsClosedPromise:Fc,kControllerErrorFunction:jc,isClosed:Yc,isDestroyed:Hn,isDuplexNodeStream:Uc,isFinished:Vc,isIterable:qc,isReadableNodeStream:qn,isReadableStream:Ss,isReadableEnded:Hc,isReadableFinished:Is,isReadableErrored:zc,isNodeStream:qe,isWebStream:Bc,isWritable:$s,isWritableNodeStream:Gn,isWritableStream:Es,isWritableEnded:As,isWritableFinished:Gc,isWritableErrored:Kc,isServerRequest:Jc,isServerResponse:Ns,willEmitClose:Xc,isTransformStream:Rs};const tt=ye,{AbortError:Ps,codes:eh}=Se,{ERR_INVALID_ARG_TYPE:th,ERR_STREAM_PREMATURE_CLOSE:Mo}=eh,{kEmptyObject:zr,once:Yr}=Ze,{validateAbortSignal:nh,validateFunction:rh,validateObject:ih,validateBoolean:oh}=Un,{Promise:ah,PromisePrototypeThen:sh}=ae,{isClosed:lh,isReadable:Lo,isReadableNodeStream:mr,isReadableStream:dh,isReadableFinished:Do,isReadableErrored:ko,isWritable:xo,isWritableNodeStream:Wo,isWritableStream:uh,isWritableFinished:Fo,isWritableErrored:jo,isNodeStream:fh,willEmitClose:ch,kIsClosedPromise:hh}=Qe;function bh(e){return e.setHeader&&typeof e.abort=="function"}const Jr=()=>{};function Os(e,t,n){var r,a;if(arguments.length===2?(n=t,t=zr):t==null?t=zr:ih(t,"options"),rh(n,"callback"),nh(t.signal,"options.signal"),n=Yr(n),dh(e)||uh(e))return gh(e,t,n);if(!fh(e))throw new th("stream",["ReadableStream","WritableStream","Stream"],e);const s=(r=t.readable)!==null&&r!==void 0?r:mr(e),l=(a=t.writable)!==null&&a!==void 0?a:Wo(e),c=e._writableState,b=e._readableState,f=()=>{e.writable||E()};let h=ch(e)&&mr(e)===s&&Wo(e)===l,A=Fo(e,!1);const E=()=>{A=!0,e.destroyed&&(h=!1),!(h&&(!e.readable||s))&&(!s||_)&&n.call(e)};let _=Do(e,!1);const g=()=>{_=!0,e.destroyed&&(h=!1),!(h&&(!e.writable||l))&&(!l||A)&&n.call(e)},L=C=>{n.call(e,C)};let P=lh(e);const I=()=>{P=!0;const C=jo(e)||ko(e);if(C&&typeof C!="boolean")return n.call(e,C);if(s&&!_&&mr(e,!0)&&!Do(e,!1))return n.call(e,new Mo);if(l&&!A&&!Fo(e,!1))return n.call(e,new Mo);n.call(e)},w=()=>{P=!0;const C=jo(e)||ko(e);if(C&&typeof C!="boolean")return n.call(e,C);n.call(e)},O=()=>{e.req.on("finish",E)};bh(e)?(e.on("complete",E),h||e.on("abort",I),e.req?O():e.on("request",O)):l&&!c&&(e.on("end",f),e.on("close",f)),!h&&typeof e.aborted=="boolean"&&e.on("aborted",I),e.on("end",g),e.on("finish",E),t.error!==!1&&e.on("error",L),e.on("close",I),P?tt.nextTick(I):c!=null&&c.errorEmitted||b!=null&&b.errorEmitted?h||tt.nextTick(w):(!s&&(!h||Lo(e))&&(A||xo(e)===!1)||!l&&(!h||xo(e))&&(_||Lo(e)===!1)||b&&e.req&&e.aborted)&&tt.nextTick(w);const B=()=>{n=Jr,e.removeListener("aborted",I),e.removeListener("complete",E),e.removeListener("abort",I),e.removeListener("request",O),e.req&&e.req.removeListener("finish",E),e.removeListener("end",f),e.removeListener("close",f),e.removeListener("finish",E),e.removeListener("end",g),e.removeListener("error",L),e.removeListener("close",I)};if(t.signal&&!P){const C=()=>{const H=n;B(),H.call(e,new Ps(void 0,{cause:t.signal.reason}))};if(t.signal.aborted)tt.nextTick(C);else{const H=n;n=Yr((...q)=>{t.signal.removeEventListener("abort",C),H.apply(e,q)}),t.signal.addEventListener("abort",C)}}return B}function gh(e,t,n){let r=!1,a=Jr;if(t.signal)if(a=()=>{r=!0,n.call(e,new Ps(void 0,{cause:t.signal.reason}))},t.signal.aborted)tt.nextTick(a);else{const l=n;n=Yr((...c)=>{t.signal.removeEventListener("abort",a),l.apply(e,c)}),t.signal.addEventListener("abort",a)}const s=(...l)=>{r||tt.nextTick(()=>n.apply(e,l))};return sh(e[hh].promise,s,s),Jr}function ph(e,t){var n;let r=!1;return t===null&&(t=zr),(n=t)!==null&&n!==void 0&&n.cleanup&&(oh(t.cleanup,"cleanup"),r=t.cleanup),new ah((a,s)=>{const l=Os(e,t,c=>{r&&l(),c?s(c):a()})})}Ri.exports=Os;Ri.exports.finished=ph;var ot=Ri.exports;const Fe=ye,{aggregateTwoErrors:_h,codes:{ERR_MULTIPLE_CALLBACK:wh},AbortError:yh}=Se,{Symbol:Cs}=ae,{kDestroyed:mh,isDestroyed:Sh,isFinished:Eh,isServerRequest:Rh}=Qe,Ms=Cs("kDestroy"),Xr=Cs("kConstruct");function Ls(e,t,n){e&&(e.stack,t&&!t.errored&&(t.errored=e),n&&!n.errored&&(n.errored=e))}function Ah(e,t){const n=this._readableState,r=this._writableState,a=r||n;return r!=null&&r.destroyed||n!=null&&n.destroyed?(typeof t=="function"&&t(),this):(Ls(e,r,n),r&&(r.destroyed=!0),n&&(n.destroyed=!0),a.constructed?Uo(this,e,t):this.once(Ms,function(s){Uo(this,_h(s,e),t)}),this)}function Uo(e,t,n){let r=!1;function a(s){if(r)return;r=!0;const l=e._readableState,c=e._writableState;Ls(s,c,l),c&&(c.closed=!0),l&&(l.closed=!0),typeof n=="function"&&n(s),s?Fe.nextTick(Ih,e,s):Fe.nextTick(Ds,e)}try{e._destroy(t||null,a)}catch(s){a(s)}}function Ih(e,t){Zr(e,t),Ds(e)}function Ds(e){const t=e._readableState,n=e._writableState;n&&(n.closeEmitted=!0),t&&(t.closeEmitted=!0),(n!=null&&n.emitClose||t!=null&&t.emitClose)&&e.emit("close")}function Zr(e,t){const n=e._readableState,r=e._writableState;r!=null&&r.errorEmitted||n!=null&&n.errorEmitted||(r&&(r.errorEmitted=!0),n&&(n.errorEmitted=!0),e.emit("error",t))}function Th(){const e=this._readableState,t=this._writableState;e&&(e.constructed=!0,e.closed=!1,e.closeEmitted=!1,e.destroyed=!1,e.errored=null,e.errorEmitted=!1,e.reading=!1,e.ended=e.readable===!1,e.endEmitted=e.readable===!1),t&&(t.constructed=!0,t.destroyed=!1,t.closed=!1,t.closeEmitted=!1,t.errored=null,t.errorEmitted=!1,t.finalCalled=!1,t.prefinished=!1,t.ended=t.writable===!1,t.ending=t.writable===!1,t.finished=t.writable===!1)}function Qr(e,t,n){const r=e._readableState,a=e._writableState;if(a!=null&&a.destroyed||r!=null&&r.destroyed)return this;r!=null&&r.autoDestroy||a!=null&&a.autoDestroy?e.destroy(t):t&&(t.stack,a&&!a.errored&&(a.errored=t),r&&!r.errored&&(r.errored=t),n?Fe.nextTick(Zr,e,t):Zr(e,t))}function $h(e,t){if(typeof e._construct!="function")return;const n=e._readableState,r=e._writableState;n&&(n.constructed=!1),r&&(r.constructed=!1),e.once(Xr,t),!(e.listenerCount(Xr)>1)&&Fe.nextTick(vh,e)}function vh(e){let t=!1;function n(r){if(t){Qr(e,r??new wh);return}t=!0;const a=e._readableState,s=e._writableState,l=s||a;a&&(a.constructed=!0),s&&(s.constructed=!0),l.destroyed?e.emit(Ms,r):r?Qr(e,r,!0):Fe.nextTick(Nh,e)}try{e._construct(r=>{Fe.nextTick(n,r)})}catch(r){Fe.nextTick(n,r)}}function Nh(e){e.emit(Xr)}function Bo(e){return(e==null?void 0:e.setHeader)&&typeof e.abort=="function"}function ks(e){e.emit("close")}function Ph(e,t){e.emit("error",t),Fe.nextTick(ks,e)}function Oh(e,t){!e||Sh(e)||(!t&&!Eh(e)&&(t=new yh),Rh(e)?(e.socket=null,e.destroy(t)):Bo(e)?e.abort():Bo(e.req)?e.req.abort():typeof e.destroy=="function"?e.destroy(t):typeof e.close=="function"?e.close():t?Fe.nextTick(Ph,e,t):Fe.nextTick(ks,e),e.destroyed||(e[mh]=!0))}var Dt={construct:$h,destroyer:Oh,destroy:Ah,undestroy:Th,errorOrDestroy:Qr};const{ArrayIsArray:Ch,ObjectSetPrototypeOf:xs}=ae,{EventEmitter:Vn}=yt;function Kn(e){Vn.call(this,e)}xs(Kn.prototype,Vn.prototype);xs(Kn,Vn);Kn.prototype.pipe=function(e,t){const n=this;function r(h){e.writable&&e.write(h)===!1&&n.pause&&n.pause()}n.on("data",r);function a(){n.readable&&n.resume&&n.resume()}e.on("drain",a),!e._isStdio&&(!t||t.end!==!1)&&(n.on("end",l),n.on("close",c));let s=!1;function l(){s||(s=!0,e.end())}function c(){s||(s=!0,typeof e.destroy=="function"&&e.destroy())}function b(h){f(),Vn.listenerCount(this,"error")===0&&this.emit("error",h)}ei(n,"error",b),ei(e,"error",b);function f(){n.removeListener("data",r),e.removeListener("drain",a),n.removeListener("end",l),n.removeListener("close",c),n.removeListener("error",b),e.removeListener("error",b),n.removeListener("end",f),n.removeListener("close",f),e.removeListener("close",f)}return n.on("end",f),n.on("close",f),e.on("close",f),e.emit("pipe",n),e};function ei(e,t,n){if(typeof e.prependListener=="function")return e.prependListener(t,n);!e._events||!e._events[t]?e.on(t,n):Ch(e._events[t])?e._events[t].unshift(n):e._events[t]=[n,e._events[t]]}var Ai={Stream:Kn,prependListener:ei},Ws={exports:{}};(function(e){const{AbortError:t,codes:n}=Se,{isNodeStream:r,isWebStream:a,kControllerErrorFunction:s}=Qe,l=ot,{ERR_INVALID_ARG_TYPE:c}=n,b=(f,h)=>{if(typeof f!="object"||!("aborted"in f))throw new c(h,"AbortSignal",f)};e.exports.addAbortSignal=function(h,A){if(b(h,"signal"),!r(A)&&!a(A))throw new c("stream",["ReadableStream","WritableStream","Stream"],A);return e.exports.addAbortSignalNoValidate(h,A)},e.exports.addAbortSignalNoValidate=function(f,h){if(typeof f!="object"||!("aborted"in f))return h;const A=r(h)?()=>{h.destroy(new t(void 0,{cause:f.reason}))}:()=>{h[s](new t(void 0,{cause:f.reason}))};return f.aborted?A():(f.addEventListener("abort",A),l(h,()=>f.removeEventListener("abort",A))),h}})(Ws);var zn=Ws.exports;const{StringPrototypeSlice:qo,SymbolIterator:Mh,TypedArrayPrototypeSet:sn,Uint8Array:Lh}=ae,{Buffer:Sr}=we,{inspect:Dh}=Ze;var kh=class{constructor(){this.head=null,this.tail=null,this.length=0}push(t){const n={data:t,next:null};this.length>0?this.tail.next=n:this.head=n,this.tail=n,++this.length}unshift(t){const n={data:t,next:this.head};this.length===0&&(this.tail=n),this.head=n,++this.length}shift(){if(this.length===0)return;const t=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,t}clear(){this.head=this.tail=null,this.length=0}join(t){if(this.length===0)return"";let n=this.head,r=""+n.data;for(;(n=n.next)!==null;)r+=t+n.data;return r}concat(t){if(this.length===0)return Sr.alloc(0);const n=Sr.allocUnsafe(t>>>0);let r=this.head,a=0;for(;r;)sn(n,r.data,a),a+=r.data.length,r=r.next;return n}consume(t,n){const r=this.head.data;if(t<r.length){const a=r.slice(0,t);return this.head.data=r.slice(t),a}return t===r.length?this.shift():n?this._getString(t):this._getBuffer(t)}first(){return this.head.data}*[Mh](){for(let t=this.head;t;t=t.next)yield t.data}_getString(t){let n="",r=this.head,a=0;do{const s=r.data;if(t>s.length)n+=s,t-=s.length;else{t===s.length?(n+=s,++a,r.next?this.head=r.next:this.head=this.tail=null):(n+=qo(s,0,t),this.head=r,r.data=qo(s,t));break}++a}while((r=r.next)!==null);return this.length-=a,n}_getBuffer(t){const n=Sr.allocUnsafe(t),r=t;let a=this.head,s=0;do{const l=a.data;if(t>l.length)sn(n,l,r-t),t-=l.length;else{t===l.length?(sn(n,l,r-t),++s,a.next?this.head=a.next:this.head=this.tail=null):(sn(n,new Lh(l.buffer,l.byteOffset,t),r-t),this.head=a,a.data=l.slice(t));break}++s}while((a=a.next)!==null);return this.length-=s,n}[Symbol.for("nodejs.util.inspect.custom")](t,n){return Dh(this,{...n,depth:0,customInspect:!1})}};const{MathFloor:xh,NumberIsInteger:Wh}=ae,{ERR_INVALID_ARG_VALUE:Fh}=Se.codes;function jh(e,t,n){return e.highWaterMark!=null?e.highWaterMark:t?e[n]:null}function Fs(e){return e?16:16*1024}function Uh(e,t,n,r){const a=jh(t,r,n);if(a!=null){if(!Wh(a)||a<0){const s=r?`options.${n}`:"options.highWaterMark";throw new Fh(s,a)}return xh(a)}return Fs(e.objectMode)}var Ii={getHighWaterMark:Uh,getDefaultHighWaterMark:Fs};const Go=ye,{PromisePrototypeThen:Bh,SymbolAsyncIterator:Ho,SymbolIterator:Vo}=ae,{Buffer:qh}=we,{ERR_INVALID_ARG_TYPE:Gh,ERR_STREAM_NULL_VALUES:Hh}=Se.codes;function Vh(e,t,n){let r;if(typeof t=="string"||t instanceof qh)return new e({objectMode:!0,...n,read(){this.push(t),this.push(null)}});let a;if(t&&t[Ho])a=!0,r=t[Ho]();else if(t&&t[Vo])a=!1,r=t[Vo]();else throw new Gh("iterable",["Iterable"],t);const s=new e({objectMode:!0,highWaterMark:1,...n});let l=!1;s._read=function(){l||(l=!0,b())},s._destroy=function(f,h){Bh(c(f),()=>Go.nextTick(h,f),A=>Go.nextTick(h,A||f))};async function c(f){const h=f!=null,A=typeof r.throw=="function";if(h&&A){const{value:E,done:_}=await r.throw(f);if(await E,_)return}if(typeof r.return=="function"){const{value:E}=await r.return();await E}}async function b(){for(;;){try{const{value:f,done:h}=a?await r.next():r.next();if(h)s.push(null);else{const A=f&&typeof f.then=="function"?await f:f;if(A===null)throw l=!1,new Hh;if(s.push(A))continue;l=!1}}catch(f){s.destroy(f)}break}}return s}var js=Vh,Er,Ko;function Yn(){if(Ko)return Er;Ko=1;const e=ye,{ArrayPrototypeIndexOf:t,NumberIsInteger:n,NumberIsNaN:r,NumberParseInt:a,ObjectDefineProperties:s,ObjectKeys:l,ObjectSetPrototypeOf:c,Promise:b,SafeSet:f,SymbolAsyncIterator:h,Symbol:A}=ae;Er=m,m.ReadableState=Q;const{EventEmitter:E}=yt,{Stream:_,prependListener:g}=Ai,{Buffer:L}=we,{addAbortSignal:P}=zn,I=ot;let w=Ze.debuglog("stream",i=>{w=i});const O=kh,B=Dt,{getHighWaterMark:C,getDefaultHighWaterMark:H}=Ii,{aggregateTwoErrors:q,codes:{ERR_INVALID_ARG_TYPE:V,ERR_METHOD_NOT_IMPLEMENTED:U,ERR_OUT_OF_RANGE:y,ERR_STREAM_PUSH_AFTER_EOF:D,ERR_STREAM_UNSHIFT_AFTER_END_EVENT:K}}=Se,{validateObject:k}=Un,x=A("kPaused"),{StringDecoder:N}=ca,G=js;c(m.prototype,_.prototype),c(m,_);const z=()=>{},{errorOrDestroy:W}=B;function Q(i,o,S){typeof S!="boolean"&&(S=o instanceof ze()),this.objectMode=!!(i&&i.objectMode),S&&(this.objectMode=this.objectMode||!!(i&&i.readableObjectMode)),this.highWaterMark=i?C(this,i,"readableHighWaterMark",S):H(!1),this.buffer=new O,this.length=0,this.pipes=[],this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.constructed=!0,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this[x]=null,this.errorEmitted=!1,this.emitClose=!i||i.emitClose!==!1,this.autoDestroy=!i||i.autoDestroy!==!1,this.destroyed=!1,this.errored=null,this.closed=!1,this.closeEmitted=!1,this.defaultEncoding=i&&i.defaultEncoding||"utf8",this.awaitDrainWriters=null,this.multiAwaitDrain=!1,this.readingMore=!1,this.dataEmitted=!1,this.decoder=null,this.encoding=null,i&&i.encoding&&(this.decoder=new N(i.encoding),this.encoding=i.encoding)}function m(i){if(!(this instanceof m))return new m(i);const o=this instanceof ze();this._readableState=new Q(i,this,o),i&&(typeof i.read=="function"&&(this._read=i.read),typeof i.destroy=="function"&&(this._destroy=i.destroy),typeof i.construct=="function"&&(this._construct=i.construct),i.signal&&!o&&P(i.signal,this)),_.call(this,i),B.construct(this,()=>{this._readableState.needReadable&&le(this,this._readableState)})}m.prototype.destroy=B.destroy,m.prototype._undestroy=B.undestroy,m.prototype._destroy=function(i,o){o(i)},m.prototype[E.captureRejectionSymbol]=function(i){this.destroy(i)},m.prototype.push=function(i,o){return J(this,i,o,!1)},m.prototype.unshift=function(i,o){return J(this,i,o,!0)};function J(i,o,S,R){w("readableAddChunk",o);const T=i._readableState;let Y;if(T.objectMode||(typeof o=="string"?(S=S||T.defaultEncoding,T.encoding!==S&&(R&&T.encoding?o=L.from(o,S).toString(T.encoding):(o=L.from(o,S),S=""))):o instanceof L?S="":_._isUint8Array(o)?(o=_._uint8ArrayToBuffer(o),S=""):o!=null&&(Y=new V("chunk",["string","Buffer","Uint8Array"],o))),Y)W(i,Y);else if(o===null)T.reading=!1,at(i,T);else if(T.objectMode||o&&o.length>0)if(R)if(T.endEmitted)W(i,new K);else{if(T.destroyed||T.errored)return!1;ne(i,T,o,!0)}else if(T.ended)W(i,new D);else{if(T.destroyed||T.errored)return!1;T.reading=!1,T.decoder&&!S?(o=T.decoder.write(o),T.objectMode||o.length!==0?ne(i,T,o,!1):le(i,T)):ne(i,T,o,!1)}else R||(T.reading=!1,le(i,T));return!T.ended&&(T.length<T.highWaterMark||T.length===0)}function ne(i,o,S,R){o.flowing&&o.length===0&&!o.sync&&i.listenerCount("data")>0?(o.multiAwaitDrain?o.awaitDrainWriters.clear():o.awaitDrainWriters=null,o.dataEmitted=!0,i.emit("data",S)):(o.length+=o.objectMode?1:S.length,R?o.buffer.unshift(S):o.buffer.push(S),o.needReadable&&Ee(i)),le(i,o)}m.prototype.isPaused=function(){const i=this._readableState;return i[x]===!0||i.flowing===!1},m.prototype.setEncoding=function(i){const o=new N(i);this._readableState.decoder=o,this._readableState.encoding=this._readableState.decoder.encoding;const S=this._readableState.buffer;let R="";for(const T of S)R+=o.write(T);return S.clear(),R!==""&&S.push(R),this._readableState.length=R.length,this};const ve=1073741824;function Ne(i){if(i>ve)throw new y("size","<= 1GiB",i);return i--,i|=i>>>1,i|=i>>>2,i|=i>>>4,i|=i>>>8,i|=i>>>16,i++,i}function ce(i,o){return i<=0||o.length===0&&o.ended?0:o.objectMode?1:r(i)?o.flowing&&o.length?o.buffer.first().length:o.length:i<=o.length?i:o.ended?o.length:0}m.prototype.read=function(i){w("read",i),i===void 0?i=NaN:n(i)||(i=a(i,10));const o=this._readableState,S=i;if(i>o.highWaterMark&&(o.highWaterMark=Ne(i)),i!==0&&(o.emittedReadable=!1),i===0&&o.needReadable&&((o.highWaterMark!==0?o.length>=o.highWaterMark:o.length>0)||o.ended))return w("read: emitReadable",o.length,o.ended),o.length===0&&o.ended?ee(this):Ee(this),null;if(i=ce(i,o),i===0&&o.ended)return o.length===0&&ee(this),null;let R=o.needReadable;if(w("need readable",R),(o.length===0||o.length-i<o.highWaterMark)&&(R=!0,w("length less than watermark",R)),o.ended||o.reading||o.destroyed||o.errored||!o.constructed)R=!1,w("reading, ended or constructing",R);else if(R){w("do read"),o.reading=!0,o.sync=!0,o.length===0&&(o.needReadable=!0);try{this._read(o.highWaterMark)}catch(Y){W(this,Y)}o.sync=!1,o.reading||(i=ce(S,o))}let T;return i>0?T=j(i,o):T=null,T===null?(o.needReadable=o.length<=o.highWaterMark,i=0):(o.length-=i,o.multiAwaitDrain?o.awaitDrainWriters.clear():o.awaitDrainWriters=null),o.length===0&&(o.ended||(o.needReadable=!0),S!==i&&o.ended&&ee(this)),T!==null&&!o.errorEmitted&&!o.closeEmitted&&(o.dataEmitted=!0,this.emit("data",T)),T};function at(i,o){if(w("onEofChunk"),!o.ended){if(o.decoder){const S=o.decoder.end();S&&S.length&&(o.buffer.push(S),o.length+=o.objectMode?1:S.length)}o.ended=!0,o.sync?Ee(i):(o.needReadable=!1,o.emittedReadable=!0,Re(i))}}function Ee(i){const o=i._readableState;w("emitReadable",o.needReadable,o.emittedReadable),o.needReadable=!1,o.emittedReadable||(w("emitReadable",o.flowing),o.emittedReadable=!0,e.nextTick(Re,i))}function Re(i){const o=i._readableState;w("emitReadable_",o.destroyed,o.length,o.ended),!o.destroyed&&!o.errored&&(o.length||o.ended)&&(i.emit("readable"),o.emittedReadable=!1),o.needReadable=!o.flowing&&!o.ended&&o.length<=o.highWaterMark,$(i)}function le(i,o){!o.readingMore&&o.constructed&&(o.readingMore=!0,e.nextTick(st,i,o))}function st(i,o){for(;!o.reading&&!o.ended&&(o.length<o.highWaterMark||o.flowing&&o.length===0);){const S=o.length;if(w("maybeReadMore read 0"),i.read(0),S===o.length)break}o.readingMore=!1}m.prototype._read=function(i){throw new U("_read()")},m.prototype.pipe=function(i,o){const S=this,R=this._readableState;R.pipes.length===1&&(R.multiAwaitDrain||(R.multiAwaitDrain=!0,R.awaitDrainWriters=new f(R.awaitDrainWriters?[R.awaitDrainWriters]:[]))),R.pipes.push(i),w("pipe count=%d opts=%j",R.pipes.length,o);const Y=(!o||o.end!==!1)&&i!==e.stdout&&i!==e.stderr?xt:Me;R.endEmitted?e.nextTick(Y):S.once("end",Y),i.on("unpipe",Z);function Z(be,ie){w("onunpipe"),be===S&&ie&&ie.hasUnpiped===!1&&(ie.hasUnpiped=!0,Xn())}function xt(){w("onend"),i.end()}let he,Wt=!1;function Xn(){w("cleanup"),i.removeListener("close",dt),i.removeListener("finish",ut),he&&i.removeListener("drain",he),i.removeListener("error",lt),i.removeListener("unpipe",Z),S.removeListener("end",xt),S.removeListener("end",Me),S.removeListener("data",jt),Wt=!0,he&&R.awaitDrainWriters&&(!i._writableState||i._writableState.needDrain)&&he()}function Ft(){Wt||(R.pipes.length===1&&R.pipes[0]===i?(w("false write response, pause",0),R.awaitDrainWriters=i,R.multiAwaitDrain=!1):R.pipes.length>1&&R.pipes.includes(i)&&(w("false write response, pause",R.awaitDrainWriters.size),R.awaitDrainWriters.add(i)),S.pause()),he||(he=Pe(S,i),i.on("drain",he))}S.on("data",jt);function jt(be){w("ondata");const ie=i.write(be);w("dest.write",ie),ie===!1&&Ft()}function lt(be){if(w("onerror",be),Me(),i.removeListener("error",lt),i.listenerCount("error")===0){const ie=i._writableState||i._readableState;ie&&!ie.errorEmitted?W(i,be):i.emit("error",be)}}g(i,"error",lt);function dt(){i.removeListener("finish",ut),Me()}i.once("close",dt);function ut(){w("onfinish"),i.removeListener("close",dt),Me()}i.once("finish",ut);function Me(){w("unpipe"),S.unpipe(i)}return i.emit("pipe",S),i.writableNeedDrain===!0?R.flowing&&Ft():R.flowing||(w("pipe resume"),S.resume()),i};function Pe(i,o){return function(){const R=i._readableState;R.awaitDrainWriters===o?(w("pipeOnDrain",1),R.awaitDrainWriters=null):R.multiAwaitDrain&&(w("pipeOnDrain",R.awaitDrainWriters.size),R.awaitDrainWriters.delete(o)),(!R.awaitDrainWriters||R.awaitDrainWriters.size===0)&&i.listenerCount("data")&&i.resume()}}m.prototype.unpipe=function(i){const o=this._readableState,S={hasUnpiped:!1};if(o.pipes.length===0)return this;if(!i){const T=o.pipes;o.pipes=[],this.pause();for(let Y=0;Y<T.length;Y++)T[Y].emit("unpipe",this,{hasUnpiped:!1});return this}const R=t(o.pipes,i);return R===-1?this:(o.pipes.splice(R,1),o.pipes.length===0&&this.pause(),i.emit("unpipe",this,S),this)},m.prototype.on=function(i,o){const S=_.prototype.on.call(this,i,o),R=this._readableState;return i==="data"?(R.readableListening=this.listenerCount("readable")>0,R.flowing!==!1&&this.resume()):i==="readable"&&!R.endEmitted&&!R.readableListening&&(R.readableListening=R.needReadable=!0,R.flowing=!1,R.emittedReadable=!1,w("on readable",R.length,R.reading),R.length?Ee(this):R.reading||e.nextTick(d,this)),S},m.prototype.addListener=m.prototype.on,m.prototype.removeListener=function(i,o){const S=_.prototype.removeListener.call(this,i,o);return i==="readable"&&e.nextTick(Oe,this),S},m.prototype.off=m.prototype.removeListener,m.prototype.removeAllListeners=function(i){const o=_.prototype.removeAllListeners.apply(this,arguments);return(i==="readable"||i===void 0)&&e.nextTick(Oe,this),o};function Oe(i){const o=i._readableState;o.readableListening=i.listenerCount("readable")>0,o.resumeScheduled&&o[x]===!1?o.flowing=!0:i.listenerCount("data")>0?i.resume():o.readableListening||(o.flowing=null)}function d(i){w("readable nexttick read 0"),i.read(0)}m.prototype.resume=function(){const i=this._readableState;return i.flowing||(w("resume"),i.flowing=!i.readableListening,u(this,i)),i[x]=!1,this};function u(i,o){o.resumeScheduled||(o.resumeScheduled=!0,e.nextTick(p,i,o))}function p(i,o){w("resume",o.reading),o.reading||i.read(0),o.resumeScheduled=!1,i.emit("resume"),$(i),o.flowing&&!o.reading&&i.read(0)}m.prototype.pause=function(){return w("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(w("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState[x]=!0,this};function $(i){const o=i._readableState;for(w("flow",o.flowing);o.flowing&&i.read()!==null;);}m.prototype.wrap=function(i){let o=!1;i.on("data",R=>{!this.push(R)&&i.pause&&(o=!0,i.pause())}),i.on("end",()=>{this.push(null)}),i.on("error",R=>{W(this,R)}),i.on("close",()=>{this.destroy()}),i.on("destroy",()=>{this.destroy()}),this._read=()=>{o&&i.resume&&(o=!1,i.resume())};const S=l(i);for(let R=1;R<S.length;R++){const T=S[R];this[T]===void 0&&typeof i[T]=="function"&&(this[T]=i[T].bind(i))}return this},m.prototype[h]=function(){return v(this)},m.prototype.iterator=function(i){return i!==void 0&&k(i,"options"),v(this,i)};function v(i,o){typeof i.read!="function"&&(i=m.wrap(i,{objectMode:!0}));const S=F(i,o);return S.stream=i,S}async function*F(i,o){let S=z;function R(Z){this===i?(S(),S=z):S=Z}i.on("readable",R);let T;const Y=I(i,{writable:!1},Z=>{T=Z?q(T,Z):null,S(),S=z});try{for(;;){const Z=i.destroyed?null:i.read();if(Z!==null)yield Z;else{if(T)throw T;if(T===null)return;await new b(R)}}}catch(Z){throw T=q(T,Z),T}finally{(T||(o==null?void 0:o.destroyOnReturn)!==!1)&&(T===void 0||i._readableState.autoDestroy)?B.destroyer(i,null):(i.off("readable",R),Y())}}s(m.prototype,{readable:{__proto__:null,get(){const i=this._readableState;return!!i&&i.readable!==!1&&!i.destroyed&&!i.errorEmitted&&!i.endEmitted},set(i){this._readableState&&(this._readableState.readable=!!i)}},readableDidRead:{__proto__:null,enumerable:!1,get:function(){return this._readableState.dataEmitted}},readableAborted:{__proto__:null,enumerable:!1,get:function(){return!!(this._readableState.readable!==!1&&(this._readableState.destroyed||this._readableState.errored)&&!this._readableState.endEmitted)}},readableHighWaterMark:{__proto__:null,enumerable:!1,get:function(){return this._readableState.highWaterMark}},readableBuffer:{__proto__:null,enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}},readableFlowing:{__proto__:null,enumerable:!1,get:function(){return this._readableState.flowing},set:function(i){this._readableState&&(this._readableState.flowing=i)}},readableLength:{__proto__:null,enumerable:!1,get(){return this._readableState.length}},readableObjectMode:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.objectMode:!1}},readableEncoding:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.encoding:null}},errored:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.errored:null}},closed:{__proto__:null,get(){return this._readableState?this._readableState.closed:!1}},destroyed:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.destroyed:!1},set(i){this._readableState&&(this._readableState.destroyed=i)}},readableEnded:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.endEmitted:!1}}}),s(Q.prototype,{pipesCount:{__proto__:null,get(){return this.pipes.length}},paused:{__proto__:null,get(){return this[x]!==!1},set(i){this[x]=!!i}}}),m._fromList=j;function j(i,o){if(o.length===0)return null;let S;return o.objectMode?S=o.buffer.shift():!i||i>=o.length?(o.decoder?S=o.buffer.join(""):o.buffer.length===1?S=o.buffer.first():S=o.buffer.concat(o.length),o.buffer.clear()):S=o.buffer.consume(i,o.decoder),S}function ee(i){const o=i._readableState;w("endReadable",o.endEmitted),o.endEmitted||(o.ended=!0,e.nextTick(Ae,o,i))}function Ae(i,o){if(w("endReadableNT",i.endEmitted,i.length),!i.errored&&!i.closeEmitted&&!i.endEmitted&&i.length===0){if(i.endEmitted=!0,o.emit("end"),o.writable&&o.allowHalfOpen===!1)e.nextTick(Ce,o);else if(i.autoDestroy){const S=o._writableState;(!S||S.autoDestroy&&(S.finished||S.writable===!1))&&o.destroy()}}}function Ce(i){i.writable&&!i.writableEnded&&!i.destroyed&&i.end()}m.from=function(i,o){return G(m,i,o)};let re;function kt(){return re===void 0&&(re={}),re}return m.fromWeb=function(i,o){return kt().newStreamReadableFromReadableStream(i,o)},m.toWeb=function(i,o){return kt().newReadableStreamFromStreamReadable(i,o)},m.wrap=function(i,o){var S,R;return new m({objectMode:(S=(R=i.readableObjectMode)!==null&&R!==void 0?R:i.objectMode)!==null&&S!==void 0?S:!0,...o,destroy(T,Y){B.destroyer(i,T),Y(T)}}).wrap(i)},Er}var Rr,zo;function Us(){if(zo)return Rr;zo=1;const e=ye,{ArrayPrototypeSlice:t,Error:n,FunctionPrototypeSymbolHasInstance:r,ObjectDefineProperty:a,ObjectDefineProperties:s,ObjectSetPrototypeOf:l,StringPrototypeToLowerCase:c,Symbol:b,SymbolHasInstance:f}=ae;Rr=N,N.WritableState=k;const{EventEmitter:h}=yt,A=Ai.Stream,{Buffer:E}=we,_=Dt,{addAbortSignal:g}=zn,{getHighWaterMark:L,getDefaultHighWaterMark:P}=Ii,{ERR_INVALID_ARG_TYPE:I,ERR_METHOD_NOT_IMPLEMENTED:w,ERR_MULTIPLE_CALLBACK:O,ERR_STREAM_CANNOT_PIPE:B,ERR_STREAM_DESTROYED:C,ERR_STREAM_ALREADY_FINISHED:H,ERR_STREAM_NULL_VALUES:q,ERR_STREAM_WRITE_AFTER_END:V,ERR_UNKNOWN_ENCODING:U}=Se.codes,{errorOrDestroy:y}=_;l(N.prototype,A.prototype),l(N,A);function D(){}const K=b("kOnFinished");function k(d,u,p){typeof p!="boolean"&&(p=u instanceof ze()),this.objectMode=!!(d&&d.objectMode),p&&(this.objectMode=this.objectMode||!!(d&&d.writableObjectMode)),this.highWaterMark=d?L(this,d,"writableHighWaterMark",p):P(!1),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;const $=!!(d&&d.decodeStrings===!1);this.decodeStrings=!$,this.defaultEncoding=d&&d.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=m.bind(void 0,u),this.writecb=null,this.writelen=0,this.afterWriteTickInfo=null,x(this),this.pendingcb=0,this.constructed=!0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!d||d.emitClose!==!1,this.autoDestroy=!d||d.autoDestroy!==!1,this.errored=null,this.closed=!1,this.closeEmitted=!1,this[K]=[]}function x(d){d.buffered=[],d.bufferedIndex=0,d.allBuffers=!0,d.allNoop=!0}k.prototype.getBuffer=function(){return t(this.buffered,this.bufferedIndex)},a(k.prototype,"bufferedRequestCount",{__proto__:null,get(){return this.buffered.length-this.bufferedIndex}});function N(d){const u=this instanceof ze();if(!u&&!r(N,this))return new N(d);this._writableState=new k(d,this,u),d&&(typeof d.write=="function"&&(this._write=d.write),typeof d.writev=="function"&&(this._writev=d.writev),typeof d.destroy=="function"&&(this._destroy=d.destroy),typeof d.final=="function"&&(this._final=d.final),typeof d.construct=="function"&&(this._construct=d.construct),d.signal&&g(d.signal,this)),A.call(this,d),_.construct(this,()=>{const p=this._writableState;p.writing||Ne(this,p),Re(this,p)})}a(N,f,{__proto__:null,value:function(d){return r(this,d)?!0:this!==N?!1:d&&d._writableState instanceof k}}),N.prototype.pipe=function(){y(this,new B)};function G(d,u,p,$){const v=d._writableState;if(typeof p=="function")$=p,p=v.defaultEncoding;else{if(!p)p=v.defaultEncoding;else if(p!=="buffer"&&!E.isEncoding(p))throw new U(p);typeof $!="function"&&($=D)}if(u===null)throw new q;if(!v.objectMode)if(typeof u=="string")v.decodeStrings!==!1&&(u=E.from(u,p),p="buffer");else if(u instanceof E)p="buffer";else if(A._isUint8Array(u))u=A._uint8ArrayToBuffer(u),p="buffer";else throw new I("chunk",["string","Buffer","Uint8Array"],u);let F;return v.ending?F=new V:v.destroyed&&(F=new C("write")),F?(e.nextTick($,F),y(d,F,!0),F):(v.pendingcb++,z(d,v,u,p,$))}N.prototype.write=function(d,u,p){return G(this,d,u,p)===!0},N.prototype.cork=function(){this._writableState.corked++},N.prototype.uncork=function(){const d=this._writableState;d.corked&&(d.corked--,d.writing||Ne(this,d))},N.prototype.setDefaultEncoding=function(u){if(typeof u=="string"&&(u=c(u)),!E.isEncoding(u))throw new U(u);return this._writableState.defaultEncoding=u,this};function z(d,u,p,$,v){const F=u.objectMode?1:p.length;u.length+=F;const j=u.length<u.highWaterMark;return j||(u.needDrain=!0),u.writing||u.corked||u.errored||!u.constructed?(u.buffered.push({chunk:p,encoding:$,callback:v}),u.allBuffers&&$!=="buffer"&&(u.allBuffers=!1),u.allNoop&&v!==D&&(u.allNoop=!1)):(u.writelen=F,u.writecb=v,u.writing=!0,u.sync=!0,d._write(p,$,u.onwrite),u.sync=!1),j&&!u.errored&&!u.destroyed}function W(d,u,p,$,v,F,j){u.writelen=$,u.writecb=j,u.writing=!0,u.sync=!0,u.destroyed?u.onwrite(new C("write")):p?d._writev(v,u.onwrite):d._write(v,F,u.onwrite),u.sync=!1}function Q(d,u,p,$){--u.pendingcb,$(p),ve(u),y(d,p)}function m(d,u){const p=d._writableState,$=p.sync,v=p.writecb;if(typeof v!="function"){y(d,new O);return}p.writing=!1,p.writecb=null,p.length-=p.writelen,p.writelen=0,u?(u.stack,p.errored||(p.errored=u),d._readableState&&!d._readableState.errored&&(d._readableState.errored=u),$?e.nextTick(Q,d,p,u,v):Q(d,p,u,v)):(p.buffered.length>p.bufferedIndex&&Ne(d,p),$?p.afterWriteTickInfo!==null&&p.afterWriteTickInfo.cb===v?p.afterWriteTickInfo.count++:(p.afterWriteTickInfo={count:1,cb:v,stream:d,state:p},e.nextTick(J,p.afterWriteTickInfo)):ne(d,p,1,v))}function J({stream:d,state:u,count:p,cb:$}){return u.afterWriteTickInfo=null,ne(d,u,p,$)}function ne(d,u,p,$){for(!u.ending&&!d.destroyed&&u.length===0&&u.needDrain&&(u.needDrain=!1,d.emit("drain"));p-- >0;)u.pendingcb--,$();u.destroyed&&ve(u),Re(d,u)}function ve(d){if(d.writing)return;for(let v=d.bufferedIndex;v<d.buffered.length;++v){var u;const{chunk:F,callback:j}=d.buffered[v],ee=d.objectMode?1:F.length;d.length-=ee,j((u=d.errored)!==null&&u!==void 0?u:new C("write"))}const p=d[K].splice(0);for(let v=0;v<p.length;v++){var $;p[v](($=d.errored)!==null&&$!==void 0?$:new C("end"))}x(d)}function Ne(d,u){if(u.corked||u.bufferProcessing||u.destroyed||!u.constructed)return;const{buffered:p,bufferedIndex:$,objectMode:v}=u,F=p.length-$;if(!F)return;let j=$;if(u.bufferProcessing=!0,F>1&&d._writev){u.pendingcb-=F-1;const ee=u.allNoop?D:Ce=>{for(let re=j;re<p.length;++re)p[re].callback(Ce)},Ae=u.allNoop&&j===0?p:t(p,j);Ae.allBuffers=u.allBuffers,W(d,u,!0,u.length,Ae,"",ee),x(u)}else{do{const{chunk:ee,encoding:Ae,callback:Ce}=p[j];p[j++]=null;const re=v?1:ee.length;W(d,u,!1,re,ee,Ae,Ce)}while(j<p.length&&!u.writing);j===p.length?x(u):j>256?(p.splice(0,j),u.bufferedIndex=0):u.bufferedIndex=j}u.bufferProcessing=!1}N.prototype._write=function(d,u,p){if(this._writev)this._writev([{chunk:d,encoding:u}],p);else throw new w("_write()")},N.prototype._writev=null,N.prototype.end=function(d,u,p){const $=this._writableState;typeof d=="function"?(p=d,d=null,u=null):typeof u=="function"&&(p=u,u=null);let v;if(d!=null){const F=G(this,d,u);F instanceof n&&(v=F)}return $.corked&&($.corked=1,this.uncork()),v||(!$.errored&&!$.ending?($.ending=!0,Re(this,$,!0),$.ended=!0):$.finished?v=new H("end"):$.destroyed&&(v=new C("end"))),typeof p=="function"&&(v||$.finished?e.nextTick(p,v):$[K].push(p)),this};function ce(d){return d.ending&&!d.destroyed&&d.constructed&&d.length===0&&!d.errored&&d.buffered.length===0&&!d.finished&&!d.writing&&!d.errorEmitted&&!d.closeEmitted}function at(d,u){let p=!1;function $(v){if(p){y(d,v??O());return}if(p=!0,u.pendingcb--,v){const F=u[K].splice(0);for(let j=0;j<F.length;j++)F[j](v);y(d,v,u.sync)}else ce(u)&&(u.prefinished=!0,d.emit("prefinish"),u.pendingcb++,e.nextTick(le,d,u))}u.sync=!0,u.pendingcb++;try{d._final($)}catch(v){$(v)}u.sync=!1}function Ee(d,u){!u.prefinished&&!u.finalCalled&&(typeof d._final=="function"&&!u.destroyed?(u.finalCalled=!0,at(d,u)):(u.prefinished=!0,d.emit("prefinish")))}function Re(d,u,p){ce(u)&&(Ee(d,u),u.pendingcb===0&&(p?(u.pendingcb++,e.nextTick(($,v)=>{ce(v)?le($,v):v.pendingcb--},d,u)):ce(u)&&(u.pendingcb++,le(d,u))))}function le(d,u){u.pendingcb--,u.finished=!0;const p=u[K].splice(0);for(let $=0;$<p.length;$++)p[$]();if(d.emit("finish"),u.autoDestroy){const $=d._readableState;(!$||$.autoDestroy&&($.endEmitted||$.readable===!1))&&d.destroy()}}s(N.prototype,{closed:{__proto__:null,get(){return this._writableState?this._writableState.closed:!1}},destroyed:{__proto__:null,get(){return this._writableState?this._writableState.destroyed:!1},set(d){this._writableState&&(this._writableState.destroyed=d)}},writable:{__proto__:null,get(){const d=this._writableState;return!!d&&d.writable!==!1&&!d.destroyed&&!d.errored&&!d.ending&&!d.ended},set(d){this._writableState&&(this._writableState.writable=!!d)}},writableFinished:{__proto__:null,get(){return this._writableState?this._writableState.finished:!1}},writableObjectMode:{__proto__:null,get(){return this._writableState?this._writableState.objectMode:!1}},writableBuffer:{__proto__:null,get(){return this._writableState&&this._writableState.getBuffer()}},writableEnded:{__proto__:null,get(){return this._writableState?this._writableState.ending:!1}},writableNeedDrain:{__proto__:null,get(){const d=this._writableState;return d?!d.destroyed&&!d.ending&&d.needDrain:!1}},writableHighWaterMark:{__proto__:null,get(){return this._writableState&&this._writableState.highWaterMark}},writableCorked:{__proto__:null,get(){return this._writableState?this._writableState.corked:0}},writableLength:{__proto__:null,get(){return this._writableState&&this._writableState.length}},errored:{__proto__:null,enumerable:!1,get(){return this._writableState?this._writableState.errored:null}},writableAborted:{__proto__:null,enumerable:!1,get:function(){return!!(this._writableState.writable!==!1&&(this._writableState.destroyed||this._writableState.errored)&&!this._writableState.finished)}}});const st=_.destroy;N.prototype.destroy=function(d,u){const p=this._writableState;return!p.destroyed&&(p.bufferedIndex<p.buffered.length||p[K].length)&&e.nextTick(ve,p),st.call(this,d,u),this},N.prototype._undestroy=_.undestroy,N.prototype._destroy=function(d,u){u(d)},N.prototype[h.captureRejectionSymbol]=function(d){this.destroy(d)};let Pe;function Oe(){return Pe===void 0&&(Pe={}),Pe}return N.fromWeb=function(d,u){return Oe().newStreamWritableFromWritableStream(d,u)},N.toWeb=function(d){return Oe().newWritableStreamFromStreamWritable(d)},Rr}var Ar,Yo;function Kh(){if(Yo)return Ar;Yo=1;const e=ye,t=we,{isReadable:n,isWritable:r,isIterable:a,isNodeStream:s,isReadableNodeStream:l,isWritableNodeStream:c,isDuplexNodeStream:b}=Qe,f=ot,{AbortError:h,codes:{ERR_INVALID_ARG_TYPE:A,ERR_INVALID_RETURN_VALUE:E}}=Se,{destroyer:_}=Dt,g=ze(),L=Yn(),{createDeferredPromise:P}=Ze,I=js,w=globalThis.Blob||t.Blob,O=typeof w<"u"?function(y){return y instanceof w}:function(y){return!1},B=globalThis.AbortController||Ot().AbortController,{FunctionPrototypeCall:C}=ae;class H extends g{constructor(y){super(y),(y==null?void 0:y.readable)===!1&&(this._readableState.readable=!1,this._readableState.ended=!0,this._readableState.endEmitted=!0),(y==null?void 0:y.writable)===!1&&(this._writableState.writable=!1,this._writableState.ending=!0,this._writableState.ended=!0,this._writableState.finished=!0)}}Ar=function U(y,D){if(b(y))return y;if(l(y))return V({readable:y});if(c(y))return V({writable:y});if(s(y))return V({writable:!1,readable:!1});if(typeof y=="function"){const{value:k,write:x,final:N,destroy:G}=q(y);if(a(k))return I(H,k,{objectMode:!0,write:x,final:N,destroy:G});const z=k==null?void 0:k.then;if(typeof z=="function"){let W;const Q=C(z,k,m=>{if(m!=null)throw new E("nully","body",m)},m=>{_(W,m)});return W=new H({objectMode:!0,readable:!1,write:x,final(m){N(async()=>{try{await Q,e.nextTick(m,null)}catch(J){e.nextTick(m,J)}})},destroy:G})}throw new E("Iterable, AsyncIterable or AsyncFunction",D,k)}if(O(y))return U(y.arrayBuffer());if(a(y))return I(H,y,{objectMode:!0,writable:!1});if(typeof(y==null?void 0:y.writable)=="object"||typeof(y==null?void 0:y.readable)=="object"){const k=y!=null&&y.readable?l(y==null?void 0:y.readable)?y==null?void 0:y.readable:U(y.readable):void 0,x=y!=null&&y.writable?c(y==null?void 0:y.writable)?y==null?void 0:y.writable:U(y.writable):void 0;return V({readable:k,writable:x})}const K=y==null?void 0:y.then;if(typeof K=="function"){let k;return C(K,y,x=>{x!=null&&k.push(x),k.push(null)},x=>{_(k,x)}),k=new H({objectMode:!0,writable:!1,read(){}})}throw new A(D,["Blob","ReadableStream","WritableStream","Stream","Iterable","AsyncIterable","Function","{ readable, writable } pair","Promise"],y)};function q(U){let{promise:y,resolve:D}=P();const K=new B,k=K.signal;return{value:U(async function*(){for(;;){const N=y;y=null;const{chunk:G,done:z,cb:W}=await N;if(e.nextTick(W),z)return;if(k.aborted)throw new h(void 0,{cause:k.reason});({promise:y,resolve:D}=P()),yield G}}(),{signal:k}),write(N,G,z){const W=D;D=null,W({chunk:N,done:!1,cb:z})},final(N){const G=D;D=null,G({done:!0,cb:N})},destroy(N,G){K.abort(),G(N)}}}function V(U){const y=U.readable&&typeof U.readable.read!="function"?L.wrap(U.readable):U.readable,D=U.writable;let K=!!n(y),k=!!r(D),x,N,G,z,W;function Q(m){const J=z;z=null,J?J(m):m&&W.destroy(m)}return W=new H({readableObjectMode:!!(y!=null&&y.readableObjectMode),writableObjectMode:!!(D!=null&&D.writableObjectMode),readable:K,writable:k}),k&&(f(D,m=>{k=!1,m&&_(y,m),Q(m)}),W._write=function(m,J,ne){D.write(m,J)?ne():x=ne},W._final=function(m){D.end(),N=m},D.on("drain",function(){if(x){const m=x;x=null,m()}}),D.on("finish",function(){if(N){const m=N;N=null,m()}})),K&&(f(y,m=>{K=!1,m&&_(y,m),Q(m)}),y.on("readable",function(){if(G){const m=G;G=null,m()}}),y.on("end",function(){W.push(null)}),W._read=function(){for(;;){const m=y.read();if(m===null){G=W._read;return}if(!W.push(m))return}}),W._destroy=function(m,J){!m&&z!==null&&(m=new h),G=null,x=null,N=null,z===null?J(m):(z=J,_(D,m),_(y,m))},W}return Ar}var Ir,Jo;function ze(){if(Jo)return Ir;Jo=1;const{ObjectDefineProperties:e,ObjectGetOwnPropertyDescriptor:t,ObjectKeys:n,ObjectSetPrototypeOf:r}=ae;Ir=l;const a=Yn(),s=Us();r(l.prototype,a.prototype),r(l,a);{const h=n(s.prototype);for(let A=0;A<h.length;A++){const E=h[A];l.prototype[E]||(l.prototype[E]=s.prototype[E])}}function l(h){if(!(this instanceof l))return new l(h);a.call(this,h),s.call(this,h),h?(this.allowHalfOpen=h.allowHalfOpen!==!1,h.readable===!1&&(this._readableState.readable=!1,this._readableState.ended=!0,this._readableState.endEmitted=!0),h.writable===!1&&(this._writableState.writable=!1,this._writableState.ending=!0,this._writableState.ended=!0,this._writableState.finished=!0)):this.allowHalfOpen=!0}e(l.prototype,{writable:{__proto__:null,...t(s.prototype,"writable")},writableHighWaterMark:{__proto__:null,...t(s.prototype,"writableHighWaterMark")},writableObjectMode:{__proto__:null,...t(s.prototype,"writableObjectMode")},writableBuffer:{__proto__:null,...t(s.prototype,"writableBuffer")},writableLength:{__proto__:null,...t(s.prototype,"writableLength")},writableFinished:{__proto__:null,...t(s.prototype,"writableFinished")},writableCorked:{__proto__:null,...t(s.prototype,"writableCorked")},writableEnded:{__proto__:null,...t(s.prototype,"writableEnded")},writableNeedDrain:{__proto__:null,...t(s.prototype,"writableNeedDrain")},destroyed:{__proto__:null,get(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set(h){this._readableState&&this._writableState&&(this._readableState.destroyed=h,this._writableState.destroyed=h)}}});let c;function b(){return c===void 0&&(c={}),c}l.fromWeb=function(h,A){return b().newStreamDuplexFromReadableWritablePair(h,A)},l.toWeb=function(h){return b().newReadableWritablePairFromDuplex(h)};let f;return l.from=function(h){return f||(f=Kh()),f(h,"body")},Ir}const{ObjectSetPrototypeOf:Bs,Symbol:zh}=ae;var qs=Ye;const{ERR_METHOD_NOT_IMPLEMENTED:Yh}=Se.codes,Ti=ze(),{getHighWaterMark:Jh}=Ii;Bs(Ye.prototype,Ti.prototype);Bs(Ye,Ti);const Jt=zh("kCallback");function Ye(e){if(!(this instanceof Ye))return new Ye(e);const t=e?Jh(this,e,"readableHighWaterMark",!0):null;t===0&&(e={...e,highWaterMark:null,readableHighWaterMark:t,writableHighWaterMark:e.writableHighWaterMark||0}),Ti.call(this,e),this._readableState.sync=!1,this[Jt]=null,e&&(typeof e.transform=="function"&&(this._transform=e.transform),typeof e.flush=="function"&&(this._flush=e.flush)),this.on("prefinish",Xh)}function ti(e){typeof this._flush=="function"&&!this.destroyed?this._flush((t,n)=>{if(t){e?e(t):this.destroy(t);return}n!=null&&this.push(n),this.push(null),e&&e()}):(this.push(null),e&&e())}function Xh(){this._final!==ti&&ti.call(this)}Ye.prototype._final=ti;Ye.prototype._transform=function(e,t,n){throw new Yh("_transform()")};Ye.prototype._write=function(e,t,n){const r=this._readableState,a=this._writableState,s=r.length;this._transform(e,t,(l,c)=>{if(l){n(l);return}c!=null&&this.push(c),a.ended||s===r.length||r.length<r.highWaterMark?n():this[Jt]=n})};Ye.prototype._read=function(){if(this[Jt]){const e=this[Jt];this[Jt]=null,e()}};const{ObjectSetPrototypeOf:Gs}=ae;var Hs=Nt;const $i=qs;Gs(Nt.prototype,$i.prototype);Gs(Nt,$i);function Nt(e){if(!(this instanceof Nt))return new Nt(e);$i.call(this,e)}Nt.prototype._transform=function(e,t,n){n(null,e)};const Vt=ye,{ArrayIsArray:Zh,Promise:Qh,SymbolAsyncIterator:eb}=ae,mn=ot,{once:tb}=Ze,nb=Dt,Xo=ze(),{aggregateTwoErrors:rb,codes:{ERR_INVALID_ARG_TYPE:ni,ERR_INVALID_RETURN_VALUE:Tr,ERR_MISSING_ARGS:ib,ERR_STREAM_DESTROYED:ob,ERR_STREAM_PREMATURE_CLOSE:ab},AbortError:sb}=Se,{validateFunction:lb,validateAbortSignal:db}=Un,{isIterable:bt,isReadable:$r,isReadableNodeStream:bn,isNodeStream:Zo,isTransformStream:Tt,isWebStream:ub,isReadableStream:vr,isReadableEnded:fb}=Qe,cb=globalThis.AbortController||Ot().AbortController;let Nr,Pr;function Qo(e,t,n){let r=!1;e.on("close",()=>{r=!0});const a=mn(e,{readable:t,writable:n},s=>{r=!s});return{destroy:s=>{r||(r=!0,nb.destroyer(e,s||new ob("pipe")))},cleanup:a}}function hb(e){return lb(e[e.length-1],"streams[stream.length - 1]"),e.pop()}function Or(e){if(bt(e))return e;if(bn(e))return bb(e);throw new ni("val",["Readable","Iterable","AsyncIterable"],e)}async function*bb(e){Pr||(Pr=Yn()),yield*Pr.prototype[eb].call(e)}async function ln(e,t,n,{end:r}){let a,s=null;const l=f=>{if(f&&(a=f),s){const h=s;s=null,h()}},c=()=>new Qh((f,h)=>{a?h(a):s=()=>{a?h(a):f()}});t.on("drain",l);const b=mn(t,{readable:!1},l);try{t.writableNeedDrain&&await c();for await(const f of e)t.write(f)||await c();r&&t.end(),await c(),n()}catch(f){n(a!==f?rb(a,f):f)}finally{b(),t.off("drain",l)}}async function Cr(e,t,n,{end:r}){Tt(t)&&(t=t.writable);const a=t.getWriter();try{for await(const s of e)await a.ready,a.write(s).catch(()=>{});await a.ready,r&&await a.close(),n()}catch(s){try{await a.abort(s),n(s)}catch(l){n(l)}}}function gb(...e){return Vs(e,tb(hb(e)))}function Vs(e,t,n){if(e.length===1&&Zh(e[0])&&(e=e[0]),e.length<2)throw new ib("streams");const r=new cb,a=r.signal,s=n==null?void 0:n.signal,l=[];db(s,"options.signal");function c(){_(new sb)}s==null||s.addEventListener("abort",c);let b,f;const h=[];let A=0;function E(I){_(I,--A===0)}function _(I,w){if(I&&(!b||b.code==="ERR_STREAM_PREMATURE_CLOSE")&&(b=I),!(!b&&!w)){for(;h.length;)h.shift()(b);s==null||s.removeEventListener("abort",c),r.abort(),w&&(b||l.forEach(O=>O()),Vt.nextTick(t,b,f))}}let g;for(let I=0;I<e.length;I++){const w=e[I],O=I<e.length-1,B=I>0,C=O||(n==null?void 0:n.end)!==!1,H=I===e.length-1;if(Zo(w)){let q=function(V){V&&V.name!=="AbortError"&&V.code!=="ERR_STREAM_PREMATURE_CLOSE"&&E(V)};if(C){const{destroy:V,cleanup:U}=Qo(w,O,B);h.push(V),$r(w)&&H&&l.push(U)}w.on("error",q),$r(w)&&H&&l.push(()=>{w.removeListener("error",q)})}if(I===0)if(typeof w=="function"){if(g=w({signal:a}),!bt(g))throw new Tr("Iterable, AsyncIterable or Stream","source",g)}else bt(w)||bn(w)||Tt(w)?g=w:g=Xo.from(w);else if(typeof w=="function"){if(Tt(g)){var L;g=Or((L=g)===null||L===void 0?void 0:L.readable)}else g=Or(g);if(g=w(g,{signal:a}),O){if(!bt(g,!0))throw new Tr("AsyncIterable",`transform[${I-1}]`,g)}else{var P;Nr||(Nr=Hs);const q=new Nr({objectMode:!0}),V=(P=g)===null||P===void 0?void 0:P.then;if(typeof V=="function")A++,V.call(g,D=>{f=D,D!=null&&q.write(D),C&&q.end(),Vt.nextTick(E)},D=>{q.destroy(D),Vt.nextTick(E,D)});else if(bt(g,!0))A++,ln(g,q,E,{end:C});else if(vr(g)||Tt(g)){const D=g.readable||g;A++,ln(D,q,E,{end:C})}else throw new Tr("AsyncIterable or Promise","destination",g);g=q;const{destroy:U,cleanup:y}=Qo(g,!1,!0);h.push(U),H&&l.push(y)}}else if(Zo(w)){if(bn(g)){A+=2;const q=pb(g,w,E,{end:C});$r(w)&&H&&l.push(q)}else if(Tt(g)||vr(g)){const q=g.readable||g;A++,ln(q,w,E,{end:C})}else if(bt(g))A++,ln(g,w,E,{end:C});else throw new ni("val",["Readable","Iterable","AsyncIterable","ReadableStream","TransformStream"],g);g=w}else if(ub(w)){if(bn(g))A++,Cr(Or(g),w,E,{end:C});else if(vr(g)||bt(g))A++,Cr(g,w,E,{end:C});else if(Tt(g))A++,Cr(g.readable,w,E,{end:C});else throw new ni("val",["Readable","Iterable","AsyncIterable","ReadableStream","TransformStream"],g);g=w}else g=Xo.from(w)}return(a!=null&&a.aborted||s!=null&&s.aborted)&&Vt.nextTick(c),g}function pb(e,t,n,{end:r}){let a=!1;if(t.on("close",()=>{a||n(new ab)}),e.pipe(t,{end:!1}),r){let s=function(){a=!0,t.end()};fb(e)?Vt.nextTick(s):e.once("end",s)}else n();return mn(e,{readable:!0,writable:!1},s=>{const l=e._readableState;s&&s.code==="ERR_STREAM_PREMATURE_CLOSE"&&l&&l.ended&&!l.errored&&!l.errorEmitted?e.once("end",n).once("error",n):n(s)}),mn(t,{readable:!1,writable:!0},n)}var vi={pipelineImpl:Vs,pipeline:gb};const{pipeline:_b}=vi,dn=ze(),{destroyer:wb}=Dt,{isNodeStream:un,isReadable:ea,isWritable:ta,isWebStream:Mr,isTransformStream:ct,isWritableStream:na,isReadableStream:ra}=Qe,{AbortError:yb,codes:{ERR_INVALID_ARG_VALUE:ia,ERR_MISSING_ARGS:mb}}=Se,Sb=ot;var Ks=function(...t){if(t.length===0)throw new mb("streams");if(t.length===1)return dn.from(t[0]);const n=[...t];if(typeof t[0]=="function"&&(t[0]=dn.from(t[0])),typeof t[t.length-1]=="function"){const _=t.length-1;t[_]=dn.from(t[_])}for(let _=0;_<t.length;++_)if(!(!un(t[_])&&!Mr(t[_]))){if(_<t.length-1&&!(ea(t[_])||ra(t[_])||ct(t[_])))throw new ia(`streams[${_}]`,n[_],"must be readable");if(_>0&&!(ta(t[_])||na(t[_])||ct(t[_])))throw new ia(`streams[${_}]`,n[_],"must be writable")}let r,a,s,l,c;function b(_){const g=l;l=null,g?g(_):_?c.destroy(_):!E&&!A&&c.destroy()}const f=t[0],h=_b(t,b),A=!!(ta(f)||na(f)||ct(f)),E=!!(ea(h)||ra(h)||ct(h));if(c=new dn({writableObjectMode:!!(f!=null&&f.writableObjectMode),readableObjectMode:!!(h!=null&&h.writableObjectMode),writable:A,readable:E}),A){if(un(f))c._write=function(g,L,P){f.write(g,L)?P():r=P},c._final=function(g){f.end(),a=g},f.on("drain",function(){if(r){const g=r;r=null,g()}});else if(Mr(f)){const L=(ct(f)?f.writable:f).getWriter();c._write=async function(P,I,w){try{await L.ready,L.write(P).catch(()=>{}),w()}catch(O){w(O)}},c._final=async function(P){try{await L.ready,L.close().catch(()=>{}),a=P}catch(I){P(I)}}}const _=ct(h)?h.readable:h;Sb(_,()=>{if(a){const g=a;a=null,g()}})}if(E){if(un(h))h.on("readable",function(){if(s){const _=s;s=null,_()}}),h.on("end",function(){c.push(null)}),c._read=function(){for(;;){const _=h.read();if(_===null){s=c._read;return}if(!c.push(_))return}};else if(Mr(h)){const g=(ct(h)?h.readable:h).getReader();c._read=async function(){for(;;)try{const{value:L,done:P}=await g.read();if(!c.push(L))return;if(P){c.push(null);return}}catch{return}}}}return c._destroy=function(_,g){!_&&l!==null&&(_=new yb),s=null,r=null,a=null,l===null?g(_):(l=g,un(h)&&wb(h,_))},c};const zs=globalThis.AbortController||Ot().AbortController,{codes:{ERR_INVALID_ARG_VALUE:Eb,ERR_INVALID_ARG_TYPE:Zt,ERR_MISSING_ARGS:Rb,ERR_OUT_OF_RANGE:Ab},AbortError:Ue}=Se,{validateAbortSignal:Et,validateInteger:Ib,validateObject:Rt}=Un,Tb=ae.Symbol("kWeak"),{finished:$b}=ot,vb=Ks,{addAbortSignalNoValidate:Nb}=zn,{isWritable:Pb,isNodeStream:Ob}=Qe,{ArrayPrototypePush:Cb,MathFloor:Mb,Number:Lb,NumberIsNaN:Db,Promise:oa,PromiseReject:aa,PromisePrototypeThen:kb,Symbol:Ys}=ae,Sn=Ys("kEmpty"),sa=Ys("kEof");function xb(e,t){if(t!=null&&Rt(t,"options"),(t==null?void 0:t.signal)!=null&&Et(t.signal,"options.signal"),Ob(e)&&!Pb(e))throw new Eb("stream",e,"must be writable");const n=vb(this,e);return t!=null&&t.signal&&Nb(t.signal,n),n}function Jn(e,t){if(typeof e!="function")throw new Zt("fn",["Function","AsyncFunction"],e);t!=null&&Rt(t,"options"),(t==null?void 0:t.signal)!=null&&Et(t.signal,"options.signal");let n=1;return(t==null?void 0:t.concurrency)!=null&&(n=Mb(t.concurrency)),Ib(n,"concurrency",1),(async function*(){var a,s;const l=new zs,c=this,b=[],f=l.signal,h={signal:f},A=()=>l.abort();t!=null&&(a=t.signal)!==null&&a!==void 0&&a.aborted&&A(),t==null||(s=t.signal)===null||s===void 0||s.addEventListener("abort",A);let E,_,g=!1;function L(){g=!0}async function P(){try{for await(let O of c){var I;if(g)return;if(f.aborted)throw new Ue;try{O=e(O,h)}catch(B){O=aa(B)}O!==Sn&&(typeof((I=O)===null||I===void 0?void 0:I.catch)=="function"&&O.catch(L),b.push(O),E&&(E(),E=null),!g&&b.length&&b.length>=n&&await new oa(B=>{_=B}))}b.push(sa)}catch(O){const B=aa(O);kb(B,void 0,L),b.push(B)}finally{var w;g=!0,E&&(E(),E=null),t==null||(w=t.signal)===null||w===void 0||w.removeEventListener("abort",A)}}P();try{for(;;){for(;b.length>0;){const I=await b[0];if(I===sa)return;if(f.aborted)throw new Ue;I!==Sn&&(yield I),b.shift(),_&&(_(),_=null)}await new oa(I=>{E=I})}}finally{l.abort(),g=!0,_&&(_(),_=null)}}).call(this)}function Wb(e=void 0){return e!=null&&Rt(e,"options"),(e==null?void 0:e.signal)!=null&&Et(e.signal,"options.signal"),(async function*(){let n=0;for await(const a of this){var r;if(e!=null&&(r=e.signal)!==null&&r!==void 0&&r.aborted)throw new Ue({cause:e.signal.reason});yield[n++,a]}}).call(this)}async function Js(e,t=void 0){for await(const n of Ni.call(this,e,t))return!0;return!1}async function Fb(e,t=void 0){if(typeof e!="function")throw new Zt("fn",["Function","AsyncFunction"],e);return!await Js.call(this,async(...n)=>!await e(...n),t)}async function jb(e,t){for await(const n of Ni.call(this,e,t))return n}async function Ub(e,t){if(typeof e!="function")throw new Zt("fn",["Function","AsyncFunction"],e);async function n(r,a){return await e(r,a),Sn}for await(const r of Jn.call(this,n,t));}function Ni(e,t){if(typeof e!="function")throw new Zt("fn",["Function","AsyncFunction"],e);async function n(r,a){return await e(r,a)?r:Sn}return Jn.call(this,n,t)}class Bb extends Rb{constructor(){super("reduce"),this.message="Reduce of an empty stream requires an initial value"}}async function qb(e,t,n){var r;if(typeof e!="function")throw new Zt("reducer",["Function","AsyncFunction"],e);n!=null&&Rt(n,"options"),(n==null?void 0:n.signal)!=null&&Et(n.signal,"options.signal");let a=arguments.length>1;if(n!=null&&(r=n.signal)!==null&&r!==void 0&&r.aborted){const f=new Ue(void 0,{cause:n.signal.reason});throw this.once("error",()=>{}),await $b(this.destroy(f)),f}const s=new zs,l=s.signal;if(n!=null&&n.signal){const f={once:!0,[Tb]:this};n.signal.addEventListener("abort",()=>s.abort(),f)}let c=!1;try{for await(const f of this){var b;if(c=!0,n!=null&&(b=n.signal)!==null&&b!==void 0&&b.aborted)throw new Ue;a?t=await e(t,f,{signal:l}):(t=f,a=!0)}if(!c&&!a)throw new Bb}finally{s.abort()}return t}async function Gb(e){e!=null&&Rt(e,"options"),(e==null?void 0:e.signal)!=null&&Et(e.signal,"options.signal");const t=[];for await(const r of this){var n;if(e!=null&&(n=e.signal)!==null&&n!==void 0&&n.aborted)throw new Ue(void 0,{cause:e.signal.reason});Cb(t,r)}return t}function Hb(e,t){const n=Jn.call(this,e,t);return(async function*(){for await(const a of n)yield*a}).call(this)}function Xs(e){if(e=Lb(e),Db(e))return 0;if(e<0)throw new Ab("number",">= 0",e);return e}function Vb(e,t=void 0){return t!=null&&Rt(t,"options"),(t==null?void 0:t.signal)!=null&&Et(t.signal,"options.signal"),e=Xs(e),(async function*(){var r;if(t!=null&&(r=t.signal)!==null&&r!==void 0&&r.aborted)throw new Ue;for await(const s of this){var a;if(t!=null&&(a=t.signal)!==null&&a!==void 0&&a.aborted)throw new Ue;e--<=0&&(yield s)}}).call(this)}function Kb(e,t=void 0){return t!=null&&Rt(t,"options"),(t==null?void 0:t.signal)!=null&&Et(t.signal,"options.signal"),e=Xs(e),(async function*(){var r;if(t!=null&&(r=t.signal)!==null&&r!==void 0&&r.aborted)throw new Ue;for await(const s of this){var a;if(t!=null&&(a=t.signal)!==null&&a!==void 0&&a.aborted)throw new Ue;if(e-- >0)yield s;else return}}).call(this)}wi.streamReturningOperators={asIndexedPairs:Wb,drop:Vb,filter:Ni,flatMap:Hb,map:Jn,take:Kb,compose:xb};wi.promiseReturningOperators={every:Fb,forEach:Ub,reduce:qb,toArray:Gb,some:Js,find:jb};var Lr,la;function Zs(){if(la)return Lr;la=1;const{ArrayPrototypePop:e,Promise:t}=ae,{isIterable:n,isNodeStream:r,isWebStream:a}=Qe,{pipelineImpl:s}=vi,{finished:l}=ot;Qs();function c(...b){return new t((f,h)=>{let A,E;const _=b[b.length-1];if(_&&typeof _=="object"&&!r(_)&&!n(_)&&!a(_)){const g=e(b);A=g.signal,E=g.end}s(b,(g,L)=>{g?h(g):f(L)},{signal:A,end:E})})}return Lr={finished:l,pipeline:c},Lr}var da;function Qs(){if(da)return wr.exports;da=1;const{Buffer:e}=we,{ObjectDefineProperty:t,ObjectKeys:n,ReflectApply:r}=ae,{promisify:{custom:a}}=Ze,{streamReturningOperators:s,promiseReturningOperators:l}=wi,{codes:{ERR_ILLEGAL_CONSTRUCTOR:c}}=Se,b=Ks,{pipeline:f}=vi,{destroyer:h}=Dt,A=ot,E=Zs(),_=Qe,g=wr.exports=Ai.Stream;g.isDisturbed=_.isDisturbed,g.isErrored=_.isErrored,g.isReadable=_.isReadable,g.Readable=Yn();for(const P of n(s)){let w=function(...O){if(new.target)throw c();return g.Readable.from(r(I,this,O))};const I=s[P];t(w,"name",{__proto__:null,value:I.name}),t(w,"length",{__proto__:null,value:I.length}),t(g.Readable.prototype,P,{__proto__:null,value:w,enumerable:!1,configurable:!0,writable:!0})}for(const P of n(l)){let w=function(...O){if(new.target)throw c();return r(I,this,O)};const I=l[P];t(w,"name",{__proto__:null,value:I.name}),t(w,"length",{__proto__:null,value:I.length}),t(g.Readable.prototype,P,{__proto__:null,value:w,enumerable:!1,configurable:!0,writable:!0})}g.Writable=Us(),g.Duplex=ze(),g.Transform=qs,g.PassThrough=Hs,g.pipeline=f;const{addAbortSignal:L}=zn;return g.addAbortSignal=L,g.finished=A,g.destroy=h,g.compose=b,t(g,"promises",{__proto__:null,configurable:!0,enumerable:!0,get(){return E}}),t(f,a,{__proto__:null,enumerable:!0,get(){return E.pipeline}}),t(A,a,{__proto__:null,enumerable:!0,get(){return E.finished}}),g.Stream=g,g._isUint8Array=function(I){return I instanceof Uint8Array},g._uint8ArrayToBuffer=function(I){return e.from(I.buffer,I.byteOffset,I.byteLength)},wr.exports}(function(e){const t=Qs(),n=Zs(),r=t.Readable.destroy;e.exports=t.Readable,e.exports._uint8ArrayToBuffer=t._uint8ArrayToBuffer,e.exports._isUint8Array=t._isUint8Array,e.exports.isDisturbed=t.isDisturbed,e.exports.isErrored=t.isErrored,e.exports.isReadable=t.isReadable,e.exports.Readable=t.Readable,e.exports.Writable=t.Writable,e.exports.Duplex=t.Duplex,e.exports.Transform=t.Transform,e.exports.PassThrough=t.PassThrough,e.exports.addAbortSignal=t.addAbortSignal,e.exports.finished=t.finished,e.exports.destroy=t.destroy,e.exports.destroy=r,e.exports.pipeline=t.pipeline,e.exports.compose=t.compose,Object.defineProperty(t,"promises",{configurable:!0,enumerable:!0,get(){return n}}),e.exports.Stream=t.Stream,e.exports.default=e.exports})(Hf);function ua(e){let t=!1,n=0,r;try{r=window[e],t=!0,n=r.length;const a="__storage_test__";return r.setItem(a,a),r.removeItem(a),!0}catch(a){const s=a;return s&&(s.code===22||s.code===1014||s.name==="QuotaExceededError"||s.name==="NS_ERROR_DOM_QUOTA_REACHED")&&t&&n!==0}}class zb{constructor(){M(this,"store",{})}getItem(t){return this.store[t]||null}setItem(t,n){this.store[t]=n}}class Yb{constructor(t,n){M(this,"storage",void 0),M(this,"_storeKey",void 0),this.storage=n,this._storeKey=t;try{n.getItem(t)||this.resetStore()}catch{}}static getInstance(t){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"local";if(!this.instance){let r;n==="local"&&ua("localStorage")?r=window.localStorage:n==="session"&&ua("sessionStorage")?r=window.sessionStorage:r=new zb,this.instance=new this(t,r)}return this.instance}toJSON(){return this.storage.getItem(this._storeKey)}resetStore(){const t=this.getStore();return this.storage.setItem(this._storeKey,JSON.stringify({})),t}getStore(){return JSON.parse(this.storage.getItem(this._storeKey)||"{}")}get(t){return JSON.parse(this.storage.getItem(this._storeKey)||"{}")[t]}set(t,n){const r=JSON.parse(this.storage.getItem(this._storeKey)||"{}");r[t]=n,this.storage.setItem(this._storeKey,JSON.stringify(r))}}M(Yb,"instance",void 0);se(se({},ol),al);const Jb=Rn.getLogger("http-helpers");Jb.setLevel(fa.levels.INFO);class Xb extends Error{}Xb.prototype.name="InvalidTokenError";const Zb={EIP155:"eip155",SOLANA:"solana",OTHER:"other"},Qb={EIP155:"eip155",SOLANA:"solana",XRPL:"xrpl",MULTICHAIN:"multichain"};class Pt extends sl{constructor(t,n){super(n),M(this,"code",void 0),M(this,"message",void 0),this.code=t,this.message=n||"",Object.defineProperty(this,"name",{value:"Web3AuthError"})}toJSON(){return{name:this.name,code:this.code,message:this.message}}toString(){return JSON.stringify(this.toJSON())}}class te extends Pt{constructor(t,n){super(t,n),Object.defineProperty(this,"name",{value:"WalletInitializationError"})}static fromCode(t){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";return new te(t,`${te.messages[t]}, ${n}`)}static notFound(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return te.fromCode(5001,t)}static notInstalled(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return te.fromCode(5002,t)}static notReady(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return te.fromCode(5003,t)}static windowBlocked(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return te.fromCode(5004,t)}static windowClosed(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return te.fromCode(5005,t)}static incompatibleChainNameSpace(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return te.fromCode(5006,t)}static duplicateAdapterError(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return te.fromCode(5007,t)}static invalidProviderConfigError(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return te.fromCode(5008,t)}static providerNotReadyError(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return te.fromCode(5009,t)}static rpcConnectionError(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return te.fromCode(5010,t)}static invalidParams(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return te.fromCode(5011,t)}static invalidNetwork(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return te.fromCode(5013,t)}}M(te,"messages",{5e3:"Custom",5001:"Wallet is not found",5002:"Wallet is not installed",5003:"Wallet is not ready yet",5004:"Wallet window is blocked",5005:"Wallet window has been closed by the user",5006:"Incompatible chain namespace provided",5007:"Adapter has already been included",5008:"Invalid provider Config",5009:"Provider is not ready yet",5010:"Failed to connect with rpc url",5011:"Invalid params passed in",5013:"Invalid network provided"});class ge extends Pt{constructor(t,n){super(t,n),Object.defineProperty(this,"name",{value:"WalletLoginError"})}static fromCode(t){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";return new ge(t,`${ge.messages[t]}. ${n}`)}static connectionError(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return ge.fromCode(5111,t)}static disconnectionError(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return ge.fromCode(5112,t)}static notConnectedError(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return ge.fromCode(5113,t)}static popupClosed(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return ge.fromCode(5114,t)}static mfaEnabled(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return ge.fromCode(5115,t)}static chainConfigNotAdded(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return ge.fromCode(5116,t)}static unsupportedOperation(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return ge.fromCode(5117,t)}static coreKitKeyNotFound(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return ge.fromCode(5118,t)}static userNotLoggedIn(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return ge.fromCode(5119,t)}}M(ge,"messages",{5e3:"Custom",5111:"Failed to connect with wallet",5112:"Failed to disconnect from wallet",5113:"Wallet is not connected",5114:"Wallet popup has been closed by the user",5115:"User has already enabled mfa, please use the @web3auth/web3auth-web sdk for login with mfa",5116:"Chain config has not been added. Please add the chain config before calling switchChain",5117:"Unsupported operation",5118:"useCoreKitKey flag is enabled but coreKitKey is not available",5119:"User not logged in."});class De extends Pt{constructor(t,n){super(t,n),Object.defineProperty(this,"name",{value:"WalletOperationsError"})}static fromCode(t){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";return new De(t,`${De.messages[t]}, ${n}`)}static chainIDNotAllowed(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return De.fromCode(5201,t)}static operationNotAllowed(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return De.fromCode(5202,t)}static chainNamespaceNotAllowed(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return De.fromCode(5203,t)}}M(De,"messages",{5e3:"Custom",5201:"Provided chainId is not allowed",5202:"This operation is not allowed"});class Pi extends Pt{constructor(t,n){super(t,n),Object.defineProperty(this,"name",{value:"WalletProviderError"})}static fromCode(t){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";return new De(t,`${Pi.messages[t]}, ${n}`)}static invalidRequestArgs(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return De.fromCode(5301,t)}static invalidRequestMethod(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return De.fromCode(5302,t)}static invalidRequestParams(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return De.fromCode(5303,t)}}M(Pi,"messages",{5e3:"Custom",5301:"Expected a single, non-array, object argument.",5302:"'args.method' must be a non-empty string.",5303:"'args.params' must be an object or array if provided."});const En={OPENLOGIN:"openlogin",WALLET_CONNECT_V2:"wallet-connect-v2"},Kt=se({TORUS_SOLANA:"torus-solana",PHANTOM:"phantom",SOLFLARE:"solflare",SLOPE:"slope"},En),gn=se({TORUS_EVM:"torus-evm",METAMASK:"metamask",COINBASE:"coinbase"},En),fn=se(se({},gn),Kt);En.OPENLOGIN+"",En.WALLET_CONNECT_V2+"",Kt.TORUS_SOLANA+"",Kt.PHANTOM+"",Kt.SOLFLARE+"",Kt.SLOPE+"",gn.TORUS_EVM+"",gn.METAMASK+"",gn.COINBASE+"";const eg={EXTERNAL:"external",IN_APP:"in_app"},Le={NOT_READY:"not_ready",READY:"ready",CONNECTING:"connecting",CONNECTED:"connected",DISCONNECTED:"disconnected",ERRORED:"errored"},cn=se(se({},Le),{},{ADAPTER_DATA_UPDATED:"adapter_data_updated",CACHE_CLEAR:"cache_clear"});var Dr=Rn.getLogger("web3auth-logger");class ug extends ul{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};super(t),M(this,"name",fn.TORUS_SOLANA),M(this,"adapterNamespace",Qb.SOLANA),M(this,"currentChainNamespace",Zb.SOLANA),M(this,"type",eg.EXTERNAL),M(this,"status",Le.NOT_READY),M(this,"torusInstance",null),M(this,"torusWalletOptions",void 0),M(this,"initParams",void 0),M(this,"loginSettings",{}),M(this,"solanaProvider",null),this.torusWalletOptions=t.adapterSettings||{},this.initParams=t.initParams||{},this.loginSettings=t.loginSettings||{}}get provider(){return this.status!==Le.NOT_READY&&this.solanaProvider?this.solanaProvider:null}set provider(t){throw new Error("Not implemented")}async init(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};await super.init(t),super.checkInitializationRequirements();const{chainId:n,blockExplorer:r,displayName:a,rpcTarget:s,ticker:l,tickerName:c}=this.chainConfig,b={chainId:n,rpcTarget:s,blockExplorerUrl:r,displayName:a,tickerName:c,ticker:l,logo:""};this.torusInstance=new Gf(this.torusWalletOptions),Dr.debug("initializing torus solana adapter init"),await this.torusInstance.init(se(se({showTorusButton:!1},this.initParams),{},{network:b})),this.solanaProvider=new ll({config:{chainConfig:this.chainConfig}}),this.status=Le.READY,this.emit(cn.READY,fn.TORUS_SOLANA);try{Dr.debug("initializing torus solana adapter"),t.autoConnect&&(this.rehydrated=!0,await this.connect())}catch(f){Dr.error("Failed to connect with cached torus solana provider",f),this.emit(cn.ERRORED,f)}}async connect(){if(super.checkConnectionRequirements(),!this.torusInstance||!this.solanaProvider)throw te.notReady("Torus wallet is not initialized");this.status=Le.CONNECTING,this.emit(cn.CONNECTING,{adapter:fn.TORUS_SOLANA});try{await this.torusInstance.login(this.loginSettings);try{const t=this.torusInstance.provider;t.sendTransaction=this.torusInstance.sendTransaction.bind(this.torusInstance),t.signAllTransactions=this.torusInstance.signAllTransactions.bind(this.torusInstance),t.signMessage=this.torusInstance.signMessage.bind(this.torusInstance),t.signTransaction=this.torusInstance.signTransaction.bind(this.torusInstance),await this.solanaProvider.setupProvider(t)}catch(t){if(t instanceof Pt&&t.code===5010){const{chainId:n,blockExplorer:r,displayName:a,rpcTarget:s,ticker:l,tickerName:c}=this.chainConfig,b={chainId:n,rpcTarget:s,blockExplorerUrl:r,displayName:a,tickerName:c,ticker:l,logo:""};await this.torusInstance.setProvider(b)}else throw t}return this.status=Le.CONNECTED,this.torusInstance.showTorusButton(),this.emit(Le.CONNECTED,{adapter:fn.TORUS_SOLANA,reconnected:this.rehydrated}),this.provider}catch(t){throw this.status=Le.READY,this.rehydrated=!1,this.emit(cn.ERRORED,t),t instanceof Pt?t:ge.connectionError("Failed to login with torus solana wallet")}}async disconnect(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{cleanup:!1};if(await super.disconnectSession(),!this.torusInstance)throw te.notReady("Torus wallet is not initialized");await this.torusInstance.logout(),t.cleanup?(this.status=Le.NOT_READY,this.torusInstance=null,this.solanaProvider=null):this.status=Le.READY,await super.disconnect()}async getUserInfo(){if(this.status!==Le.CONNECTED)throw ge.notConnectedError("Not connected with wallet");if(!this.torusInstance)throw te.notReady("Torus wallet is not initialized");return await this.torusInstance.getUserInfo()}async addChain(t){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;super.checkAddChainRequirements(t,n),this.addChainConfig(t)}async switchChain(t){var n;let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;super.checkSwitchChainRequirements(t,r);const a=this.getChainConfig(t.chainId);await((n=this.torusInstance)===null||n===void 0?void 0:n.setProvider({rpcTarget:a.rpcTarget,chainId:a.chainId,displayName:a.displayName,blockExplorerUrl:a.blockExplorer,ticker:a.ticker,tickerName:a.tickerName,logo:"https://images.web3auth.io/login-torus-solana.svg"})),this.setAdapterSettings({chainConfig:this.getChainConfig(t.chainId)})}}export{ug as SolanaWalletAdapter};
