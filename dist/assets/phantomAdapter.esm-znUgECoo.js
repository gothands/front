import{b as ve,c as Me,e as Zt,s as zr,r as en,d as Q,_ as me,T as Zr,j as ei,l as ar,a as ti,C as ni}from"./index-L3ozMu8u.js";import{B as ri}from"./baseSolanaAdapter.esm-PuQFH4iL.js";import{a as ii}from"./solanaProvider.esm-NGEjt1Cg.js";var oi={exports:{}},Nt={exports:{}},V={ArrayIsArray(e){return Array.isArray(e)},ArrayPrototypeIncludes(e,t){return e.includes(t)},ArrayPrototypeIndexOf(e,t){return e.indexOf(t)},ArrayPrototypeJoin(e,t){return e.join(t)},ArrayPrototypeMap(e,t){return e.map(t)},ArrayPrototypePop(e,t){return e.pop(t)},ArrayPrototypePush(e,t){return e.push(t)},ArrayPrototypeSlice(e,t,n){return e.slice(t,n)},Error,FunctionPrototypeCall(e,t,...n){return e.call(t,...n)},FunctionPrototypeSymbolHasInstance(e,t){return Function.prototype[Symbol.hasInstance].call(e,t)},MathFloor:Math.floor,Number,NumberIsInteger:Number.isInteger,NumberIsNaN:Number.isNaN,NumberMAX_SAFE_INTEGER:Number.MAX_SAFE_INTEGER,NumberMIN_SAFE_INTEGER:Number.MIN_SAFE_INTEGER,NumberParseInt:Number.parseInt,ObjectDefineProperties(e,t){return Object.defineProperties(e,t)},ObjectDefineProperty(e,t,n){return Object.defineProperty(e,t,n)},ObjectGetOwnPropertyDescriptor(e,t){return Object.getOwnPropertyDescriptor(e,t)},ObjectKeys(e){return Object.keys(e)},ObjectSetPrototypeOf(e,t){return Object.setPrototypeOf(e,t)},Promise,PromisePrototypeCatch(e,t){return e.catch(t)},PromisePrototypeThen(e,t,n){return e.then(t,n)},PromiseReject(e){return Promise.reject(e)},ReflectApply:Reflect.apply,RegExpPrototypeTest(e,t){return e.test(t)},SafeSet:Set,String,StringPrototypeSlice(e,t,n){return e.slice(t,n)},StringPrototypeToLowerCase(e){return e.toLowerCase()},StringPrototypeToUpperCase(e){return e.toUpperCase()},StringPrototypeTrim(e){return e.trim()},Symbol,SymbolFor:Symbol.for,SymbolAsyncIterator:Symbol.asyncIterator,SymbolHasInstance:Symbol.hasInstance,SymbolIterator:Symbol.iterator,TypedArrayPrototypeSet(e,t,n){return e.set(t,n)},Uint8Array},lr={exports:{}};(function(e){const t=ve,n=Object.getPrototypeOf(async function(){}).constructor,r=globalThis.Blob||t.Blob,a=typeof r<"u"?function(b){return b instanceof r}:function(b){return!1};class l extends Error{constructor(b){if(!Array.isArray(b))throw new TypeError(`Expected input to be an Array, got ${typeof b}`);let p="";for(let d=0;d<b.length;d++)p+=`    ${b[d].stack}
`;super(p),this.name="AggregateError",this.errors=b}}e.exports={AggregateError:l,kEmptyObject:Object.freeze({}),once(u){let b=!1;return function(...p){b||(b=!0,u.apply(this,p))}},createDeferredPromise:function(){let u,b;return{promise:new Promise((d,c)=>{u=d,b=c}),resolve:u,reject:b}},promisify(u){return new Promise((b,p)=>{u((d,...c)=>d?p(d):b(...c))})},debuglog(){return function(){}},format(u,...b){return u.replace(/%([sdifj])/g,function(...[p,d]){const c=b.shift();return d==="f"?c.toFixed(6):d==="j"?JSON.stringify(c):d==="s"&&typeof c=="object"?`${c.constructor!==Object?c.constructor.name:""} {}`.trim():c.toString()})},inspect(u){switch(typeof u){case"string":if(u.includes("'"))if(u.includes('"')){if(!u.includes("`")&&!u.includes("${"))return`\`${u}\``}else return`"${u}"`;return`'${u}'`;case"number":return isNaN(u)?"NaN":Object.is(u,-0)?String(u):u;case"bigint":return`${String(u)}n`;case"boolean":case"undefined":return String(u);case"object":return"{}"}},types:{isAsyncFunction(u){return u instanceof n},isArrayBufferView(u){return ArrayBuffer.isView(u)}},isBlob:a},e.exports.promisify.custom=Symbol.for("nodejs.util.promisify.custom")})(lr);var we=lr.exports,tn={};const{format:ai,inspect:at,AggregateError:li}=we,si=globalThis.AggregateError||li,fi=Symbol("kIsNodeError"),ui=["string","function","number","object","Function","Object","boolean","bigint","symbol"],di=/^([A-Z][a-z0-9]*)+$/,ci="__node_internal_",ut={};function Pe(e,t){if(!e)throw new ut.ERR_INTERNAL_ASSERTION(t)}function Sn(e){let t="",n=e.length;const r=e[0]==="-"?1:0;for(;n>=r+4;n-=3)t=`_${e.slice(n-3,n)}${t}`;return`${e.slice(0,n)}${t}`}function hi(e,t,n){if(typeof t=="function")return Pe(t.length<=n.length,`Code: ${e}; The provided arguments length (${n.length}) does not match the required ones (${t.length}).`),t(...n);const r=(t.match(/%[dfijoOs]/g)||[]).length;return Pe(r===n.length,`Code: ${e}; The provided arguments length (${n.length}) does not match the required ones (${r}).`),n.length===0?t:ai(t,...n)}function z(e,t,n){n||(n=Error);class r extends n{constructor(...l){super(hi(e,t,l))}toString(){return`${this.name} [${e}]: ${this.message}`}}Object.defineProperties(r.prototype,{name:{value:n.name,writable:!0,enumerable:!1,configurable:!0},toString:{value(){return`${this.name} [${e}]: ${this.message}`},writable:!0,enumerable:!1,configurable:!0}}),r.prototype.code=e,r.prototype[fi]=!0,ut[e]=r}function mn(e){const t=ci+e.name;return Object.defineProperty(e,"name",{value:t}),e}function bi(e,t){if(e&&t&&e!==t){if(Array.isArray(t.errors))return t.errors.push(e),t;const n=new si([t,e],t.message);return n.code=t.code,n}return e||t}let gi=class extends Error{constructor(t="The operation was aborted",n=void 0){if(n!==void 0&&typeof n!="object")throw new ut.ERR_INVALID_ARG_TYPE("options","Object",n);super(t,n),this.code="ABORT_ERR",this.name="AbortError"}};z("ERR_ASSERTION","%s",Error);z("ERR_INVALID_ARG_TYPE",(e,t,n)=>{Pe(typeof e=="string","'name' must be a string"),Array.isArray(t)||(t=[t]);let r="The ";e.endsWith(" argument")?r+=`${e} `:r+=`"${e}" ${e.includes(".")?"property":"argument"} `,r+="must be ";const a=[],l=[],u=[];for(const p of t)Pe(typeof p=="string","All expected entries have to be of type string"),ui.includes(p)?a.push(p.toLowerCase()):di.test(p)?l.push(p):(Pe(p!=="object",'The value "object" should be written as "Object"'),u.push(p));if(l.length>0){const p=a.indexOf("object");p!==-1&&(a.splice(a,p,1),l.push("Object"))}if(a.length>0){switch(a.length){case 1:r+=`of type ${a[0]}`;break;case 2:r+=`one of type ${a[0]} or ${a[1]}`;break;default:{const p=a.pop();r+=`one of type ${a.join(", ")}, or ${p}`}}(l.length>0||u.length>0)&&(r+=" or ")}if(l.length>0){switch(l.length){case 1:r+=`an instance of ${l[0]}`;break;case 2:r+=`an instance of ${l[0]} or ${l[1]}`;break;default:{const p=l.pop();r+=`an instance of ${l.join(", ")}, or ${p}`}}u.length>0&&(r+=" or ")}switch(u.length){case 0:break;case 1:u[0].toLowerCase()!==u[0]&&(r+="an "),r+=`${u[0]}`;break;case 2:r+=`one of ${u[0]} or ${u[1]}`;break;default:{const p=u.pop();r+=`one of ${u.join(", ")}, or ${p}`}}if(n==null)r+=`. Received ${n}`;else if(typeof n=="function"&&n.name)r+=`. Received function ${n.name}`;else if(typeof n=="object"){var b;if((b=n.constructor)!==null&&b!==void 0&&b.name)r+=`. Received an instance of ${n.constructor.name}`;else{const p=at(n,{depth:-1});r+=`. Received ${p}`}}else{let p=at(n,{colors:!1});p.length>25&&(p=`${p.slice(0,25)}...`),r+=`. Received type ${typeof n} (${p})`}return r},TypeError);z("ERR_INVALID_ARG_VALUE",(e,t,n="is invalid")=>{let r=at(t);return r.length>128&&(r=r.slice(0,128)+"..."),`The ${e.includes(".")?"property":"argument"} '${e}' ${n}. Received ${r}`},TypeError);z("ERR_INVALID_RETURN_VALUE",(e,t,n)=>{var r;const a=n!=null&&(r=n.constructor)!==null&&r!==void 0&&r.name?`instance of ${n.constructor.name}`:`type ${typeof n}`;return`Expected ${e} to be returned from the "${t}" function but got ${a}.`},TypeError);z("ERR_MISSING_ARGS",(...e)=>{Pe(e.length>0,"At least one arg needs to be specified");let t;const n=e.length;switch(e=(Array.isArray(e)?e:[e]).map(r=>`"${r}"`).join(" or "),n){case 1:t+=`The ${e[0]} argument`;break;case 2:t+=`The ${e[0]} and ${e[1]} arguments`;break;default:{const r=e.pop();t+=`The ${e.join(", ")}, and ${r} arguments`}break}return`${t} must be specified`},TypeError);z("ERR_OUT_OF_RANGE",(e,t,n)=>{Pe(t,'Missing "range" argument');let r;return Number.isInteger(n)&&Math.abs(n)>2**32?r=Sn(String(n)):typeof n=="bigint"?(r=String(n),(n>2n**32n||n<-(2n**32n))&&(r=Sn(r)),r+="n"):r=at(n),`The value of "${e}" is out of range. It must be ${t}. Received ${r}`},RangeError);z("ERR_MULTIPLE_CALLBACK","Callback called multiple times",Error);z("ERR_METHOD_NOT_IMPLEMENTED","The %s method is not implemented",Error);z("ERR_STREAM_ALREADY_FINISHED","Cannot call %s after a stream was finished",Error);z("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable",Error);z("ERR_STREAM_DESTROYED","Cannot call %s after a stream was destroyed",Error);z("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError);z("ERR_STREAM_PREMATURE_CLOSE","Premature close",Error);z("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF",Error);z("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event",Error);z("ERR_STREAM_WRITE_AFTER_END","write after end",Error);z("ERR_UNKNOWN_ENCODING","Unknown encoding: %s",TypeError);var ne={AbortError:gi,aggregateTwoErrors:mn(bi),hideStackFrames:mn,codes:ut};const{ArrayIsArray:nn,ArrayPrototypeIncludes:sr,ArrayPrototypeJoin:fr,ArrayPrototypeMap:pi,NumberIsInteger:rn,NumberIsNaN:wi,NumberMAX_SAFE_INTEGER:_i,NumberMIN_SAFE_INTEGER:yi,NumberParseInt:Si,ObjectPrototypeHasOwnProperty:mi,RegExpPrototypeExec:ur,String:Ei,StringPrototypeToUpperCase:Ri,StringPrototypeTrim:Ai}=V,{hideStackFrames:oe,codes:{ERR_SOCKET_BAD_PORT:Ti,ERR_INVALID_ARG_TYPE:ee,ERR_INVALID_ARG_VALUE:je,ERR_OUT_OF_RANGE:Oe,ERR_UNKNOWN_SIGNAL:En}}=ne,{normalizeEncoding:Ni}=we,{isAsyncFunction:Ii,isArrayBufferView:Pi}=we.types,Rn={};function Oi(e){return e===(e|0)}function vi(e){return e===e>>>0}const Mi=/^[0-7]+$/,Ci="must be a 32-bit unsigned integer or an octal string";function $i(e,t,n){if(typeof e>"u"&&(e=n),typeof e=="string"){if(ur(Mi,e)===null)throw new je(t,e,Ci);e=Si(e,8)}return dr(e,t),e}const Di=oe((e,t,n=yi,r=_i)=>{if(typeof e!="number")throw new ee(t,"number",e);if(!rn(e))throw new Oe(t,"an integer",e);if(e<n||e>r)throw new Oe(t,`>= ${n} && <= ${r}`,e)}),xi=oe((e,t,n=-2147483648,r=2147483647)=>{if(typeof e!="number")throw new ee(t,"number",e);if(!rn(e))throw new Oe(t,"an integer",e);if(e<n||e>r)throw new Oe(t,`>= ${n} && <= ${r}`,e)}),dr=oe((e,t,n=!1)=>{if(typeof e!="number")throw new ee(t,"number",e);if(!rn(e))throw new Oe(t,"an integer",e);const r=n?1:0,a=4294967295;if(e<r||e>a)throw new Oe(t,`>= ${r} && <= ${a}`,e)});function on(e,t){if(typeof e!="string")throw new ee(t,"string",e)}function Li(e,t,n=void 0,r){if(typeof e!="number")throw new ee(t,"number",e);if(n!=null&&e<n||r!=null&&e>r||(n!=null||r!=null)&&wi(e))throw new Oe(t,`${n!=null?`>= ${n}`:""}${n!=null&&r!=null?" && ":""}${r!=null?`<= ${r}`:""}`,e)}const ki=oe((e,t,n)=>{if(!sr(n,e)){const a="must be one of: "+fr(pi(n,l=>typeof l=="string"?`'${l}'`:Ei(l)),", ");throw new je(t,e,a)}});function cr(e,t){if(typeof e!="boolean")throw new ee(t,"boolean",e)}function It(e,t,n){return e==null||!mi(e,t)?n:e[t]}const Wi=oe((e,t,n=null)=>{const r=It(n,"allowArray",!1),a=It(n,"allowFunction",!1);if(!It(n,"nullable",!1)&&e===null||!r&&nn(e)||typeof e!="object"&&(!a||typeof e!="function"))throw new ee(t,"Object",e)}),Fi=oe((e,t)=>{if(e!=null&&typeof e!="object"&&typeof e!="function")throw new ee(t,"a dictionary",e)}),an=oe((e,t,n=0)=>{if(!nn(e))throw new ee(t,"Array",e);if(e.length<n){const r=`must be longer than ${n}`;throw new je(t,e,r)}});function ji(e,t){an(e,t);for(let n=0;n<e.length;n++)on(e[n],`${t}[${n}]`)}function Ui(e,t){an(e,t);for(let n=0;n<e.length;n++)cr(e[n],`${t}[${n}]`)}function Bi(e,t="signal"){if(on(e,t),Rn[e]===void 0)throw Rn[Ri(e)]!==void 0?new En(e+" (signals must use all capital letters)"):new En(e)}const Gi=oe((e,t="buffer")=>{if(!Pi(e))throw new ee(t,["Buffer","TypedArray","DataView"],e)});function Hi(e,t){const n=Ni(t),r=e.length;if(n==="hex"&&r%2!==0)throw new je("encoding",t,`is invalid for data of length ${r}`)}function Vi(e,t="Port",n=!0){if(typeof e!="number"&&typeof e!="string"||typeof e=="string"&&Ai(e).length===0||+e!==+e>>>0||e>65535||e===0&&!n)throw new Ti(t,e,n);return e|0}const qi=oe((e,t)=>{if(e!==void 0&&(e===null||typeof e!="object"||!("aborted"in e)))throw new ee(t,"AbortSignal",e)}),Yi=oe((e,t)=>{if(typeof e!="function")throw new ee(t,"Function",e)}),Ki=oe((e,t)=>{if(typeof e!="function"||Ii(e))throw new ee(t,"Function",e)}),Ji=oe((e,t)=>{if(e!==void 0)throw new ee(t,"undefined",e)});function Xi(e,t,n){if(!sr(n,e))throw new ee(t,`('${fr(n,"|")}')`,e)}const Qi=/^(?:<[^>]*>)(?:\s*;\s*[^;"\s]+(?:=(")?[^;"\s]*\1)?)*$/;function An(e,t){if(typeof e>"u"||!ur(Qi,e))throw new je(t,e,'must be an array or string of format "</styles.css>; rel=preload; as=style"')}function zi(e){if(typeof e=="string")return An(e,"hints"),e;if(nn(e)){const t=e.length;let n="";if(t===0)return n;for(let r=0;r<t;r++){const a=e[r];An(a,"hints"),n+=a,r!==t-1&&(n+=", ")}return n}throw new je("hints",e,'must be an array or string of format "</styles.css>; rel=preload; as=style"')}var dt={isInt32:Oi,isUint32:vi,parseFileMode:$i,validateArray:an,validateStringArray:ji,validateBooleanArray:Ui,validateBoolean:cr,validateBuffer:Gi,validateDictionary:Fi,validateEncoding:Hi,validateFunction:Yi,validateInt32:xi,validateInteger:Di,validateNumber:Li,validateObject:Wi,validateOneOf:ki,validatePlainFunction:Ki,validatePort:Vi,validateSignalName:Bi,validateString:on,validateUint32:dr,validateUndefined:Ji,validateUnion:Xi,validateAbortSignal:qi,validateLinkHeaderValue:zi},ln={exports:{}};const{Symbol:ct,SymbolAsyncIterator:Tn,SymbolIterator:Nn,SymbolFor:hr}=V,br=ct("kDestroyed"),gr=ct("kIsErrored"),Gt=ct("kIsReadable"),pr=ct("kIsDisturbed"),Zi=hr("nodejs.webstream.isClosedPromise"),eo=hr("nodejs.webstream.controllerErrorFunction");function ht(e,t=!1){var n;return!!(e&&typeof e.pipe=="function"&&typeof e.on=="function"&&(!t||typeof e.pause=="function"&&typeof e.resume=="function")&&(!e._writableState||((n=e._readableState)===null||n===void 0?void 0:n.readable)!==!1)&&(!e._writableState||e._readableState))}function bt(e){var t;return!!(e&&typeof e.write=="function"&&typeof e.on=="function"&&(!e._readableState||((t=e._writableState)===null||t===void 0?void 0:t.writable)!==!1))}function to(e){return!!(e&&typeof e.pipe=="function"&&e._readableState&&typeof e.on=="function"&&typeof e.write=="function")}function de(e){return e&&(e._readableState||e._writableState||typeof e.write=="function"&&typeof e.on=="function"||typeof e.pipe=="function"&&typeof e.on=="function")}function wr(e){return!!(e&&!de(e)&&typeof e.pipeThrough=="function"&&typeof e.getReader=="function"&&typeof e.cancel=="function")}function _r(e){return!!(e&&!de(e)&&typeof e.getWriter=="function"&&typeof e.abort=="function")}function yr(e){return!!(e&&!de(e)&&typeof e.readable=="object"&&typeof e.writable=="object")}function no(e){return wr(e)||_r(e)||yr(e)}function ro(e,t){return e==null?!1:t===!0?typeof e[Tn]=="function":t===!1?typeof e[Nn]=="function":typeof e[Tn]=="function"||typeof e[Nn]=="function"}function gt(e){if(!de(e))return null;const t=e._writableState,n=e._readableState,r=t||n;return!!(e.destroyed||e[br]||r!=null&&r.destroyed)}function Sr(e){if(!bt(e))return null;if(e.writableEnded===!0)return!0;const t=e._writableState;return t!=null&&t.errored?!1:typeof(t==null?void 0:t.ended)!="boolean"?null:t.ended}function io(e,t){if(!bt(e))return null;if(e.writableFinished===!0)return!0;const n=e._writableState;return n!=null&&n.errored?!1:typeof(n==null?void 0:n.finished)!="boolean"?null:!!(n.finished||t===!1&&n.ended===!0&&n.length===0)}function oo(e){if(!ht(e))return null;if(e.readableEnded===!0)return!0;const t=e._readableState;return!t||t.errored?!1:typeof(t==null?void 0:t.ended)!="boolean"?null:t.ended}function mr(e,t){if(!ht(e))return null;const n=e._readableState;return n!=null&&n.errored?!1:typeof(n==null?void 0:n.endEmitted)!="boolean"?null:!!(n.endEmitted||t===!1&&n.ended===!0&&n.length===0)}function Er(e){return e&&e[Gt]!=null?e[Gt]:typeof(e==null?void 0:e.readable)!="boolean"?null:gt(e)?!1:ht(e)&&e.readable&&!mr(e)}function Rr(e){return typeof(e==null?void 0:e.writable)!="boolean"?null:gt(e)?!1:bt(e)&&e.writable&&!Sr(e)}function ao(e,t){return de(e)?gt(e)?!0:!((t==null?void 0:t.readable)!==!1&&Er(e)||(t==null?void 0:t.writable)!==!1&&Rr(e)):null}function lo(e){var t,n;return de(e)?e.writableErrored?e.writableErrored:(t=(n=e._writableState)===null||n===void 0?void 0:n.errored)!==null&&t!==void 0?t:null:null}function so(e){var t,n;return de(e)?e.readableErrored?e.readableErrored:(t=(n=e._readableState)===null||n===void 0?void 0:n.errored)!==null&&t!==void 0?t:null:null}function fo(e){if(!de(e))return null;if(typeof e.closed=="boolean")return e.closed;const t=e._writableState,n=e._readableState;return typeof(t==null?void 0:t.closed)=="boolean"||typeof(n==null?void 0:n.closed)=="boolean"?(t==null?void 0:t.closed)||(n==null?void 0:n.closed):typeof e._closed=="boolean"&&Ar(e)?e._closed:null}function Ar(e){return typeof e._closed=="boolean"&&typeof e._defaultKeepAlive=="boolean"&&typeof e._removedConnection=="boolean"&&typeof e._removedContLen=="boolean"}function Tr(e){return typeof e._sent100=="boolean"&&Ar(e)}function uo(e){var t;return typeof e._consuming=="boolean"&&typeof e._dumped=="boolean"&&((t=e.req)===null||t===void 0?void 0:t.upgradeOrConnect)===void 0}function co(e){if(!de(e))return null;const t=e._writableState,n=e._readableState,r=t||n;return!r&&Tr(e)||!!(r&&r.autoDestroy&&r.emitClose&&r.closed===!1)}function ho(e){var t;return!!(e&&((t=e[pr])!==null&&t!==void 0?t:e.readableDidRead||e.readableAborted))}function bo(e){var t,n,r,a,l,u,b,p,d,c;return!!(e&&((t=(n=(r=(a=(l=(u=e[gr])!==null&&u!==void 0?u:e.readableErrored)!==null&&l!==void 0?l:e.writableErrored)!==null&&a!==void 0?a:(b=e._readableState)===null||b===void 0?void 0:b.errorEmitted)!==null&&r!==void 0?r:(p=e._writableState)===null||p===void 0?void 0:p.errorEmitted)!==null&&n!==void 0?n:(d=e._readableState)===null||d===void 0?void 0:d.errored)!==null&&t!==void 0?t:!((c=e._writableState)===null||c===void 0)&&c.errored))}var _e={kDestroyed:br,isDisturbed:ho,kIsDisturbed:pr,isErrored:bo,kIsErrored:gr,isReadable:Er,kIsReadable:Gt,kIsClosedPromise:Zi,kControllerErrorFunction:eo,isClosed:fo,isDestroyed:gt,isDuplexNodeStream:to,isFinished:ao,isIterable:ro,isReadableNodeStream:ht,isReadableStream:wr,isReadableEnded:oo,isReadableFinished:mr,isReadableErrored:so,isNodeStream:de,isWebStream:no,isWritable:Rr,isWritableNodeStream:bt,isWritableStream:_r,isWritableEnded:Sr,isWritableFinished:io,isWritableErrored:lo,isServerRequest:uo,isServerResponse:Tr,willEmitClose:co,isTransformStream:yr};const Se=Me,{AbortError:Nr,codes:go}=ne,{ERR_INVALID_ARG_TYPE:po,ERR_STREAM_PREMATURE_CLOSE:In}=go,{kEmptyObject:Ht,once:Vt}=we,{validateAbortSignal:wo,validateFunction:_o,validateObject:yo,validateBoolean:So}=dt,{Promise:mo,PromisePrototypeThen:Eo}=V,{isClosed:Ro,isReadable:Pn,isReadableNodeStream:Pt,isReadableStream:Ao,isReadableFinished:On,isReadableErrored:vn,isWritable:Mn,isWritableNodeStream:Cn,isWritableStream:To,isWritableFinished:$n,isWritableErrored:Dn,isNodeStream:No,willEmitClose:Io,kIsClosedPromise:Po}=_e;function Oo(e){return e.setHeader&&typeof e.abort=="function"}const qt=()=>{};function Ir(e,t,n){var r,a;if(arguments.length===2?(n=t,t=Ht):t==null?t=Ht:yo(t,"options"),_o(n,"callback"),wo(t.signal,"options.signal"),n=Vt(n),Ao(e)||To(e))return vo(e,t,n);if(!No(e))throw new po("stream",["ReadableStream","WritableStream","Stream"],e);const l=(r=t.readable)!==null&&r!==void 0?r:Pt(e),u=(a=t.writable)!==null&&a!==void 0?a:Cn(e),b=e._writableState,p=e._readableState,d=()=>{e.writable||I()};let c=Io(e)&&Pt(e)===l&&Cn(e)===u,R=$n(e,!1);const I=()=>{R=!0,e.destroyed&&(c=!1),!(c&&(!e.readable||l))&&(!l||_)&&n.call(e)};let _=On(e,!1);const h=()=>{_=!0,e.destroyed&&(c=!1),!(c&&(!e.writable||u))&&(!u||R)&&n.call(e)},D=M=>{n.call(e,M)};let v=Ro(e);const P=()=>{v=!0;const M=Dn(e)||vn(e);if(M&&typeof M!="boolean")return n.call(e,M);if(l&&!_&&Pt(e,!0)&&!On(e,!1))return n.call(e,new In);if(u&&!R&&!$n(e,!1))return n.call(e,new In);n.call(e)},w=()=>{v=!0;const M=Dn(e)||vn(e);if(M&&typeof M!="boolean")return n.call(e,M);n.call(e)},$=()=>{e.req.on("finish",I)};Oo(e)?(e.on("complete",I),c||e.on("abort",P),e.req?$():e.on("request",$)):u&&!b&&(e.on("end",d),e.on("close",d)),!c&&typeof e.aborted=="boolean"&&e.on("aborted",P),e.on("end",h),e.on("finish",I),t.error!==!1&&e.on("error",D),e.on("close",P),v?Se.nextTick(P):b!=null&&b.errorEmitted||p!=null&&p.errorEmitted?c||Se.nextTick(w):(!l&&(!c||Pn(e))&&(R||Mn(e)===!1)||!u&&(!c||Mn(e))&&(_||Pn(e)===!1)||p&&e.req&&e.aborted)&&Se.nextTick(w);const U=()=>{n=qt,e.removeListener("aborted",P),e.removeListener("complete",I),e.removeListener("abort",P),e.removeListener("request",$),e.req&&e.req.removeListener("finish",I),e.removeListener("end",d),e.removeListener("close",d),e.removeListener("finish",I),e.removeListener("end",h),e.removeListener("error",D),e.removeListener("close",P)};if(t.signal&&!v){const M=()=>{const q=n;U(),q.call(e,new Nr(void 0,{cause:t.signal.reason}))};if(t.signal.aborted)Se.nextTick(M);else{const q=n;n=Vt((...B)=>{t.signal.removeEventListener("abort",M),q.apply(e,B)}),t.signal.addEventListener("abort",M)}}return U}function vo(e,t,n){let r=!1,a=qt;if(t.signal)if(a=()=>{r=!0,n.call(e,new Nr(void 0,{cause:t.signal.reason}))},t.signal.aborted)Se.nextTick(a);else{const u=n;n=Vt((...b)=>{t.signal.removeEventListener("abort",a),u.apply(e,b)}),t.signal.addEventListener("abort",a)}const l=(...u)=>{r||Se.nextTick(()=>n.apply(e,u))};return Eo(e[Po].promise,l,l),qt}function Mo(e,t){var n;let r=!1;return t===null&&(t=Ht),(n=t)!==null&&n!==void 0&&n.cleanup&&(So(t.cleanup,"cleanup"),r=t.cleanup),new mo((a,l)=>{const u=Ir(e,t,b=>{r&&u(),b?l(b):a()})})}ln.exports=Ir;ln.exports.finished=Mo;var Ee=ln.exports;const fe=Me,{aggregateTwoErrors:Co,codes:{ERR_MULTIPLE_CALLBACK:$o},AbortError:Do}=ne,{Symbol:Pr}=V,{kDestroyed:xo,isDestroyed:Lo,isFinished:ko,isServerRequest:Wo}=_e,Or=Pr("kDestroy"),Yt=Pr("kConstruct");function vr(e,t,n){e&&(e.stack,t&&!t.errored&&(t.errored=e),n&&!n.errored&&(n.errored=e))}function Fo(e,t){const n=this._readableState,r=this._writableState,a=r||n;return r!=null&&r.destroyed||n!=null&&n.destroyed?(typeof t=="function"&&t(),this):(vr(e,r,n),r&&(r.destroyed=!0),n&&(n.destroyed=!0),a.constructed?xn(this,e,t):this.once(Or,function(l){xn(this,Co(l,e),t)}),this)}function xn(e,t,n){let r=!1;function a(l){if(r)return;r=!0;const u=e._readableState,b=e._writableState;vr(l,b,u),b&&(b.closed=!0),u&&(u.closed=!0),typeof n=="function"&&n(l),l?fe.nextTick(jo,e,l):fe.nextTick(Mr,e)}try{e._destroy(t||null,a)}catch(l){a(l)}}function jo(e,t){Kt(e,t),Mr(e)}function Mr(e){const t=e._readableState,n=e._writableState;n&&(n.closeEmitted=!0),t&&(t.closeEmitted=!0),(n!=null&&n.emitClose||t!=null&&t.emitClose)&&e.emit("close")}function Kt(e,t){const n=e._readableState,r=e._writableState;r!=null&&r.errorEmitted||n!=null&&n.errorEmitted||(r&&(r.errorEmitted=!0),n&&(n.errorEmitted=!0),e.emit("error",t))}function Uo(){const e=this._readableState,t=this._writableState;e&&(e.constructed=!0,e.closed=!1,e.closeEmitted=!1,e.destroyed=!1,e.errored=null,e.errorEmitted=!1,e.reading=!1,e.ended=e.readable===!1,e.endEmitted=e.readable===!1),t&&(t.constructed=!0,t.destroyed=!1,t.closed=!1,t.closeEmitted=!1,t.errored=null,t.errorEmitted=!1,t.finalCalled=!1,t.prefinished=!1,t.ended=t.writable===!1,t.ending=t.writable===!1,t.finished=t.writable===!1)}function Jt(e,t,n){const r=e._readableState,a=e._writableState;if(a!=null&&a.destroyed||r!=null&&r.destroyed)return this;r!=null&&r.autoDestroy||a!=null&&a.autoDestroy?e.destroy(t):t&&(t.stack,a&&!a.errored&&(a.errored=t),r&&!r.errored&&(r.errored=t),n?fe.nextTick(Kt,e,t):Kt(e,t))}function Bo(e,t){if(typeof e._construct!="function")return;const n=e._readableState,r=e._writableState;n&&(n.constructed=!1),r&&(r.constructed=!1),e.once(Yt,t),!(e.listenerCount(Yt)>1)&&fe.nextTick(Go,e)}function Go(e){let t=!1;function n(r){if(t){Jt(e,r??new $o);return}t=!0;const a=e._readableState,l=e._writableState,u=l||a;a&&(a.constructed=!0),l&&(l.constructed=!0),u.destroyed?e.emit(Or,r):r?Jt(e,r,!0):fe.nextTick(Ho,e)}try{e._construct(r=>{fe.nextTick(n,r)})}catch(r){fe.nextTick(n,r)}}function Ho(e){e.emit(Yt)}function Ln(e){return(e==null?void 0:e.setHeader)&&typeof e.abort=="function"}function Cr(e){e.emit("close")}function Vo(e,t){e.emit("error",t),fe.nextTick(Cr,e)}function qo(e,t){!e||Lo(e)||(!t&&!ko(e)&&(t=new Do),Wo(e)?(e.socket=null,e.destroy(t)):Ln(e)?e.abort():Ln(e.req)?e.req.abort():typeof e.destroy=="function"?e.destroy(t):typeof e.close=="function"?e.close():t?fe.nextTick(Vo,e,t):fe.nextTick(Cr,e),e.destroyed||(e[xo]=!0))}var Ue={construct:Bo,destroyer:qo,destroy:Fo,undestroy:Uo,errorOrDestroy:Jt};const{ArrayIsArray:Yo,ObjectSetPrototypeOf:$r}=V,{EventEmitter:pt}=Zt;function wt(e){pt.call(this,e)}$r(wt.prototype,pt.prototype);$r(wt,pt);wt.prototype.pipe=function(e,t){const n=this;function r(c){e.writable&&e.write(c)===!1&&n.pause&&n.pause()}n.on("data",r);function a(){n.readable&&n.resume&&n.resume()}e.on("drain",a),!e._isStdio&&(!t||t.end!==!1)&&(n.on("end",u),n.on("close",b));let l=!1;function u(){l||(l=!0,e.end())}function b(){l||(l=!0,typeof e.destroy=="function"&&e.destroy())}function p(c){d(),pt.listenerCount(this,"error")===0&&this.emit("error",c)}Xt(n,"error",p),Xt(e,"error",p);function d(){n.removeListener("data",r),e.removeListener("drain",a),n.removeListener("end",u),n.removeListener("close",b),n.removeListener("error",p),e.removeListener("error",p),n.removeListener("end",d),n.removeListener("close",d),e.removeListener("close",d)}return n.on("end",d),n.on("close",d),e.on("close",d),e.emit("pipe",n),e};function Xt(e,t,n){if(typeof e.prependListener=="function")return e.prependListener(t,n);!e._events||!e._events[t]?e.on(t,n):Yo(e._events[t])?e._events[t].unshift(n):e._events[t]=[n,e._events[t]]}var sn={Stream:wt,prependListener:Xt},Dr={exports:{}};(function(e){const{AbortError:t,codes:n}=ne,{isNodeStream:r,isWebStream:a,kControllerErrorFunction:l}=_e,u=Ee,{ERR_INVALID_ARG_TYPE:b}=n,p=(d,c)=>{if(typeof d!="object"||!("aborted"in d))throw new b(c,"AbortSignal",d)};e.exports.addAbortSignal=function(c,R){if(p(c,"signal"),!r(R)&&!a(R))throw new b("stream",["ReadableStream","WritableStream","Stream"],R);return e.exports.addAbortSignalNoValidate(c,R)},e.exports.addAbortSignalNoValidate=function(d,c){if(typeof d!="object"||!("aborted"in d))return c;const R=r(c)?()=>{c.destroy(new t(void 0,{cause:d.reason}))}:()=>{c[l](new t(void 0,{cause:d.reason}))};return d.aborted?R():(d.addEventListener("abort",R),u(c,()=>d.removeEventListener("abort",R))),c}})(Dr);var _t=Dr.exports;const{StringPrototypeSlice:kn,SymbolIterator:Ko,TypedArrayPrototypeSet:Ze,Uint8Array:Jo}=V,{Buffer:Ot}=ve,{inspect:Xo}=we;var Qo=class{constructor(){this.head=null,this.tail=null,this.length=0}push(t){const n={data:t,next:null};this.length>0?this.tail.next=n:this.head=n,this.tail=n,++this.length}unshift(t){const n={data:t,next:this.head};this.length===0&&(this.tail=n),this.head=n,++this.length}shift(){if(this.length===0)return;const t=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,t}clear(){this.head=this.tail=null,this.length=0}join(t){if(this.length===0)return"";let n=this.head,r=""+n.data;for(;(n=n.next)!==null;)r+=t+n.data;return r}concat(t){if(this.length===0)return Ot.alloc(0);const n=Ot.allocUnsafe(t>>>0);let r=this.head,a=0;for(;r;)Ze(n,r.data,a),a+=r.data.length,r=r.next;return n}consume(t,n){const r=this.head.data;if(t<r.length){const a=r.slice(0,t);return this.head.data=r.slice(t),a}return t===r.length?this.shift():n?this._getString(t):this._getBuffer(t)}first(){return this.head.data}*[Ko](){for(let t=this.head;t;t=t.next)yield t.data}_getString(t){let n="",r=this.head,a=0;do{const l=r.data;if(t>l.length)n+=l,t-=l.length;else{t===l.length?(n+=l,++a,r.next?this.head=r.next:this.head=this.tail=null):(n+=kn(l,0,t),this.head=r,r.data=kn(l,t));break}++a}while((r=r.next)!==null);return this.length-=a,n}_getBuffer(t){const n=Ot.allocUnsafe(t),r=t;let a=this.head,l=0;do{const u=a.data;if(t>u.length)Ze(n,u,r-t),t-=u.length;else{t===u.length?(Ze(n,u,r-t),++l,a.next?this.head=a.next:this.head=this.tail=null):(Ze(n,new Jo(u.buffer,u.byteOffset,t),r-t),this.head=a,a.data=u.slice(t));break}++l}while((a=a.next)!==null);return this.length-=l,n}[Symbol.for("nodejs.util.inspect.custom")](t,n){return Xo(this,{...n,depth:0,customInspect:!1})}};const{MathFloor:zo,NumberIsInteger:Zo}=V,{ERR_INVALID_ARG_VALUE:ea}=ne.codes;function ta(e,t,n){return e.highWaterMark!=null?e.highWaterMark:t?e[n]:null}function xr(e){return e?16:16*1024}function na(e,t,n,r){const a=ta(t,r,n);if(a!=null){if(!Zo(a)||a<0){const l=r?`options.${n}`:"options.highWaterMark";throw new ea(l,a)}return zo(a)}return xr(e.objectMode)}var fn={getHighWaterMark:na,getDefaultHighWaterMark:xr};const Wn=Me,{PromisePrototypeThen:ra,SymbolAsyncIterator:Fn,SymbolIterator:jn}=V,{Buffer:ia}=ve,{ERR_INVALID_ARG_TYPE:oa,ERR_STREAM_NULL_VALUES:aa}=ne.codes;function la(e,t,n){let r;if(typeof t=="string"||t instanceof ia)return new e({objectMode:!0,...n,read(){this.push(t),this.push(null)}});let a;if(t&&t[Fn])a=!0,r=t[Fn]();else if(t&&t[jn])a=!1,r=t[jn]();else throw new oa("iterable",["Iterable"],t);const l=new e({objectMode:!0,highWaterMark:1,...n});let u=!1;l._read=function(){u||(u=!0,p())},l._destroy=function(d,c){ra(b(d),()=>Wn.nextTick(c,d),R=>Wn.nextTick(c,R||d))};async function b(d){const c=d!=null,R=typeof r.throw=="function";if(c&&R){const{value:I,done:_}=await r.throw(d);if(await I,_)return}if(typeof r.return=="function"){const{value:I}=await r.return();await I}}async function p(){for(;;){try{const{value:d,done:c}=a?await r.next():r.next();if(c)l.push(null);else{const R=d&&typeof d.then=="function"?await d:d;if(R===null)throw u=!1,new aa;if(l.push(R))continue;u=!1}}catch(d){l.destroy(d)}break}}return l}var Lr=la,vt,Un;function yt(){if(Un)return vt;Un=1;const e=Me,{ArrayPrototypeIndexOf:t,NumberIsInteger:n,NumberIsNaN:r,NumberParseInt:a,ObjectDefineProperties:l,ObjectKeys:u,ObjectSetPrototypeOf:b,Promise:p,SafeSet:d,SymbolAsyncIterator:c,Symbol:R}=V;vt=S,S.ReadableState=ae;const{EventEmitter:I}=Zt,{Stream:_,prependListener:h}=sn,{Buffer:D}=ve,{addAbortSignal:v}=_t,P=Ee;let w=we.debuglog("stream",i=>{w=i});const $=Qo,U=Ue,{getHighWaterMark:M,getDefaultHighWaterMark:q}=fn,{aggregateTwoErrors:B,codes:{ERR_INVALID_ARG_TYPE:Y,ERR_METHOD_NOT_IMPLEMENTED:j,ERR_OUT_OF_RANGE:y,ERR_STREAM_PUSH_AFTER_EOF:C,ERR_STREAM_UNSHIFT_AFTER_END_EVENT:K}}=ne,{validateObject:x}=dt,L=R("kPaused"),{StringDecoder:O}=zr,G=Lr;b(S.prototype,_.prototype),b(S,_);const J=()=>{},{errorOrDestroy:k}=U;function ae(i,o,m){typeof m!="boolean"&&(m=o instanceof ge()),this.objectMode=!!(i&&i.objectMode),m&&(this.objectMode=this.objectMode||!!(i&&i.readableObjectMode)),this.highWaterMark=i?M(this,i,"readableHighWaterMark",m):q(!1),this.buffer=new $,this.length=0,this.pipes=[],this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.constructed=!0,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this[L]=null,this.errorEmitted=!1,this.emitClose=!i||i.emitClose!==!1,this.autoDestroy=!i||i.autoDestroy!==!1,this.destroyed=!1,this.errored=null,this.closed=!1,this.closeEmitted=!1,this.defaultEncoding=i&&i.defaultEncoding||"utf8",this.awaitDrainWriters=null,this.multiAwaitDrain=!1,this.readingMore=!1,this.dataEmitted=!1,this.decoder=null,this.encoding=null,i&&i.encoding&&(this.decoder=new O(i.encoding),this.encoding=i.encoding)}function S(i){if(!(this instanceof S))return new S(i);const o=this instanceof ge();this._readableState=new ae(i,this,o),i&&(typeof i.read=="function"&&(this._read=i.read),typeof i.destroy=="function"&&(this._destroy=i.destroy),typeof i.construct=="function"&&(this._construct=i.construct),i.signal&&!o&&v(i.signal,this)),_.call(this,i),U.construct(this,()=>{this._readableState.needReadable&&ye(this,this._readableState)})}S.prototype.destroy=U.destroy,S.prototype._undestroy=U.undestroy,S.prototype._destroy=function(i,o){o(i)},S.prototype[I.captureRejectionSymbol]=function(i){this.destroy(i)},S.prototype.push=function(i,o){return te(this,i,o,!1)},S.prototype.unshift=function(i,o){return te(this,i,o,!0)};function te(i,o,m,E){w("readableAddChunk",o);const A=i._readableState;let Z;if(A.objectMode||(typeof o=="string"?(m=m||A.defaultEncoding,A.encoding!==m&&(E&&A.encoding?o=D.from(o,m).toString(A.encoding):(o=D.from(o,m),m=""))):o instanceof D?m="":_._isUint8Array(o)?(o=_._uint8ArrayToBuffer(o),m=""):o!=null&&(Z=new Y("chunk",["string","Buffer","Uint8Array"],o))),Z)k(i,Z);else if(o===null)A.reading=!1,mt(i,A);else if(A.objectMode||o&&o.length>0)if(E)if(A.endEmitted)k(i,new K);else{if(A.destroyed||A.errored)return!1;ce(i,A,o,!0)}else if(A.ended)k(i,new C);else{if(A.destroyed||A.errored)return!1;A.reading=!1,A.decoder&&!m?(o=A.decoder.write(o),A.objectMode||o.length!==0?ce(i,A,o,!1):ye(i,A)):ce(i,A,o,!1)}else E||(A.reading=!1,ye(i,A));return!A.ended&&(A.length<A.highWaterMark||A.length===0)}function ce(i,o,m,E){o.flowing&&o.length===0&&!o.sync&&i.listenerCount("data")>0?(o.multiAwaitDrain?o.awaitDrainWriters.clear():o.awaitDrainWriters=null,o.dataEmitted=!0,i.emit("data",m)):(o.length+=o.objectMode?1:m.length,E?o.buffer.unshift(m):o.buffer.push(m),o.needReadable&&De(i)),ye(i,o)}S.prototype.isPaused=function(){const i=this._readableState;return i[L]===!0||i.flowing===!1},S.prototype.setEncoding=function(i){const o=new O(i);this._readableState.decoder=o,this._readableState.encoding=this._readableState.decoder.encoding;const m=this._readableState.buffer;let E="";for(const A of m)E+=o.write(A);return m.clear(),E!==""&&m.push(E),this._readableState.length=E.length,this};const Be=1073741824;function Ge(i){if(i>Be)throw new y("size","<= 1GiB",i);return i--,i|=i>>>1,i|=i>>>2,i|=i>>>4,i|=i>>>8,i|=i>>>16,i++,i}function Re(i,o){return i<=0||o.length===0&&o.ended?0:o.objectMode?1:r(i)?o.flowing&&o.length?o.buffer.first().length:o.length:i<=o.length?i:o.ended?o.length:0}S.prototype.read=function(i){w("read",i),i===void 0?i=NaN:n(i)||(i=a(i,10));const o=this._readableState,m=i;if(i>o.highWaterMark&&(o.highWaterMark=Ge(i)),i!==0&&(o.emittedReadable=!1),i===0&&o.needReadable&&((o.highWaterMark!==0?o.length>=o.highWaterMark:o.length>0)||o.ended))return w("read: emitReadable",o.length,o.ended),o.length===0&&o.ended?se(this):De(this),null;if(i=Re(i,o),i===0&&o.ended)return o.length===0&&se(this),null;let E=o.needReadable;if(w("need readable",E),(o.length===0||o.length-i<o.highWaterMark)&&(E=!0,w("length less than watermark",E)),o.ended||o.reading||o.destroyed||o.errored||!o.constructed)E=!1,w("reading, ended or constructing",E);else if(E){w("do read"),o.reading=!0,o.sync=!0,o.length===0&&(o.needReadable=!0);try{this._read(o.highWaterMark)}catch(Z){k(this,Z)}o.sync=!1,o.reading||(i=Re(m,o))}let A;return i>0?A=F(i,o):A=null,A===null?(o.needReadable=o.length<=o.highWaterMark,i=0):(o.length-=i,o.multiAwaitDrain?o.awaitDrainWriters.clear():o.awaitDrainWriters=null),o.length===0&&(o.ended||(o.needReadable=!0),m!==i&&o.ended&&se(this)),A!==null&&!o.errorEmitted&&!o.closeEmitted&&(o.dataEmitted=!0,this.emit("data",A)),A};function mt(i,o){if(w("onEofChunk"),!o.ended){if(o.decoder){const m=o.decoder.end();m&&m.length&&(o.buffer.push(m),o.length+=o.objectMode?1:m.length)}o.ended=!0,o.sync?De(i):(o.needReadable=!1,o.emittedReadable=!0,xe(i))}}function De(i){const o=i._readableState;w("emitReadable",o.needReadable,o.emittedReadable),o.needReadable=!1,o.emittedReadable||(w("emitReadable",o.flowing),o.emittedReadable=!0,e.nextTick(xe,i))}function xe(i){const o=i._readableState;w("emitReadable_",o.destroyed,o.length,o.ended),!o.destroyed&&!o.errored&&(o.length||o.ended)&&(i.emit("readable"),o.emittedReadable=!1),o.needReadable=!o.flowing&&!o.ended&&o.length<=o.highWaterMark,T(i)}function ye(i,o){!o.readingMore&&o.constructed&&(o.readingMore=!0,e.nextTick(Et,i,o))}function Et(i,o){for(;!o.reading&&!o.ended&&(o.length<o.highWaterMark||o.flowing&&o.length===0);){const m=o.length;if(w("maybeReadMore read 0"),i.read(0),m===o.length)break}o.readingMore=!1}S.prototype._read=function(i){throw new j("_read()")},S.prototype.pipe=function(i,o){const m=this,E=this._readableState;E.pipes.length===1&&(E.multiAwaitDrain||(E.multiAwaitDrain=!0,E.awaitDrainWriters=new d(E.awaitDrainWriters?[E.awaitDrainWriters]:[]))),E.pipes.push(i),w("pipe count=%d opts=%j",E.pipes.length,o);const Z=(!o||o.end!==!1)&&i!==e.stdout&&i!==e.stderr?pn:Ye;E.endEmitted?e.nextTick(Z):m.once("end",Z),i.on("unpipe",re);function re(Te,be){w("onunpipe"),Te===m&&be&&be.hasUnpiped===!1&&(be.hasUnpiped=!0,Qr())}function pn(){w("onend"),i.end()}let Ae,wn=!1;function Qr(){w("cleanup"),i.removeListener("close",At),i.removeListener("finish",Tt),Ae&&i.removeListener("drain",Ae),i.removeListener("error",Rt),i.removeListener("unpipe",re),m.removeListener("end",pn),m.removeListener("end",Ye),m.removeListener("data",yn),wn=!0,Ae&&E.awaitDrainWriters&&(!i._writableState||i._writableState.needDrain)&&Ae()}function _n(){wn||(E.pipes.length===1&&E.pipes[0]===i?(w("false write response, pause",0),E.awaitDrainWriters=i,E.multiAwaitDrain=!1):E.pipes.length>1&&E.pipes.includes(i)&&(w("false write response, pause",E.awaitDrainWriters.size),E.awaitDrainWriters.add(i)),m.pause()),Ae||(Ae=He(m,i),i.on("drain",Ae))}m.on("data",yn);function yn(Te){w("ondata");const be=i.write(Te);w("dest.write",be),be===!1&&_n()}function Rt(Te){if(w("onerror",Te),Ye(),i.removeListener("error",Rt),i.listenerCount("error")===0){const be=i._writableState||i._readableState;be&&!be.errorEmitted?k(i,Te):i.emit("error",Te)}}h(i,"error",Rt);function At(){i.removeListener("finish",Tt),Ye()}i.once("close",At);function Tt(){w("onfinish"),i.removeListener("close",At),Ye()}i.once("finish",Tt);function Ye(){w("unpipe"),m.unpipe(i)}return i.emit("pipe",m),i.writableNeedDrain===!0?E.flowing&&_n():E.flowing||(w("pipe resume"),m.resume()),i};function He(i,o){return function(){const E=i._readableState;E.awaitDrainWriters===o?(w("pipeOnDrain",1),E.awaitDrainWriters=null):E.multiAwaitDrain&&(w("pipeOnDrain",E.awaitDrainWriters.size),E.awaitDrainWriters.delete(o)),(!E.awaitDrainWriters||E.awaitDrainWriters.size===0)&&i.listenerCount("data")&&i.resume()}}S.prototype.unpipe=function(i){const o=this._readableState,m={hasUnpiped:!1};if(o.pipes.length===0)return this;if(!i){const A=o.pipes;o.pipes=[],this.pause();for(let Z=0;Z<A.length;Z++)A[Z].emit("unpipe",this,{hasUnpiped:!1});return this}const E=t(o.pipes,i);return E===-1?this:(o.pipes.splice(E,1),o.pipes.length===0&&this.pause(),i.emit("unpipe",this,m),this)},S.prototype.on=function(i,o){const m=_.prototype.on.call(this,i,o),E=this._readableState;return i==="data"?(E.readableListening=this.listenerCount("readable")>0,E.flowing!==!1&&this.resume()):i==="readable"&&!E.endEmitted&&!E.readableListening&&(E.readableListening=E.needReadable=!0,E.flowing=!1,E.emittedReadable=!1,w("on readable",E.length,E.reading),E.length?De(this):E.reading||e.nextTick(s,this)),m},S.prototype.addListener=S.prototype.on,S.prototype.removeListener=function(i,o){const m=_.prototype.removeListener.call(this,i,o);return i==="readable"&&e.nextTick(Ve,this),m},S.prototype.off=S.prototype.removeListener,S.prototype.removeAllListeners=function(i){const o=_.prototype.removeAllListeners.apply(this,arguments);return(i==="readable"||i===void 0)&&e.nextTick(Ve,this),o};function Ve(i){const o=i._readableState;o.readableListening=i.listenerCount("readable")>0,o.resumeScheduled&&o[L]===!1?o.flowing=!0:i.listenerCount("data")>0?i.resume():o.readableListening||(o.flowing=null)}function s(i){w("readable nexttick read 0"),i.read(0)}S.prototype.resume=function(){const i=this._readableState;return i.flowing||(w("resume"),i.flowing=!i.readableListening,f(this,i)),i[L]=!1,this};function f(i,o){o.resumeScheduled||(o.resumeScheduled=!0,e.nextTick(g,i,o))}function g(i,o){w("resume",o.reading),o.reading||i.read(0),o.resumeScheduled=!1,i.emit("resume"),T(i),o.flowing&&!o.reading&&i.read(0)}S.prototype.pause=function(){return w("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(w("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState[L]=!0,this};function T(i){const o=i._readableState;for(w("flow",o.flowing);o.flowing&&i.read()!==null;);}S.prototype.wrap=function(i){let o=!1;i.on("data",E=>{!this.push(E)&&i.pause&&(o=!0,i.pause())}),i.on("end",()=>{this.push(null)}),i.on("error",E=>{k(this,E)}),i.on("close",()=>{this.destroy()}),i.on("destroy",()=>{this.destroy()}),this._read=()=>{o&&i.resume&&(o=!1,i.resume())};const m=u(i);for(let E=1;E<m.length;E++){const A=m[E];this[A]===void 0&&typeof i[A]=="function"&&(this[A]=i[A].bind(i))}return this},S.prototype[c]=function(){return N(this)},S.prototype.iterator=function(i){return i!==void 0&&x(i,"options"),N(this,i)};function N(i,o){typeof i.read!="function"&&(i=S.wrap(i,{objectMode:!0}));const m=W(i,o);return m.stream=i,m}async function*W(i,o){let m=J;function E(re){this===i?(m(),m=J):m=re}i.on("readable",E);let A;const Z=P(i,{writable:!1},re=>{A=re?B(A,re):null,m(),m=J});try{for(;;){const re=i.destroyed?null:i.read();if(re!==null)yield re;else{if(A)throw A;if(A===null)return;await new p(E)}}}catch(re){throw A=B(A,re),A}finally{(A||(o==null?void 0:o.destroyOnReturn)!==!1)&&(A===void 0||i._readableState.autoDestroy)?U.destroyer(i,null):(i.off("readable",E),Z())}}l(S.prototype,{readable:{__proto__:null,get(){const i=this._readableState;return!!i&&i.readable!==!1&&!i.destroyed&&!i.errorEmitted&&!i.endEmitted},set(i){this._readableState&&(this._readableState.readable=!!i)}},readableDidRead:{__proto__:null,enumerable:!1,get:function(){return this._readableState.dataEmitted}},readableAborted:{__proto__:null,enumerable:!1,get:function(){return!!(this._readableState.readable!==!1&&(this._readableState.destroyed||this._readableState.errored)&&!this._readableState.endEmitted)}},readableHighWaterMark:{__proto__:null,enumerable:!1,get:function(){return this._readableState.highWaterMark}},readableBuffer:{__proto__:null,enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}},readableFlowing:{__proto__:null,enumerable:!1,get:function(){return this._readableState.flowing},set:function(i){this._readableState&&(this._readableState.flowing=i)}},readableLength:{__proto__:null,enumerable:!1,get(){return this._readableState.length}},readableObjectMode:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.objectMode:!1}},readableEncoding:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.encoding:null}},errored:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.errored:null}},closed:{__proto__:null,get(){return this._readableState?this._readableState.closed:!1}},destroyed:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.destroyed:!1},set(i){this._readableState&&(this._readableState.destroyed=i)}},readableEnded:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.endEmitted:!1}}}),l(ae.prototype,{pipesCount:{__proto__:null,get(){return this.pipes.length}},paused:{__proto__:null,get(){return this[L]!==!1},set(i){this[L]=!!i}}}),S._fromList=F;function F(i,o){if(o.length===0)return null;let m;return o.objectMode?m=o.buffer.shift():!i||i>=o.length?(o.decoder?m=o.buffer.join(""):o.buffer.length===1?m=o.buffer.first():m=o.buffer.concat(o.length),o.buffer.clear()):m=o.buffer.consume(i,o.decoder),m}function se(i){const o=i._readableState;w("endReadable",o.endEmitted),o.endEmitted||(o.ended=!0,e.nextTick(Le,o,i))}function Le(i,o){if(w("endReadableNT",i.endEmitted,i.length),!i.errored&&!i.closeEmitted&&!i.endEmitted&&i.length===0){if(i.endEmitted=!0,o.emit("end"),o.writable&&o.allowHalfOpen===!1)e.nextTick(qe,o);else if(i.autoDestroy){const m=o._writableState;(!m||m.autoDestroy&&(m.finished||m.writable===!1))&&o.destroy()}}}function qe(i){i.writable&&!i.writableEnded&&!i.destroyed&&i.end()}S.from=function(i,o){return G(S,i,o)};let he;function gn(){return he===void 0&&(he={}),he}return S.fromWeb=function(i,o){return gn().newStreamReadableFromReadableStream(i,o)},S.toWeb=function(i,o){return gn().newReadableStreamFromStreamReadable(i,o)},S.wrap=function(i,o){var m,E;return new S({objectMode:(m=(E=i.readableObjectMode)!==null&&E!==void 0?E:i.objectMode)!==null&&m!==void 0?m:!0,...o,destroy(A,Z){U.destroyer(i,A),Z(A)}}).wrap(i)},vt}var Mt,Bn;function kr(){if(Bn)return Mt;Bn=1;const e=Me,{ArrayPrototypeSlice:t,Error:n,FunctionPrototypeSymbolHasInstance:r,ObjectDefineProperty:a,ObjectDefineProperties:l,ObjectSetPrototypeOf:u,StringPrototypeToLowerCase:b,Symbol:p,SymbolHasInstance:d}=V;Mt=O,O.WritableState=x;const{EventEmitter:c}=Zt,R=sn.Stream,{Buffer:I}=ve,_=Ue,{addAbortSignal:h}=_t,{getHighWaterMark:D,getDefaultHighWaterMark:v}=fn,{ERR_INVALID_ARG_TYPE:P,ERR_METHOD_NOT_IMPLEMENTED:w,ERR_MULTIPLE_CALLBACK:$,ERR_STREAM_CANNOT_PIPE:U,ERR_STREAM_DESTROYED:M,ERR_STREAM_ALREADY_FINISHED:q,ERR_STREAM_NULL_VALUES:B,ERR_STREAM_WRITE_AFTER_END:Y,ERR_UNKNOWN_ENCODING:j}=ne.codes,{errorOrDestroy:y}=_;u(O.prototype,R.prototype),u(O,R);function C(){}const K=p("kOnFinished");function x(s,f,g){typeof g!="boolean"&&(g=f instanceof ge()),this.objectMode=!!(s&&s.objectMode),g&&(this.objectMode=this.objectMode||!!(s&&s.writableObjectMode)),this.highWaterMark=s?D(this,s,"writableHighWaterMark",g):v(!1),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;const T=!!(s&&s.decodeStrings===!1);this.decodeStrings=!T,this.defaultEncoding=s&&s.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=S.bind(void 0,f),this.writecb=null,this.writelen=0,this.afterWriteTickInfo=null,L(this),this.pendingcb=0,this.constructed=!0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!s||s.emitClose!==!1,this.autoDestroy=!s||s.autoDestroy!==!1,this.errored=null,this.closed=!1,this.closeEmitted=!1,this[K]=[]}function L(s){s.buffered=[],s.bufferedIndex=0,s.allBuffers=!0,s.allNoop=!0}x.prototype.getBuffer=function(){return t(this.buffered,this.bufferedIndex)},a(x.prototype,"bufferedRequestCount",{__proto__:null,get(){return this.buffered.length-this.bufferedIndex}});function O(s){const f=this instanceof ge();if(!f&&!r(O,this))return new O(s);this._writableState=new x(s,this,f),s&&(typeof s.write=="function"&&(this._write=s.write),typeof s.writev=="function"&&(this._writev=s.writev),typeof s.destroy=="function"&&(this._destroy=s.destroy),typeof s.final=="function"&&(this._final=s.final),typeof s.construct=="function"&&(this._construct=s.construct),s.signal&&h(s.signal,this)),R.call(this,s),_.construct(this,()=>{const g=this._writableState;g.writing||Ge(this,g),xe(this,g)})}a(O,d,{__proto__:null,value:function(s){return r(this,s)?!0:this!==O?!1:s&&s._writableState instanceof x}}),O.prototype.pipe=function(){y(this,new U)};function G(s,f,g,T){const N=s._writableState;if(typeof g=="function")T=g,g=N.defaultEncoding;else{if(!g)g=N.defaultEncoding;else if(g!=="buffer"&&!I.isEncoding(g))throw new j(g);typeof T!="function"&&(T=C)}if(f===null)throw new B;if(!N.objectMode)if(typeof f=="string")N.decodeStrings!==!1&&(f=I.from(f,g),g="buffer");else if(f instanceof I)g="buffer";else if(R._isUint8Array(f))f=R._uint8ArrayToBuffer(f),g="buffer";else throw new P("chunk",["string","Buffer","Uint8Array"],f);let W;return N.ending?W=new Y:N.destroyed&&(W=new M("write")),W?(e.nextTick(T,W),y(s,W,!0),W):(N.pendingcb++,J(s,N,f,g,T))}O.prototype.write=function(s,f,g){return G(this,s,f,g)===!0},O.prototype.cork=function(){this._writableState.corked++},O.prototype.uncork=function(){const s=this._writableState;s.corked&&(s.corked--,s.writing||Ge(this,s))},O.prototype.setDefaultEncoding=function(f){if(typeof f=="string"&&(f=b(f)),!I.isEncoding(f))throw new j(f);return this._writableState.defaultEncoding=f,this};function J(s,f,g,T,N){const W=f.objectMode?1:g.length;f.length+=W;const F=f.length<f.highWaterMark;return F||(f.needDrain=!0),f.writing||f.corked||f.errored||!f.constructed?(f.buffered.push({chunk:g,encoding:T,callback:N}),f.allBuffers&&T!=="buffer"&&(f.allBuffers=!1),f.allNoop&&N!==C&&(f.allNoop=!1)):(f.writelen=W,f.writecb=N,f.writing=!0,f.sync=!0,s._write(g,T,f.onwrite),f.sync=!1),F&&!f.errored&&!f.destroyed}function k(s,f,g,T,N,W,F){f.writelen=T,f.writecb=F,f.writing=!0,f.sync=!0,f.destroyed?f.onwrite(new M("write")):g?s._writev(N,f.onwrite):s._write(N,W,f.onwrite),f.sync=!1}function ae(s,f,g,T){--f.pendingcb,T(g),Be(f),y(s,g)}function S(s,f){const g=s._writableState,T=g.sync,N=g.writecb;if(typeof N!="function"){y(s,new $);return}g.writing=!1,g.writecb=null,g.length-=g.writelen,g.writelen=0,f?(f.stack,g.errored||(g.errored=f),s._readableState&&!s._readableState.errored&&(s._readableState.errored=f),T?e.nextTick(ae,s,g,f,N):ae(s,g,f,N)):(g.buffered.length>g.bufferedIndex&&Ge(s,g),T?g.afterWriteTickInfo!==null&&g.afterWriteTickInfo.cb===N?g.afterWriteTickInfo.count++:(g.afterWriteTickInfo={count:1,cb:N,stream:s,state:g},e.nextTick(te,g.afterWriteTickInfo)):ce(s,g,1,N))}function te({stream:s,state:f,count:g,cb:T}){return f.afterWriteTickInfo=null,ce(s,f,g,T)}function ce(s,f,g,T){for(!f.ending&&!s.destroyed&&f.length===0&&f.needDrain&&(f.needDrain=!1,s.emit("drain"));g-- >0;)f.pendingcb--,T();f.destroyed&&Be(f),xe(s,f)}function Be(s){if(s.writing)return;for(let N=s.bufferedIndex;N<s.buffered.length;++N){var f;const{chunk:W,callback:F}=s.buffered[N],se=s.objectMode?1:W.length;s.length-=se,F((f=s.errored)!==null&&f!==void 0?f:new M("write"))}const g=s[K].splice(0);for(let N=0;N<g.length;N++){var T;g[N]((T=s.errored)!==null&&T!==void 0?T:new M("end"))}L(s)}function Ge(s,f){if(f.corked||f.bufferProcessing||f.destroyed||!f.constructed)return;const{buffered:g,bufferedIndex:T,objectMode:N}=f,W=g.length-T;if(!W)return;let F=T;if(f.bufferProcessing=!0,W>1&&s._writev){f.pendingcb-=W-1;const se=f.allNoop?C:qe=>{for(let he=F;he<g.length;++he)g[he].callback(qe)},Le=f.allNoop&&F===0?g:t(g,F);Le.allBuffers=f.allBuffers,k(s,f,!0,f.length,Le,"",se),L(f)}else{do{const{chunk:se,encoding:Le,callback:qe}=g[F];g[F++]=null;const he=N?1:se.length;k(s,f,!1,he,se,Le,qe)}while(F<g.length&&!f.writing);F===g.length?L(f):F>256?(g.splice(0,F),f.bufferedIndex=0):f.bufferedIndex=F}f.bufferProcessing=!1}O.prototype._write=function(s,f,g){if(this._writev)this._writev([{chunk:s,encoding:f}],g);else throw new w("_write()")},O.prototype._writev=null,O.prototype.end=function(s,f,g){const T=this._writableState;typeof s=="function"?(g=s,s=null,f=null):typeof f=="function"&&(g=f,f=null);let N;if(s!=null){const W=G(this,s,f);W instanceof n&&(N=W)}return T.corked&&(T.corked=1,this.uncork()),N||(!T.errored&&!T.ending?(T.ending=!0,xe(this,T,!0),T.ended=!0):T.finished?N=new q("end"):T.destroyed&&(N=new M("end"))),typeof g=="function"&&(N||T.finished?e.nextTick(g,N):T[K].push(g)),this};function Re(s){return s.ending&&!s.destroyed&&s.constructed&&s.length===0&&!s.errored&&s.buffered.length===0&&!s.finished&&!s.writing&&!s.errorEmitted&&!s.closeEmitted}function mt(s,f){let g=!1;function T(N){if(g){y(s,N??$());return}if(g=!0,f.pendingcb--,N){const W=f[K].splice(0);for(let F=0;F<W.length;F++)W[F](N);y(s,N,f.sync)}else Re(f)&&(f.prefinished=!0,s.emit("prefinish"),f.pendingcb++,e.nextTick(ye,s,f))}f.sync=!0,f.pendingcb++;try{s._final(T)}catch(N){T(N)}f.sync=!1}function De(s,f){!f.prefinished&&!f.finalCalled&&(typeof s._final=="function"&&!f.destroyed?(f.finalCalled=!0,mt(s,f)):(f.prefinished=!0,s.emit("prefinish")))}function xe(s,f,g){Re(f)&&(De(s,f),f.pendingcb===0&&(g?(f.pendingcb++,e.nextTick((T,N)=>{Re(N)?ye(T,N):N.pendingcb--},s,f)):Re(f)&&(f.pendingcb++,ye(s,f))))}function ye(s,f){f.pendingcb--,f.finished=!0;const g=f[K].splice(0);for(let T=0;T<g.length;T++)g[T]();if(s.emit("finish"),f.autoDestroy){const T=s._readableState;(!T||T.autoDestroy&&(T.endEmitted||T.readable===!1))&&s.destroy()}}l(O.prototype,{closed:{__proto__:null,get(){return this._writableState?this._writableState.closed:!1}},destroyed:{__proto__:null,get(){return this._writableState?this._writableState.destroyed:!1},set(s){this._writableState&&(this._writableState.destroyed=s)}},writable:{__proto__:null,get(){const s=this._writableState;return!!s&&s.writable!==!1&&!s.destroyed&&!s.errored&&!s.ending&&!s.ended},set(s){this._writableState&&(this._writableState.writable=!!s)}},writableFinished:{__proto__:null,get(){return this._writableState?this._writableState.finished:!1}},writableObjectMode:{__proto__:null,get(){return this._writableState?this._writableState.objectMode:!1}},writableBuffer:{__proto__:null,get(){return this._writableState&&this._writableState.getBuffer()}},writableEnded:{__proto__:null,get(){return this._writableState?this._writableState.ending:!1}},writableNeedDrain:{__proto__:null,get(){const s=this._writableState;return s?!s.destroyed&&!s.ending&&s.needDrain:!1}},writableHighWaterMark:{__proto__:null,get(){return this._writableState&&this._writableState.highWaterMark}},writableCorked:{__proto__:null,get(){return this._writableState?this._writableState.corked:0}},writableLength:{__proto__:null,get(){return this._writableState&&this._writableState.length}},errored:{__proto__:null,enumerable:!1,get(){return this._writableState?this._writableState.errored:null}},writableAborted:{__proto__:null,enumerable:!1,get:function(){return!!(this._writableState.writable!==!1&&(this._writableState.destroyed||this._writableState.errored)&&!this._writableState.finished)}}});const Et=_.destroy;O.prototype.destroy=function(s,f){const g=this._writableState;return!g.destroyed&&(g.bufferedIndex<g.buffered.length||g[K].length)&&e.nextTick(Be,g),Et.call(this,s,f),this},O.prototype._undestroy=_.undestroy,O.prototype._destroy=function(s,f){f(s)},O.prototype[c.captureRejectionSymbol]=function(s){this.destroy(s)};let He;function Ve(){return He===void 0&&(He={}),He}return O.fromWeb=function(s,f){return Ve().newStreamWritableFromWritableStream(s,f)},O.toWeb=function(s){return Ve().newWritableStreamFromStreamWritable(s)},Mt}var Ct,Gn;function sa(){if(Gn)return Ct;Gn=1;const e=Me,t=ve,{isReadable:n,isWritable:r,isIterable:a,isNodeStream:l,isReadableNodeStream:u,isWritableNodeStream:b,isDuplexNodeStream:p}=_e,d=Ee,{AbortError:c,codes:{ERR_INVALID_ARG_TYPE:R,ERR_INVALID_RETURN_VALUE:I}}=ne,{destroyer:_}=Ue,h=ge(),D=yt(),{createDeferredPromise:v}=we,P=Lr,w=globalThis.Blob||t.Blob,$=typeof w<"u"?function(y){return y instanceof w}:function(y){return!1},U=globalThis.AbortController||en().AbortController,{FunctionPrototypeCall:M}=V;class q extends h{constructor(y){super(y),(y==null?void 0:y.readable)===!1&&(this._readableState.readable=!1,this._readableState.ended=!0,this._readableState.endEmitted=!0),(y==null?void 0:y.writable)===!1&&(this._writableState.writable=!1,this._writableState.ending=!0,this._writableState.ended=!0,this._writableState.finished=!0)}}Ct=function j(y,C){if(p(y))return y;if(u(y))return Y({readable:y});if(b(y))return Y({writable:y});if(l(y))return Y({writable:!1,readable:!1});if(typeof y=="function"){const{value:x,write:L,final:O,destroy:G}=B(y);if(a(x))return P(q,x,{objectMode:!0,write:L,final:O,destroy:G});const J=x==null?void 0:x.then;if(typeof J=="function"){let k;const ae=M(J,x,S=>{if(S!=null)throw new I("nully","body",S)},S=>{_(k,S)});return k=new q({objectMode:!0,readable:!1,write:L,final(S){O(async()=>{try{await ae,e.nextTick(S,null)}catch(te){e.nextTick(S,te)}})},destroy:G})}throw new I("Iterable, AsyncIterable or AsyncFunction",C,x)}if($(y))return j(y.arrayBuffer());if(a(y))return P(q,y,{objectMode:!0,writable:!1});if(typeof(y==null?void 0:y.writable)=="object"||typeof(y==null?void 0:y.readable)=="object"){const x=y!=null&&y.readable?u(y==null?void 0:y.readable)?y==null?void 0:y.readable:j(y.readable):void 0,L=y!=null&&y.writable?b(y==null?void 0:y.writable)?y==null?void 0:y.writable:j(y.writable):void 0;return Y({readable:x,writable:L})}const K=y==null?void 0:y.then;if(typeof K=="function"){let x;return M(K,y,L=>{L!=null&&x.push(L),x.push(null)},L=>{_(x,L)}),x=new q({objectMode:!0,writable:!1,read(){}})}throw new R(C,["Blob","ReadableStream","WritableStream","Stream","Iterable","AsyncIterable","Function","{ readable, writable } pair","Promise"],y)};function B(j){let{promise:y,resolve:C}=v();const K=new U,x=K.signal;return{value:j(async function*(){for(;;){const O=y;y=null;const{chunk:G,done:J,cb:k}=await O;if(e.nextTick(k),J)return;if(x.aborted)throw new c(void 0,{cause:x.reason});({promise:y,resolve:C}=v()),yield G}}(),{signal:x}),write(O,G,J){const k=C;C=null,k({chunk:O,done:!1,cb:J})},final(O){const G=C;C=null,G({done:!0,cb:O})},destroy(O,G){K.abort(),G(O)}}}function Y(j){const y=j.readable&&typeof j.readable.read!="function"?D.wrap(j.readable):j.readable,C=j.writable;let K=!!n(y),x=!!r(C),L,O,G,J,k;function ae(S){const te=J;J=null,te?te(S):S&&k.destroy(S)}return k=new q({readableObjectMode:!!(y!=null&&y.readableObjectMode),writableObjectMode:!!(C!=null&&C.writableObjectMode),readable:K,writable:x}),x&&(d(C,S=>{x=!1,S&&_(y,S),ae(S)}),k._write=function(S,te,ce){C.write(S,te)?ce():L=ce},k._final=function(S){C.end(),O=S},C.on("drain",function(){if(L){const S=L;L=null,S()}}),C.on("finish",function(){if(O){const S=O;O=null,S()}})),K&&(d(y,S=>{K=!1,S&&_(y,S),ae(S)}),y.on("readable",function(){if(G){const S=G;G=null,S()}}),y.on("end",function(){k.push(null)}),k._read=function(){for(;;){const S=y.read();if(S===null){G=k._read;return}if(!k.push(S))return}}),k._destroy=function(S,te){!S&&J!==null&&(S=new c),G=null,L=null,O=null,J===null?te(S):(J=te,_(C,S),_(y,S))},k}return Ct}var $t,Hn;function ge(){if(Hn)return $t;Hn=1;const{ObjectDefineProperties:e,ObjectGetOwnPropertyDescriptor:t,ObjectKeys:n,ObjectSetPrototypeOf:r}=V;$t=u;const a=yt(),l=kr();r(u.prototype,a.prototype),r(u,a);{const c=n(l.prototype);for(let R=0;R<c.length;R++){const I=c[R];u.prototype[I]||(u.prototype[I]=l.prototype[I])}}function u(c){if(!(this instanceof u))return new u(c);a.call(this,c),l.call(this,c),c?(this.allowHalfOpen=c.allowHalfOpen!==!1,c.readable===!1&&(this._readableState.readable=!1,this._readableState.ended=!0,this._readableState.endEmitted=!0),c.writable===!1&&(this._writableState.writable=!1,this._writableState.ending=!0,this._writableState.ended=!0,this._writableState.finished=!0)):this.allowHalfOpen=!0}e(u.prototype,{writable:{__proto__:null,...t(l.prototype,"writable")},writableHighWaterMark:{__proto__:null,...t(l.prototype,"writableHighWaterMark")},writableObjectMode:{__proto__:null,...t(l.prototype,"writableObjectMode")},writableBuffer:{__proto__:null,...t(l.prototype,"writableBuffer")},writableLength:{__proto__:null,...t(l.prototype,"writableLength")},writableFinished:{__proto__:null,...t(l.prototype,"writableFinished")},writableCorked:{__proto__:null,...t(l.prototype,"writableCorked")},writableEnded:{__proto__:null,...t(l.prototype,"writableEnded")},writableNeedDrain:{__proto__:null,...t(l.prototype,"writableNeedDrain")},destroyed:{__proto__:null,get(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set(c){this._readableState&&this._writableState&&(this._readableState.destroyed=c,this._writableState.destroyed=c)}}});let b;function p(){return b===void 0&&(b={}),b}u.fromWeb=function(c,R){return p().newStreamDuplexFromReadableWritablePair(c,R)},u.toWeb=function(c){return p().newReadableWritablePairFromDuplex(c)};let d;return u.from=function(c){return d||(d=sa()),d(c,"body")},$t}const{ObjectSetPrototypeOf:Wr,Symbol:fa}=V;var Fr=pe;const{ERR_METHOD_NOT_IMPLEMENTED:ua}=ne.codes,un=ge(),{getHighWaterMark:da}=fn;Wr(pe.prototype,un.prototype);Wr(pe,un);const Xe=fa("kCallback");function pe(e){if(!(this instanceof pe))return new pe(e);const t=e?da(this,e,"readableHighWaterMark",!0):null;t===0&&(e={...e,highWaterMark:null,readableHighWaterMark:t,writableHighWaterMark:e.writableHighWaterMark||0}),un.call(this,e),this._readableState.sync=!1,this[Xe]=null,e&&(typeof e.transform=="function"&&(this._transform=e.transform),typeof e.flush=="function"&&(this._flush=e.flush)),this.on("prefinish",ca)}function Qt(e){typeof this._flush=="function"&&!this.destroyed?this._flush((t,n)=>{if(t){e?e(t):this.destroy(t);return}n!=null&&this.push(n),this.push(null),e&&e()}):(this.push(null),e&&e())}function ca(){this._final!==Qt&&Qt.call(this)}pe.prototype._final=Qt;pe.prototype._transform=function(e,t,n){throw new ua("_transform()")};pe.prototype._write=function(e,t,n){const r=this._readableState,a=this._writableState,l=r.length;this._transform(e,t,(u,b)=>{if(u){n(u);return}b!=null&&this.push(b),a.ended||l===r.length||r.length<r.highWaterMark?n():this[Xe]=n})};pe.prototype._read=function(){if(this[Xe]){const e=this[Xe];this[Xe]=null,e()}};const{ObjectSetPrototypeOf:jr}=V;var Ur=Fe;const dn=Fr;jr(Fe.prototype,dn.prototype);jr(Fe,dn);function Fe(e){if(!(this instanceof Fe))return new Fe(e);dn.call(this,e)}Fe.prototype._transform=function(e,t,n){n(null,e)};const Ke=Me,{ArrayIsArray:ha,Promise:ba,SymbolAsyncIterator:ga}=V,lt=Ee,{once:pa}=we,wa=Ue,Vn=ge(),{aggregateTwoErrors:_a,codes:{ERR_INVALID_ARG_TYPE:zt,ERR_INVALID_RETURN_VALUE:Dt,ERR_MISSING_ARGS:ya,ERR_STREAM_DESTROYED:Sa,ERR_STREAM_PREMATURE_CLOSE:ma},AbortError:Ea}=ne,{validateFunction:Ra,validateAbortSignal:Aa}=dt,{isIterable:Ie,isReadable:xt,isReadableNodeStream:it,isNodeStream:qn,isTransformStream:We,isWebStream:Ta,isReadableStream:Lt,isReadableEnded:Na}=_e,Ia=globalThis.AbortController||en().AbortController;let kt,Wt;function Yn(e,t,n){let r=!1;e.on("close",()=>{r=!0});const a=lt(e,{readable:t,writable:n},l=>{r=!l});return{destroy:l=>{r||(r=!0,wa.destroyer(e,l||new Sa("pipe")))},cleanup:a}}function Pa(e){return Ra(e[e.length-1],"streams[stream.length - 1]"),e.pop()}function Ft(e){if(Ie(e))return e;if(it(e))return Oa(e);throw new zt("val",["Readable","Iterable","AsyncIterable"],e)}async function*Oa(e){Wt||(Wt=yt()),yield*Wt.prototype[ga].call(e)}async function et(e,t,n,{end:r}){let a,l=null;const u=d=>{if(d&&(a=d),l){const c=l;l=null,c()}},b=()=>new ba((d,c)=>{a?c(a):l=()=>{a?c(a):d()}});t.on("drain",u);const p=lt(t,{readable:!1},u);try{t.writableNeedDrain&&await b();for await(const d of e)t.write(d)||await b();r&&t.end(),await b(),n()}catch(d){n(a!==d?_a(a,d):d)}finally{p(),t.off("drain",u)}}async function jt(e,t,n,{end:r}){We(t)&&(t=t.writable);const a=t.getWriter();try{for await(const l of e)await a.ready,a.write(l).catch(()=>{});await a.ready,r&&await a.close(),n()}catch(l){try{await a.abort(l),n(l)}catch(u){n(u)}}}function va(...e){return Br(e,pa(Pa(e)))}function Br(e,t,n){if(e.length===1&&ha(e[0])&&(e=e[0]),e.length<2)throw new ya("streams");const r=new Ia,a=r.signal,l=n==null?void 0:n.signal,u=[];Aa(l,"options.signal");function b(){_(new Ea)}l==null||l.addEventListener("abort",b);let p,d;const c=[];let R=0;function I(P){_(P,--R===0)}function _(P,w){if(P&&(!p||p.code==="ERR_STREAM_PREMATURE_CLOSE")&&(p=P),!(!p&&!w)){for(;c.length;)c.shift()(p);l==null||l.removeEventListener("abort",b),r.abort(),w&&(p||u.forEach($=>$()),Ke.nextTick(t,p,d))}}let h;for(let P=0;P<e.length;P++){const w=e[P],$=P<e.length-1,U=P>0,M=$||(n==null?void 0:n.end)!==!1,q=P===e.length-1;if(qn(w)){let B=function(Y){Y&&Y.name!=="AbortError"&&Y.code!=="ERR_STREAM_PREMATURE_CLOSE"&&I(Y)};if(M){const{destroy:Y,cleanup:j}=Yn(w,$,U);c.push(Y),xt(w)&&q&&u.push(j)}w.on("error",B),xt(w)&&q&&u.push(()=>{w.removeListener("error",B)})}if(P===0)if(typeof w=="function"){if(h=w({signal:a}),!Ie(h))throw new Dt("Iterable, AsyncIterable or Stream","source",h)}else Ie(w)||it(w)||We(w)?h=w:h=Vn.from(w);else if(typeof w=="function"){if(We(h)){var D;h=Ft((D=h)===null||D===void 0?void 0:D.readable)}else h=Ft(h);if(h=w(h,{signal:a}),$){if(!Ie(h,!0))throw new Dt("AsyncIterable",`transform[${P-1}]`,h)}else{var v;kt||(kt=Ur);const B=new kt({objectMode:!0}),Y=(v=h)===null||v===void 0?void 0:v.then;if(typeof Y=="function")R++,Y.call(h,C=>{d=C,C!=null&&B.write(C),M&&B.end(),Ke.nextTick(I)},C=>{B.destroy(C),Ke.nextTick(I,C)});else if(Ie(h,!0))R++,et(h,B,I,{end:M});else if(Lt(h)||We(h)){const C=h.readable||h;R++,et(C,B,I,{end:M})}else throw new Dt("AsyncIterable or Promise","destination",h);h=B;const{destroy:j,cleanup:y}=Yn(h,!1,!0);c.push(j),q&&u.push(y)}}else if(qn(w)){if(it(h)){R+=2;const B=Ma(h,w,I,{end:M});xt(w)&&q&&u.push(B)}else if(We(h)||Lt(h)){const B=h.readable||h;R++,et(B,w,I,{end:M})}else if(Ie(h))R++,et(h,w,I,{end:M});else throw new zt("val",["Readable","Iterable","AsyncIterable","ReadableStream","TransformStream"],h);h=w}else if(Ta(w)){if(it(h))R++,jt(Ft(h),w,I,{end:M});else if(Lt(h)||Ie(h))R++,jt(h,w,I,{end:M});else if(We(h))R++,jt(h.readable,w,I,{end:M});else throw new zt("val",["Readable","Iterable","AsyncIterable","ReadableStream","TransformStream"],h);h=w}else h=Vn.from(w)}return(a!=null&&a.aborted||l!=null&&l.aborted)&&Ke.nextTick(b),h}function Ma(e,t,n,{end:r}){let a=!1;if(t.on("close",()=>{a||n(new ma)}),e.pipe(t,{end:!1}),r){let l=function(){a=!0,t.end()};Na(e)?Ke.nextTick(l):e.once("end",l)}else n();return lt(e,{readable:!0,writable:!1},l=>{const u=e._readableState;l&&l.code==="ERR_STREAM_PREMATURE_CLOSE"&&u&&u.ended&&!u.errored&&!u.errorEmitted?e.once("end",n).once("error",n):n(l)}),lt(t,{readable:!1,writable:!0},n)}var cn={pipelineImpl:Br,pipeline:va};const{pipeline:Ca}=cn,tt=ge(),{destroyer:$a}=Ue,{isNodeStream:nt,isReadable:Kn,isWritable:Jn,isWebStream:Ut,isTransformStream:Ne,isWritableStream:Xn,isReadableStream:Qn}=_e,{AbortError:Da,codes:{ERR_INVALID_ARG_VALUE:zn,ERR_MISSING_ARGS:xa}}=ne,La=Ee;var Gr=function(...t){if(t.length===0)throw new xa("streams");if(t.length===1)return tt.from(t[0]);const n=[...t];if(typeof t[0]=="function"&&(t[0]=tt.from(t[0])),typeof t[t.length-1]=="function"){const _=t.length-1;t[_]=tt.from(t[_])}for(let _=0;_<t.length;++_)if(!(!nt(t[_])&&!Ut(t[_]))){if(_<t.length-1&&!(Kn(t[_])||Qn(t[_])||Ne(t[_])))throw new zn(`streams[${_}]`,n[_],"must be readable");if(_>0&&!(Jn(t[_])||Xn(t[_])||Ne(t[_])))throw new zn(`streams[${_}]`,n[_],"must be writable")}let r,a,l,u,b;function p(_){const h=u;u=null,h?h(_):_?b.destroy(_):!I&&!R&&b.destroy()}const d=t[0],c=Ca(t,p),R=!!(Jn(d)||Xn(d)||Ne(d)),I=!!(Kn(c)||Qn(c)||Ne(c));if(b=new tt({writableObjectMode:!!(d!=null&&d.writableObjectMode),readableObjectMode:!!(c!=null&&c.writableObjectMode),writable:R,readable:I}),R){if(nt(d))b._write=function(h,D,v){d.write(h,D)?v():r=v},b._final=function(h){d.end(),a=h},d.on("drain",function(){if(r){const h=r;r=null,h()}});else if(Ut(d)){const D=(Ne(d)?d.writable:d).getWriter();b._write=async function(v,P,w){try{await D.ready,D.write(v).catch(()=>{}),w()}catch($){w($)}},b._final=async function(v){try{await D.ready,D.close().catch(()=>{}),a=v}catch(P){v(P)}}}const _=Ne(c)?c.readable:c;La(_,()=>{if(a){const h=a;a=null,h()}})}if(I){if(nt(c))c.on("readable",function(){if(l){const _=l;l=null,_()}}),c.on("end",function(){b.push(null)}),b._read=function(){for(;;){const _=c.read();if(_===null){l=b._read;return}if(!b.push(_))return}};else if(Ut(c)){const h=(Ne(c)?c.readable:c).getReader();b._read=async function(){for(;;)try{const{value:D,done:v}=await h.read();if(!b.push(D))return;if(v){b.push(null);return}}catch{return}}}}return b._destroy=function(_,h){!_&&u!==null&&(_=new Da),l=null,r=null,a=null,u===null?h(_):(u=h,nt(c)&&$a(c,_))},b};const Hr=globalThis.AbortController||en().AbortController,{codes:{ERR_INVALID_ARG_VALUE:ka,ERR_INVALID_ARG_TYPE:Qe,ERR_MISSING_ARGS:Wa,ERR_OUT_OF_RANGE:Fa},AbortError:ue}=ne,{validateAbortSignal:Ce,validateInteger:ja,validateObject:$e}=dt,Ua=V.Symbol("kWeak"),{finished:Ba}=Ee,Ga=Gr,{addAbortSignalNoValidate:Ha}=_t,{isWritable:Va,isNodeStream:qa}=_e,{ArrayPrototypePush:Ya,MathFloor:Ka,Number:Ja,NumberIsNaN:Xa,Promise:Zn,PromiseReject:er,PromisePrototypeThen:Qa,Symbol:Vr}=V,st=Vr("kEmpty"),tr=Vr("kEof");function za(e,t){if(t!=null&&$e(t,"options"),(t==null?void 0:t.signal)!=null&&Ce(t.signal,"options.signal"),qa(e)&&!Va(e))throw new ka("stream",e,"must be writable");const n=Ga(this,e);return t!=null&&t.signal&&Ha(t.signal,n),n}function St(e,t){if(typeof e!="function")throw new Qe("fn",["Function","AsyncFunction"],e);t!=null&&$e(t,"options"),(t==null?void 0:t.signal)!=null&&Ce(t.signal,"options.signal");let n=1;return(t==null?void 0:t.concurrency)!=null&&(n=Ka(t.concurrency)),ja(n,"concurrency",1),(async function*(){var a,l;const u=new Hr,b=this,p=[],d=u.signal,c={signal:d},R=()=>u.abort();t!=null&&(a=t.signal)!==null&&a!==void 0&&a.aborted&&R(),t==null||(l=t.signal)===null||l===void 0||l.addEventListener("abort",R);let I,_,h=!1;function D(){h=!0}async function v(){try{for await(let $ of b){var P;if(h)return;if(d.aborted)throw new ue;try{$=e($,c)}catch(U){$=er(U)}$!==st&&(typeof((P=$)===null||P===void 0?void 0:P.catch)=="function"&&$.catch(D),p.push($),I&&(I(),I=null),!h&&p.length&&p.length>=n&&await new Zn(U=>{_=U}))}p.push(tr)}catch($){const U=er($);Qa(U,void 0,D),p.push(U)}finally{var w;h=!0,I&&(I(),I=null),t==null||(w=t.signal)===null||w===void 0||w.removeEventListener("abort",R)}}v();try{for(;;){for(;p.length>0;){const P=await p[0];if(P===tr)return;if(d.aborted)throw new ue;P!==st&&(yield P),p.shift(),_&&(_(),_=null)}await new Zn(P=>{I=P})}}finally{u.abort(),h=!0,_&&(_(),_=null)}}).call(this)}function Za(e=void 0){return e!=null&&$e(e,"options"),(e==null?void 0:e.signal)!=null&&Ce(e.signal,"options.signal"),(async function*(){let n=0;for await(const a of this){var r;if(e!=null&&(r=e.signal)!==null&&r!==void 0&&r.aborted)throw new ue({cause:e.signal.reason});yield[n++,a]}}).call(this)}async function qr(e,t=void 0){for await(const n of hn.call(this,e,t))return!0;return!1}async function el(e,t=void 0){if(typeof e!="function")throw new Qe("fn",["Function","AsyncFunction"],e);return!await qr.call(this,async(...n)=>!await e(...n),t)}async function tl(e,t){for await(const n of hn.call(this,e,t))return n}async function nl(e,t){if(typeof e!="function")throw new Qe("fn",["Function","AsyncFunction"],e);async function n(r,a){return await e(r,a),st}for await(const r of St.call(this,n,t));}function hn(e,t){if(typeof e!="function")throw new Qe("fn",["Function","AsyncFunction"],e);async function n(r,a){return await e(r,a)?r:st}return St.call(this,n,t)}class rl extends Wa{constructor(){super("reduce"),this.message="Reduce of an empty stream requires an initial value"}}async function il(e,t,n){var r;if(typeof e!="function")throw new Qe("reducer",["Function","AsyncFunction"],e);n!=null&&$e(n,"options"),(n==null?void 0:n.signal)!=null&&Ce(n.signal,"options.signal");let a=arguments.length>1;if(n!=null&&(r=n.signal)!==null&&r!==void 0&&r.aborted){const d=new ue(void 0,{cause:n.signal.reason});throw this.once("error",()=>{}),await Ba(this.destroy(d)),d}const l=new Hr,u=l.signal;if(n!=null&&n.signal){const d={once:!0,[Ua]:this};n.signal.addEventListener("abort",()=>l.abort(),d)}let b=!1;try{for await(const d of this){var p;if(b=!0,n!=null&&(p=n.signal)!==null&&p!==void 0&&p.aborted)throw new ue;a?t=await e(t,d,{signal:u}):(t=d,a=!0)}if(!b&&!a)throw new rl}finally{l.abort()}return t}async function ol(e){e!=null&&$e(e,"options"),(e==null?void 0:e.signal)!=null&&Ce(e.signal,"options.signal");const t=[];for await(const r of this){var n;if(e!=null&&(n=e.signal)!==null&&n!==void 0&&n.aborted)throw new ue(void 0,{cause:e.signal.reason});Ya(t,r)}return t}function al(e,t){const n=St.call(this,e,t);return(async function*(){for await(const a of n)yield*a}).call(this)}function Yr(e){if(e=Ja(e),Xa(e))return 0;if(e<0)throw new Fa("number",">= 0",e);return e}function ll(e,t=void 0){return t!=null&&$e(t,"options"),(t==null?void 0:t.signal)!=null&&Ce(t.signal,"options.signal"),e=Yr(e),(async function*(){var r;if(t!=null&&(r=t.signal)!==null&&r!==void 0&&r.aborted)throw new ue;for await(const l of this){var a;if(t!=null&&(a=t.signal)!==null&&a!==void 0&&a.aborted)throw new ue;e--<=0&&(yield l)}}).call(this)}function sl(e,t=void 0){return t!=null&&$e(t,"options"),(t==null?void 0:t.signal)!=null&&Ce(t.signal,"options.signal"),e=Yr(e),(async function*(){var r;if(t!=null&&(r=t.signal)!==null&&r!==void 0&&r.aborted)throw new ue;for await(const l of this){var a;if(t!=null&&(a=t.signal)!==null&&a!==void 0&&a.aborted)throw new ue;if(e-- >0)yield l;else return}}).call(this)}tn.streamReturningOperators={asIndexedPairs:Za,drop:ll,filter:hn,flatMap:al,map:St,take:sl,compose:za};tn.promiseReturningOperators={every:el,forEach:nl,reduce:il,toArray:ol,some:qr,find:tl};var Bt,nr;function Kr(){if(nr)return Bt;nr=1;const{ArrayPrototypePop:e,Promise:t}=V,{isIterable:n,isNodeStream:r,isWebStream:a}=_e,{pipelineImpl:l}=cn,{finished:u}=Ee;Jr();function b(...p){return new t((d,c)=>{let R,I;const _=p[p.length-1];if(_&&typeof _=="object"&&!r(_)&&!n(_)&&!a(_)){const h=e(p);R=h.signal,I=h.end}l(p,(h,D)=>{h?c(h):d(D)},{signal:R,end:I})})}return Bt={finished:u,pipeline:b},Bt}var rr;function Jr(){if(rr)return Nt.exports;rr=1;const{Buffer:e}=ve,{ObjectDefineProperty:t,ObjectKeys:n,ReflectApply:r}=V,{promisify:{custom:a}}=we,{streamReturningOperators:l,promiseReturningOperators:u}=tn,{codes:{ERR_ILLEGAL_CONSTRUCTOR:b}}=ne,p=Gr,{pipeline:d}=cn,{destroyer:c}=Ue,R=Ee,I=Kr(),_=_e,h=Nt.exports=sn.Stream;h.isDisturbed=_.isDisturbed,h.isErrored=_.isErrored,h.isReadable=_.isReadable,h.Readable=yt();for(const v of n(l)){let w=function(...$){if(new.target)throw b();return h.Readable.from(r(P,this,$))};const P=l[v];t(w,"name",{__proto__:null,value:P.name}),t(w,"length",{__proto__:null,value:P.length}),t(h.Readable.prototype,v,{__proto__:null,value:w,enumerable:!1,configurable:!0,writable:!0})}for(const v of n(u)){let w=function(...$){if(new.target)throw b();return r(P,this,$)};const P=u[v];t(w,"name",{__proto__:null,value:P.name}),t(w,"length",{__proto__:null,value:P.length}),t(h.Readable.prototype,v,{__proto__:null,value:w,enumerable:!1,configurable:!0,writable:!0})}h.Writable=kr(),h.Duplex=ge(),h.Transform=Fr,h.PassThrough=Ur,h.pipeline=d;const{addAbortSignal:D}=_t;return h.addAbortSignal=D,h.finished=R,h.destroy=c,h.compose=p,t(h,"promises",{__proto__:null,configurable:!0,enumerable:!0,get(){return I}}),t(d,a,{__proto__:null,enumerable:!0,get(){return I.pipeline}}),t(R,a,{__proto__:null,enumerable:!0,get(){return I.finished}}),h.Stream=h,h._isUint8Array=function(P){return P instanceof Uint8Array},h._uint8ArrayToBuffer=function(P){return e.from(P.buffer,P.byteOffset,P.byteLength)},Nt.exports}(function(e){const t=Jr(),n=Kr(),r=t.Readable.destroy;e.exports=t.Readable,e.exports._uint8ArrayToBuffer=t._uint8ArrayToBuffer,e.exports._isUint8Array=t._isUint8Array,e.exports.isDisturbed=t.isDisturbed,e.exports.isErrored=t.isErrored,e.exports.isReadable=t.isReadable,e.exports.Readable=t.Readable,e.exports.Writable=t.Writable,e.exports.Duplex=t.Duplex,e.exports.Transform=t.Transform,e.exports.PassThrough=t.PassThrough,e.exports.addAbortSignal=t.addAbortSignal,e.exports.finished=t.finished,e.exports.destroy=t.destroy,e.exports.destroy=r,e.exports.pipeline=t.pipeline,e.exports.compose=t.compose,Object.defineProperty(t,"promises",{configurable:!0,enumerable:!0,get(){return n}}),e.exports.Stream=t.Stream,e.exports.default=e.exports})(oi);function ir(e){let t=!1,n=0,r;try{r=window[e],t=!0,n=r.length;const a="__storage_test__";return r.setItem(a,a),r.removeItem(a),!0}catch(a){const l=a;return l&&(l.code===22||l.code===1014||l.name==="QuotaExceededError"||l.name==="NS_ERROR_DOM_QUOTA_REACHED")&&t&&n!==0}}class fl{constructor(){Q(this,"store",{})}getItem(t){return this.store[t]||null}setItem(t,n){this.store[t]=n}}class ul{constructor(t,n){Q(this,"storage",void 0),Q(this,"_storeKey",void 0),this.storage=n,this._storeKey=t;try{n.getItem(t)||this.resetStore()}catch{}}static getInstance(t){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"local";if(!this.instance){let r;n==="local"&&ir("localStorage")?r=window.localStorage:n==="session"&&ir("sessionStorage")?r=window.sessionStorage:r=new fl,this.instance=new this(t,r)}return this.instance}toJSON(){return this.storage.getItem(this._storeKey)}resetStore(){const t=this.getStore();return this.storage.setItem(this._storeKey,JSON.stringify({})),t}getStore(){return JSON.parse(this.storage.getItem(this._storeKey)||"{}")}get(t){return JSON.parse(this.storage.getItem(this._storeKey)||"{}")[t]}set(t,n){const r=JSON.parse(this.storage.getItem(this._storeKey)||"{}");r[t]=n,this.storage.setItem(this._storeKey,JSON.stringify(r))}}Q(ul,"instance",void 0);me(me({},Zr),ei);const dl=ar.getLogger("http-helpers");dl.setLevel(ti.levels.INFO);class cl extends Error{}cl.prototype.name="InvalidTokenError";const hl={EIP155:"eip155",SOLANA:"solana",OTHER:"other"},bl={EIP155:"eip155",SOLANA:"solana",XRPL:"xrpl",MULTICHAIN:"multichain"};class ze extends ni{constructor(t,n){super(n),Q(this,"code",void 0),Q(this,"message",void 0),this.code=t,this.message=n||"",Object.defineProperty(this,"name",{value:"Web3AuthError"})}toJSON(){return{name:this.name,code:this.code,message:this.message}}toString(){return JSON.stringify(this.toJSON())}}class H extends ze{constructor(t,n){super(t,n),Object.defineProperty(this,"name",{value:"WalletInitializationError"})}static fromCode(t){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";return new H(t,`${H.messages[t]}, ${n}`)}static notFound(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return H.fromCode(5001,t)}static notInstalled(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return H.fromCode(5002,t)}static notReady(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return H.fromCode(5003,t)}static windowBlocked(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return H.fromCode(5004,t)}static windowClosed(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return H.fromCode(5005,t)}static incompatibleChainNameSpace(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return H.fromCode(5006,t)}static duplicateAdapterError(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return H.fromCode(5007,t)}static invalidProviderConfigError(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return H.fromCode(5008,t)}static providerNotReadyError(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return H.fromCode(5009,t)}static rpcConnectionError(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return H.fromCode(5010,t)}static invalidParams(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return H.fromCode(5011,t)}static invalidNetwork(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return H.fromCode(5013,t)}}Q(H,"messages",{5e3:"Custom",5001:"Wallet is not found",5002:"Wallet is not installed",5003:"Wallet is not ready yet",5004:"Wallet window is blocked",5005:"Wallet window has been closed by the user",5006:"Incompatible chain namespace provided",5007:"Adapter has already been included",5008:"Invalid provider Config",5009:"Provider is not ready yet",5010:"Failed to connect with rpc url",5011:"Invalid params passed in",5013:"Invalid network provided"});class X extends ze{constructor(t,n){super(t,n),Object.defineProperty(this,"name",{value:"WalletLoginError"})}static fromCode(t){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";return new X(t,`${X.messages[t]}. ${n}`)}static connectionError(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return X.fromCode(5111,t)}static disconnectionError(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return X.fromCode(5112,t)}static notConnectedError(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return X.fromCode(5113,t)}static popupClosed(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return X.fromCode(5114,t)}static mfaEnabled(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return X.fromCode(5115,t)}static chainConfigNotAdded(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return X.fromCode(5116,t)}static unsupportedOperation(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return X.fromCode(5117,t)}static coreKitKeyNotFound(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return X.fromCode(5118,t)}static userNotLoggedIn(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return X.fromCode(5119,t)}}Q(X,"messages",{5e3:"Custom",5111:"Failed to connect with wallet",5112:"Failed to disconnect from wallet",5113:"Wallet is not connected",5114:"Wallet popup has been closed by the user",5115:"User has already enabled mfa, please use the @web3auth/web3auth-web sdk for login with mfa",5116:"Chain config has not been added. Please add the chain config before calling switchChain",5117:"Unsupported operation",5118:"useCoreKitKey flag is enabled but coreKitKey is not available",5119:"User not logged in."});class le extends ze{constructor(t,n){super(t,n),Object.defineProperty(this,"name",{value:"WalletOperationsError"})}static fromCode(t){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";return new le(t,`${le.messages[t]}, ${n}`)}static chainIDNotAllowed(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return le.fromCode(5201,t)}static operationNotAllowed(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return le.fromCode(5202,t)}static chainNamespaceNotAllowed(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return le.fromCode(5203,t)}}Q(le,"messages",{5e3:"Custom",5201:"Provided chainId is not allowed",5202:"This operation is not allowed"});class bn extends ze{constructor(t,n){super(t,n),Object.defineProperty(this,"name",{value:"WalletProviderError"})}static fromCode(t){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";return new le(t,`${bn.messages[t]}, ${n}`)}static invalidRequestArgs(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return le.fromCode(5301,t)}static invalidRequestMethod(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return le.fromCode(5302,t)}static invalidRequestParams(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return le.fromCode(5303,t)}}Q(bn,"messages",{5e3:"Custom",5301:"Expected a single, non-array, object argument.",5302:"'args.method' must be a non-empty string.",5303:"'args.params' must be an object or array if provided."});const ft={OPENLOGIN:"openlogin",WALLET_CONNECT_V2:"wallet-connect-v2"},Je=me({TORUS_SOLANA:"torus-solana",PHANTOM:"phantom",SOLFLARE:"solflare",SLOPE:"slope"},ft),ot=me({TORUS_EVM:"torus-evm",METAMASK:"metamask",COINBASE:"coinbase"},ft),rt=me(me({},ot),Je);ft.OPENLOGIN+"",ft.WALLET_CONNECT_V2+"",Je.TORUS_SOLANA+"",Je.PHANTOM+"",Je.SOLFLARE+"",Je.SLOPE+"",ot.TORUS_EVM+"",ot.METAMASK+"",ot.COINBASE+"";const gl={EXTERNAL:"external",IN_APP:"in_app"},ie={NOT_READY:"not_ready",READY:"ready",CONNECTING:"connecting",CONNECTED:"connected",DISCONNECTED:"disconnected",ERRORED:"errored"},ke=me(me({},ie),{},{ADAPTER_DATA_UPDATED:"adapter_data_updated",CACHE_CLEAR:"cache_clear"});var or=ar.getLogger("web3auth-logger");function Xr(e,t,n){return new Promise((r,a)=>{n>0?setTimeout(async()=>{const l=await e();l&&r(l),l||Xr(e,t,n-1).then(u=>(r(u),u)).catch(u=>a(u))},t):r(!1)})}const pl=async function(){var e;let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{interval:1e3,count:3};return typeof window<"u"&&!!((e=window.solana)!==null&&e!==void 0&&e.isPhantom)||await Xr(()=>{var a;return(a=window.solana)===null||a===void 0?void 0:a.isPhantom},t.interval,t.count)?window.solana:null};class El extends ri{constructor(){super(...arguments),Q(this,"name",rt.PHANTOM),Q(this,"adapterNamespace",bl.SOLANA),Q(this,"currentChainNamespace",hl.SOLANA),Q(this,"type",gl.EXTERNAL),Q(this,"status",ie.NOT_READY),Q(this,"_wallet",null),Q(this,"phantomProvider",null),Q(this,"_onDisconnect",()=>{this._wallet&&(this._wallet.off("disconnect",this._onDisconnect),this.rehydrated=!1,this.status=this.status===ie.CONNECTED?ie.READY:ie.NOT_READY,this.emit(ke.DISCONNECTED))})}get isWalletConnected(){var t;return!!((t=this._wallet)!==null&&t!==void 0&&t.isConnected&&this.status===ie.CONNECTED)}get provider(){return this.status!==ie.NOT_READY&&this.phantomProvider?this.phantomProvider:null}set provider(t){throw new Error("Not implemented")}async init(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(await super.init(t),super.checkInitializationRequirements(),this._wallet=await pl({interval:500,count:3}),!this._wallet)throw H.notInstalled();this.phantomProvider=new ii({config:{chainConfig:this.chainConfig}}),this.status=ie.READY,this.emit(ke.READY,rt.PHANTOM);try{or.debug("initializing phantom adapter"),t.autoConnect&&(this.rehydrated=!0,await this.connect())}catch(n){or.error("Failed to connect with cached phantom provider",n),this.emit("ERRORED",n)}}async connect(){var t=this;try{if(super.checkConnectionRequirements(),this.status=ie.CONNECTING,this.emit(ke.CONNECTING,{adapter:rt.PHANTOM}),!this._wallet)throw H.notInstalled();if(this._wallet.isConnected)await this.connectWithProvider(this._wallet);else{const n=this._wallet._handleDisconnect;try{await new Promise((r,a)=>{const l=async()=>{await this.connectWithProvider(this._wallet),r(this.provider)};if(!this._wallet){a(H.notInstalled());return}this._wallet.once("connect",l),this._wallet._handleDisconnect=function(){a(H.windowClosed());for(var u=arguments.length,b=new Array(u),p=0;p<u;p++)b[p]=arguments[p];return n.apply(t._wallet,b)},this._wallet.connect().catch(u=>{a(u)})})}catch(r){throw r instanceof ze?r:X.connectionError(r==null?void 0:r.message)}finally{this._wallet._handleDisconnect=n}}if(!this._wallet.publicKey)throw X.connectionError();return this._wallet.on("disconnect",this._onDisconnect),this.provider}catch(n){throw this.status=ie.READY,this.rehydrated=!1,this.emit(ke.ERRORED,n),n}}async disconnect(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{cleanup:!1};await super.disconnectSession();try{var n;await((n=this._wallet)===null||n===void 0?void 0:n.disconnect()),t.cleanup&&(this.status=ie.NOT_READY,this.phantomProvider=null,this._wallet=null),await super.disconnect()}catch(r){this.emit(ke.ERRORED,X.disconnectionError(r==null?void 0:r.message))}}async getUserInfo(){if(!this.isWalletConnected)throw X.notConnectedError("Not connected with wallet, Please login/connect first");return{}}async addChain(t){var n;let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;super.checkAddChainRequirements(t,r),(n=this.phantomProvider)===null||n===void 0||n.addChain(t),this.addChainConfig(t)}async switchChain(t){var n;let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;super.checkSwitchChainRequirements(t,r),await((n=this.phantomProvider)===null||n===void 0?void 0:n.switchChain(t)),this.setAdapterSettings({chainConfig:this.getChainConfig(t.chainId)})}async connectWithProvider(t){if(!this.phantomProvider)throw X.connectionError("No phantom provider");return await this.phantomProvider.setupProvider(t),this.status=ie.CONNECTED,this.emit(ke.CONNECTED,{adapter:rt.PHANTOM,reconnected:this.rehydrated}),this.provider}}export{El as PhantomAdapter};
