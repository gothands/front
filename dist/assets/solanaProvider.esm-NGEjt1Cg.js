import{H as Bc,w as ci,x as vs,y as Tc,z as zu,A as Cc,B as En,D as Pc,E as As,F as Rs,G as Qr,I as Or,J as as,K as ns,L as Ut,M as oa,N as Gu,O as Is,Q as Vu,R as Yu,S as Zu,U as Lc,V as Oc,b as $e,c as _r,e as Fs,s as Xu,r as po,d as Zt,_ as Ot,f as tt,h as Ju,T as Qu,j as el,l as Nc,a as tl,C as nl,v as cs,W as Xe,X as rl,Y as sl,Z as kn,$ as il,a0 as ol,i as mt,a1 as Mc,a2 as Uc,a3 as jt,a4 as aa,a5 as al,a6 as cl,a7 as fl,a8 as ul,a9 as go,aa as ll}from"./index-L3ozMu8u.js";function dl(n,e,t,r){if(typeof n.setBigUint64=="function")return n.setBigUint64(e,t,r);const s=BigInt(32),i=BigInt(4294967295),o=Number(t>>s&i),c=Number(t&i),f=r?4:0,l=r?0:4;n.setUint32(e+f,o,r),n.setUint32(e+l,c,r)}class Dc extends Bc{constructor(e,t,r,s){super(),this.blockLen=e,this.outputLen=t,this.padOffset=r,this.isLE=s,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=ci(this.buffer)}update(e){vs(this);const{view:t,buffer:r,blockLen:s}=this;e=Tc(e);const i=e.length;for(let o=0;o<i;){const c=Math.min(s-this.pos,i-o);if(c===s){const f=ci(e);for(;s<=i-o;o+=s)this.process(f,o);continue}r.set(e.subarray(o,o+c),this.pos),this.pos+=c,o+=c,this.pos===s&&(this.process(t,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){vs(this),zu(e,this),this.finished=!0;const{buffer:t,view:r,blockLen:s,isLE:i}=this;let{pos:o}=this;t[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>s-o&&(this.process(r,0),o=0);for(let x=o;x<s;x++)t[x]=0;dl(r,s-8,BigInt(this.length*8),i),this.process(r,0);const c=ci(e),f=this.outputLen;if(f%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const l=f/4,p=this.get();if(l>p.length)throw new Error("_sha2: outputLen bigger than state");for(let x=0;x<l;x++)c.setUint32(4*x,p[x],i)}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const r=e.slice(0,t);return this.destroy(),r}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:t,buffer:r,length:s,finished:i,destroyed:o,pos:c}=this;return e.length=s,e.pos=c,e.finished=i,e.destroyed=o,s%t&&e.buffer.set(r),e}}const hl=(n,e,t)=>n&e^~n&t,pl=(n,e,t)=>n&e^n&t^e&t,gl=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Jn=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Qn=new Uint32Array(64);class yl extends Dc{constructor(){super(64,32,8,!1),this.A=Jn[0]|0,this.B=Jn[1]|0,this.C=Jn[2]|0,this.D=Jn[3]|0,this.E=Jn[4]|0,this.F=Jn[5]|0,this.G=Jn[6]|0,this.H=Jn[7]|0}get(){const{A:e,B:t,C:r,D:s,E:i,F:o,G:c,H:f}=this;return[e,t,r,s,i,o,c,f]}set(e,t,r,s,i,o,c,f){this.A=e|0,this.B=t|0,this.C=r|0,this.D=s|0,this.E=i|0,this.F=o|0,this.G=c|0,this.H=f|0}process(e,t){for(let x=0;x<16;x++,t+=4)Qn[x]=e.getUint32(t,!1);for(let x=16;x<64;x++){const k=Qn[x-15],E=Qn[x-2],b=En(k,7)^En(k,18)^k>>>3,_=En(E,17)^En(E,19)^E>>>10;Qn[x]=_+Qn[x-7]+b+Qn[x-16]|0}let{A:r,B:s,C:i,D:o,E:c,F:f,G:l,H:p}=this;for(let x=0;x<64;x++){const k=En(c,6)^En(c,11)^En(c,25),E=p+k+hl(c,f,l)+gl[x]+Qn[x]|0,_=(En(r,2)^En(r,13)^En(r,22))+pl(r,s,i)|0;p=l,l=f,f=c,c=o+E|0,o=i,i=s,s=r,r=E+_|0}r=r+this.A|0,s=s+this.B|0,i=i+this.C|0,o=o+this.D|0,c=c+this.E|0,f=f+this.F|0,l=l+this.G|0,p=p+this.H|0,this.set(r,s,i,o,c,f,l,p)}roundClean(){Qn.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}const zi=Cc(()=>new yl);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Dt=BigInt(0),Et=BigInt(1),pr=BigInt(2),bl=BigInt(3),Gi=BigInt(4),ca=BigInt(5),fa=BigInt(8);BigInt(9);BigInt(16);function _t(n,e){const t=n%e;return t>=Dt?t:e+t}function wl(n,e,t){if(t<=Dt||e<Dt)throw new Error("Expected power/modulo > 0");if(t===Et)return Dt;let r=Et;for(;e>Dt;)e&Et&&(r=r*n%t),n=n*n%t,e>>=Et;return r}function It(n,e,t){let r=n;for(;e-- >Dt;)r*=r,r%=t;return r}function Vi(n,e){if(n===Dt||e<=Dt)throw new Error(`invert: expected positive integers, got n=${n} mod=${e}`);let t=_t(n,e),r=e,s=Dt,i=Et;for(;t!==Dt;){const c=r/t,f=r%t,l=s-i*c;r=t,t=f,s=i,i=l}if(r!==Et)throw new Error("invert: does not exist");return _t(s,e)}function ml(n){const e=(n-Et)/pr;let t,r,s;for(t=n-Et,r=0;t%pr===Dt;t/=pr,r++);for(s=pr;s<n&&wl(s,e,n)!==n-Et;s++);if(r===1){const o=(n+Et)/Gi;return function(f,l){const p=f.pow(l,o);if(!f.eql(f.sqr(p),l))throw new Error("Cannot find square root");return p}}const i=(t+Et)/pr;return function(c,f){if(c.pow(f,e)===c.neg(c.ONE))throw new Error("Cannot find square root");let l=r,p=c.pow(c.mul(c.ONE,s),t),x=c.pow(f,i),k=c.pow(f,t);for(;!c.eql(k,c.ONE);){if(c.eql(k,c.ZERO))return c.ZERO;let E=1;for(let _=c.sqr(k);E<l&&!c.eql(_,c.ONE);E++)_=c.sqr(_);const b=c.pow(p,Et<<BigInt(l-E-1));p=c.sqr(b),x=c.mul(x,b),k=c.mul(k,p),l=E}return x}}function xl(n){if(n%Gi===bl){const e=(n+Et)/Gi;return function(r,s){const i=r.pow(s,e);if(!r.eql(r.sqr(i),s))throw new Error("Cannot find square root");return i}}if(n%fa===ca){const e=(n-ca)/fa;return function(r,s){const i=r.mul(s,pr),o=r.pow(i,e),c=r.mul(s,o),f=r.mul(r.mul(c,pr),o),l=r.mul(c,r.sub(f,r.ONE));if(!r.eql(r.sqr(l),s))throw new Error("Cannot find square root");return l}}return ml(n)}const _l=(n,e)=>(_t(n,e)&Et)===Et,Sl=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function El(n){const e={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},t=Sl.reduce((r,s)=>(r[s]="function",r),e);return as(n,t)}function vl(n,e,t){if(t<Dt)throw new Error("Expected power > 0");if(t===Dt)return n.ONE;if(t===Et)return e;let r=n.ONE,s=e;for(;t>Dt;)t&Et&&(r=n.mul(r,s)),s=n.sqr(s),t>>=Et;return r}function Al(n,e){const t=new Array(e.length),r=e.reduce((i,o,c)=>n.is0(o)?i:(t[c]=i,n.mul(i,o)),n.ONE),s=n.inv(r);return e.reduceRight((i,o,c)=>n.is0(o)?i:(t[c]=n.mul(i,t[c]),n.mul(i,o)),s),t}function $c(n,e){const t=e!==void 0?e:n.toString(2).length,r=Math.ceil(t/8);return{nBitLength:t,nByteLength:r}}function Fc(n,e,t=!1,r={}){if(n<=Dt)throw new Error(`Expected Field ORDER > 0, got ${n}`);const{nBitLength:s,nByteLength:i}=$c(n,e);if(i>2048)throw new Error("Field lengths over 2048 bytes are not supported");const o=xl(n),c=Object.freeze({ORDER:n,BITS:s,BYTES:i,MASK:Pc(s),ZERO:Dt,ONE:Et,create:f=>_t(f,n),isValid:f=>{if(typeof f!="bigint")throw new Error(`Invalid field element: expected bigint, got ${typeof f}`);return Dt<=f&&f<n},is0:f=>f===Dt,isOdd:f=>(f&Et)===Et,neg:f=>_t(-f,n),eql:(f,l)=>f===l,sqr:f=>_t(f*f,n),add:(f,l)=>_t(f+l,n),sub:(f,l)=>_t(f-l,n),mul:(f,l)=>_t(f*l,n),pow:(f,l)=>vl(c,f,l),div:(f,l)=>_t(f*Vi(l,n),n),sqrN:f=>f*f,addN:(f,l)=>f+l,subN:(f,l)=>f-l,mulN:(f,l)=>f*l,inv:f=>Vi(f,n),sqrt:r.sqrt||(f=>o(c,f)),invertBatch:f=>Al(c,f),cmov:(f,l,p)=>p?l:f,toBytes:f=>t?As(f,i):Rs(f,i),fromBytes:f=>{if(f.length!==i)throw new Error(`Fp.fromBytes: expected ${i}, got ${f.length}`);return t?Qr(f):Or(f)}});return Object.freeze(c)}function Rl(n,e){if(!n.isOdd)throw new Error("Field doesn't have isOdd");const t=n.sqrt(e);return n.isOdd(t)?n.neg(t):t}function qc(n){if(typeof n!="bigint")throw new Error("field order must be bigint");const e=n.toString(2).length;return Math.ceil(e/8)}function jc(n){const e=qc(n);return e+Math.ceil(e/2)}function Il(n,e,t=!1){const r=n.length,s=qc(e),i=jc(e);if(r<16||r<i||r>1024)throw new Error(`expected ${i}-1024 bytes of input, got ${r}`);const o=t?Or(n):Qr(n),c=_t(o,e-Et)+Et;return t?As(c,s):Rs(c,s)}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const kl=BigInt(0),fi=BigInt(1);function Kc(n,e){const t=(s,i)=>{const o=i.negate();return s?o:i},r=s=>{const i=Math.ceil(e/s)+1,o=2**(s-1);return{windows:i,windowSize:o}};return{constTimeNegate:t,unsafeLadder(s,i){let o=n.ZERO,c=s;for(;i>kl;)i&fi&&(o=o.add(c)),c=c.double(),i>>=fi;return o},precomputeWindow(s,i){const{windows:o,windowSize:c}=r(i),f=[];let l=s,p=l;for(let x=0;x<o;x++){p=l,f.push(p);for(let k=1;k<c;k++)p=p.add(l),f.push(p);l=p.double()}return f},wNAF(s,i,o){const{windows:c,windowSize:f}=r(s);let l=n.ZERO,p=n.BASE;const x=BigInt(2**s-1),k=2**s,E=BigInt(s);for(let b=0;b<c;b++){const _=b*f;let v=Number(o&x);o>>=E,v>f&&(v-=k,o+=fi);const I=_,A=_+Math.abs(v)-1,T=b%2!==0,$=v<0;v===0?p=p.add(t(T,i[I])):l=l.add(t($,i[A]))}return{p:l,f:p}},wNAFCached(s,i,o,c){const f=s._WINDOW_SIZE||1;let l=i.get(s);return l||(l=this.precomputeWindow(s,f),f!==1&&i.set(s,c(l))),this.wNAF(f,l,o)}}}function yo(n){return El(n.Fp),as(n,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...$c(n.n,n.nBitLength),...n,p:n.Fp.ORDER})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function Bl(n){const e=yo(n);as(e,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});const{endo:t,Fp:r,a:s}=e;if(t){if(!r.eql(s,r.ZERO))throw new Error("Endomorphism can only be defined for Koblitz curves that have a=0");if(typeof t!="object"||typeof t.beta!="bigint"||typeof t.splitScalar!="function")throw new Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...e})}const{bytesToNumberBE:Tl,hexToBytes:Cl}=Vu,br={Err:class extends Error{constructor(e=""){super(e)}},_parseInt(n){const{Err:e}=br;if(n.length<2||n[0]!==2)throw new e("Invalid signature integer tag");const t=n[1],r=n.subarray(2,t+2);if(!t||r.length!==t)throw new e("Invalid signature integer: wrong length");if(r[0]&128)throw new e("Invalid signature integer: negative");if(r[0]===0&&!(r[1]&128))throw new e("Invalid signature integer: unnecessary leading zero");return{d:Tl(r),l:n.subarray(t+2)}},toSig(n){const{Err:e}=br,t=typeof n=="string"?Cl(n):n;if(!(t instanceof Uint8Array))throw new Error("ui8a expected");let r=t.length;if(r<2||t[0]!=48)throw new e("Invalid signature tag");if(t[1]!==r-2)throw new e("Invalid signature: incorrect length");const{d:s,l:i}=br._parseInt(t.subarray(2)),{d:o,l:c}=br._parseInt(i);if(c.length)throw new e("Invalid signature: left bytes after parsing");return{r:s,s:o}},hexFromSig(n){const e=l=>Number.parseInt(l[0],16)&8?"00"+l:l,t=l=>{const p=l.toString(16);return p.length&1?`0${p}`:p},r=e(t(n.s)),s=e(t(n.r)),i=r.length/2,o=s.length/2,c=t(i),f=t(o);return`30${t(o+i+4)}02${f}${s}02${c}${r}`}},$n=BigInt(0),ln=BigInt(1);BigInt(2);const ua=BigInt(3);BigInt(4);function Pl(n){const e=Bl(n),{Fp:t}=e,r=e.toBytes||((b,_,v)=>{const I=_.toAffine();return ns(Uint8Array.from([4]),t.toBytes(I.x),t.toBytes(I.y))}),s=e.fromBytes||(b=>{const _=b.subarray(1),v=t.fromBytes(_.subarray(0,t.BYTES)),I=t.fromBytes(_.subarray(t.BYTES,2*t.BYTES));return{x:v,y:I}});function i(b){const{a:_,b:v}=e,I=t.sqr(b),A=t.mul(I,b);return t.add(t.add(A,t.mul(b,_)),v)}if(!t.eql(t.sqr(e.Gy),i(e.Gx)))throw new Error("bad generator point: equation left != right");function o(b){return typeof b=="bigint"&&$n<b&&b<e.n}function c(b){if(!o(b))throw new Error("Expected valid bigint: 0 < bigint < curve.n")}function f(b){const{allowedPrivateKeyLengths:_,nByteLength:v,wrapPrivateKey:I,n:A}=e;if(_&&typeof b!="bigint"){if(b instanceof Uint8Array&&(b=Is(b)),typeof b!="string"||!_.includes(b.length))throw new Error("Invalid key");b=b.padStart(v*2,"0")}let T;try{T=typeof b=="bigint"?b:Or(Ut("private key",b,v))}catch{throw new Error(`private key must be ${v} bytes, hex or bigint, not ${typeof b}`)}return I&&(T=_t(T,A)),c(T),T}const l=new Map;function p(b){if(!(b instanceof x))throw new Error("ProjectivePoint expected")}class x{constructor(_,v,I){if(this.px=_,this.py=v,this.pz=I,_==null||!t.isValid(_))throw new Error("x required");if(v==null||!t.isValid(v))throw new Error("y required");if(I==null||!t.isValid(I))throw new Error("z required")}static fromAffine(_){const{x:v,y:I}=_||{};if(!_||!t.isValid(v)||!t.isValid(I))throw new Error("invalid affine point");if(_ instanceof x)throw new Error("projective point not allowed");const A=T=>t.eql(T,t.ZERO);return A(v)&&A(I)?x.ZERO:new x(v,I,t.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(_){const v=t.invertBatch(_.map(I=>I.pz));return _.map((I,A)=>I.toAffine(v[A])).map(x.fromAffine)}static fromHex(_){const v=x.fromAffine(s(Ut("pointHex",_)));return v.assertValidity(),v}static fromPrivateKey(_){return x.BASE.multiply(f(_))}_setWindowSize(_){this._WINDOW_SIZE=_,l.delete(this)}assertValidity(){if(this.is0()){if(e.allowInfinityPoint&&!t.is0(this.py))return;throw new Error("bad point: ZERO")}const{x:_,y:v}=this.toAffine();if(!t.isValid(_)||!t.isValid(v))throw new Error("bad point: x or y not FE");const I=t.sqr(v),A=i(_);if(!t.eql(I,A))throw new Error("bad point: equation left != right");if(!this.isTorsionFree())throw new Error("bad point: not in prime-order subgroup")}hasEvenY(){const{y:_}=this.toAffine();if(t.isOdd)return!t.isOdd(_);throw new Error("Field doesn't support isOdd")}equals(_){p(_);const{px:v,py:I,pz:A}=this,{px:T,py:$,pz:D}=_,P=t.eql(t.mul(v,D),t.mul(T,A)),H=t.eql(t.mul(I,D),t.mul($,A));return P&&H}negate(){return new x(this.px,t.neg(this.py),this.pz)}double(){const{a:_,b:v}=e,I=t.mul(v,ua),{px:A,py:T,pz:$}=this;let D=t.ZERO,P=t.ZERO,H=t.ZERO,K=t.mul(A,A),ie=t.mul(T,T),F=t.mul($,$),oe=t.mul(A,T);return oe=t.add(oe,oe),H=t.mul(A,$),H=t.add(H,H),D=t.mul(_,H),P=t.mul(I,F),P=t.add(D,P),D=t.sub(ie,P),P=t.add(ie,P),P=t.mul(D,P),D=t.mul(oe,D),H=t.mul(I,H),F=t.mul(_,F),oe=t.sub(K,F),oe=t.mul(_,oe),oe=t.add(oe,H),H=t.add(K,K),K=t.add(H,K),K=t.add(K,F),K=t.mul(K,oe),P=t.add(P,K),F=t.mul(T,$),F=t.add(F,F),K=t.mul(F,oe),D=t.sub(D,K),H=t.mul(F,ie),H=t.add(H,H),H=t.add(H,H),new x(D,P,H)}add(_){p(_);const{px:v,py:I,pz:A}=this,{px:T,py:$,pz:D}=_;let P=t.ZERO,H=t.ZERO,K=t.ZERO;const ie=e.a,F=t.mul(e.b,ua);let oe=t.mul(v,T),Pe=t.mul(I,$),ve=t.mul(A,D),Me=t.add(v,I),W=t.add(T,$);Me=t.mul(Me,W),W=t.add(oe,Pe),Me=t.sub(Me,W),W=t.add(v,A);let te=t.add(T,D);return W=t.mul(W,te),te=t.add(oe,ve),W=t.sub(W,te),te=t.add(I,A),P=t.add($,D),te=t.mul(te,P),P=t.add(Pe,ve),te=t.sub(te,P),K=t.mul(ie,W),P=t.mul(F,ve),K=t.add(P,K),P=t.sub(Pe,K),K=t.add(Pe,K),H=t.mul(P,K),Pe=t.add(oe,oe),Pe=t.add(Pe,oe),ve=t.mul(ie,ve),W=t.mul(F,W),Pe=t.add(Pe,ve),ve=t.sub(oe,ve),ve=t.mul(ie,ve),W=t.add(W,ve),oe=t.mul(Pe,W),H=t.add(H,oe),oe=t.mul(te,W),P=t.mul(Me,P),P=t.sub(P,oe),oe=t.mul(Me,Pe),K=t.mul(te,K),K=t.add(K,oe),new x(P,H,K)}subtract(_){return this.add(_.negate())}is0(){return this.equals(x.ZERO)}wNAF(_){return E.wNAFCached(this,l,_,v=>{const I=t.invertBatch(v.map(A=>A.pz));return v.map((A,T)=>A.toAffine(I[T])).map(x.fromAffine)})}multiplyUnsafe(_){const v=x.ZERO;if(_===$n)return v;if(c(_),_===ln)return this;const{endo:I}=e;if(!I)return E.unsafeLadder(this,_);let{k1neg:A,k1:T,k2neg:$,k2:D}=I.splitScalar(_),P=v,H=v,K=this;for(;T>$n||D>$n;)T&ln&&(P=P.add(K)),D&ln&&(H=H.add(K)),K=K.double(),T>>=ln,D>>=ln;return A&&(P=P.negate()),$&&(H=H.negate()),H=new x(t.mul(H.px,I.beta),H.py,H.pz),P.add(H)}multiply(_){c(_);let v=_,I,A;const{endo:T}=e;if(T){const{k1neg:$,k1:D,k2neg:P,k2:H}=T.splitScalar(v);let{p:K,f:ie}=this.wNAF(D),{p:F,f:oe}=this.wNAF(H);K=E.constTimeNegate($,K),F=E.constTimeNegate(P,F),F=new x(t.mul(F.px,T.beta),F.py,F.pz),I=K.add(F),A=ie.add(oe)}else{const{p:$,f:D}=this.wNAF(v);I=$,A=D}return x.normalizeZ([I,A])[0]}multiplyAndAddUnsafe(_,v,I){const A=x.BASE,T=(D,P)=>P===$n||P===ln||!D.equals(A)?D.multiplyUnsafe(P):D.multiply(P),$=T(this,v).add(T(_,I));return $.is0()?void 0:$}toAffine(_){const{px:v,py:I,pz:A}=this,T=this.is0();_==null&&(_=T?t.ONE:t.inv(A));const $=t.mul(v,_),D=t.mul(I,_),P=t.mul(A,_);if(T)return{x:t.ZERO,y:t.ZERO};if(!t.eql(P,t.ONE))throw new Error("invZ was invalid");return{x:$,y:D}}isTorsionFree(){const{h:_,isTorsionFree:v}=e;if(_===ln)return!0;if(v)return v(x,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:_,clearCofactor:v}=e;return _===ln?this:v?v(x,this):this.multiplyUnsafe(e.h)}toRawBytes(_=!0){return this.assertValidity(),r(x,this,_)}toHex(_=!0){return Is(this.toRawBytes(_))}}x.BASE=new x(e.Gx,e.Gy,t.ONE),x.ZERO=new x(t.ZERO,t.ONE,t.ZERO);const k=e.nBitLength,E=Kc(x,e.endo?Math.ceil(k/2):k);return{CURVE:e,ProjectivePoint:x,normPrivateKeyToScalar:f,weierstrassEquation:i,isWithinCurveOrder:o}}function Ll(n){const e=yo(n);return as(e,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...e})}function Ol(n){const e=Ll(n),{Fp:t,n:r}=e,s=t.BYTES+1,i=2*t.BYTES+1;function o(W){return $n<W&&W<t.ORDER}function c(W){return _t(W,r)}function f(W){return Vi(W,r)}const{ProjectivePoint:l,normPrivateKeyToScalar:p,weierstrassEquation:x,isWithinCurveOrder:k}=Pl({...e,toBytes(W,te,be){const z=te.toAffine(),R=t.toBytes(z.x),m=ns;return be?m(Uint8Array.from([te.hasEvenY()?2:3]),R):m(Uint8Array.from([4]),R,t.toBytes(z.y))},fromBytes(W){const te=W.length,be=W[0],z=W.subarray(1);if(te===s&&(be===2||be===3)){const R=Or(z);if(!o(R))throw new Error("Point is not on curve");const m=x(R);let M=t.sqrt(m);const Z=(M&ln)===ln;return(be&1)===1!==Z&&(M=t.neg(M)),{x:R,y:M}}else if(te===i&&be===4){const R=t.fromBytes(z.subarray(0,t.BYTES)),m=t.fromBytes(z.subarray(t.BYTES,2*t.BYTES));return{x:R,y:m}}else throw new Error(`Point of length ${te} was invalid. Expected ${s} compressed bytes or ${i} uncompressed bytes`)}}),E=W=>Is(Rs(W,e.nByteLength));function b(W){const te=r>>ln;return W>te}function _(W){return b(W)?c(-W):W}const v=(W,te,be)=>Or(W.slice(te,be));class I{constructor(te,be,z){this.r=te,this.s=be,this.recovery=z,this.assertValidity()}static fromCompact(te){const be=e.nByteLength;return te=Ut("compactSignature",te,be*2),new I(v(te,0,be),v(te,be,2*be))}static fromDER(te){const{r:be,s:z}=br.toSig(Ut("DER",te));return new I(be,z)}assertValidity(){if(!k(this.r))throw new Error("r must be 0 < r < CURVE.n");if(!k(this.s))throw new Error("s must be 0 < s < CURVE.n")}addRecoveryBit(te){return new I(this.r,this.s,te)}recoverPublicKey(te){const{r:be,s:z,recovery:R}=this,m=H(Ut("msgHash",te));if(R==null||![0,1,2,3].includes(R))throw new Error("recovery id invalid");const M=R===2||R===3?be+e.n:be;if(M>=t.ORDER)throw new Error("recovery id 2 or 3 invalid");const Z=R&1?"03":"02",ne=l.fromHex(Z+E(M)),Q=f(M),re=c(-m*Q),we=c(z*Q),Te=l.BASE.multiplyAndAddUnsafe(ne,re,we);if(!Te)throw new Error("point at infinify");return Te.assertValidity(),Te}hasHighS(){return b(this.s)}normalizeS(){return this.hasHighS()?new I(this.r,c(-this.s),this.recovery):this}toDERRawBytes(){return oa(this.toDERHex())}toDERHex(){return br.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return oa(this.toCompactHex())}toCompactHex(){return E(this.r)+E(this.s)}}const A={isValidPrivateKey(W){try{return p(W),!0}catch{return!1}},normPrivateKeyToScalar:p,randomPrivateKey:()=>{const W=jc(e.n);return Il(e.randomBytes(W),e.n)},precompute(W=8,te=l.BASE){return te._setWindowSize(W),te.multiply(BigInt(3)),te}};function T(W,te=!0){return l.fromPrivateKey(W).toRawBytes(te)}function $(W){const te=W instanceof Uint8Array,be=typeof W=="string",z=(te||be)&&W.length;return te?z===s||z===i:be?z===2*s||z===2*i:W instanceof l}function D(W,te,be=!0){if($(W))throw new Error("first arg must be private key");if(!$(te))throw new Error("second arg must be public key");return l.fromHex(te).multiply(p(W)).toRawBytes(be)}const P=e.bits2int||function(W){const te=Or(W),be=W.length*8-e.nBitLength;return be>0?te>>BigInt(be):te},H=e.bits2int_modN||function(W){return c(P(W))},K=Pc(e.nBitLength);function ie(W){if(typeof W!="bigint")throw new Error("bigint expected");if(!($n<=W&&W<K))throw new Error(`bigint expected < 2^${e.nBitLength}`);return Rs(W,e.nByteLength)}function F(W,te,be=oe){if(["recovered","canonical"].some(Ke=>Ke in be))throw new Error("sign() legacy options not supported");const{hash:z,randomBytes:R}=e;let{lowS:m,prehash:M,extraEntropy:Z}=be;m==null&&(m=!0),W=Ut("msgHash",W),M&&(W=Ut("prehashed msgHash",z(W)));const ne=H(W),Q=p(te),re=[ie(Q),ie(ne)];if(Z!=null){const Ke=Z===!0?R(t.BYTES):Z;re.push(Ut("extraEntropy",Ke))}const we=ns(...re),Te=ne;function et(Ke){const rt=P(Ke);if(!k(rt))return;const gt=f(rt),yt=l.BASE.multiply(rt).toAffine(),B=c(yt.x);if(B===$n)return;const L=c(gt*c(Te+B*Q));if(L===$n)return;let X=(yt.x===B?0:2)|Number(yt.y&ln),xe=L;return m&&b(L)&&(xe=_(L),X^=1),new I(B,xe,X)}return{seed:we,k2sig:et}}const oe={lowS:e.lowS,prehash:!1},Pe={lowS:e.lowS,prehash:!1};function ve(W,te,be=oe){const{seed:z,k2sig:R}=F(W,te,be),m=e;return Gu(m.hash.outputLen,m.nByteLength,m.hmac)(z,R)}l.BASE._setWindowSize(8);function Me(W,te,be,z=Pe){var yt;const R=W;if(te=Ut("msgHash",te),be=Ut("publicKey",be),"strict"in z)throw new Error("options.strict was renamed to lowS");const{lowS:m,prehash:M}=z;let Z,ne;try{if(typeof R=="string"||R instanceof Uint8Array)try{Z=I.fromDER(R)}catch(B){if(!(B instanceof br.Err))throw B;Z=I.fromCompact(R)}else if(typeof R=="object"&&typeof R.r=="bigint"&&typeof R.s=="bigint"){const{r:B,s:L}=R;Z=new I(B,L)}else throw new Error("PARSE");ne=l.fromHex(be)}catch(B){if(B.message==="PARSE")throw new Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(m&&Z.hasHighS())return!1;M&&(te=e.hash(te));const{r:Q,s:re}=Z,we=H(te),Te=f(re),et=c(we*Te),Ke=c(Q*Te),rt=(yt=l.BASE.multiplyAndAddUnsafe(ne,et,Ke))==null?void 0:yt.toAffine();return rt?c(rt.x)===Q:!1}return{CURVE:e,getPublicKey:T,getSharedSecret:D,sign:ve,verify:Me,ProjectivePoint:l,Signature:I,utils:A}}class Wc extends Bc{constructor(e,t){super(),this.finished=!1,this.destroyed=!1,Yu(e);const r=Tc(t);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const s=this.blockLen,i=new Uint8Array(s);i.set(r.length>s?e.create().update(r).digest():r);for(let o=0;o<i.length;o++)i[o]^=54;this.iHash.update(i),this.oHash=e.create();for(let o=0;o<i.length;o++)i[o]^=106;this.oHash.update(i),i.fill(0)}update(e){return vs(this),this.iHash.update(e),this}digestInto(e){vs(this),Zu(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:t,iHash:r,finished:s,destroyed:i,blockLen:o,outputLen:c}=this;return e=e,e.finished=s,e.destroyed=i,e.blockLen=o,e.outputLen=c,e.oHash=t._cloneInto(e.oHash),e.iHash=r._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const Hc=(n,e,t)=>new Wc(n,e).update(t).digest();Hc.create=(n,e)=>new Wc(n,e);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function Nl(n){return{hash:n,hmac:(e,...t)=>Hc(n,e,Lc(...t)),randomBytes:Oc}}function Ml(n,e){const t=r=>Ol({...n,...Nl(r)});return Object.freeze({...t(e),create:t})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const zc=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),la=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),Ul=BigInt(1),Yi=BigInt(2),da=(n,e)=>(n+e/Yi)/e;function Dl(n){const e=zc,t=BigInt(3),r=BigInt(6),s=BigInt(11),i=BigInt(22),o=BigInt(23),c=BigInt(44),f=BigInt(88),l=n*n*n%e,p=l*l*n%e,x=It(p,t,e)*p%e,k=It(x,t,e)*p%e,E=It(k,Yi,e)*l%e,b=It(E,s,e)*E%e,_=It(b,i,e)*b%e,v=It(_,c,e)*_%e,I=It(v,f,e)*v%e,A=It(I,c,e)*_%e,T=It(A,t,e)*p%e,$=It(T,o,e)*b%e,D=It($,r,e)*l%e,P=It(D,Yi,e);if(!Zi.eql(Zi.sqr(P),n))throw new Error("Cannot find square root");return P}const Zi=Fc(zc,void 0,void 0,{sqrt:Dl}),bo=Ml({a:BigInt(0),b:BigInt(7),Fp:Zi,n:la,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:n=>{const e=la,t=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),r=-Ul*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),s=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),i=t,o=BigInt("0x100000000000000000000000000000000"),c=da(i*n,e),f=da(-r*n,e);let l=_t(n-c*t-f*s,e),p=_t(-c*r-f*i,e);const x=l>o,k=p>o;if(x&&(l=e-l),k&&(p=e-p),l>o||p>o)throw new Error("splitScalar: Endomorphism failed, k="+n);return{k1neg:x,k1:l,k2neg:k,k2:p}}}},zi);BigInt(0);bo.ProjectivePoint;var ui={exports:{}},ha;function $l(){return ha||(ha=1,function(n){function e(r,s,i,o,c,f,l){try{var p=r[f](l),x=p.value}catch(k){i(k);return}p.done?s(x):Promise.resolve(x).then(o,c)}function t(r){return function(){var s=this,i=arguments;return new Promise(function(o,c){var f=r.apply(s,i);function l(x){e(f,o,c,l,p,"next",x)}function p(x){e(f,o,c,l,p,"throw",x)}l(void 0)})}}n.exports=t,n.exports.__esModule=!0,n.exports.default=n.exports}(ui)),ui.exports}var li={exports:{}},di={exports:{}},pa;function fs(){return pa||(pa=1,function(n){function e(t){"@babel/helpers - typeof";return n.exports=e=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},n.exports.__esModule=!0,n.exports.default=n.exports,e(t)}n.exports=e,n.exports.__esModule=!0,n.exports.default=n.exports}(di)),di.exports}var ga;function Fl(){return ga||(ga=1,function(n){var e=fs().default;function t(){n.exports=t=function(){return s},n.exports.__esModule=!0,n.exports.default=n.exports;var r,s={},i=Object.prototype,o=i.hasOwnProperty,c=Object.defineProperty||function(R,m,M){R[m]=M.value},f=typeof Symbol=="function"?Symbol:{},l=f.iterator||"@@iterator",p=f.asyncIterator||"@@asyncIterator",x=f.toStringTag||"@@toStringTag";function k(R,m,M){return Object.defineProperty(R,m,{value:M,enumerable:!0,configurable:!0,writable:!0}),R[m]}try{k({},"")}catch{k=function(M,Z,ne){return M[Z]=ne}}function E(R,m,M,Z){var ne=m&&m.prototype instanceof $?m:$,Q=Object.create(ne.prototype),re=new be(Z||[]);return c(Q,"_invoke",{value:ve(R,M,re)}),Q}function b(R,m,M){try{return{type:"normal",arg:R.call(m,M)}}catch(Z){return{type:"throw",arg:Z}}}s.wrap=E;var _="suspendedStart",v="suspendedYield",I="executing",A="completed",T={};function $(){}function D(){}function P(){}var H={};k(H,l,function(){return this});var K=Object.getPrototypeOf,ie=K&&K(K(z([])));ie&&ie!==i&&o.call(ie,l)&&(H=ie);var F=P.prototype=$.prototype=Object.create(H);function oe(R){["next","throw","return"].forEach(function(m){k(R,m,function(M){return this._invoke(m,M)})})}function Pe(R,m){function M(ne,Q,re,we){var Te=b(R[ne],R,Q);if(Te.type!=="throw"){var et=Te.arg,Ke=et.value;return Ke&&e(Ke)=="object"&&o.call(Ke,"__await")?m.resolve(Ke.__await).then(function(rt){M("next",rt,re,we)},function(rt){M("throw",rt,re,we)}):m.resolve(Ke).then(function(rt){et.value=rt,re(et)},function(rt){return M("throw",rt,re,we)})}we(Te.arg)}var Z;c(this,"_invoke",{value:function(Q,re){function we(){return new m(function(Te,et){M(Q,re,Te,et)})}return Z=Z?Z.then(we,we):we()}})}function ve(R,m,M){var Z=_;return function(ne,Q){if(Z===I)throw new Error("Generator is already running");if(Z===A){if(ne==="throw")throw Q;return{value:r,done:!0}}for(M.method=ne,M.arg=Q;;){var re=M.delegate;if(re){var we=Me(re,M);if(we){if(we===T)continue;return we}}if(M.method==="next")M.sent=M._sent=M.arg;else if(M.method==="throw"){if(Z===_)throw Z=A,M.arg;M.dispatchException(M.arg)}else M.method==="return"&&M.abrupt("return",M.arg);Z=I;var Te=b(R,m,M);if(Te.type==="normal"){if(Z=M.done?A:v,Te.arg===T)continue;return{value:Te.arg,done:M.done}}Te.type==="throw"&&(Z=A,M.method="throw",M.arg=Te.arg)}}}function Me(R,m){var M=m.method,Z=R.iterator[M];if(Z===r)return m.delegate=null,M==="throw"&&R.iterator.return&&(m.method="return",m.arg=r,Me(R,m),m.method==="throw")||M!=="return"&&(m.method="throw",m.arg=new TypeError("The iterator does not provide a '"+M+"' method")),T;var ne=b(Z,R.iterator,m.arg);if(ne.type==="throw")return m.method="throw",m.arg=ne.arg,m.delegate=null,T;var Q=ne.arg;return Q?Q.done?(m[R.resultName]=Q.value,m.next=R.nextLoc,m.method!=="return"&&(m.method="next",m.arg=r),m.delegate=null,T):Q:(m.method="throw",m.arg=new TypeError("iterator result is not an object"),m.delegate=null,T)}function W(R){var m={tryLoc:R[0]};1 in R&&(m.catchLoc=R[1]),2 in R&&(m.finallyLoc=R[2],m.afterLoc=R[3]),this.tryEntries.push(m)}function te(R){var m=R.completion||{};m.type="normal",delete m.arg,R.completion=m}function be(R){this.tryEntries=[{tryLoc:"root"}],R.forEach(W,this),this.reset(!0)}function z(R){if(R||R===""){var m=R[l];if(m)return m.call(R);if(typeof R.next=="function")return R;if(!isNaN(R.length)){var M=-1,Z=function ne(){for(;++M<R.length;)if(o.call(R,M))return ne.value=R[M],ne.done=!1,ne;return ne.value=r,ne.done=!0,ne};return Z.next=Z}}throw new TypeError(e(R)+" is not iterable")}return D.prototype=P,c(F,"constructor",{value:P,configurable:!0}),c(P,"constructor",{value:D,configurable:!0}),D.displayName=k(P,x,"GeneratorFunction"),s.isGeneratorFunction=function(R){var m=typeof R=="function"&&R.constructor;return!!m&&(m===D||(m.displayName||m.name)==="GeneratorFunction")},s.mark=function(R){return Object.setPrototypeOf?Object.setPrototypeOf(R,P):(R.__proto__=P,k(R,x,"GeneratorFunction")),R.prototype=Object.create(F),R},s.awrap=function(R){return{__await:R}},oe(Pe.prototype),k(Pe.prototype,p,function(){return this}),s.AsyncIterator=Pe,s.async=function(R,m,M,Z,ne){ne===void 0&&(ne=Promise);var Q=new Pe(E(R,m,M,Z),ne);return s.isGeneratorFunction(m)?Q:Q.next().then(function(re){return re.done?re.value:Q.next()})},oe(F),k(F,x,"Generator"),k(F,l,function(){return this}),k(F,"toString",function(){return"[object Generator]"}),s.keys=function(R){var m=Object(R),M=[];for(var Z in m)M.push(Z);return M.reverse(),function ne(){for(;M.length;){var Q=M.pop();if(Q in m)return ne.value=Q,ne.done=!1,ne}return ne.done=!0,ne}},s.values=z,be.prototype={constructor:be,reset:function(m){if(this.prev=0,this.next=0,this.sent=this._sent=r,this.done=!1,this.delegate=null,this.method="next",this.arg=r,this.tryEntries.forEach(te),!m)for(var M in this)M.charAt(0)==="t"&&o.call(this,M)&&!isNaN(+M.slice(1))&&(this[M]=r)},stop:function(){this.done=!0;var m=this.tryEntries[0].completion;if(m.type==="throw")throw m.arg;return this.rval},dispatchException:function(m){if(this.done)throw m;var M=this;function Z(et,Ke){return re.type="throw",re.arg=m,M.next=et,Ke&&(M.method="next",M.arg=r),!!Ke}for(var ne=this.tryEntries.length-1;ne>=0;--ne){var Q=this.tryEntries[ne],re=Q.completion;if(Q.tryLoc==="root")return Z("end");if(Q.tryLoc<=this.prev){var we=o.call(Q,"catchLoc"),Te=o.call(Q,"finallyLoc");if(we&&Te){if(this.prev<Q.catchLoc)return Z(Q.catchLoc,!0);if(this.prev<Q.finallyLoc)return Z(Q.finallyLoc)}else if(we){if(this.prev<Q.catchLoc)return Z(Q.catchLoc,!0)}else{if(!Te)throw new Error("try statement without catch or finally");if(this.prev<Q.finallyLoc)return Z(Q.finallyLoc)}}}},abrupt:function(m,M){for(var Z=this.tryEntries.length-1;Z>=0;--Z){var ne=this.tryEntries[Z];if(ne.tryLoc<=this.prev&&o.call(ne,"finallyLoc")&&this.prev<ne.finallyLoc){var Q=ne;break}}Q&&(m==="break"||m==="continue")&&Q.tryLoc<=M&&M<=Q.finallyLoc&&(Q=null);var re=Q?Q.completion:{};return re.type=m,re.arg=M,Q?(this.method="next",this.next=Q.finallyLoc,T):this.complete(re)},complete:function(m,M){if(m.type==="throw")throw m.arg;return m.type==="break"||m.type==="continue"?this.next=m.arg:m.type==="return"?(this.rval=this.arg=m.arg,this.method="return",this.next="end"):m.type==="normal"&&M&&(this.next=M),T},finish:function(m){for(var M=this.tryEntries.length-1;M>=0;--M){var Z=this.tryEntries[M];if(Z.finallyLoc===m)return this.complete(Z.completion,Z.afterLoc),te(Z),T}},catch:function(m){for(var M=this.tryEntries.length-1;M>=0;--M){var Z=this.tryEntries[M];if(Z.tryLoc===m){var ne=Z.completion;if(ne.type==="throw"){var Q=ne.arg;te(Z)}return Q}}throw new Error("illegal catch attempt")},delegateYield:function(m,M,Z){return this.delegate={iterator:z(m),resultName:M,nextLoc:Z},this.method==="next"&&(this.arg=r),T}},s}n.exports=t,n.exports.__esModule=!0,n.exports.default=n.exports}(li)),li.exports}var hi,ya;function ql(){if(ya)return hi;ya=1;var n=Fl()();hi=n;try{regeneratorRuntime=n}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=n:Function("r","regeneratorRuntime = r")(n)}return hi}var jl={exports:{}},pi={exports:{}},Nt={ArrayIsArray(n){return Array.isArray(n)},ArrayPrototypeIncludes(n,e){return n.includes(e)},ArrayPrototypeIndexOf(n,e){return n.indexOf(e)},ArrayPrototypeJoin(n,e){return n.join(e)},ArrayPrototypeMap(n,e){return n.map(e)},ArrayPrototypePop(n,e){return n.pop(e)},ArrayPrototypePush(n,e){return n.push(e)},ArrayPrototypeSlice(n,e,t){return n.slice(e,t)},Error,FunctionPrototypeCall(n,e,...t){return n.call(e,...t)},FunctionPrototypeSymbolHasInstance(n,e){return Function.prototype[Symbol.hasInstance].call(n,e)},MathFloor:Math.floor,Number,NumberIsInteger:Number.isInteger,NumberIsNaN:Number.isNaN,NumberMAX_SAFE_INTEGER:Number.MAX_SAFE_INTEGER,NumberMIN_SAFE_INTEGER:Number.MIN_SAFE_INTEGER,NumberParseInt:Number.parseInt,ObjectDefineProperties(n,e){return Object.defineProperties(n,e)},ObjectDefineProperty(n,e,t){return Object.defineProperty(n,e,t)},ObjectGetOwnPropertyDescriptor(n,e){return Object.getOwnPropertyDescriptor(n,e)},ObjectKeys(n){return Object.keys(n)},ObjectSetPrototypeOf(n,e){return Object.setPrototypeOf(n,e)},Promise,PromisePrototypeCatch(n,e){return n.catch(e)},PromisePrototypeThen(n,e,t){return n.then(e,t)},PromiseReject(n){return Promise.reject(n)},ReflectApply:Reflect.apply,RegExpPrototypeTest(n,e){return n.test(e)},SafeSet:Set,String,StringPrototypeSlice(n,e,t){return n.slice(e,t)},StringPrototypeToLowerCase(n){return n.toLowerCase()},StringPrototypeToUpperCase(n){return n.toUpperCase()},StringPrototypeTrim(n){return n.trim()},Symbol,SymbolFor:Symbol.for,SymbolAsyncIterator:Symbol.asyncIterator,SymbolHasInstance:Symbol.hasInstance,SymbolIterator:Symbol.iterator,TypedArrayPrototypeSet(n,e,t){return n.set(e,t)},Uint8Array},Gc={exports:{}};(function(n){const e=$e,t=Object.getPrototypeOf(async function(){}).constructor,r=globalThis.Blob||e.Blob,s=typeof r<"u"?function(c){return c instanceof r}:function(c){return!1};class i extends Error{constructor(c){if(!Array.isArray(c))throw new TypeError(`Expected input to be an Array, got ${typeof c}`);let f="";for(let l=0;l<c.length;l++)f+=`    ${c[l].stack}
`;super(f),this.name="AggregateError",this.errors=c}}n.exports={AggregateError:i,kEmptyObject:Object.freeze({}),once(o){let c=!1;return function(...f){c||(c=!0,o.apply(this,f))}},createDeferredPromise:function(){let o,c;return{promise:new Promise((l,p)=>{o=l,c=p}),resolve:o,reject:c}},promisify(o){return new Promise((c,f)=>{o((l,...p)=>l?f(l):c(...p))})},debuglog(){return function(){}},format(o,...c){return o.replace(/%([sdifj])/g,function(...[f,l]){const p=c.shift();return l==="f"?p.toFixed(6):l==="j"?JSON.stringify(p):l==="s"&&typeof p=="object"?`${p.constructor!==Object?p.constructor.name:""} {}`.trim():p.toString()})},inspect(o){switch(typeof o){case"string":if(o.includes("'"))if(o.includes('"')){if(!o.includes("`")&&!o.includes("${"))return`\`${o}\``}else return`"${o}"`;return`'${o}'`;case"number":return isNaN(o)?"NaN":Object.is(o,-0)?String(o):o;case"bigint":return`${String(o)}n`;case"boolean":case"undefined":return String(o);case"object":return"{}"}},types:{isAsyncFunction(o){return o instanceof t},isArrayBufferView(o){return ArrayBuffer.isView(o)}},isBlob:s},n.exports.promisify.custom=Symbol.for("nodejs.util.promisify.custom")})(Gc);var Hn=Gc.exports,wo={};const{format:Kl,inspect:ks,AggregateError:Wl}=Hn,Hl=globalThis.AggregateError||Wl,zl=Symbol("kIsNodeError"),Gl=["string","function","number","object","Function","Object","boolean","bigint","symbol"],Vl=/^([A-Z][a-z0-9]*)+$/,Yl="__node_internal_",qs={};function wr(n,e){if(!n)throw new qs.ERR_INTERNAL_ASSERTION(e)}function ba(n){let e="",t=n.length;const r=n[0]==="-"?1:0;for(;t>=r+4;t-=3)e=`_${n.slice(t-3,t)}${e}`;return`${n.slice(0,t)}${e}`}function Zl(n,e,t){if(typeof e=="function")return wr(e.length<=t.length,`Code: ${n}; The provided arguments length (${t.length}) does not match the required ones (${e.length}).`),e(...t);const r=(e.match(/%[dfijoOs]/g)||[]).length;return wr(r===t.length,`Code: ${n}; The provided arguments length (${t.length}) does not match the required ones (${r}).`),t.length===0?e:Kl(e,...t)}function Kt(n,e,t){t||(t=Error);class r extends t{constructor(...i){super(Zl(n,e,i))}toString(){return`${this.name} [${n}]: ${this.message}`}}Object.defineProperties(r.prototype,{name:{value:t.name,writable:!0,enumerable:!1,configurable:!0},toString:{value(){return`${this.name} [${n}]: ${this.message}`},writable:!0,enumerable:!1,configurable:!0}}),r.prototype.code=n,r.prototype[zl]=!0,qs[n]=r}function wa(n){const e=Yl+n.name;return Object.defineProperty(n,"name",{value:e}),n}function Xl(n,e){if(n&&e&&n!==e){if(Array.isArray(e.errors))return e.errors.push(n),e;const t=new Hl([e,n],e.message);return t.code=e.code,t}return n||e}let Jl=class extends Error{constructor(e="The operation was aborted",t=void 0){if(t!==void 0&&typeof t!="object")throw new qs.ERR_INVALID_ARG_TYPE("options","Object",t);super(e,t),this.code="ABORT_ERR",this.name="AbortError"}};Kt("ERR_ASSERTION","%s",Error);Kt("ERR_INVALID_ARG_TYPE",(n,e,t)=>{wr(typeof n=="string","'name' must be a string"),Array.isArray(e)||(e=[e]);let r="The ";n.endsWith(" argument")?r+=`${n} `:r+=`"${n}" ${n.includes(".")?"property":"argument"} `,r+="must be ";const s=[],i=[],o=[];for(const f of e)wr(typeof f=="string","All expected entries have to be of type string"),Gl.includes(f)?s.push(f.toLowerCase()):Vl.test(f)?i.push(f):(wr(f!=="object",'The value "object" should be written as "Object"'),o.push(f));if(i.length>0){const f=s.indexOf("object");f!==-1&&(s.splice(s,f,1),i.push("Object"))}if(s.length>0){switch(s.length){case 1:r+=`of type ${s[0]}`;break;case 2:r+=`one of type ${s[0]} or ${s[1]}`;break;default:{const f=s.pop();r+=`one of type ${s.join(", ")}, or ${f}`}}(i.length>0||o.length>0)&&(r+=" or ")}if(i.length>0){switch(i.length){case 1:r+=`an instance of ${i[0]}`;break;case 2:r+=`an instance of ${i[0]} or ${i[1]}`;break;default:{const f=i.pop();r+=`an instance of ${i.join(", ")}, or ${f}`}}o.length>0&&(r+=" or ")}switch(o.length){case 0:break;case 1:o[0].toLowerCase()!==o[0]&&(r+="an "),r+=`${o[0]}`;break;case 2:r+=`one of ${o[0]} or ${o[1]}`;break;default:{const f=o.pop();r+=`one of ${o.join(", ")}, or ${f}`}}if(t==null)r+=`. Received ${t}`;else if(typeof t=="function"&&t.name)r+=`. Received function ${t.name}`;else if(typeof t=="object"){var c;if((c=t.constructor)!==null&&c!==void 0&&c.name)r+=`. Received an instance of ${t.constructor.name}`;else{const f=ks(t,{depth:-1});r+=`. Received ${f}`}}else{let f=ks(t,{colors:!1});f.length>25&&(f=`${f.slice(0,25)}...`),r+=`. Received type ${typeof t} (${f})`}return r},TypeError);Kt("ERR_INVALID_ARG_VALUE",(n,e,t="is invalid")=>{let r=ks(e);return r.length>128&&(r=r.slice(0,128)+"..."),`The ${n.includes(".")?"property":"argument"} '${n}' ${t}. Received ${r}`},TypeError);Kt("ERR_INVALID_RETURN_VALUE",(n,e,t)=>{var r;const s=t!=null&&(r=t.constructor)!==null&&r!==void 0&&r.name?`instance of ${t.constructor.name}`:`type ${typeof t}`;return`Expected ${n} to be returned from the "${e}" function but got ${s}.`},TypeError);Kt("ERR_MISSING_ARGS",(...n)=>{wr(n.length>0,"At least one arg needs to be specified");let e;const t=n.length;switch(n=(Array.isArray(n)?n:[n]).map(r=>`"${r}"`).join(" or "),t){case 1:e+=`The ${n[0]} argument`;break;case 2:e+=`The ${n[0]} and ${n[1]} arguments`;break;default:{const r=n.pop();e+=`The ${n.join(", ")}, and ${r} arguments`}break}return`${e} must be specified`},TypeError);Kt("ERR_OUT_OF_RANGE",(n,e,t)=>{wr(e,'Missing "range" argument');let r;return Number.isInteger(t)&&Math.abs(t)>2**32?r=ba(String(t)):typeof t=="bigint"?(r=String(t),(t>2n**32n||t<-(2n**32n))&&(r=ba(r)),r+="n"):r=ks(t),`The value of "${n}" is out of range. It must be ${e}. Received ${r}`},RangeError);Kt("ERR_MULTIPLE_CALLBACK","Callback called multiple times",Error);Kt("ERR_METHOD_NOT_IMPLEMENTED","The %s method is not implemented",Error);Kt("ERR_STREAM_ALREADY_FINISHED","Cannot call %s after a stream was finished",Error);Kt("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable",Error);Kt("ERR_STREAM_DESTROYED","Cannot call %s after a stream was destroyed",Error);Kt("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError);Kt("ERR_STREAM_PREMATURE_CLOSE","Premature close",Error);Kt("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF",Error);Kt("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event",Error);Kt("ERR_STREAM_WRITE_AFTER_END","write after end",Error);Kt("ERR_UNKNOWN_ENCODING","Unknown encoding: %s",TypeError);var nn={AbortError:Jl,aggregateTwoErrors:wa(Xl),hideStackFrames:wa,codes:qs};const{ArrayIsArray:mo,ArrayPrototypeIncludes:Vc,ArrayPrototypeJoin:Yc,ArrayPrototypeMap:Ql,NumberIsInteger:xo,NumberIsNaN:ed,NumberMAX_SAFE_INTEGER:td,NumberMIN_SAFE_INTEGER:nd,NumberParseInt:rd,ObjectPrototypeHasOwnProperty:sd,RegExpPrototypeExec:Zc,String:id,StringPrototypeToUpperCase:od,StringPrototypeTrim:ad}=Nt,{hideStackFrames:gn,codes:{ERR_SOCKET_BAD_PORT:cd,ERR_INVALID_ARG_TYPE:Xt,ERR_INVALID_ARG_VALUE:qr,ERR_OUT_OF_RANGE:xr,ERR_UNKNOWN_SIGNAL:ma}}=nn,{normalizeEncoding:fd}=Hn,{isAsyncFunction:ud,isArrayBufferView:ld}=Hn.types,xa={};function dd(n){return n===(n|0)}function hd(n){return n===n>>>0}const pd=/^[0-7]+$/,gd="must be a 32-bit unsigned integer or an octal string";function yd(n,e,t){if(typeof n>"u"&&(n=t),typeof n=="string"){if(Zc(pd,n)===null)throw new qr(e,n,gd);n=rd(n,8)}return Xc(n,e),n}const bd=gn((n,e,t=nd,r=td)=>{if(typeof n!="number")throw new Xt(e,"number",n);if(!xo(n))throw new xr(e,"an integer",n);if(n<t||n>r)throw new xr(e,`>= ${t} && <= ${r}`,n)}),wd=gn((n,e,t=-2147483648,r=2147483647)=>{if(typeof n!="number")throw new Xt(e,"number",n);if(!xo(n))throw new xr(e,"an integer",n);if(n<t||n>r)throw new xr(e,`>= ${t} && <= ${r}`,n)}),Xc=gn((n,e,t=!1)=>{if(typeof n!="number")throw new Xt(e,"number",n);if(!xo(n))throw new xr(e,"an integer",n);const r=t?1:0,s=4294967295;if(n<r||n>s)throw new xr(e,`>= ${r} && <= ${s}`,n)});function _o(n,e){if(typeof n!="string")throw new Xt(e,"string",n)}function md(n,e,t=void 0,r){if(typeof n!="number")throw new Xt(e,"number",n);if(t!=null&&n<t||r!=null&&n>r||(t!=null||r!=null)&&ed(n))throw new xr(e,`${t!=null?`>= ${t}`:""}${t!=null&&r!=null?" && ":""}${r!=null?`<= ${r}`:""}`,n)}const xd=gn((n,e,t)=>{if(!Vc(t,n)){const s="must be one of: "+Yc(Ql(t,i=>typeof i=="string"?`'${i}'`:id(i)),", ");throw new qr(e,n,s)}});function Jc(n,e){if(typeof n!="boolean")throw new Xt(e,"boolean",n)}function gi(n,e,t){return n==null||!sd(n,e)?t:n[e]}const _d=gn((n,e,t=null)=>{const r=gi(t,"allowArray",!1),s=gi(t,"allowFunction",!1);if(!gi(t,"nullable",!1)&&n===null||!r&&mo(n)||typeof n!="object"&&(!s||typeof n!="function"))throw new Xt(e,"Object",n)}),Sd=gn((n,e)=>{if(n!=null&&typeof n!="object"&&typeof n!="function")throw new Xt(e,"a dictionary",n)}),So=gn((n,e,t=0)=>{if(!mo(n))throw new Xt(e,"Array",n);if(n.length<t){const r=`must be longer than ${t}`;throw new qr(e,n,r)}});function Ed(n,e){So(n,e);for(let t=0;t<n.length;t++)_o(n[t],`${e}[${t}]`)}function vd(n,e){So(n,e);for(let t=0;t<n.length;t++)Jc(n[t],`${e}[${t}]`)}function Ad(n,e="signal"){if(_o(n,e),xa[n]===void 0)throw xa[od(n)]!==void 0?new ma(n+" (signals must use all capital letters)"):new ma(n)}const Rd=gn((n,e="buffer")=>{if(!ld(n))throw new Xt(e,["Buffer","TypedArray","DataView"],n)});function Id(n,e){const t=fd(e),r=n.length;if(t==="hex"&&r%2!==0)throw new qr("encoding",e,`is invalid for data of length ${r}`)}function kd(n,e="Port",t=!0){if(typeof n!="number"&&typeof n!="string"||typeof n=="string"&&ad(n).length===0||+n!==+n>>>0||n>65535||n===0&&!t)throw new cd(e,n,t);return n|0}const Bd=gn((n,e)=>{if(n!==void 0&&(n===null||typeof n!="object"||!("aborted"in n)))throw new Xt(e,"AbortSignal",n)}),Td=gn((n,e)=>{if(typeof n!="function")throw new Xt(e,"Function",n)}),Cd=gn((n,e)=>{if(typeof n!="function"||ud(n))throw new Xt(e,"Function",n)}),Pd=gn((n,e)=>{if(n!==void 0)throw new Xt(e,"undefined",n)});function Ld(n,e,t){if(!Vc(t,n))throw new Xt(e,`('${Yc(t,"|")}')`,n)}const Od=/^(?:<[^>]*>)(?:\s*;\s*[^;"\s]+(?:=(")?[^;"\s]*\1)?)*$/;function _a(n,e){if(typeof n>"u"||!Zc(Od,n))throw new qr(e,n,'must be an array or string of format "</styles.css>; rel=preload; as=style"')}function Nd(n){if(typeof n=="string")return _a(n,"hints"),n;if(mo(n)){const e=n.length;let t="";if(e===0)return t;for(let r=0;r<e;r++){const s=n[r];_a(s,"hints"),t+=s,r!==e-1&&(t+=", ")}return t}throw new qr("hints",n,'must be an array or string of format "</styles.css>; rel=preload; as=style"')}var js={isInt32:dd,isUint32:hd,parseFileMode:yd,validateArray:So,validateStringArray:Ed,validateBooleanArray:vd,validateBoolean:Jc,validateBuffer:Rd,validateDictionary:Sd,validateEncoding:Id,validateFunction:Td,validateInt32:wd,validateInteger:bd,validateNumber:md,validateObject:_d,validateOneOf:xd,validatePlainFunction:Cd,validatePort:kd,validateSignalName:Ad,validateString:_o,validateUint32:Xc,validateUndefined:Pd,validateUnion:Ld,validateAbortSignal:Bd,validateLinkHeaderValue:Nd},Eo={exports:{}};const{Symbol:Ks,SymbolAsyncIterator:Sa,SymbolIterator:Ea,SymbolFor:Qc}=Nt,ef=Ks("kDestroyed"),tf=Ks("kIsErrored"),Xi=Ks("kIsReadable"),nf=Ks("kIsDisturbed"),Md=Qc("nodejs.webstream.isClosedPromise"),Ud=Qc("nodejs.webstream.controllerErrorFunction");function Ws(n,e=!1){var t;return!!(n&&typeof n.pipe=="function"&&typeof n.on=="function"&&(!e||typeof n.pause=="function"&&typeof n.resume=="function")&&(!n._writableState||((t=n._readableState)===null||t===void 0?void 0:t.readable)!==!1)&&(!n._writableState||n._readableState))}function Hs(n){var e;return!!(n&&typeof n.write=="function"&&typeof n.on=="function"&&(!n._readableState||((e=n._writableState)===null||e===void 0?void 0:e.writable)!==!1))}function Dd(n){return!!(n&&typeof n.pipe=="function"&&n._readableState&&typeof n.on=="function"&&typeof n.write=="function")}function Cn(n){return n&&(n._readableState||n._writableState||typeof n.write=="function"&&typeof n.on=="function"||typeof n.pipe=="function"&&typeof n.on=="function")}function rf(n){return!!(n&&!Cn(n)&&typeof n.pipeThrough=="function"&&typeof n.getReader=="function"&&typeof n.cancel=="function")}function sf(n){return!!(n&&!Cn(n)&&typeof n.getWriter=="function"&&typeof n.abort=="function")}function of(n){return!!(n&&!Cn(n)&&typeof n.readable=="object"&&typeof n.writable=="object")}function $d(n){return rf(n)||sf(n)||of(n)}function Fd(n,e){return n==null?!1:e===!0?typeof n[Sa]=="function":e===!1?typeof n[Ea]=="function":typeof n[Sa]=="function"||typeof n[Ea]=="function"}function zs(n){if(!Cn(n))return null;const e=n._writableState,t=n._readableState,r=e||t;return!!(n.destroyed||n[ef]||r!=null&&r.destroyed)}function af(n){if(!Hs(n))return null;if(n.writableEnded===!0)return!0;const e=n._writableState;return e!=null&&e.errored?!1:typeof(e==null?void 0:e.ended)!="boolean"?null:e.ended}function qd(n,e){if(!Hs(n))return null;if(n.writableFinished===!0)return!0;const t=n._writableState;return t!=null&&t.errored?!1:typeof(t==null?void 0:t.finished)!="boolean"?null:!!(t.finished||e===!1&&t.ended===!0&&t.length===0)}function jd(n){if(!Ws(n))return null;if(n.readableEnded===!0)return!0;const e=n._readableState;return!e||e.errored?!1:typeof(e==null?void 0:e.ended)!="boolean"?null:e.ended}function cf(n,e){if(!Ws(n))return null;const t=n._readableState;return t!=null&&t.errored?!1:typeof(t==null?void 0:t.endEmitted)!="boolean"?null:!!(t.endEmitted||e===!1&&t.ended===!0&&t.length===0)}function ff(n){return n&&n[Xi]!=null?n[Xi]:typeof(n==null?void 0:n.readable)!="boolean"?null:zs(n)?!1:Ws(n)&&n.readable&&!cf(n)}function uf(n){return typeof(n==null?void 0:n.writable)!="boolean"?null:zs(n)?!1:Hs(n)&&n.writable&&!af(n)}function Kd(n,e){return Cn(n)?zs(n)?!0:!((e==null?void 0:e.readable)!==!1&&ff(n)||(e==null?void 0:e.writable)!==!1&&uf(n)):null}function Wd(n){var e,t;return Cn(n)?n.writableErrored?n.writableErrored:(e=(t=n._writableState)===null||t===void 0?void 0:t.errored)!==null&&e!==void 0?e:null:null}function Hd(n){var e,t;return Cn(n)?n.readableErrored?n.readableErrored:(e=(t=n._readableState)===null||t===void 0?void 0:t.errored)!==null&&e!==void 0?e:null:null}function zd(n){if(!Cn(n))return null;if(typeof n.closed=="boolean")return n.closed;const e=n._writableState,t=n._readableState;return typeof(e==null?void 0:e.closed)=="boolean"||typeof(t==null?void 0:t.closed)=="boolean"?(e==null?void 0:e.closed)||(t==null?void 0:t.closed):typeof n._closed=="boolean"&&lf(n)?n._closed:null}function lf(n){return typeof n._closed=="boolean"&&typeof n._defaultKeepAlive=="boolean"&&typeof n._removedConnection=="boolean"&&typeof n._removedContLen=="boolean"}function df(n){return typeof n._sent100=="boolean"&&lf(n)}function Gd(n){var e;return typeof n._consuming=="boolean"&&typeof n._dumped=="boolean"&&((e=n.req)===null||e===void 0?void 0:e.upgradeOrConnect)===void 0}function Vd(n){if(!Cn(n))return null;const e=n._writableState,t=n._readableState,r=e||t;return!r&&df(n)||!!(r&&r.autoDestroy&&r.emitClose&&r.closed===!1)}function Yd(n){var e;return!!(n&&((e=n[nf])!==null&&e!==void 0?e:n.readableDidRead||n.readableAborted))}function Zd(n){var e,t,r,s,i,o,c,f,l,p;return!!(n&&((e=(t=(r=(s=(i=(o=n[tf])!==null&&o!==void 0?o:n.readableErrored)!==null&&i!==void 0?i:n.writableErrored)!==null&&s!==void 0?s:(c=n._readableState)===null||c===void 0?void 0:c.errorEmitted)!==null&&r!==void 0?r:(f=n._writableState)===null||f===void 0?void 0:f.errorEmitted)!==null&&t!==void 0?t:(l=n._readableState)===null||l===void 0?void 0:l.errored)!==null&&e!==void 0?e:!((p=n._writableState)===null||p===void 0)&&p.errored))}var zn={kDestroyed:ef,isDisturbed:Yd,kIsDisturbed:nf,isErrored:Zd,kIsErrored:tf,isReadable:ff,kIsReadable:Xi,kIsClosedPromise:Md,kControllerErrorFunction:Ud,isClosed:zd,isDestroyed:zs,isDuplexNodeStream:Dd,isFinished:Kd,isIterable:Fd,isReadableNodeStream:Ws,isReadableStream:rf,isReadableEnded:jd,isReadableFinished:cf,isReadableErrored:Hd,isNodeStream:Cn,isWebStream:$d,isWritable:uf,isWritableNodeStream:Hs,isWritableStream:sf,isWritableEnded:af,isWritableFinished:qd,isWritableErrored:Wd,isServerRequest:Gd,isServerResponse:df,willEmitClose:Vd,isTransformStream:of};const rr=_r,{AbortError:hf,codes:Xd}=nn,{ERR_INVALID_ARG_TYPE:Jd,ERR_STREAM_PREMATURE_CLOSE:va}=Xd,{kEmptyObject:Ji,once:Qi}=Hn,{validateAbortSignal:Qd,validateFunction:eh,validateObject:th,validateBoolean:nh}=js,{Promise:rh,PromisePrototypeThen:sh}=Nt,{isClosed:ih,isReadable:Aa,isReadableNodeStream:yi,isReadableStream:oh,isReadableFinished:Ra,isReadableErrored:Ia,isWritable:ka,isWritableNodeStream:Ba,isWritableStream:ah,isWritableFinished:Ta,isWritableErrored:Ca,isNodeStream:ch,willEmitClose:fh,kIsClosedPromise:uh}=zn;function lh(n){return n.setHeader&&typeof n.abort=="function"}const eo=()=>{};function pf(n,e,t){var r,s;if(arguments.length===2?(t=e,e=Ji):e==null?e=Ji:th(e,"options"),eh(t,"callback"),Qd(e.signal,"options.signal"),t=Qi(t),oh(n)||ah(n))return dh(n,e,t);if(!ch(n))throw new Jd("stream",["ReadableStream","WritableStream","Stream"],n);const i=(r=e.readable)!==null&&r!==void 0?r:yi(n),o=(s=e.writable)!==null&&s!==void 0?s:Ba(n),c=n._writableState,f=n._readableState,l=()=>{n.writable||k()};let p=fh(n)&&yi(n)===i&&Ba(n)===o,x=Ta(n,!1);const k=()=>{x=!0,n.destroyed&&(p=!1),!(p&&(!n.readable||i))&&(!i||E)&&t.call(n)};let E=Ra(n,!1);const b=()=>{E=!0,n.destroyed&&(p=!1),!(p&&(!n.writable||o))&&(!o||x)&&t.call(n)},_=D=>{t.call(n,D)};let v=ih(n);const I=()=>{v=!0;const D=Ca(n)||Ia(n);if(D&&typeof D!="boolean")return t.call(n,D);if(i&&!E&&yi(n,!0)&&!Ra(n,!1))return t.call(n,new va);if(o&&!x&&!Ta(n,!1))return t.call(n,new va);t.call(n)},A=()=>{v=!0;const D=Ca(n)||Ia(n);if(D&&typeof D!="boolean")return t.call(n,D);t.call(n)},T=()=>{n.req.on("finish",k)};lh(n)?(n.on("complete",k),p||n.on("abort",I),n.req?T():n.on("request",T)):o&&!c&&(n.on("end",l),n.on("close",l)),!p&&typeof n.aborted=="boolean"&&n.on("aborted",I),n.on("end",b),n.on("finish",k),e.error!==!1&&n.on("error",_),n.on("close",I),v?rr.nextTick(I):c!=null&&c.errorEmitted||f!=null&&f.errorEmitted?p||rr.nextTick(A):(!i&&(!p||Aa(n))&&(x||ka(n)===!1)||!o&&(!p||ka(n))&&(E||Aa(n)===!1)||f&&n.req&&n.aborted)&&rr.nextTick(A);const $=()=>{t=eo,n.removeListener("aborted",I),n.removeListener("complete",k),n.removeListener("abort",I),n.removeListener("request",T),n.req&&n.req.removeListener("finish",k),n.removeListener("end",l),n.removeListener("close",l),n.removeListener("finish",k),n.removeListener("end",b),n.removeListener("error",_),n.removeListener("close",I)};if(e.signal&&!v){const D=()=>{const P=t;$(),P.call(n,new hf(void 0,{cause:e.signal.reason}))};if(e.signal.aborted)rr.nextTick(D);else{const P=t;t=Qi((...H)=>{e.signal.removeEventListener("abort",D),P.apply(n,H)}),e.signal.addEventListener("abort",D)}}return $}function dh(n,e,t){let r=!1,s=eo;if(e.signal)if(s=()=>{r=!0,t.call(n,new hf(void 0,{cause:e.signal.reason}))},e.signal.aborted)rr.nextTick(s);else{const o=t;t=Qi((...c)=>{e.signal.removeEventListener("abort",s),o.apply(n,c)}),e.signal.addEventListener("abort",s)}const i=(...o)=>{r||rr.nextTick(()=>t.apply(n,o))};return sh(n[uh].promise,i,i),eo}function hh(n,e){var t;let r=!1;return e===null&&(e=Ji),(t=e)!==null&&t!==void 0&&t.cleanup&&(nh(e.cleanup,"cleanup"),r=e.cleanup),new rh((s,i)=>{const o=pf(n,e,c=>{r&&o(),c?i(c):s()})})}Eo.exports=pf;Eo.exports.finished=hh;var ar=Eo.exports;const In=_r,{aggregateTwoErrors:ph,codes:{ERR_MULTIPLE_CALLBACK:gh},AbortError:yh}=nn,{Symbol:gf}=Nt,{kDestroyed:bh,isDestroyed:wh,isFinished:mh,isServerRequest:xh}=zn,yf=gf("kDestroy"),to=gf("kConstruct");function bf(n,e,t){n&&(n.stack,e&&!e.errored&&(e.errored=n),t&&!t.errored&&(t.errored=n))}function _h(n,e){const t=this._readableState,r=this._writableState,s=r||t;return r!=null&&r.destroyed||t!=null&&t.destroyed?(typeof e=="function"&&e(),this):(bf(n,r,t),r&&(r.destroyed=!0),t&&(t.destroyed=!0),s.constructed?Pa(this,n,e):this.once(yf,function(i){Pa(this,ph(i,n),e)}),this)}function Pa(n,e,t){let r=!1;function s(i){if(r)return;r=!0;const o=n._readableState,c=n._writableState;bf(i,c,o),c&&(c.closed=!0),o&&(o.closed=!0),typeof t=="function"&&t(i),i?In.nextTick(Sh,n,i):In.nextTick(wf,n)}try{n._destroy(e||null,s)}catch(i){s(i)}}function Sh(n,e){no(n,e),wf(n)}function wf(n){const e=n._readableState,t=n._writableState;t&&(t.closeEmitted=!0),e&&(e.closeEmitted=!0),(t!=null&&t.emitClose||e!=null&&e.emitClose)&&n.emit("close")}function no(n,e){const t=n._readableState,r=n._writableState;r!=null&&r.errorEmitted||t!=null&&t.errorEmitted||(r&&(r.errorEmitted=!0),t&&(t.errorEmitted=!0),n.emit("error",e))}function Eh(){const n=this._readableState,e=this._writableState;n&&(n.constructed=!0,n.closed=!1,n.closeEmitted=!1,n.destroyed=!1,n.errored=null,n.errorEmitted=!1,n.reading=!1,n.ended=n.readable===!1,n.endEmitted=n.readable===!1),e&&(e.constructed=!0,e.destroyed=!1,e.closed=!1,e.closeEmitted=!1,e.errored=null,e.errorEmitted=!1,e.finalCalled=!1,e.prefinished=!1,e.ended=e.writable===!1,e.ending=e.writable===!1,e.finished=e.writable===!1)}function ro(n,e,t){const r=n._readableState,s=n._writableState;if(s!=null&&s.destroyed||r!=null&&r.destroyed)return this;r!=null&&r.autoDestroy||s!=null&&s.autoDestroy?n.destroy(e):e&&(e.stack,s&&!s.errored&&(s.errored=e),r&&!r.errored&&(r.errored=e),t?In.nextTick(no,n,e):no(n,e))}function vh(n,e){if(typeof n._construct!="function")return;const t=n._readableState,r=n._writableState;t&&(t.constructed=!1),r&&(r.constructed=!1),n.once(to,e),!(n.listenerCount(to)>1)&&In.nextTick(Ah,n)}function Ah(n){let e=!1;function t(r){if(e){ro(n,r??new gh);return}e=!0;const s=n._readableState,i=n._writableState,o=i||s;s&&(s.constructed=!0),i&&(i.constructed=!0),o.destroyed?n.emit(yf,r):r?ro(n,r,!0):In.nextTick(Rh,n)}try{n._construct(r=>{In.nextTick(t,r)})}catch(r){In.nextTick(t,r)}}function Rh(n){n.emit(to)}function La(n){return(n==null?void 0:n.setHeader)&&typeof n.abort=="function"}function mf(n){n.emit("close")}function Ih(n,e){n.emit("error",e),In.nextTick(mf,n)}function kh(n,e){!n||wh(n)||(!e&&!mh(n)&&(e=new yh),xh(n)?(n.socket=null,n.destroy(e)):La(n)?n.abort():La(n.req)?n.req.abort():typeof n.destroy=="function"?n.destroy(e):typeof n.close=="function"?n.close():e?In.nextTick(Ih,n,e):In.nextTick(mf,n),n.destroyed||(n[bh]=!0))}var jr={construct:vh,destroyer:kh,destroy:_h,undestroy:Eh,errorOrDestroy:ro};const{ArrayIsArray:Bh,ObjectSetPrototypeOf:xf}=Nt,{EventEmitter:Gs}=Fs;function Vs(n){Gs.call(this,n)}xf(Vs.prototype,Gs.prototype);xf(Vs,Gs);Vs.prototype.pipe=function(n,e){const t=this;function r(p){n.writable&&n.write(p)===!1&&t.pause&&t.pause()}t.on("data",r);function s(){t.readable&&t.resume&&t.resume()}n.on("drain",s),!n._isStdio&&(!e||e.end!==!1)&&(t.on("end",o),t.on("close",c));let i=!1;function o(){i||(i=!0,n.end())}function c(){i||(i=!0,typeof n.destroy=="function"&&n.destroy())}function f(p){l(),Gs.listenerCount(this,"error")===0&&this.emit("error",p)}so(t,"error",f),so(n,"error",f);function l(){t.removeListener("data",r),n.removeListener("drain",s),t.removeListener("end",o),t.removeListener("close",c),t.removeListener("error",f),n.removeListener("error",f),t.removeListener("end",l),t.removeListener("close",l),n.removeListener("close",l)}return t.on("end",l),t.on("close",l),n.on("close",l),n.emit("pipe",t),n};function so(n,e,t){if(typeof n.prependListener=="function")return n.prependListener(e,t);!n._events||!n._events[e]?n.on(e,t):Bh(n._events[e])?n._events[e].unshift(t):n._events[e]=[t,n._events[e]]}var vo={Stream:Vs,prependListener:so},_f={exports:{}};(function(n){const{AbortError:e,codes:t}=nn,{isNodeStream:r,isWebStream:s,kControllerErrorFunction:i}=zn,o=ar,{ERR_INVALID_ARG_TYPE:c}=t,f=(l,p)=>{if(typeof l!="object"||!("aborted"in l))throw new c(p,"AbortSignal",l)};n.exports.addAbortSignal=function(p,x){if(f(p,"signal"),!r(x)&&!s(x))throw new c("stream",["ReadableStream","WritableStream","Stream"],x);return n.exports.addAbortSignalNoValidate(p,x)},n.exports.addAbortSignalNoValidate=function(l,p){if(typeof l!="object"||!("aborted"in l))return p;const x=r(p)?()=>{p.destroy(new e(void 0,{cause:l.reason}))}:()=>{p[i](new e(void 0,{cause:l.reason}))};return l.aborted?x():(l.addEventListener("abort",x),o(p,()=>l.removeEventListener("abort",x))),p}})(_f);var Ys=_f.exports;const{StringPrototypeSlice:Oa,SymbolIterator:Th,TypedArrayPrototypeSet:gs,Uint8Array:Ch}=Nt,{Buffer:bi}=$e,{inspect:Ph}=Hn;var Lh=class{constructor(){this.head=null,this.tail=null,this.length=0}push(e){const t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length}unshift(e){const t={data:e,next:this.head};this.length===0&&(this.tail=t),this.head=t,++this.length}shift(){if(this.length===0)return;const e=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,e}clear(){this.head=this.tail=null,this.length=0}join(e){if(this.length===0)return"";let t=this.head,r=""+t.data;for(;(t=t.next)!==null;)r+=e+t.data;return r}concat(e){if(this.length===0)return bi.alloc(0);const t=bi.allocUnsafe(e>>>0);let r=this.head,s=0;for(;r;)gs(t,r.data,s),s+=r.data.length,r=r.next;return t}consume(e,t){const r=this.head.data;if(e<r.length){const s=r.slice(0,e);return this.head.data=r.slice(e),s}return e===r.length?this.shift():t?this._getString(e):this._getBuffer(e)}first(){return this.head.data}*[Th](){for(let e=this.head;e;e=e.next)yield e.data}_getString(e){let t="",r=this.head,s=0;do{const i=r.data;if(e>i.length)t+=i,e-=i.length;else{e===i.length?(t+=i,++s,r.next?this.head=r.next:this.head=this.tail=null):(t+=Oa(i,0,e),this.head=r,r.data=Oa(i,e));break}++s}while((r=r.next)!==null);return this.length-=s,t}_getBuffer(e){const t=bi.allocUnsafe(e),r=e;let s=this.head,i=0;do{const o=s.data;if(e>o.length)gs(t,o,r-e),e-=o.length;else{e===o.length?(gs(t,o,r-e),++i,s.next?this.head=s.next:this.head=this.tail=null):(gs(t,new Ch(o.buffer,o.byteOffset,e),r-e),this.head=s,s.data=o.slice(e));break}++i}while((s=s.next)!==null);return this.length-=i,t}[Symbol.for("nodejs.util.inspect.custom")](e,t){return Ph(this,{...t,depth:0,customInspect:!1})}};const{MathFloor:Oh,NumberIsInteger:Nh}=Nt,{ERR_INVALID_ARG_VALUE:Mh}=nn.codes;function Uh(n,e,t){return n.highWaterMark!=null?n.highWaterMark:e?n[t]:null}function Sf(n){return n?16:16*1024}function Dh(n,e,t,r){const s=Uh(e,r,t);if(s!=null){if(!Nh(s)||s<0){const i=r?`options.${t}`:"options.highWaterMark";throw new Mh(i,s)}return Oh(s)}return Sf(n.objectMode)}var Ao={getHighWaterMark:Dh,getDefaultHighWaterMark:Sf};const Na=_r,{PromisePrototypeThen:$h,SymbolAsyncIterator:Ma,SymbolIterator:Ua}=Nt,{Buffer:Fh}=$e,{ERR_INVALID_ARG_TYPE:qh,ERR_STREAM_NULL_VALUES:jh}=nn.codes;function Kh(n,e,t){let r;if(typeof e=="string"||e instanceof Fh)return new n({objectMode:!0,...t,read(){this.push(e),this.push(null)}});let s;if(e&&e[Ma])s=!0,r=e[Ma]();else if(e&&e[Ua])s=!1,r=e[Ua]();else throw new qh("iterable",["Iterable"],e);const i=new n({objectMode:!0,highWaterMark:1,...t});let o=!1;i._read=function(){o||(o=!0,f())},i._destroy=function(l,p){$h(c(l),()=>Na.nextTick(p,l),x=>Na.nextTick(p,x||l))};async function c(l){const p=l!=null,x=typeof r.throw=="function";if(p&&x){const{value:k,done:E}=await r.throw(l);if(await k,E)return}if(typeof r.return=="function"){const{value:k}=await r.return();await k}}async function f(){for(;;){try{const{value:l,done:p}=s?await r.next():r.next();if(p)i.push(null);else{const x=l&&typeof l.then=="function"?await l:l;if(x===null)throw o=!1,new jh;if(i.push(x))continue;o=!1}}catch(l){i.destroy(l)}break}}return i}var Ef=Kh,wi,Da;function Zs(){if(Da)return wi;Da=1;const n=_r,{ArrayPrototypeIndexOf:e,NumberIsInteger:t,NumberIsNaN:r,NumberParseInt:s,ObjectDefineProperties:i,ObjectKeys:o,ObjectSetPrototypeOf:c,Promise:f,SafeSet:l,SymbolAsyncIterator:p,Symbol:x}=Nt;wi=m,m.ReadableState=R;const{EventEmitter:k}=Fs,{Stream:E,prependListener:b}=vo,{Buffer:_}=$e,{addAbortSignal:v}=Ys,I=ar;let A=Hn.debuglog("stream",y=>{A=y});const T=Lh,$=jr,{getHighWaterMark:D,getDefaultHighWaterMark:P}=Ao,{aggregateTwoErrors:H,codes:{ERR_INVALID_ARG_TYPE:K,ERR_METHOD_NOT_IMPLEMENTED:ie,ERR_OUT_OF_RANGE:F,ERR_STREAM_PUSH_AFTER_EOF:oe,ERR_STREAM_UNSHIFT_AFTER_END_EVENT:Pe}}=nn,{validateObject:ve}=js,Me=x("kPaused"),{StringDecoder:W}=Xu,te=Ef;c(m.prototype,E.prototype),c(m,E);const be=()=>{},{errorOrDestroy:z}=$;function R(y,w,ce){typeof ce!="boolean"&&(ce=w instanceof jn()),this.objectMode=!!(y&&y.objectMode),ce&&(this.objectMode=this.objectMode||!!(y&&y.readableObjectMode)),this.highWaterMark=y?D(this,y,"readableHighWaterMark",ce):P(!1),this.buffer=new T,this.length=0,this.pipes=[],this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.constructed=!0,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this[Me]=null,this.errorEmitted=!1,this.emitClose=!y||y.emitClose!==!1,this.autoDestroy=!y||y.autoDestroy!==!1,this.destroyed=!1,this.errored=null,this.closed=!1,this.closeEmitted=!1,this.defaultEncoding=y&&y.defaultEncoding||"utf8",this.awaitDrainWriters=null,this.multiAwaitDrain=!1,this.readingMore=!1,this.dataEmitted=!1,this.decoder=null,this.encoding=null,y&&y.encoding&&(this.decoder=new W(y.encoding),this.encoding=y.encoding)}function m(y){if(!(this instanceof m))return new m(y);const w=this instanceof jn();this._readableState=new R(y,this,w),y&&(typeof y.read=="function"&&(this._read=y.read),typeof y.destroy=="function"&&(this._destroy=y.destroy),typeof y.construct=="function"&&(this._construct=y.construct),y.signal&&!w&&v(y.signal,this)),E.call(this,y),$.construct(this,()=>{this._readableState.needReadable&&Ke(this,this._readableState)})}m.prototype.destroy=$.destroy,m.prototype._undestroy=$.undestroy,m.prototype._destroy=function(y,w){w(y)},m.prototype[k.captureRejectionSymbol]=function(y){this.destroy(y)},m.prototype.push=function(y,w){return M(this,y,w,!1)},m.prototype.unshift=function(y,w){return M(this,y,w,!0)};function M(y,w,ce,fe){A("readableAddChunk",w);const _e=y._readableState;let Tt;if(_e.objectMode||(typeof w=="string"?(ce=ce||_e.defaultEncoding,_e.encoding!==ce&&(fe&&_e.encoding?w=_.from(w,ce).toString(_e.encoding):(w=_.from(w,ce),ce=""))):w instanceof _?ce="":E._isUint8Array(w)?(w=E._uint8ArrayToBuffer(w),ce=""):w!=null&&(Tt=new K("chunk",["string","Buffer","Uint8Array"],w))),Tt)z(y,Tt);else if(w===null)_e.reading=!1,we(y,_e);else if(_e.objectMode||w&&w.length>0)if(fe)if(_e.endEmitted)z(y,new Pe);else{if(_e.destroyed||_e.errored)return!1;Z(y,_e,w,!0)}else if(_e.ended)z(y,new oe);else{if(_e.destroyed||_e.errored)return!1;_e.reading=!1,_e.decoder&&!ce?(w=_e.decoder.write(w),_e.objectMode||w.length!==0?Z(y,_e,w,!1):Ke(y,_e)):Z(y,_e,w,!1)}else fe||(_e.reading=!1,Ke(y,_e));return!_e.ended&&(_e.length<_e.highWaterMark||_e.length===0)}function Z(y,w,ce,fe){w.flowing&&w.length===0&&!w.sync&&y.listenerCount("data")>0?(w.multiAwaitDrain?w.awaitDrainWriters.clear():w.awaitDrainWriters=null,w.dataEmitted=!0,y.emit("data",ce)):(w.length+=w.objectMode?1:ce.length,fe?w.buffer.unshift(ce):w.buffer.push(ce),w.needReadable&&Te(y)),Ke(y,w)}m.prototype.isPaused=function(){const y=this._readableState;return y[Me]===!0||y.flowing===!1},m.prototype.setEncoding=function(y){const w=new W(y);this._readableState.decoder=w,this._readableState.encoding=this._readableState.decoder.encoding;const ce=this._readableState.buffer;let fe="";for(const _e of ce)fe+=w.write(_e);return ce.clear(),fe!==""&&ce.push(fe),this._readableState.length=fe.length,this};const ne=1073741824;function Q(y){if(y>ne)throw new F("size","<= 1GiB",y);return y--,y|=y>>>1,y|=y>>>2,y|=y>>>4,y|=y>>>8,y|=y>>>16,y++,y}function re(y,w){return y<=0||w.length===0&&w.ended?0:w.objectMode?1:r(y)?w.flowing&&w.length?w.buffer.first().length:w.length:y<=w.length?y:w.ended?w.length:0}m.prototype.read=function(y){A("read",y),y===void 0?y=NaN:t(y)||(y=s(y,10));const w=this._readableState,ce=y;if(y>w.highWaterMark&&(w.highWaterMark=Q(y)),y!==0&&(w.emittedReadable=!1),y===0&&w.needReadable&&((w.highWaterMark!==0?w.length>=w.highWaterMark:w.length>0)||w.ended))return A("read: emitReadable",w.length,w.ended),w.length===0&&w.ended?$t(this):Te(this),null;if(y=re(y,w),y===0&&w.ended)return w.length===0&&$t(this),null;let fe=w.needReadable;if(A("need readable",fe),(w.length===0||w.length-y<w.highWaterMark)&&(fe=!0,A("length less than watermark",fe)),w.ended||w.reading||w.destroyed||w.errored||!w.constructed)fe=!1,A("reading, ended or constructing",fe);else if(fe){A("do read"),w.reading=!0,w.sync=!0,w.length===0&&(w.needReadable=!0);try{this._read(w.highWaterMark)}catch(Tt){z(this,Tt)}w.sync=!1,w.reading||(y=re(ce,w))}let _e;return y>0?_e=st(y,w):_e=null,_e===null?(w.needReadable=w.length<=w.highWaterMark,y=0):(w.length-=y,w.multiAwaitDrain?w.awaitDrainWriters.clear():w.awaitDrainWriters=null),w.length===0&&(w.ended||(w.needReadable=!0),ce!==y&&w.ended&&$t(this)),_e!==null&&!w.errorEmitted&&!w.closeEmitted&&(w.dataEmitted=!0,this.emit("data",_e)),_e};function we(y,w){if(A("onEofChunk"),!w.ended){if(w.decoder){const ce=w.decoder.end();ce&&ce.length&&(w.buffer.push(ce),w.length+=w.objectMode?1:ce.length)}w.ended=!0,w.sync?Te(y):(w.needReadable=!1,w.emittedReadable=!0,et(y))}}function Te(y){const w=y._readableState;A("emitReadable",w.needReadable,w.emittedReadable),w.needReadable=!1,w.emittedReadable||(A("emitReadable",w.flowing),w.emittedReadable=!0,n.nextTick(et,y))}function et(y){const w=y._readableState;A("emitReadable_",w.destroyed,w.length,w.ended),!w.destroyed&&!w.errored&&(w.length||w.ended)&&(y.emit("readable"),w.emittedReadable=!1),w.needReadable=!w.flowing&&!w.ended&&w.length<=w.highWaterMark,xe(y)}function Ke(y,w){!w.readingMore&&w.constructed&&(w.readingMore=!0,n.nextTick(rt,y,w))}function rt(y,w){for(;!w.reading&&!w.ended&&(w.length<w.highWaterMark||w.flowing&&w.length===0);){const ce=w.length;if(A("maybeReadMore read 0"),y.read(0),ce===w.length)break}w.readingMore=!1}m.prototype._read=function(y){throw new ie("_read()")},m.prototype.pipe=function(y,w){const ce=this,fe=this._readableState;fe.pipes.length===1&&(fe.multiAwaitDrain||(fe.multiAwaitDrain=!0,fe.awaitDrainWriters=new l(fe.awaitDrainWriters?[fe.awaitDrainWriters]:[]))),fe.pipes.push(y),A("pipe count=%d opts=%j",fe.pipes.length,w);const Tt=(!w||w.end!==!1)&&y!==n.stdout&&y!==n.stderr?Gn:Xn;fe.endEmitted?n.nextTick(Tt):ce.once("end",Tt),y.on("unpipe",Mt);function Mt(Un,wn){A("onunpipe"),Un===ce&&wn&&wn.hasUnpiped===!1&&(wn.hasUnpiped=!0,Yn())}function Gn(){A("onend"),y.end()}let Jt,Vn=!1;function Yn(){A("cleanup"),y.removeListener("close",Mn),y.removeListener("finish",fr),Jt&&y.removeListener("drain",Jt),y.removeListener("error",Nn),y.removeListener("unpipe",Mt),ce.removeListener("end",Gn),ce.removeListener("end",Xn),ce.removeListener("data",cr),Vn=!0,Jt&&fe.awaitDrainWriters&&(!y._writableState||y._writableState.needDrain)&&Jt()}function Zn(){Vn||(fe.pipes.length===1&&fe.pipes[0]===y?(A("false write response, pause",0),fe.awaitDrainWriters=y,fe.multiAwaitDrain=!1):fe.pipes.length>1&&fe.pipes.includes(y)&&(A("false write response, pause",fe.awaitDrainWriters.size),fe.awaitDrainWriters.add(y)),ce.pause()),Jt||(Jt=gt(ce,y),y.on("drain",Jt))}ce.on("data",cr);function cr(Un){A("ondata");const wn=y.write(Un);A("dest.write",wn),wn===!1&&Zn()}function Nn(Un){if(A("onerror",Un),Xn(),y.removeListener("error",Nn),y.listenerCount("error")===0){const wn=y._writableState||y._readableState;wn&&!wn.errorEmitted?z(y,Un):y.emit("error",Un)}}b(y,"error",Nn);function Mn(){y.removeListener("finish",fr),Xn()}y.once("close",Mn);function fr(){A("onfinish"),y.removeListener("close",Mn),Xn()}y.once("finish",fr);function Xn(){A("unpipe"),ce.unpipe(y)}return y.emit("pipe",ce),y.writableNeedDrain===!0?fe.flowing&&Zn():fe.flowing||(A("pipe resume"),ce.resume()),y};function gt(y,w){return function(){const fe=y._readableState;fe.awaitDrainWriters===w?(A("pipeOnDrain",1),fe.awaitDrainWriters=null):fe.multiAwaitDrain&&(A("pipeOnDrain",fe.awaitDrainWriters.size),fe.awaitDrainWriters.delete(w)),(!fe.awaitDrainWriters||fe.awaitDrainWriters.size===0)&&y.listenerCount("data")&&y.resume()}}m.prototype.unpipe=function(y){const w=this._readableState,ce={hasUnpiped:!1};if(w.pipes.length===0)return this;if(!y){const _e=w.pipes;w.pipes=[],this.pause();for(let Tt=0;Tt<_e.length;Tt++)_e[Tt].emit("unpipe",this,{hasUnpiped:!1});return this}const fe=e(w.pipes,y);return fe===-1?this:(w.pipes.splice(fe,1),w.pipes.length===0&&this.pause(),y.emit("unpipe",this,ce),this)},m.prototype.on=function(y,w){const ce=E.prototype.on.call(this,y,w),fe=this._readableState;return y==="data"?(fe.readableListening=this.listenerCount("readable")>0,fe.flowing!==!1&&this.resume()):y==="readable"&&!fe.endEmitted&&!fe.readableListening&&(fe.readableListening=fe.needReadable=!0,fe.flowing=!1,fe.emittedReadable=!1,A("on readable",fe.length,fe.reading),fe.length?Te(this):fe.reading||n.nextTick(B,this)),ce},m.prototype.addListener=m.prototype.on,m.prototype.removeListener=function(y,w){const ce=E.prototype.removeListener.call(this,y,w);return y==="readable"&&n.nextTick(yt,this),ce},m.prototype.off=m.prototype.removeListener,m.prototype.removeAllListeners=function(y){const w=E.prototype.removeAllListeners.apply(this,arguments);return(y==="readable"||y===void 0)&&n.nextTick(yt,this),w};function yt(y){const w=y._readableState;w.readableListening=y.listenerCount("readable")>0,w.resumeScheduled&&w[Me]===!1?w.flowing=!0:y.listenerCount("data")>0?y.resume():w.readableListening||(w.flowing=null)}function B(y){A("readable nexttick read 0"),y.read(0)}m.prototype.resume=function(){const y=this._readableState;return y.flowing||(A("resume"),y.flowing=!y.readableListening,L(this,y)),y[Me]=!1,this};function L(y,w){w.resumeScheduled||(w.resumeScheduled=!0,n.nextTick(X,y,w))}function X(y,w){A("resume",w.reading),w.reading||y.read(0),w.resumeScheduled=!1,y.emit("resume"),xe(y),w.flowing&&!w.reading&&y.read(0)}m.prototype.pause=function(){return A("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(A("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState[Me]=!0,this};function xe(y){const w=y._readableState;for(A("flow",w.flowing);w.flowing&&y.read()!==null;);}m.prototype.wrap=function(y){let w=!1;y.on("data",fe=>{!this.push(fe)&&y.pause&&(w=!0,y.pause())}),y.on("end",()=>{this.push(null)}),y.on("error",fe=>{z(this,fe)}),y.on("close",()=>{this.destroy()}),y.on("destroy",()=>{this.destroy()}),this._read=()=>{w&&y.resume&&(w=!1,y.resume())};const ce=o(y);for(let fe=1;fe<ce.length;fe++){const _e=ce[fe];this[_e]===void 0&&typeof y[_e]=="function"&&(this[_e]=y[_e].bind(y))}return this},m.prototype[p]=function(){return Ae(this)},m.prototype.iterator=function(y){return y!==void 0&&ve(y,"options"),Ae(this,y)};function Ae(y,w){typeof y.read!="function"&&(y=m.wrap(y,{objectMode:!0}));const ce=dt(y,w);return ce.stream=y,ce}async function*dt(y,w){let ce=be;function fe(Mt){this===y?(ce(),ce=be):ce=Mt}y.on("readable",fe);let _e;const Tt=I(y,{writable:!1},Mt=>{_e=Mt?H(_e,Mt):null,ce(),ce=be});try{for(;;){const Mt=y.destroyed?null:y.read();if(Mt!==null)yield Mt;else{if(_e)throw _e;if(_e===null)return;await new f(fe)}}}catch(Mt){throw _e=H(_e,Mt),_e}finally{(_e||(w==null?void 0:w.destroyOnReturn)!==!1)&&(_e===void 0||y._readableState.autoDestroy)?$.destroyer(y,null):(y.off("readable",fe),Tt())}}i(m.prototype,{readable:{__proto__:null,get(){const y=this._readableState;return!!y&&y.readable!==!1&&!y.destroyed&&!y.errorEmitted&&!y.endEmitted},set(y){this._readableState&&(this._readableState.readable=!!y)}},readableDidRead:{__proto__:null,enumerable:!1,get:function(){return this._readableState.dataEmitted}},readableAborted:{__proto__:null,enumerable:!1,get:function(){return!!(this._readableState.readable!==!1&&(this._readableState.destroyed||this._readableState.errored)&&!this._readableState.endEmitted)}},readableHighWaterMark:{__proto__:null,enumerable:!1,get:function(){return this._readableState.highWaterMark}},readableBuffer:{__proto__:null,enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}},readableFlowing:{__proto__:null,enumerable:!1,get:function(){return this._readableState.flowing},set:function(y){this._readableState&&(this._readableState.flowing=y)}},readableLength:{__proto__:null,enumerable:!1,get(){return this._readableState.length}},readableObjectMode:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.objectMode:!1}},readableEncoding:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.encoding:null}},errored:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.errored:null}},closed:{__proto__:null,get(){return this._readableState?this._readableState.closed:!1}},destroyed:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.destroyed:!1},set(y){this._readableState&&(this._readableState.destroyed=y)}},readableEnded:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.endEmitted:!1}}}),i(R.prototype,{pipesCount:{__proto__:null,get(){return this.pipes.length}},paused:{__proto__:null,get(){return this[Me]!==!1},set(y){this[Me]=!!y}}}),m._fromList=st;function st(y,w){if(w.length===0)return null;let ce;return w.objectMode?ce=w.buffer.shift():!y||y>=w.length?(w.decoder?ce=w.buffer.join(""):w.buffer.length===1?ce=w.buffer.first():ce=w.buffer.concat(w.length),w.buffer.clear()):ce=w.buffer.consume(y,w.decoder),ce}function $t(y){const w=y._readableState;A("endReadable",w.endEmitted),w.endEmitted||(w.ended=!0,n.nextTick(yn,w,y))}function yn(y,w){if(A("endReadableNT",y.endEmitted,y.length),!y.errored&&!y.closeEmitted&&!y.endEmitted&&y.length===0){if(y.endEmitted=!0,w.emit("end"),w.writable&&w.allowHalfOpen===!1)n.nextTick(rn,w);else if(y.autoDestroy){const ce=w._writableState;(!ce||ce.autoDestroy&&(ce.finished||ce.writable===!1))&&w.destroy()}}}function rn(y){y.writable&&!y.writableEnded&&!y.destroyed&&y.end()}m.from=function(y,w){return te(m,y,w)};let Wt;function bn(){return Wt===void 0&&(Wt={}),Wt}return m.fromWeb=function(y,w){return bn().newStreamReadableFromReadableStream(y,w)},m.toWeb=function(y,w){return bn().newReadableStreamFromStreamReadable(y,w)},m.wrap=function(y,w){var ce,fe;return new m({objectMode:(ce=(fe=y.readableObjectMode)!==null&&fe!==void 0?fe:y.objectMode)!==null&&ce!==void 0?ce:!0,...w,destroy(_e,Tt){$.destroyer(y,_e),Tt(_e)}}).wrap(y)},wi}var mi,$a;function vf(){if($a)return mi;$a=1;const n=_r,{ArrayPrototypeSlice:e,Error:t,FunctionPrototypeSymbolHasInstance:r,ObjectDefineProperty:s,ObjectDefineProperties:i,ObjectSetPrototypeOf:o,StringPrototypeToLowerCase:c,Symbol:f,SymbolHasInstance:l}=Nt;mi=W,W.WritableState=ve;const{EventEmitter:p}=Fs,x=vo.Stream,{Buffer:k}=$e,E=jr,{addAbortSignal:b}=Ys,{getHighWaterMark:_,getDefaultHighWaterMark:v}=Ao,{ERR_INVALID_ARG_TYPE:I,ERR_METHOD_NOT_IMPLEMENTED:A,ERR_MULTIPLE_CALLBACK:T,ERR_STREAM_CANNOT_PIPE:$,ERR_STREAM_DESTROYED:D,ERR_STREAM_ALREADY_FINISHED:P,ERR_STREAM_NULL_VALUES:H,ERR_STREAM_WRITE_AFTER_END:K,ERR_UNKNOWN_ENCODING:ie}=nn.codes,{errorOrDestroy:F}=E;o(W.prototype,x.prototype),o(W,x);function oe(){}const Pe=f("kOnFinished");function ve(B,L,X){typeof X!="boolean"&&(X=L instanceof jn()),this.objectMode=!!(B&&B.objectMode),X&&(this.objectMode=this.objectMode||!!(B&&B.writableObjectMode)),this.highWaterMark=B?_(this,B,"writableHighWaterMark",X):v(!1),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;const xe=!!(B&&B.decodeStrings===!1);this.decodeStrings=!xe,this.defaultEncoding=B&&B.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=m.bind(void 0,L),this.writecb=null,this.writelen=0,this.afterWriteTickInfo=null,Me(this),this.pendingcb=0,this.constructed=!0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!B||B.emitClose!==!1,this.autoDestroy=!B||B.autoDestroy!==!1,this.errored=null,this.closed=!1,this.closeEmitted=!1,this[Pe]=[]}function Me(B){B.buffered=[],B.bufferedIndex=0,B.allBuffers=!0,B.allNoop=!0}ve.prototype.getBuffer=function(){return e(this.buffered,this.bufferedIndex)},s(ve.prototype,"bufferedRequestCount",{__proto__:null,get(){return this.buffered.length-this.bufferedIndex}});function W(B){const L=this instanceof jn();if(!L&&!r(W,this))return new W(B);this._writableState=new ve(B,this,L),B&&(typeof B.write=="function"&&(this._write=B.write),typeof B.writev=="function"&&(this._writev=B.writev),typeof B.destroy=="function"&&(this._destroy=B.destroy),typeof B.final=="function"&&(this._final=B.final),typeof B.construct=="function"&&(this._construct=B.construct),B.signal&&b(B.signal,this)),x.call(this,B),E.construct(this,()=>{const X=this._writableState;X.writing||Q(this,X),et(this,X)})}s(W,l,{__proto__:null,value:function(B){return r(this,B)?!0:this!==W?!1:B&&B._writableState instanceof ve}}),W.prototype.pipe=function(){F(this,new $)};function te(B,L,X,xe){const Ae=B._writableState;if(typeof X=="function")xe=X,X=Ae.defaultEncoding;else{if(!X)X=Ae.defaultEncoding;else if(X!=="buffer"&&!k.isEncoding(X))throw new ie(X);typeof xe!="function"&&(xe=oe)}if(L===null)throw new H;if(!Ae.objectMode)if(typeof L=="string")Ae.decodeStrings!==!1&&(L=k.from(L,X),X="buffer");else if(L instanceof k)X="buffer";else if(x._isUint8Array(L))L=x._uint8ArrayToBuffer(L),X="buffer";else throw new I("chunk",["string","Buffer","Uint8Array"],L);let dt;return Ae.ending?dt=new K:Ae.destroyed&&(dt=new D("write")),dt?(n.nextTick(xe,dt),F(B,dt,!0),dt):(Ae.pendingcb++,be(B,Ae,L,X,xe))}W.prototype.write=function(B,L,X){return te(this,B,L,X)===!0},W.prototype.cork=function(){this._writableState.corked++},W.prototype.uncork=function(){const B=this._writableState;B.corked&&(B.corked--,B.writing||Q(this,B))},W.prototype.setDefaultEncoding=function(L){if(typeof L=="string"&&(L=c(L)),!k.isEncoding(L))throw new ie(L);return this._writableState.defaultEncoding=L,this};function be(B,L,X,xe,Ae){const dt=L.objectMode?1:X.length;L.length+=dt;const st=L.length<L.highWaterMark;return st||(L.needDrain=!0),L.writing||L.corked||L.errored||!L.constructed?(L.buffered.push({chunk:X,encoding:xe,callback:Ae}),L.allBuffers&&xe!=="buffer"&&(L.allBuffers=!1),L.allNoop&&Ae!==oe&&(L.allNoop=!1)):(L.writelen=dt,L.writecb=Ae,L.writing=!0,L.sync=!0,B._write(X,xe,L.onwrite),L.sync=!1),st&&!L.errored&&!L.destroyed}function z(B,L,X,xe,Ae,dt,st){L.writelen=xe,L.writecb=st,L.writing=!0,L.sync=!0,L.destroyed?L.onwrite(new D("write")):X?B._writev(Ae,L.onwrite):B._write(Ae,dt,L.onwrite),L.sync=!1}function R(B,L,X,xe){--L.pendingcb,xe(X),ne(L),F(B,X)}function m(B,L){const X=B._writableState,xe=X.sync,Ae=X.writecb;if(typeof Ae!="function"){F(B,new T);return}X.writing=!1,X.writecb=null,X.length-=X.writelen,X.writelen=0,L?(L.stack,X.errored||(X.errored=L),B._readableState&&!B._readableState.errored&&(B._readableState.errored=L),xe?n.nextTick(R,B,X,L,Ae):R(B,X,L,Ae)):(X.buffered.length>X.bufferedIndex&&Q(B,X),xe?X.afterWriteTickInfo!==null&&X.afterWriteTickInfo.cb===Ae?X.afterWriteTickInfo.count++:(X.afterWriteTickInfo={count:1,cb:Ae,stream:B,state:X},n.nextTick(M,X.afterWriteTickInfo)):Z(B,X,1,Ae))}function M({stream:B,state:L,count:X,cb:xe}){return L.afterWriteTickInfo=null,Z(B,L,X,xe)}function Z(B,L,X,xe){for(!L.ending&&!B.destroyed&&L.length===0&&L.needDrain&&(L.needDrain=!1,B.emit("drain"));X-- >0;)L.pendingcb--,xe();L.destroyed&&ne(L),et(B,L)}function ne(B){if(B.writing)return;for(let Ae=B.bufferedIndex;Ae<B.buffered.length;++Ae){var L;const{chunk:dt,callback:st}=B.buffered[Ae],$t=B.objectMode?1:dt.length;B.length-=$t,st((L=B.errored)!==null&&L!==void 0?L:new D("write"))}const X=B[Pe].splice(0);for(let Ae=0;Ae<X.length;Ae++){var xe;X[Ae]((xe=B.errored)!==null&&xe!==void 0?xe:new D("end"))}Me(B)}function Q(B,L){if(L.corked||L.bufferProcessing||L.destroyed||!L.constructed)return;const{buffered:X,bufferedIndex:xe,objectMode:Ae}=L,dt=X.length-xe;if(!dt)return;let st=xe;if(L.bufferProcessing=!0,dt>1&&B._writev){L.pendingcb-=dt-1;const $t=L.allNoop?oe:rn=>{for(let Wt=st;Wt<X.length;++Wt)X[Wt].callback(rn)},yn=L.allNoop&&st===0?X:e(X,st);yn.allBuffers=L.allBuffers,z(B,L,!0,L.length,yn,"",$t),Me(L)}else{do{const{chunk:$t,encoding:yn,callback:rn}=X[st];X[st++]=null;const Wt=Ae?1:$t.length;z(B,L,!1,Wt,$t,yn,rn)}while(st<X.length&&!L.writing);st===X.length?Me(L):st>256?(X.splice(0,st),L.bufferedIndex=0):L.bufferedIndex=st}L.bufferProcessing=!1}W.prototype._write=function(B,L,X){if(this._writev)this._writev([{chunk:B,encoding:L}],X);else throw new A("_write()")},W.prototype._writev=null,W.prototype.end=function(B,L,X){const xe=this._writableState;typeof B=="function"?(X=B,B=null,L=null):typeof L=="function"&&(X=L,L=null);let Ae;if(B!=null){const dt=te(this,B,L);dt instanceof t&&(Ae=dt)}return xe.corked&&(xe.corked=1,this.uncork()),Ae||(!xe.errored&&!xe.ending?(xe.ending=!0,et(this,xe,!0),xe.ended=!0):xe.finished?Ae=new P("end"):xe.destroyed&&(Ae=new D("end"))),typeof X=="function"&&(Ae||xe.finished?n.nextTick(X,Ae):xe[Pe].push(X)),this};function re(B){return B.ending&&!B.destroyed&&B.constructed&&B.length===0&&!B.errored&&B.buffered.length===0&&!B.finished&&!B.writing&&!B.errorEmitted&&!B.closeEmitted}function we(B,L){let X=!1;function xe(Ae){if(X){F(B,Ae??T());return}if(X=!0,L.pendingcb--,Ae){const dt=L[Pe].splice(0);for(let st=0;st<dt.length;st++)dt[st](Ae);F(B,Ae,L.sync)}else re(L)&&(L.prefinished=!0,B.emit("prefinish"),L.pendingcb++,n.nextTick(Ke,B,L))}L.sync=!0,L.pendingcb++;try{B._final(xe)}catch(Ae){xe(Ae)}L.sync=!1}function Te(B,L){!L.prefinished&&!L.finalCalled&&(typeof B._final=="function"&&!L.destroyed?(L.finalCalled=!0,we(B,L)):(L.prefinished=!0,B.emit("prefinish")))}function et(B,L,X){re(L)&&(Te(B,L),L.pendingcb===0&&(X?(L.pendingcb++,n.nextTick((xe,Ae)=>{re(Ae)?Ke(xe,Ae):Ae.pendingcb--},B,L)):re(L)&&(L.pendingcb++,Ke(B,L))))}function Ke(B,L){L.pendingcb--,L.finished=!0;const X=L[Pe].splice(0);for(let xe=0;xe<X.length;xe++)X[xe]();if(B.emit("finish"),L.autoDestroy){const xe=B._readableState;(!xe||xe.autoDestroy&&(xe.endEmitted||xe.readable===!1))&&B.destroy()}}i(W.prototype,{closed:{__proto__:null,get(){return this._writableState?this._writableState.closed:!1}},destroyed:{__proto__:null,get(){return this._writableState?this._writableState.destroyed:!1},set(B){this._writableState&&(this._writableState.destroyed=B)}},writable:{__proto__:null,get(){const B=this._writableState;return!!B&&B.writable!==!1&&!B.destroyed&&!B.errored&&!B.ending&&!B.ended},set(B){this._writableState&&(this._writableState.writable=!!B)}},writableFinished:{__proto__:null,get(){return this._writableState?this._writableState.finished:!1}},writableObjectMode:{__proto__:null,get(){return this._writableState?this._writableState.objectMode:!1}},writableBuffer:{__proto__:null,get(){return this._writableState&&this._writableState.getBuffer()}},writableEnded:{__proto__:null,get(){return this._writableState?this._writableState.ending:!1}},writableNeedDrain:{__proto__:null,get(){const B=this._writableState;return B?!B.destroyed&&!B.ending&&B.needDrain:!1}},writableHighWaterMark:{__proto__:null,get(){return this._writableState&&this._writableState.highWaterMark}},writableCorked:{__proto__:null,get(){return this._writableState?this._writableState.corked:0}},writableLength:{__proto__:null,get(){return this._writableState&&this._writableState.length}},errored:{__proto__:null,enumerable:!1,get(){return this._writableState?this._writableState.errored:null}},writableAborted:{__proto__:null,enumerable:!1,get:function(){return!!(this._writableState.writable!==!1&&(this._writableState.destroyed||this._writableState.errored)&&!this._writableState.finished)}}});const rt=E.destroy;W.prototype.destroy=function(B,L){const X=this._writableState;return!X.destroyed&&(X.bufferedIndex<X.buffered.length||X[Pe].length)&&n.nextTick(ne,X),rt.call(this,B,L),this},W.prototype._undestroy=E.undestroy,W.prototype._destroy=function(B,L){L(B)},W.prototype[p.captureRejectionSymbol]=function(B){this.destroy(B)};let gt;function yt(){return gt===void 0&&(gt={}),gt}return W.fromWeb=function(B,L){return yt().newStreamWritableFromWritableStream(B,L)},W.toWeb=function(B){return yt().newWritableStreamFromStreamWritable(B)},mi}var xi,Fa;function Wh(){if(Fa)return xi;Fa=1;const n=_r,e=$e,{isReadable:t,isWritable:r,isIterable:s,isNodeStream:i,isReadableNodeStream:o,isWritableNodeStream:c,isDuplexNodeStream:f}=zn,l=ar,{AbortError:p,codes:{ERR_INVALID_ARG_TYPE:x,ERR_INVALID_RETURN_VALUE:k}}=nn,{destroyer:E}=jr,b=jn(),_=Zs(),{createDeferredPromise:v}=Hn,I=Ef,A=globalThis.Blob||e.Blob,T=typeof A<"u"?function(F){return F instanceof A}:function(F){return!1},$=globalThis.AbortController||po().AbortController,{FunctionPrototypeCall:D}=Nt;class P extends b{constructor(F){super(F),(F==null?void 0:F.readable)===!1&&(this._readableState.readable=!1,this._readableState.ended=!0,this._readableState.endEmitted=!0),(F==null?void 0:F.writable)===!1&&(this._writableState.writable=!1,this._writableState.ending=!0,this._writableState.ended=!0,this._writableState.finished=!0)}}xi=function ie(F,oe){if(f(F))return F;if(o(F))return K({readable:F});if(c(F))return K({writable:F});if(i(F))return K({writable:!1,readable:!1});if(typeof F=="function"){const{value:ve,write:Me,final:W,destroy:te}=H(F);if(s(ve))return I(P,ve,{objectMode:!0,write:Me,final:W,destroy:te});const be=ve==null?void 0:ve.then;if(typeof be=="function"){let z;const R=D(be,ve,m=>{if(m!=null)throw new k("nully","body",m)},m=>{E(z,m)});return z=new P({objectMode:!0,readable:!1,write:Me,final(m){W(async()=>{try{await R,n.nextTick(m,null)}catch(M){n.nextTick(m,M)}})},destroy:te})}throw new k("Iterable, AsyncIterable or AsyncFunction",oe,ve)}if(T(F))return ie(F.arrayBuffer());if(s(F))return I(P,F,{objectMode:!0,writable:!1});if(typeof(F==null?void 0:F.writable)=="object"||typeof(F==null?void 0:F.readable)=="object"){const ve=F!=null&&F.readable?o(F==null?void 0:F.readable)?F==null?void 0:F.readable:ie(F.readable):void 0,Me=F!=null&&F.writable?c(F==null?void 0:F.writable)?F==null?void 0:F.writable:ie(F.writable):void 0;return K({readable:ve,writable:Me})}const Pe=F==null?void 0:F.then;if(typeof Pe=="function"){let ve;return D(Pe,F,Me=>{Me!=null&&ve.push(Me),ve.push(null)},Me=>{E(ve,Me)}),ve=new P({objectMode:!0,writable:!1,read(){}})}throw new x(oe,["Blob","ReadableStream","WritableStream","Stream","Iterable","AsyncIterable","Function","{ readable, writable } pair","Promise"],F)};function H(ie){let{promise:F,resolve:oe}=v();const Pe=new $,ve=Pe.signal;return{value:ie(async function*(){for(;;){const W=F;F=null;const{chunk:te,done:be,cb:z}=await W;if(n.nextTick(z),be)return;if(ve.aborted)throw new p(void 0,{cause:ve.reason});({promise:F,resolve:oe}=v()),yield te}}(),{signal:ve}),write(W,te,be){const z=oe;oe=null,z({chunk:W,done:!1,cb:be})},final(W){const te=oe;oe=null,te({done:!0,cb:W})},destroy(W,te){Pe.abort(),te(W)}}}function K(ie){const F=ie.readable&&typeof ie.readable.read!="function"?_.wrap(ie.readable):ie.readable,oe=ie.writable;let Pe=!!t(F),ve=!!r(oe),Me,W,te,be,z;function R(m){const M=be;be=null,M?M(m):m&&z.destroy(m)}return z=new P({readableObjectMode:!!(F!=null&&F.readableObjectMode),writableObjectMode:!!(oe!=null&&oe.writableObjectMode),readable:Pe,writable:ve}),ve&&(l(oe,m=>{ve=!1,m&&E(F,m),R(m)}),z._write=function(m,M,Z){oe.write(m,M)?Z():Me=Z},z._final=function(m){oe.end(),W=m},oe.on("drain",function(){if(Me){const m=Me;Me=null,m()}}),oe.on("finish",function(){if(W){const m=W;W=null,m()}})),Pe&&(l(F,m=>{Pe=!1,m&&E(F,m),R(m)}),F.on("readable",function(){if(te){const m=te;te=null,m()}}),F.on("end",function(){z.push(null)}),z._read=function(){for(;;){const m=F.read();if(m===null){te=z._read;return}if(!z.push(m))return}}),z._destroy=function(m,M){!m&&be!==null&&(m=new p),te=null,Me=null,W=null,be===null?M(m):(be=M,E(oe,m),E(F,m))},z}return xi}var _i,qa;function jn(){if(qa)return _i;qa=1;const{ObjectDefineProperties:n,ObjectGetOwnPropertyDescriptor:e,ObjectKeys:t,ObjectSetPrototypeOf:r}=Nt;_i=o;const s=Zs(),i=vf();r(o.prototype,s.prototype),r(o,s);{const p=t(i.prototype);for(let x=0;x<p.length;x++){const k=p[x];o.prototype[k]||(o.prototype[k]=i.prototype[k])}}function o(p){if(!(this instanceof o))return new o(p);s.call(this,p),i.call(this,p),p?(this.allowHalfOpen=p.allowHalfOpen!==!1,p.readable===!1&&(this._readableState.readable=!1,this._readableState.ended=!0,this._readableState.endEmitted=!0),p.writable===!1&&(this._writableState.writable=!1,this._writableState.ending=!0,this._writableState.ended=!0,this._writableState.finished=!0)):this.allowHalfOpen=!0}n(o.prototype,{writable:{__proto__:null,...e(i.prototype,"writable")},writableHighWaterMark:{__proto__:null,...e(i.prototype,"writableHighWaterMark")},writableObjectMode:{__proto__:null,...e(i.prototype,"writableObjectMode")},writableBuffer:{__proto__:null,...e(i.prototype,"writableBuffer")},writableLength:{__proto__:null,...e(i.prototype,"writableLength")},writableFinished:{__proto__:null,...e(i.prototype,"writableFinished")},writableCorked:{__proto__:null,...e(i.prototype,"writableCorked")},writableEnded:{__proto__:null,...e(i.prototype,"writableEnded")},writableNeedDrain:{__proto__:null,...e(i.prototype,"writableNeedDrain")},destroyed:{__proto__:null,get(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set(p){this._readableState&&this._writableState&&(this._readableState.destroyed=p,this._writableState.destroyed=p)}}});let c;function f(){return c===void 0&&(c={}),c}o.fromWeb=function(p,x){return f().newStreamDuplexFromReadableWritablePair(p,x)},o.toWeb=function(p){return f().newReadableWritablePairFromDuplex(p)};let l;return o.from=function(p){return l||(l=Wh()),l(p,"body")},_i}const{ObjectSetPrototypeOf:Af,Symbol:Hh}=Nt;var Rf=Kn;const{ERR_METHOD_NOT_IMPLEMENTED:zh}=nn.codes,Ro=jn(),{getHighWaterMark:Gh}=Ao;Af(Kn.prototype,Ro.prototype);Af(Kn,Ro);const es=Hh("kCallback");function Kn(n){if(!(this instanceof Kn))return new Kn(n);const e=n?Gh(this,n,"readableHighWaterMark",!0):null;e===0&&(n={...n,highWaterMark:null,readableHighWaterMark:e,writableHighWaterMark:n.writableHighWaterMark||0}),Ro.call(this,n),this._readableState.sync=!1,this[es]=null,n&&(typeof n.transform=="function"&&(this._transform=n.transform),typeof n.flush=="function"&&(this._flush=n.flush)),this.on("prefinish",Vh)}function io(n){typeof this._flush=="function"&&!this.destroyed?this._flush((e,t)=>{if(e){n?n(e):this.destroy(e);return}t!=null&&this.push(t),this.push(null),n&&n()}):(this.push(null),n&&n())}function Vh(){this._final!==io&&io.call(this)}Kn.prototype._final=io;Kn.prototype._transform=function(n,e,t){throw new zh("_transform()")};Kn.prototype._write=function(n,e,t){const r=this._readableState,s=this._writableState,i=r.length;this._transform(n,e,(o,c)=>{if(o){t(o);return}c!=null&&this.push(c),s.ended||i===r.length||r.length<r.highWaterMark?t():this[es]=t})};Kn.prototype._read=function(){if(this[es]){const n=this[es];this[es]=null,n()}};const{ObjectSetPrototypeOf:If}=Nt;var kf=Ur;const Io=Rf;If(Ur.prototype,Io.prototype);If(Ur,Io);function Ur(n){if(!(this instanceof Ur))return new Ur(n);Io.call(this,n)}Ur.prototype._transform=function(n,e,t){t(null,n)};const Yr=_r,{ArrayIsArray:Yh,Promise:Zh,SymbolAsyncIterator:Xh}=Nt,Bs=ar,{once:Jh}=Hn,Qh=jr,ja=jn(),{aggregateTwoErrors:ep,codes:{ERR_INVALID_ARG_TYPE:oo,ERR_INVALID_RETURN_VALUE:Si,ERR_MISSING_ARGS:tp,ERR_STREAM_DESTROYED:np,ERR_STREAM_PREMATURE_CLOSE:rp},AbortError:sp}=nn,{validateFunction:ip,validateAbortSignal:op}=js,{isIterable:hr,isReadable:Ei,isReadableNodeStream:_s,isNodeStream:Ka,isTransformStream:Tr,isWebStream:ap,isReadableStream:vi,isReadableEnded:cp}=zn,fp=globalThis.AbortController||po().AbortController;let Ai,Ri;function Wa(n,e,t){let r=!1;n.on("close",()=>{r=!0});const s=Bs(n,{readable:e,writable:t},i=>{r=!i});return{destroy:i=>{r||(r=!0,Qh.destroyer(n,i||new np("pipe")))},cleanup:s}}function up(n){return ip(n[n.length-1],"streams[stream.length - 1]"),n.pop()}function Ii(n){if(hr(n))return n;if(_s(n))return lp(n);throw new oo("val",["Readable","Iterable","AsyncIterable"],n)}async function*lp(n){Ri||(Ri=Zs()),yield*Ri.prototype[Xh].call(n)}async function ys(n,e,t,{end:r}){let s,i=null;const o=l=>{if(l&&(s=l),i){const p=i;i=null,p()}},c=()=>new Zh((l,p)=>{s?p(s):i=()=>{s?p(s):l()}});e.on("drain",o);const f=Bs(e,{readable:!1},o);try{e.writableNeedDrain&&await c();for await(const l of n)e.write(l)||await c();r&&e.end(),await c(),t()}catch(l){t(s!==l?ep(s,l):l)}finally{f(),e.off("drain",o)}}async function ki(n,e,t,{end:r}){Tr(e)&&(e=e.writable);const s=e.getWriter();try{for await(const i of n)await s.ready,s.write(i).catch(()=>{});await s.ready,r&&await s.close(),t()}catch(i){try{await s.abort(i),t(i)}catch(o){t(o)}}}function dp(...n){return Bf(n,Jh(up(n)))}function Bf(n,e,t){if(n.length===1&&Yh(n[0])&&(n=n[0]),n.length<2)throw new tp("streams");const r=new fp,s=r.signal,i=t==null?void 0:t.signal,o=[];op(i,"options.signal");function c(){E(new sp)}i==null||i.addEventListener("abort",c);let f,l;const p=[];let x=0;function k(I){E(I,--x===0)}function E(I,A){if(I&&(!f||f.code==="ERR_STREAM_PREMATURE_CLOSE")&&(f=I),!(!f&&!A)){for(;p.length;)p.shift()(f);i==null||i.removeEventListener("abort",c),r.abort(),A&&(f||o.forEach(T=>T()),Yr.nextTick(e,f,l))}}let b;for(let I=0;I<n.length;I++){const A=n[I],T=I<n.length-1,$=I>0,D=T||(t==null?void 0:t.end)!==!1,P=I===n.length-1;if(Ka(A)){let H=function(K){K&&K.name!=="AbortError"&&K.code!=="ERR_STREAM_PREMATURE_CLOSE"&&k(K)};if(D){const{destroy:K,cleanup:ie}=Wa(A,T,$);p.push(K),Ei(A)&&P&&o.push(ie)}A.on("error",H),Ei(A)&&P&&o.push(()=>{A.removeListener("error",H)})}if(I===0)if(typeof A=="function"){if(b=A({signal:s}),!hr(b))throw new Si("Iterable, AsyncIterable or Stream","source",b)}else hr(A)||_s(A)||Tr(A)?b=A:b=ja.from(A);else if(typeof A=="function"){if(Tr(b)){var _;b=Ii((_=b)===null||_===void 0?void 0:_.readable)}else b=Ii(b);if(b=A(b,{signal:s}),T){if(!hr(b,!0))throw new Si("AsyncIterable",`transform[${I-1}]`,b)}else{var v;Ai||(Ai=kf);const H=new Ai({objectMode:!0}),K=(v=b)===null||v===void 0?void 0:v.then;if(typeof K=="function")x++,K.call(b,oe=>{l=oe,oe!=null&&H.write(oe),D&&H.end(),Yr.nextTick(k)},oe=>{H.destroy(oe),Yr.nextTick(k,oe)});else if(hr(b,!0))x++,ys(b,H,k,{end:D});else if(vi(b)||Tr(b)){const oe=b.readable||b;x++,ys(oe,H,k,{end:D})}else throw new Si("AsyncIterable or Promise","destination",b);b=H;const{destroy:ie,cleanup:F}=Wa(b,!1,!0);p.push(ie),P&&o.push(F)}}else if(Ka(A)){if(_s(b)){x+=2;const H=hp(b,A,k,{end:D});Ei(A)&&P&&o.push(H)}else if(Tr(b)||vi(b)){const H=b.readable||b;x++,ys(H,A,k,{end:D})}else if(hr(b))x++,ys(b,A,k,{end:D});else throw new oo("val",["Readable","Iterable","AsyncIterable","ReadableStream","TransformStream"],b);b=A}else if(ap(A)){if(_s(b))x++,ki(Ii(b),A,k,{end:D});else if(vi(b)||hr(b))x++,ki(b,A,k,{end:D});else if(Tr(b))x++,ki(b.readable,A,k,{end:D});else throw new oo("val",["Readable","Iterable","AsyncIterable","ReadableStream","TransformStream"],b);b=A}else b=ja.from(A)}return(s!=null&&s.aborted||i!=null&&i.aborted)&&Yr.nextTick(c),b}function hp(n,e,t,{end:r}){let s=!1;if(e.on("close",()=>{s||t(new rp)}),n.pipe(e,{end:!1}),r){let i=function(){s=!0,e.end()};cp(n)?Yr.nextTick(i):n.once("end",i)}else t();return Bs(n,{readable:!0,writable:!1},i=>{const o=n._readableState;i&&i.code==="ERR_STREAM_PREMATURE_CLOSE"&&o&&o.ended&&!o.errored&&!o.errorEmitted?n.once("end",t).once("error",t):t(i)}),Bs(e,{readable:!1,writable:!0},t)}var ko={pipelineImpl:Bf,pipeline:dp};const{pipeline:pp}=ko,bs=jn(),{destroyer:gp}=jr,{isNodeStream:ws,isReadable:Ha,isWritable:za,isWebStream:Bi,isTransformStream:lr,isWritableStream:Ga,isReadableStream:Va}=zn,{AbortError:yp,codes:{ERR_INVALID_ARG_VALUE:Ya,ERR_MISSING_ARGS:bp}}=nn,wp=ar;var Tf=function(...e){if(e.length===0)throw new bp("streams");if(e.length===1)return bs.from(e[0]);const t=[...e];if(typeof e[0]=="function"&&(e[0]=bs.from(e[0])),typeof e[e.length-1]=="function"){const E=e.length-1;e[E]=bs.from(e[E])}for(let E=0;E<e.length;++E)if(!(!ws(e[E])&&!Bi(e[E]))){if(E<e.length-1&&!(Ha(e[E])||Va(e[E])||lr(e[E])))throw new Ya(`streams[${E}]`,t[E],"must be readable");if(E>0&&!(za(e[E])||Ga(e[E])||lr(e[E])))throw new Ya(`streams[${E}]`,t[E],"must be writable")}let r,s,i,o,c;function f(E){const b=o;o=null,b?b(E):E?c.destroy(E):!k&&!x&&c.destroy()}const l=e[0],p=pp(e,f),x=!!(za(l)||Ga(l)||lr(l)),k=!!(Ha(p)||Va(p)||lr(p));if(c=new bs({writableObjectMode:!!(l!=null&&l.writableObjectMode),readableObjectMode:!!(p!=null&&p.writableObjectMode),writable:x,readable:k}),x){if(ws(l))c._write=function(b,_,v){l.write(b,_)?v():r=v},c._final=function(b){l.end(),s=b},l.on("drain",function(){if(r){const b=r;r=null,b()}});else if(Bi(l)){const _=(lr(l)?l.writable:l).getWriter();c._write=async function(v,I,A){try{await _.ready,_.write(v).catch(()=>{}),A()}catch(T){A(T)}},c._final=async function(v){try{await _.ready,_.close().catch(()=>{}),s=v}catch(I){v(I)}}}const E=lr(p)?p.readable:p;wp(E,()=>{if(s){const b=s;s=null,b()}})}if(k){if(ws(p))p.on("readable",function(){if(i){const E=i;i=null,E()}}),p.on("end",function(){c.push(null)}),c._read=function(){for(;;){const E=p.read();if(E===null){i=c._read;return}if(!c.push(E))return}};else if(Bi(p)){const b=(lr(p)?p.readable:p).getReader();c._read=async function(){for(;;)try{const{value:_,done:v}=await b.read();if(!c.push(_))return;if(v){c.push(null);return}}catch{return}}}}return c._destroy=function(E,b){!E&&o!==null&&(E=new yp),i=null,r=null,s=null,o===null?b(E):(o=b,ws(p)&&gp(p,E))},c};const Cf=globalThis.AbortController||po().AbortController,{codes:{ERR_INVALID_ARG_VALUE:mp,ERR_INVALID_ARG_TYPE:us,ERR_MISSING_ARGS:xp,ERR_OUT_OF_RANGE:_p},AbortError:Bn}=nn,{validateAbortSignal:Sr,validateInteger:Sp,validateObject:Er}=js,Ep=Nt.Symbol("kWeak"),{finished:vp}=ar,Ap=Tf,{addAbortSignalNoValidate:Rp}=Ys,{isWritable:Ip,isNodeStream:kp}=zn,{ArrayPrototypePush:Bp,MathFloor:Tp,Number:Cp,NumberIsNaN:Pp,Promise:Za,PromiseReject:Xa,PromisePrototypeThen:Lp,Symbol:Pf}=Nt,Ts=Pf("kEmpty"),Ja=Pf("kEof");function Op(n,e){if(e!=null&&Er(e,"options"),(e==null?void 0:e.signal)!=null&&Sr(e.signal,"options.signal"),kp(n)&&!Ip(n))throw new mp("stream",n,"must be writable");const t=Ap(this,n);return e!=null&&e.signal&&Rp(e.signal,t),t}function Xs(n,e){if(typeof n!="function")throw new us("fn",["Function","AsyncFunction"],n);e!=null&&Er(e,"options"),(e==null?void 0:e.signal)!=null&&Sr(e.signal,"options.signal");let t=1;return(e==null?void 0:e.concurrency)!=null&&(t=Tp(e.concurrency)),Sp(t,"concurrency",1),(async function*(){var s,i;const o=new Cf,c=this,f=[],l=o.signal,p={signal:l},x=()=>o.abort();e!=null&&(s=e.signal)!==null&&s!==void 0&&s.aborted&&x(),e==null||(i=e.signal)===null||i===void 0||i.addEventListener("abort",x);let k,E,b=!1;function _(){b=!0}async function v(){try{for await(let T of c){var I;if(b)return;if(l.aborted)throw new Bn;try{T=n(T,p)}catch($){T=Xa($)}T!==Ts&&(typeof((I=T)===null||I===void 0?void 0:I.catch)=="function"&&T.catch(_),f.push(T),k&&(k(),k=null),!b&&f.length&&f.length>=t&&await new Za($=>{E=$}))}f.push(Ja)}catch(T){const $=Xa(T);Lp($,void 0,_),f.push($)}finally{var A;b=!0,k&&(k(),k=null),e==null||(A=e.signal)===null||A===void 0||A.removeEventListener("abort",x)}}v();try{for(;;){for(;f.length>0;){const I=await f[0];if(I===Ja)return;if(l.aborted)throw new Bn;I!==Ts&&(yield I),f.shift(),E&&(E(),E=null)}await new Za(I=>{k=I})}}finally{o.abort(),b=!0,E&&(E(),E=null)}}).call(this)}function Np(n=void 0){return n!=null&&Er(n,"options"),(n==null?void 0:n.signal)!=null&&Sr(n.signal,"options.signal"),(async function*(){let t=0;for await(const s of this){var r;if(n!=null&&(r=n.signal)!==null&&r!==void 0&&r.aborted)throw new Bn({cause:n.signal.reason});yield[t++,s]}}).call(this)}async function Lf(n,e=void 0){for await(const t of Bo.call(this,n,e))return!0;return!1}async function Mp(n,e=void 0){if(typeof n!="function")throw new us("fn",["Function","AsyncFunction"],n);return!await Lf.call(this,async(...t)=>!await n(...t),e)}async function Up(n,e){for await(const t of Bo.call(this,n,e))return t}async function Dp(n,e){if(typeof n!="function")throw new us("fn",["Function","AsyncFunction"],n);async function t(r,s){return await n(r,s),Ts}for await(const r of Xs.call(this,t,e));}function Bo(n,e){if(typeof n!="function")throw new us("fn",["Function","AsyncFunction"],n);async function t(r,s){return await n(r,s)?r:Ts}return Xs.call(this,t,e)}class $p extends xp{constructor(){super("reduce"),this.message="Reduce of an empty stream requires an initial value"}}async function Fp(n,e,t){var r;if(typeof n!="function")throw new us("reducer",["Function","AsyncFunction"],n);t!=null&&Er(t,"options"),(t==null?void 0:t.signal)!=null&&Sr(t.signal,"options.signal");let s=arguments.length>1;if(t!=null&&(r=t.signal)!==null&&r!==void 0&&r.aborted){const l=new Bn(void 0,{cause:t.signal.reason});throw this.once("error",()=>{}),await vp(this.destroy(l)),l}const i=new Cf,o=i.signal;if(t!=null&&t.signal){const l={once:!0,[Ep]:this};t.signal.addEventListener("abort",()=>i.abort(),l)}let c=!1;try{for await(const l of this){var f;if(c=!0,t!=null&&(f=t.signal)!==null&&f!==void 0&&f.aborted)throw new Bn;s?e=await n(e,l,{signal:o}):(e=l,s=!0)}if(!c&&!s)throw new $p}finally{i.abort()}return e}async function qp(n){n!=null&&Er(n,"options"),(n==null?void 0:n.signal)!=null&&Sr(n.signal,"options.signal");const e=[];for await(const r of this){var t;if(n!=null&&(t=n.signal)!==null&&t!==void 0&&t.aborted)throw new Bn(void 0,{cause:n.signal.reason});Bp(e,r)}return e}function jp(n,e){const t=Xs.call(this,n,e);return(async function*(){for await(const s of t)yield*s}).call(this)}function Of(n){if(n=Cp(n),Pp(n))return 0;if(n<0)throw new _p("number",">= 0",n);return n}function Kp(n,e=void 0){return e!=null&&Er(e,"options"),(e==null?void 0:e.signal)!=null&&Sr(e.signal,"options.signal"),n=Of(n),(async function*(){var r;if(e!=null&&(r=e.signal)!==null&&r!==void 0&&r.aborted)throw new Bn;for await(const i of this){var s;if(e!=null&&(s=e.signal)!==null&&s!==void 0&&s.aborted)throw new Bn;n--<=0&&(yield i)}}).call(this)}function Wp(n,e=void 0){return e!=null&&Er(e,"options"),(e==null?void 0:e.signal)!=null&&Sr(e.signal,"options.signal"),n=Of(n),(async function*(){var r;if(e!=null&&(r=e.signal)!==null&&r!==void 0&&r.aborted)throw new Bn;for await(const i of this){var s;if(e!=null&&(s=e.signal)!==null&&s!==void 0&&s.aborted)throw new Bn;if(n-- >0)yield i;else return}}).call(this)}wo.streamReturningOperators={asIndexedPairs:Np,drop:Kp,filter:Bo,flatMap:jp,map:Xs,take:Wp,compose:Op};wo.promiseReturningOperators={every:Mp,forEach:Dp,reduce:Fp,toArray:qp,some:Lf,find:Up};var Ti,Qa;function Nf(){if(Qa)return Ti;Qa=1;const{ArrayPrototypePop:n,Promise:e}=Nt,{isIterable:t,isNodeStream:r,isWebStream:s}=zn,{pipelineImpl:i}=ko,{finished:o}=ar;Mf();function c(...f){return new e((l,p)=>{let x,k;const E=f[f.length-1];if(E&&typeof E=="object"&&!r(E)&&!t(E)&&!s(E)){const b=n(f);x=b.signal,k=b.end}i(f,(b,_)=>{b?p(b):l(_)},{signal:x,end:k})})}return Ti={finished:o,pipeline:c},Ti}var ec;function Mf(){if(ec)return pi.exports;ec=1;const{Buffer:n}=$e,{ObjectDefineProperty:e,ObjectKeys:t,ReflectApply:r}=Nt,{promisify:{custom:s}}=Hn,{streamReturningOperators:i,promiseReturningOperators:o}=wo,{codes:{ERR_ILLEGAL_CONSTRUCTOR:c}}=nn,f=Tf,{pipeline:l}=ko,{destroyer:p}=jr,x=ar,k=Nf(),E=zn,b=pi.exports=vo.Stream;b.isDisturbed=E.isDisturbed,b.isErrored=E.isErrored,b.isReadable=E.isReadable,b.Readable=Zs();for(const v of t(i)){let A=function(...T){if(new.target)throw c();return b.Readable.from(r(I,this,T))};const I=i[v];e(A,"name",{__proto__:null,value:I.name}),e(A,"length",{__proto__:null,value:I.length}),e(b.Readable.prototype,v,{__proto__:null,value:A,enumerable:!1,configurable:!0,writable:!0})}for(const v of t(o)){let A=function(...T){if(new.target)throw c();return r(I,this,T)};const I=o[v];e(A,"name",{__proto__:null,value:I.name}),e(A,"length",{__proto__:null,value:I.length}),e(b.Readable.prototype,v,{__proto__:null,value:A,enumerable:!1,configurable:!0,writable:!0})}b.Writable=vf(),b.Duplex=jn(),b.Transform=Rf,b.PassThrough=kf,b.pipeline=l;const{addAbortSignal:_}=Ys;return b.addAbortSignal=_,b.finished=x,b.destroy=p,b.compose=f,e(b,"promises",{__proto__:null,configurable:!0,enumerable:!0,get(){return k}}),e(l,s,{__proto__:null,enumerable:!0,get(){return k.pipeline}}),e(x,s,{__proto__:null,enumerable:!0,get(){return k.finished}}),b.Stream=b,b._isUint8Array=function(I){return I instanceof Uint8Array},b._uint8ArrayToBuffer=function(I){return n.from(I.buffer,I.byteOffset,I.byteLength)},pi.exports}(function(n){const e=Mf(),t=Nf(),r=e.Readable.destroy;n.exports=e.Readable,n.exports._uint8ArrayToBuffer=e._uint8ArrayToBuffer,n.exports._isUint8Array=e._isUint8Array,n.exports.isDisturbed=e.isDisturbed,n.exports.isErrored=e.isErrored,n.exports.isReadable=e.isReadable,n.exports.Readable=e.Readable,n.exports.Writable=e.Writable,n.exports.Duplex=e.Duplex,n.exports.Transform=e.Transform,n.exports.PassThrough=e.PassThrough,n.exports.addAbortSignal=e.addAbortSignal,n.exports.finished=e.finished,n.exports.destroy=e.destroy,n.exports.destroy=r,n.exports.pipeline=e.pipeline,n.exports.compose=e.compose,Object.defineProperty(e,"promises",{configurable:!0,enumerable:!0,get(){return t}}),n.exports.Stream=e.Stream,n.exports.default=n.exports})(jl);function tc(n,e,t){try{Reflect.apply(n,e,t)}catch(r){setTimeout(()=>{throw r})}}function Hp(n){const e=n.length,t=new Array(e);for(let r=0;r<e;r+=1)t[r]=n[r];return t}class Uf extends Fs.EventEmitter{emit(e){let t=e==="error";const r=this._events;if(r!==void 0)t=t&&r.error===void 0;else if(!t)return!1;for(var s=arguments.length,i=new Array(s>1?s-1:0),o=1;o<s;o++)i[o-1]=arguments[o];if(t){let f;if(i.length>0&&([f]=i),f instanceof Error)throw f;const l=new Error(`Unhandled error.${f?` (${f.message})`:""}`);throw l.context=f,l}const c=r[e];if(c===void 0)return!1;if(typeof c=="function")tc(c,this,i);else{const f=c.length,l=Hp(c);for(let p=0;p<f;p+=1)tc(l[p],this,i)}return!0}}class Gr extends Error{constructor(e){let{code:t,message:r,data:s}=e;if(!Number.isInteger(t))throw new Error("code must be an integer");if(!r||typeof r!="string")throw new Error("message must be string");super(r),Zt(this,"code",void 0),Zt(this,"data",void 0),this.code=t,s!==void 0&&(this.data=s)}toString(){return Ju({code:this.code,message:this.message,data:this.data,stack:this.stack})}}function Js(n){return async(e,t,r,s)=>{let i;const o=new Promise(p=>{i=p});let c=null,f=!1;const l=async()=>{f=!0,r(p=>{c=p,i()}),await o};try{await n(e,t,l),f?(await o,c(null)):s(null)}catch(p){const x=p;c?c(x):s(x)}}}class dn extends Uf{constructor(){super(),Zt(this,"_middleware",void 0),this._middleware=[]}static async _runAllMiddleware(e,t,r){const s=[];let i=null,o=!1;for(const c of r)if([i,o]=await dn._runMiddleware(e,t,c,s),o)break;return[i,o,s.reverse()]}static _runMiddleware(e,t,r,s){return new Promise(i=>{const o=f=>{const l=f||t.error;l&&(t.error=tt.serializeError(l)),i([l,!0])},c=f=>{t.error?o(t.error):(f&&(typeof f!="function"&&o(new Gr({code:-32603,message:"JRPCEngine: 'next' return handlers must be functions"})),s.push(f)),i([null,!1]))};try{r(e,t,c,o)}catch(f){o(f)}})}static async _runReturnHandlers(e){for(const t of e)await new Promise((r,s)=>{t(i=>i?s(i):r())})}static _checkForCompletion(e,t,r){if(!("result"in t)&&!("error"in t))throw new Gr({code:-32603,message:"Response has no error or result for request"});if(!r)throw new Gr({code:-32603,message:"Nothing ended request"})}push(e){this._middleware.push(e)}handle(e,t){if(t&&typeof t!="function")throw new Error('"callback" must be a function if provided.');return Array.isArray(e)?t?this._handleBatch(e,t):this._handleBatch(e):t?this._handle(e,t):this._promiseHandle(e)}asMiddleware(){return async(e,t,r,s)=>{try{const[i,o,c]=await dn._runAllMiddleware(e,t,this._middleware);return o?(await dn._runReturnHandlers(c),s(i)):r(async f=>{try{await dn._runReturnHandlers(c)}catch(l){return f(l)}return f()})}catch(i){return s(i)}}}async _handleBatch(e,t){try{const r=await Promise.all(e.map(this._promiseHandle.bind(this)));return t?t(null,r):r}catch(r){if(t)return t(r);throw r}}_promiseHandle(e){return new Promise(t=>{this._handle(e,(r,s)=>{t(s)})})}async _handle(e,t){if(!e||Array.isArray(e)||typeof e!="object"){const o=new Gr({code:-32603,message:"request must be plain object"});return t(o,{id:void 0,jsonrpc:"2.0",error:o})}if(typeof e.method!="string"){const o=new Gr({code:-32603,message:"method must be string"});return t(o,{id:e.id,jsonrpc:"2.0",error:o})}const r=Ot({},e),s={id:r.id,jsonrpc:r.jsonrpc};let i=null;try{await this._processRequest(r,s)}catch(o){i=o}return i&&(delete s.result,s.error||(s.error=tt.serializeError(i))),t(i,s)}async _processRequest(e,t){const[r,s,i]=await dn._runAllMiddleware(e,t,this._middleware);if(dn._checkForCompletion(e,t,s),await dn._runReturnHandlers(i),r)throw r}}function ls(n){const e=new dn;return n.forEach(t=>e.push(t)),e.asMiddleware()}function To(n){const e=new Uf;return e.sendAsync=async t=>{const r=await n.handle(t);if(r.error){var s,i;const o=tt.serializeError(r.error,{fallbackError:{message:((s=r.error)===null||s===void 0?void 0:s.message)||r.error.toString(),code:((i=r.error)===null||i===void 0?void 0:i.code)||-32603}});throw tt.rpcErrors.internal(o)}return r.result},e.send=(t,r)=>{if(typeof r!="function")throw new Error('Must provide callback to "send" method.');n.handle(t,r)},n.on&&n.on("notification",t=>{e.emit("data",null,t)}),e.request=async t=>{const r=Ot(Ot({},t),{},{id:Math.random().toString(36).slice(2),jsonrpc:"2.0"});return await e.sendAsync(r)},e}function nc(n){let e=!1,t=0,r;try{r=window[n],e=!0,t=r.length;const s="__storage_test__";return r.setItem(s,s),r.removeItem(s),!0}catch(s){const i=s;return i&&(i.code===22||i.code===1014||i.name==="QuotaExceededError"||i.name==="NS_ERROR_DOM_QUOTA_REACHED")&&e&&t!==0}}class zp{constructor(){Zt(this,"store",{})}getItem(e){return this.store[e]||null}setItem(e,t){this.store[e]=t}}class Gp{constructor(e,t){Zt(this,"storage",void 0),Zt(this,"_storeKey",void 0),this.storage=t,this._storeKey=e;try{t.getItem(e)||this.resetStore()}catch{}}static getInstance(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"local";if(!this.instance){let r;t==="local"&&nc("localStorage")?r=window.localStorage:t==="session"&&nc("sessionStorage")?r=window.sessionStorage:r=new zp,this.instance=new this(e,r)}return this.instance}toJSON(){return this.storage.getItem(this._storeKey)}resetStore(){const e=this.getStore();return this.storage.setItem(this._storeKey,JSON.stringify({})),e}getStore(){return JSON.parse(this.storage.getItem(this._storeKey)||"{}")}get(e){return JSON.parse(this.storage.getItem(this._storeKey)||"{}")[e]}set(e,t){const r=JSON.parse(this.storage.getItem(this._storeKey)||"{}");r[e]=t,this.storage.setItem(this._storeKey,JSON.stringify(r))}}Zt(Gp,"instance",void 0);Ot(Ot({},Qu),el);const Vp=Nc.getLogger("http-helpers");Vp.setLevel(tl.levels.INFO);class Yp extends Error{}Yp.prototype.name="InvalidTokenError";const Cs={EIP155:"eip155",SOLANA:"solana",OTHER:"other"};class Qs extends nl{constructor(e,t){super(t),Zt(this,"code",void 0),Zt(this,"message",void 0),this.code=e,this.message=t||"",Object.defineProperty(this,"name",{value:"Web3AuthError"})}toJSON(){return{name:this.name,code:this.code,message:this.message}}toString(){return JSON.stringify(this.toJSON())}}class Lt extends Qs{constructor(e,t){super(e,t),Object.defineProperty(this,"name",{value:"WalletInitializationError"})}static fromCode(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";return new Lt(e,`${Lt.messages[e]}, ${t}`)}static notFound(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return Lt.fromCode(5001,e)}static notInstalled(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return Lt.fromCode(5002,e)}static notReady(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return Lt.fromCode(5003,e)}static windowBlocked(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return Lt.fromCode(5004,e)}static windowClosed(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return Lt.fromCode(5005,e)}static incompatibleChainNameSpace(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return Lt.fromCode(5006,e)}static duplicateAdapterError(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return Lt.fromCode(5007,e)}static invalidProviderConfigError(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return Lt.fromCode(5008,e)}static providerNotReadyError(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return Lt.fromCode(5009,e)}static rpcConnectionError(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return Lt.fromCode(5010,e)}static invalidParams(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return Lt.fromCode(5011,e)}static invalidNetwork(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return Lt.fromCode(5013,e)}}Zt(Lt,"messages",{5e3:"Custom",5001:"Wallet is not found",5002:"Wallet is not installed",5003:"Wallet is not ready yet",5004:"Wallet window is blocked",5005:"Wallet window has been closed by the user",5006:"Incompatible chain namespace provided",5007:"Adapter has already been included",5008:"Invalid provider Config",5009:"Provider is not ready yet",5010:"Failed to connect with rpc url",5011:"Invalid params passed in",5013:"Invalid network provided"});class Qt extends Qs{constructor(e,t){super(e,t),Object.defineProperty(this,"name",{value:"WalletLoginError"})}static fromCode(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";return new Qt(e,`${Qt.messages[e]}. ${t}`)}static connectionError(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return Qt.fromCode(5111,e)}static disconnectionError(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return Qt.fromCode(5112,e)}static notConnectedError(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return Qt.fromCode(5113,e)}static popupClosed(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return Qt.fromCode(5114,e)}static mfaEnabled(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return Qt.fromCode(5115,e)}static chainConfigNotAdded(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return Qt.fromCode(5116,e)}static unsupportedOperation(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return Qt.fromCode(5117,e)}static coreKitKeyNotFound(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return Qt.fromCode(5118,e)}static userNotLoggedIn(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return Qt.fromCode(5119,e)}}Zt(Qt,"messages",{5e3:"Custom",5111:"Failed to connect with wallet",5112:"Failed to disconnect from wallet",5113:"Wallet is not connected",5114:"Wallet popup has been closed by the user",5115:"User has already enabled mfa, please use the @web3auth/web3auth-web sdk for login with mfa",5116:"Chain config has not been added. Please add the chain config before calling switchChain",5117:"Unsupported operation",5118:"useCoreKitKey flag is enabled but coreKitKey is not available",5119:"User not logged in."});class xn extends Qs{constructor(e,t){super(e,t),Object.defineProperty(this,"name",{value:"WalletOperationsError"})}static fromCode(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";return new xn(e,`${xn.messages[e]}, ${t}`)}static chainIDNotAllowed(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return xn.fromCode(5201,e)}static operationNotAllowed(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return xn.fromCode(5202,e)}static chainNamespaceNotAllowed(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return xn.fromCode(5203,e)}}Zt(xn,"messages",{5e3:"Custom",5201:"Provided chainId is not allowed",5202:"This operation is not allowed"});class Co extends Qs{constructor(e,t){super(e,t),Object.defineProperty(this,"name",{value:"WalletProviderError"})}static fromCode(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";return new xn(e,`${Co.messages[e]}, ${t}`)}static invalidRequestArgs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return xn.fromCode(5301,e)}static invalidRequestMethod(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return xn.fromCode(5302,e)}static invalidRequestParams(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return xn.fromCode(5303,e)}}Zt(Co,"messages",{5e3:"Custom",5301:"Expected a single, non-array, object argument.",5302:"'args.method' must be a non-empty string.",5303:"'args.params' must be an object or array if provided."});const Ps={OPENLOGIN:"openlogin",WALLET_CONNECT_V2:"wallet-connect-v2"},Zr=Ot({TORUS_SOLANA:"torus-solana",PHANTOM:"phantom",SOLFLARE:"solflare",SLOPE:"slope"},Ps),Ss=Ot({TORUS_EVM:"torus-evm",METAMASK:"metamask",COINBASE:"coinbase"},Ps);Ot(Ot({},Ss),Zr);Ps.OPENLOGIN+"",Ps.WALLET_CONNECT_V2+"",Zr.TORUS_SOLANA+"",Zr.PHANTOM+"",Zr.SOLFLARE+"",Zr.SLOPE+"",Ss.TORUS_EVM+"",Ss.METAMASK+"",Ss.COINBASE+"";const Zp={NOT_READY:"not_ready",READY:"ready",CONNECTING:"connecting",CONNECTED:"connected",DISCONNECTED:"disconnected",ERRORED:"errored"};Ot(Ot({},Zp),{},{ADAPTER_DATA_UPDATED:"adapter_data_updated",CACHE_CLEAR:"cache_clear"});Nc.getLogger("web3auth-logger");const rc=n=>(typeof n=="string"||typeof n=="number")&&/^(-)?0x[0-9a-f]*$/i.test(n);function Xp(n){if(n.length>=255)throw new TypeError("Alphabet too long");for(var e=new Uint8Array(256),t=0;t<e.length;t++)e[t]=255;for(var r=0;r<n.length;r++){var s=n.charAt(r),i=s.charCodeAt(0);if(e[i]!==255)throw new TypeError(s+" is ambiguous");e[i]=r}var o=n.length,c=n.charAt(0),f=Math.log(o)/Math.log(256),l=Math.log(256)/Math.log(o);function p(E){if(E instanceof Uint8Array||(ArrayBuffer.isView(E)?E=new Uint8Array(E.buffer,E.byteOffset,E.byteLength):Array.isArray(E)&&(E=Uint8Array.from(E))),!(E instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(E.length===0)return"";for(var b=0,_=0,v=0,I=E.length;v!==I&&E[v]===0;)v++,b++;for(var A=(I-v)*l+1>>>0,T=new Uint8Array(A);v!==I;){for(var $=E[v],D=0,P=A-1;($!==0||D<_)&&P!==-1;P--,D++)$+=256*T[P]>>>0,T[P]=$%o>>>0,$=$/o>>>0;if($!==0)throw new Error("Non-zero carry");_=D,v++}for(var H=A-_;H!==A&&T[H]===0;)H++;for(var K=c.repeat(b);H<A;++H)K+=n.charAt(T[H]);return K}function x(E){if(typeof E!="string")throw new TypeError("Expected String");if(E.length===0)return new Uint8Array;for(var b=0,_=0,v=0;E[b]===c;)_++,b++;for(var I=(E.length-b)*f+1>>>0,A=new Uint8Array(I);E[b];){var T=e[E.charCodeAt(b)];if(T===255)return;for(var $=0,D=I-1;(T!==0||$<v)&&D!==-1;D--,$++)T+=o*A[D]>>>0,A[D]=T%256>>>0,T=T/256>>>0;if(T!==0)throw new Error("Non-zero carry");v=$,b++}for(var P=I-v;P!==I&&A[P]===0;)P++;for(var H=new Uint8Array(_+(I-P)),K=_;P!==I;)H[K++]=A[P++];return H}function k(E){var b=x(E);if(b)return b;throw new Error("Non-base"+o+" character")}return{encode:p,decodeUnsafe:x,decode:k}}var Jp=Xp;const Qp=Jp,eg="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";var tg=Qp(eg);const vn=cs(tg),[ng,rg]=Xe.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(n=>BigInt(n))),er=new Uint32Array(80),tr=new Uint32Array(80);class sg extends Dc{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:e,Al:t,Bh:r,Bl:s,Ch:i,Cl:o,Dh:c,Dl:f,Eh:l,El:p,Fh:x,Fl:k,Gh:E,Gl:b,Hh:_,Hl:v}=this;return[e,t,r,s,i,o,c,f,l,p,x,k,E,b,_,v]}set(e,t,r,s,i,o,c,f,l,p,x,k,E,b,_,v){this.Ah=e|0,this.Al=t|0,this.Bh=r|0,this.Bl=s|0,this.Ch=i|0,this.Cl=o|0,this.Dh=c|0,this.Dl=f|0,this.Eh=l|0,this.El=p|0,this.Fh=x|0,this.Fl=k|0,this.Gh=E|0,this.Gl=b|0,this.Hh=_|0,this.Hl=v|0}process(e,t){for(let T=0;T<16;T++,t+=4)er[T]=e.getUint32(t),tr[T]=e.getUint32(t+=4);for(let T=16;T<80;T++){const $=er[T-15]|0,D=tr[T-15]|0,P=Xe.rotrSH($,D,1)^Xe.rotrSH($,D,8)^Xe.shrSH($,D,7),H=Xe.rotrSL($,D,1)^Xe.rotrSL($,D,8)^Xe.shrSL($,D,7),K=er[T-2]|0,ie=tr[T-2]|0,F=Xe.rotrSH(K,ie,19)^Xe.rotrBH(K,ie,61)^Xe.shrSH(K,ie,6),oe=Xe.rotrSL(K,ie,19)^Xe.rotrBL(K,ie,61)^Xe.shrSL(K,ie,6),Pe=Xe.add4L(H,oe,tr[T-7],tr[T-16]),ve=Xe.add4H(Pe,P,F,er[T-7],er[T-16]);er[T]=ve|0,tr[T]=Pe|0}let{Ah:r,Al:s,Bh:i,Bl:o,Ch:c,Cl:f,Dh:l,Dl:p,Eh:x,El:k,Fh:E,Fl:b,Gh:_,Gl:v,Hh:I,Hl:A}=this;for(let T=0;T<80;T++){const $=Xe.rotrSH(x,k,14)^Xe.rotrSH(x,k,18)^Xe.rotrBH(x,k,41),D=Xe.rotrSL(x,k,14)^Xe.rotrSL(x,k,18)^Xe.rotrBL(x,k,41),P=x&E^~x&_,H=k&b^~k&v,K=Xe.add5L(A,D,H,rg[T],tr[T]),ie=Xe.add5H(K,I,$,P,ng[T],er[T]),F=K|0,oe=Xe.rotrSH(r,s,28)^Xe.rotrBH(r,s,34)^Xe.rotrBH(r,s,39),Pe=Xe.rotrSL(r,s,28)^Xe.rotrBL(r,s,34)^Xe.rotrBL(r,s,39),ve=r&i^r&c^i&c,Me=s&o^s&f^o&f;I=_|0,A=v|0,_=E|0,v=b|0,E=x|0,b=k|0,{h:x,l:k}=Xe.add(l|0,p|0,ie|0,F|0),l=c|0,p=f|0,c=i|0,f=o|0,i=r|0,o=s|0;const W=Xe.add3L(F,Pe,Me);r=Xe.add3H(W,ie,oe,ve),s=W|0}({h:r,l:s}=Xe.add(this.Ah|0,this.Al|0,r|0,s|0)),{h:i,l:o}=Xe.add(this.Bh|0,this.Bl|0,i|0,o|0),{h:c,l:f}=Xe.add(this.Ch|0,this.Cl|0,c|0,f|0),{h:l,l:p}=Xe.add(this.Dh|0,this.Dl|0,l|0,p|0),{h:x,l:k}=Xe.add(this.Eh|0,this.El|0,x|0,k|0),{h:E,l:b}=Xe.add(this.Fh|0,this.Fl|0,E|0,b|0),{h:_,l:v}=Xe.add(this.Gh|0,this.Gl|0,_|0,v|0),{h:I,l:A}=Xe.add(this.Hh|0,this.Hl|0,I|0,A|0),this.set(r,s,i,o,c,f,l,p,x,k,E,b,_,v,I,A)}roundClean(){er.fill(0),tr.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}const Df=Cc(()=>new sg);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const mn=BigInt(0),on=BigInt(1),ms=BigInt(2),ig=BigInt(8),og={zip215:!0};function ag(n){const e=yo(n);return as(n,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...e})}function Po(n){const e=ag(n),{Fp:t,n:r,prehash:s,hash:i,randomBytes:o,nByteLength:c,h:f}=e,l=ms<<BigInt(c*8)-on,p=t.create,x=e.uvRatio||((z,R)=>{try{return{isValid:!0,value:t.sqrt(z*t.inv(R))}}catch{return{isValid:!1,value:mn}}}),k=e.adjustScalarBytes||(z=>z),E=e.domain||((z,R,m)=>{if(R.length||m)throw new Error("Contexts/pre-hash are not supported");return z}),b=z=>typeof z=="bigint"&&mn<z,_=(z,R)=>b(z)&&b(R)&&z<R,v=z=>z===mn||_(z,l);function I(z,R){if(_(z,R))return z;throw new Error(`Expected valid scalar < ${R}, got ${typeof z} ${z}`)}function A(z){return z===mn?z:I(z,r)}const T=new Map;function $(z){if(!(z instanceof D))throw new Error("ExtendedPoint expected")}class D{constructor(R,m,M,Z){if(this.ex=R,this.ey=m,this.ez=M,this.et=Z,!v(R))throw new Error("x required");if(!v(m))throw new Error("y required");if(!v(M))throw new Error("z required");if(!v(Z))throw new Error("t required")}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(R){if(R instanceof D)throw new Error("extended point not allowed");const{x:m,y:M}=R||{};if(!v(m)||!v(M))throw new Error("invalid affine point");return new D(m,M,on,p(m*M))}static normalizeZ(R){const m=t.invertBatch(R.map(M=>M.ez));return R.map((M,Z)=>M.toAffine(m[Z])).map(D.fromAffine)}_setWindowSize(R){this._WINDOW_SIZE=R,T.delete(this)}assertValidity(){const{a:R,d:m}=e;if(this.is0())throw new Error("bad point: ZERO");const{ex:M,ey:Z,ez:ne,et:Q}=this,re=p(M*M),we=p(Z*Z),Te=p(ne*ne),et=p(Te*Te),Ke=p(re*R),rt=p(Te*p(Ke+we)),gt=p(et+p(m*p(re*we)));if(rt!==gt)throw new Error("bad point: equation left != right (1)");const yt=p(M*Z),B=p(ne*Q);if(yt!==B)throw new Error("bad point: equation left != right (2)")}equals(R){$(R);const{ex:m,ey:M,ez:Z}=this,{ex:ne,ey:Q,ez:re}=R,we=p(m*re),Te=p(ne*Z),et=p(M*re),Ke=p(Q*Z);return we===Te&&et===Ke}is0(){return this.equals(D.ZERO)}negate(){return new D(p(-this.ex),this.ey,this.ez,p(-this.et))}double(){const{a:R}=e,{ex:m,ey:M,ez:Z}=this,ne=p(m*m),Q=p(M*M),re=p(ms*p(Z*Z)),we=p(R*ne),Te=m+M,et=p(p(Te*Te)-ne-Q),Ke=we+Q,rt=Ke-re,gt=we-Q,yt=p(et*rt),B=p(Ke*gt),L=p(et*gt),X=p(rt*Ke);return new D(yt,B,X,L)}add(R){$(R);const{a:m,d:M}=e,{ex:Z,ey:ne,ez:Q,et:re}=this,{ex:we,ey:Te,ez:et,et:Ke}=R;if(m===BigInt(-1)){const rn=p((ne-Z)*(Te+we)),Wt=p((ne+Z)*(Te-we)),bn=p(Wt-rn);if(bn===mn)return this.double();const y=p(Q*ms*Ke),w=p(re*ms*et),ce=w+y,fe=Wt+rn,_e=w-y,Tt=p(ce*bn),Mt=p(fe*_e),Gn=p(ce*_e),Jt=p(bn*fe);return new D(Tt,Mt,Jt,Gn)}const rt=p(Z*we),gt=p(ne*Te),yt=p(re*M*Ke),B=p(Q*et),L=p((Z+ne)*(we+Te)-rt-gt),X=B-yt,xe=B+yt,Ae=p(gt-m*rt),dt=p(L*X),st=p(xe*Ae),$t=p(L*Ae),yn=p(X*xe);return new D(dt,st,yn,$t)}subtract(R){return this.add(R.negate())}wNAF(R){return K.wNAFCached(this,T,R,D.normalizeZ)}multiply(R){const{p:m,f:M}=this.wNAF(I(R,r));return D.normalizeZ([m,M])[0]}multiplyUnsafe(R){let m=A(R);return m===mn?H:this.equals(H)||m===on?this:this.equals(P)?this.wNAF(m).p:K.unsafeLadder(this,m)}isSmallOrder(){return this.multiplyUnsafe(f).is0()}isTorsionFree(){return K.unsafeLadder(this,r).is0()}toAffine(R){const{ex:m,ey:M,ez:Z}=this,ne=this.is0();R==null&&(R=ne?ig:t.inv(Z));const Q=p(m*R),re=p(M*R),we=p(Z*R);if(ne)return{x:mn,y:on};if(we!==on)throw new Error("invZ was invalid");return{x:Q,y:re}}clearCofactor(){const{h:R}=e;return R===on?this:this.multiplyUnsafe(R)}static fromHex(R,m=!1){const{d:M,a:Z}=e,ne=t.BYTES;R=Ut("pointHex",R,ne);const Q=R.slice(),re=R[ne-1];Q[ne-1]=re&-129;const we=Qr(Q);we===mn||(m?I(we,l):I(we,t.ORDER));const Te=p(we*we),et=p(Te-on),Ke=p(M*Te-Z);let{isValid:rt,value:gt}=x(et,Ke);if(!rt)throw new Error("Point.fromHex: invalid y coordinate");const yt=(gt&on)===on,B=(re&128)!==0;if(!m&&gt===mn&&B)throw new Error("Point.fromHex: x=0 and x_0=1");return B!==yt&&(gt=p(-gt)),D.fromAffine({x:gt,y:we})}static fromPrivateKey(R){return oe(R).point}toRawBytes(){const{x:R,y:m}=this.toAffine(),M=As(m,t.BYTES);return M[M.length-1]|=R&on?128:0,M}toHex(){return Is(this.toRawBytes())}}D.BASE=new D(e.Gx,e.Gy,on,p(e.Gx*e.Gy)),D.ZERO=new D(mn,on,on,mn);const{BASE:P,ZERO:H}=D,K=Kc(D,c*8);function ie(z){return _t(z,r)}function F(z){return ie(Qr(z))}function oe(z){const R=c;z=Ut("private key",z,R);const m=Ut("hashed private key",i(z),2*R),M=k(m.slice(0,R)),Z=m.slice(R,2*R),ne=F(M),Q=P.multiply(ne),re=Q.toRawBytes();return{head:M,prefix:Z,scalar:ne,point:Q,pointBytes:re}}function Pe(z){return oe(z).pointBytes}function ve(z=new Uint8Array,...R){const m=ns(...R);return F(i(E(m,Ut("context",z),!!s)))}function Me(z,R,m={}){z=Ut("message",z),s&&(z=s(z));const{prefix:M,scalar:Z,pointBytes:ne}=oe(R),Q=ve(m.context,M,z),re=P.multiply(Q).toRawBytes(),we=ve(m.context,re,ne,z),Te=ie(Q+we*Z);A(Te);const et=ns(re,As(Te,t.BYTES));return Ut("result",et,c*2)}const W=og;function te(z,R,m,M=W){const{context:Z,zip215:ne}=M,Q=t.BYTES;z=Ut("signature",z,2*Q),R=Ut("message",R),s&&(R=s(R));const re=Qr(z.slice(Q,2*Q));let we,Te,et;try{we=D.fromHex(m,ne),Te=D.fromHex(z.slice(0,Q),ne),et=P.multiplyUnsafe(re)}catch{return!1}if(!ne&&we.isSmallOrder())return!1;const Ke=ve(Z,Te.toRawBytes(),we.toRawBytes(),R);return Te.add(we.multiplyUnsafe(Ke)).subtract(et).clearCofactor().equals(D.ZERO)}return P._setWindowSize(8),{CURVE:e,getPublicKey:Pe,sign:Me,verify:te,ExtendedPoint:D,utils:{getExtendedPublicKey:oe,randomPrivateKey:()=>o(t.BYTES),precompute(z=8,R=D.BASE){return R._setWindowSize(z),R.multiply(BigInt(3)),R}}}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Lo=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),sc=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752");BigInt(0);const cg=BigInt(1),ao=BigInt(2),fg=BigInt(5),ic=BigInt(10),ug=BigInt(20),lg=BigInt(40),oc=BigInt(80);function dg(n){const e=Lo,r=n*n%e*n%e,s=It(r,ao,e)*r%e,i=It(s,cg,e)*n%e,o=It(i,fg,e)*i%e,c=It(o,ic,e)*o%e,f=It(c,ug,e)*c%e,l=It(f,lg,e)*f%e,p=It(l,oc,e)*l%e,x=It(p,oc,e)*l%e,k=It(x,ic,e)*o%e;return{pow_p_5_8:It(k,ao,e)*n%e,b2:r}}function hg(n){return n[0]&=248,n[31]&=127,n[31]|=64,n}function pg(n,e){const t=Lo,r=_t(e*e*e,t),s=_t(r*r*e,t),i=dg(n*s).pow_p_5_8;let o=_t(n*r*i,t);const c=_t(e*o*o,t),f=o,l=_t(o*sc,t),p=c===n,x=c===_t(-n,t),k=c===_t(-n*sc,t);return p&&(o=f),(x||k)&&(o=l),_l(o,t)&&(o=_t(-o,t)),{isValid:p||x,value:o}}const qn=Fc(Lo,void 0,!0),Oo={a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:qn,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:BigInt(8),Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:Df,randomBytes:Oc,adjustScalarBytes:hg,uvRatio:pg},Kr=Po(Oo);function $f(n,e,t){if(e.length>255)throw new Error("Context is too big");return Lc(rl("SigEd25519 no Ed25519 collisions"),new Uint8Array([t?1:0,e.length]),e,n)}({...Oo});({...Oo});const gg=(qn.ORDER+BigInt(3))/BigInt(8);qn.pow(ao,gg);qn.sqrt(qn.neg(qn.ONE));(qn.ORDER-BigInt(5))/BigInt(8);BigInt(486662);Rl(qn,qn.neg(BigInt(486664)));BigInt("25063068953384623474111414158702152701244531502492656460079210482610430750235");BigInt("54469307008909316920995813868745141605393597292927456921205312896311721017578");BigInt("1159843021668779879193775521855586647937357759715417654439879720876111806838");BigInt("40440834346308536858101042469323190826248399146238708352240133220865137265952");BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");var qt={};function Fn(n,e,t){return e<=n&&n<=t}function ei(n){if(n===void 0)return{};if(n===Object(n))return n;throw TypeError("Could not convert argument to dictionary")}function yg(n){for(var e=String(n),t=e.length,r=0,s=[];r<t;){var i=e.charCodeAt(r);if(i<55296||i>57343)s.push(i);else if(56320<=i&&i<=57343)s.push(65533);else if(55296<=i&&i<=56319)if(r===t-1)s.push(65533);else{var o=n.charCodeAt(r+1);if(56320<=o&&o<=57343){var c=i&1023,f=o&1023;s.push(65536+(c<<10)+f),r+=1}else s.push(65533)}r+=1}return s}function bg(n){for(var e="",t=0;t<n.length;++t){var r=n[t];r<=65535?e+=String.fromCharCode(r):(r-=65536,e+=String.fromCharCode((r>>10)+55296,(r&1023)+56320))}return e}var Ls=-1;function No(n){this.tokens=[].slice.call(n)}No.prototype={endOfStream:function(){return!this.tokens.length},read:function(){return this.tokens.length?this.tokens.shift():Ls},prepend:function(n){if(Array.isArray(n))for(var e=n;e.length;)this.tokens.unshift(e.pop());else this.tokens.unshift(n)},push:function(n){if(Array.isArray(n))for(var e=n;e.length;)this.tokens.push(e.shift());else this.tokens.push(n)}};var Dr=-1;function Ci(n,e){if(n)throw TypeError("Decoder error");return e||65533}var Os="utf-8";function Ns(n,e){if(!(this instanceof Ns))return new Ns(n,e);if(n=n!==void 0?String(n).toLowerCase():Os,n!==Os)throw new Error("Encoding not supported. Only utf-8 is supported");e=ei(e),this._streaming=!1,this._BOMseen=!1,this._decoder=null,this._fatal=!!e.fatal,this._ignoreBOM=!!e.ignoreBOM,Object.defineProperty(this,"encoding",{value:"utf-8"}),Object.defineProperty(this,"fatal",{value:this._fatal}),Object.defineProperty(this,"ignoreBOM",{value:this._ignoreBOM})}Ns.prototype={decode:function(e,t){var r;typeof e=="object"&&e instanceof ArrayBuffer?r=new Uint8Array(e):typeof e=="object"&&"buffer"in e&&e.buffer instanceof ArrayBuffer?r=new Uint8Array(e.buffer,e.byteOffset,e.byteLength):r=new Uint8Array(0),t=ei(t),this._streaming||(this._decoder=new wg({fatal:this._fatal}),this._BOMseen=!1),this._streaming=!!t.stream;for(var s=new No(r),i=[],o;!s.endOfStream()&&(o=this._decoder.handler(s,s.read()),o!==Dr);)o!==null&&(Array.isArray(o)?i.push.apply(i,o):i.push(o));if(!this._streaming){do{if(o=this._decoder.handler(s,s.read()),o===Dr)break;o!==null&&(Array.isArray(o)?i.push.apply(i,o):i.push(o))}while(!s.endOfStream());this._decoder=null}return i.length&&["utf-8"].indexOf(this.encoding)!==-1&&!this._ignoreBOM&&!this._BOMseen&&(i[0]===65279?(this._BOMseen=!0,i.shift()):this._BOMseen=!0),bg(i)}};function Ms(n,e){if(!(this instanceof Ms))return new Ms(n,e);if(n=n!==void 0?String(n).toLowerCase():Os,n!==Os)throw new Error("Encoding not supported. Only utf-8 is supported");e=ei(e),this._streaming=!1,this._encoder=null,this._options={fatal:!!e.fatal},Object.defineProperty(this,"encoding",{value:"utf-8"})}Ms.prototype={encode:function(e,t){e=e?String(e):"",t=ei(t),this._streaming||(this._encoder=new mg(this._options)),this._streaming=!!t.stream;for(var r=[],s=new No(yg(e)),i;!s.endOfStream()&&(i=this._encoder.handler(s,s.read()),i!==Dr);)Array.isArray(i)?r.push.apply(r,i):r.push(i);if(!this._streaming){for(;i=this._encoder.handler(s,s.read()),i!==Dr;)Array.isArray(i)?r.push.apply(r,i):r.push(i);this._encoder=null}return new Uint8Array(r)}};function wg(n){var e=n.fatal,t=0,r=0,s=0,i=128,o=191;this.handler=function(c,f){if(f===Ls&&s!==0)return s=0,Ci(e);if(f===Ls)return Dr;if(s===0){if(Fn(f,0,127))return f;if(Fn(f,194,223))s=1,t=f-192;else if(Fn(f,224,239))f===224&&(i=160),f===237&&(o=159),s=2,t=f-224;else if(Fn(f,240,244))f===240&&(i=144),f===244&&(o=143),s=3,t=f-240;else return Ci(e);return t=t<<6*s,null}if(!Fn(f,i,o))return t=s=r=0,i=128,o=191,c.prepend(f),Ci(e);if(i=128,o=191,r+=1,t+=f-128<<6*(s-r),r!==s)return null;var l=t;return t=s=r=0,l}}function mg(n){n.fatal,this.handler=function(e,t){if(t===Ls)return Dr;if(Fn(t,0,127))return t;var r,s;Fn(t,128,2047)?(r=1,s=192):Fn(t,2048,65535)?(r=2,s=224):Fn(t,65536,1114111)&&(r=3,s=240);for(var i=[(t>>6*r)+s];r>0;){var o=t>>6*(r-1);i.push(128|o&63),r-=1}return i}}const xg=Object.freeze(Object.defineProperty({__proto__:null,TextDecoder:Ns,TextEncoder:Ms},Symbol.toStringTag,{value:"Module"})),_g=sl(xg);var Sg=kn&&kn.__createBinding||(Object.create?function(n,e,t,r){r===void 0&&(r=t),Object.defineProperty(n,r,{enumerable:!0,get:function(){return e[t]}})}:function(n,e,t,r){r===void 0&&(r=t),n[r]=e[t]}),Eg=kn&&kn.__setModuleDefault||(Object.create?function(n,e){Object.defineProperty(n,"default",{enumerable:!0,value:e})}:function(n,e){n.default=e}),Pn=kn&&kn.__decorate||function(n,e,t,r){var s=arguments.length,i=s<3?e:r===null?r=Object.getOwnPropertyDescriptor(e,t):r,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(n,e,t,r);else for(var c=n.length-1;c>=0;c--)(o=n[c])&&(i=(s<3?o(i):s>3?o(e,t,i):o(e,t))||i);return s>3&&i&&Object.defineProperty(e,t,i),i},vg=kn&&kn.__importStar||function(n){if(n&&n.__esModule)return n;var e={};if(n!=null)for(var t in n)t!=="default"&&Object.hasOwnProperty.call(n,t)&&Sg(e,n,t);return Eg(e,n),e},Ff=kn&&kn.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(qt,"__esModule",{value:!0});var qf=qt.deserializeUnchecked=Gf=qt.deserialize=zf=qt.serialize=qt.BinaryReader=qt.BinaryWriter=qt.BorshError=qt.baseDecode=qt.baseEncode=void 0;const ir=Ff(il),jf=Ff(ol),Ag=vg(_g),Rg=typeof TextDecoder!="function"?Ag.TextDecoder:TextDecoder,Ig=new Rg("utf-8",{fatal:!0});function kg(n){return typeof n=="string"&&(n=mt.Buffer.from(n,"utf8")),jf.default.encode(mt.Buffer.from(n))}qt.baseEncode=kg;function Bg(n){return mt.Buffer.from(jf.default.decode(n))}qt.baseDecode=Bg;const Pi=1024;class Yt extends Error{constructor(e){super(e),this.fieldPath=[],this.originalMessage=e}addToFieldPath(e){this.fieldPath.splice(0,0,e),this.message=this.originalMessage+": "+this.fieldPath.join(".")}}qt.BorshError=Yt;class Kf{constructor(){this.buf=mt.Buffer.alloc(Pi),this.length=0}maybeResize(){this.buf.length<16+this.length&&(this.buf=mt.Buffer.concat([this.buf,mt.Buffer.alloc(Pi)]))}writeU8(e){this.maybeResize(),this.buf.writeUInt8(e,this.length),this.length+=1}writeU16(e){this.maybeResize(),this.buf.writeUInt16LE(e,this.length),this.length+=2}writeU32(e){this.maybeResize(),this.buf.writeUInt32LE(e,this.length),this.length+=4}writeU64(e){this.maybeResize(),this.writeBuffer(mt.Buffer.from(new ir.default(e).toArray("le",8)))}writeU128(e){this.maybeResize(),this.writeBuffer(mt.Buffer.from(new ir.default(e).toArray("le",16)))}writeU256(e){this.maybeResize(),this.writeBuffer(mt.Buffer.from(new ir.default(e).toArray("le",32)))}writeU512(e){this.maybeResize(),this.writeBuffer(mt.Buffer.from(new ir.default(e).toArray("le",64)))}writeBuffer(e){this.buf=mt.Buffer.concat([mt.Buffer.from(this.buf.subarray(0,this.length)),e,mt.Buffer.alloc(Pi)]),this.length+=e.length}writeString(e){this.maybeResize();const t=mt.Buffer.from(e,"utf8");this.writeU32(t.length),this.writeBuffer(t)}writeFixedArray(e){this.writeBuffer(mt.Buffer.from(e))}writeArray(e,t){this.maybeResize(),this.writeU32(e.length);for(const r of e)this.maybeResize(),t(r)}toArray(){return this.buf.subarray(0,this.length)}}qt.BinaryWriter=Kf;function Ln(n,e,t){const r=t.value;t.value=function(...s){try{return r.apply(this,s)}catch(i){if(i instanceof RangeError){const o=i.code;if(["ERR_BUFFER_OUT_OF_BOUNDS","ERR_OUT_OF_RANGE"].indexOf(o)>=0)throw new Yt("Reached the end of buffer when deserializing")}throw i}}}class un{constructor(e){this.buf=e,this.offset=0}readU8(){const e=this.buf.readUInt8(this.offset);return this.offset+=1,e}readU16(){const e=this.buf.readUInt16LE(this.offset);return this.offset+=2,e}readU32(){const e=this.buf.readUInt32LE(this.offset);return this.offset+=4,e}readU64(){const e=this.readBuffer(8);return new ir.default(e,"le")}readU128(){const e=this.readBuffer(16);return new ir.default(e,"le")}readU256(){const e=this.readBuffer(32);return new ir.default(e,"le")}readU512(){const e=this.readBuffer(64);return new ir.default(e,"le")}readBuffer(e){if(this.offset+e>this.buf.length)throw new Yt(`Expected buffer length ${e} isn't within bounds`);const t=this.buf.slice(this.offset,this.offset+e);return this.offset+=e,t}readString(){const e=this.readU32(),t=this.readBuffer(e);try{return Ig.decode(t)}catch(r){throw new Yt(`Error decoding UTF-8 string: ${r}`)}}readFixedArray(e){return new Uint8Array(this.readBuffer(e))}readArray(e){const t=this.readU32(),r=Array();for(let s=0;s<t;++s)r.push(e());return r}}Pn([Ln],un.prototype,"readU8",null);Pn([Ln],un.prototype,"readU16",null);Pn([Ln],un.prototype,"readU32",null);Pn([Ln],un.prototype,"readU64",null);Pn([Ln],un.prototype,"readU128",null);Pn([Ln],un.prototype,"readU256",null);Pn([Ln],un.prototype,"readU512",null);Pn([Ln],un.prototype,"readString",null);Pn([Ln],un.prototype,"readFixedArray",null);Pn([Ln],un.prototype,"readArray",null);qt.BinaryReader=un;function Wf(n){return n.charAt(0).toUpperCase()+n.slice(1)}function gr(n,e,t,r,s){try{if(typeof r=="string")s[`write${Wf(r)}`](t);else if(r instanceof Array)if(typeof r[0]=="number"){if(t.length!==r[0])throw new Yt(`Expecting byte array of length ${r[0]}, but got ${t.length} bytes`);s.writeFixedArray(t)}else if(r.length===2&&typeof r[1]=="number"){if(t.length!==r[1])throw new Yt(`Expecting byte array of length ${r[1]}, but got ${t.length} bytes`);for(let i=0;i<r[1];i++)gr(n,null,t[i],r[0],s)}else s.writeArray(t,i=>{gr(n,e,i,r[0],s)});else if(r.kind!==void 0)switch(r.kind){case"option":{t==null?s.writeU8(0):(s.writeU8(1),gr(n,e,t,r.type,s));break}case"map":{s.writeU32(t.size),t.forEach((i,o)=>{gr(n,e,o,r.key,s),gr(n,e,i,r.value,s)});break}default:throw new Yt(`FieldType ${r} unrecognized`)}else Hf(n,t,s)}catch(i){throw i instanceof Yt&&i.addToFieldPath(e),i}}function Hf(n,e,t){if(typeof e.borshSerialize=="function"){e.borshSerialize(t);return}const r=n.get(e.constructor);if(!r)throw new Yt(`Class ${e.constructor.name} is missing in schema`);if(r.kind==="struct")r.fields.map(([s,i])=>{gr(n,s,e[s],i,t)});else if(r.kind==="enum"){const s=e[r.field];for(let i=0;i<r.values.length;++i){const[o,c]=r.values[i];if(o===s){t.writeU8(i),gr(n,o,e[o],c,t);break}}}else throw new Yt(`Unexpected schema kind: ${r.kind} for ${e.constructor.name}`)}function Tg(n,e,t=Kf){const r=new t;return Hf(n,e,r),r.toArray()}var zf=qt.serialize=Tg;function yr(n,e,t,r){try{if(typeof t=="string")return r[`read${Wf(t)}`]();if(t instanceof Array){if(typeof t[0]=="number")return r.readFixedArray(t[0]);if(typeof t[1]=="number"){const s=[];for(let i=0;i<t[1];i++)s.push(yr(n,null,t[0],r));return s}else return r.readArray(()=>yr(n,e,t[0],r))}if(t.kind==="option")return r.readU8()?yr(n,e,t.type,r):void 0;if(t.kind==="map"){let s=new Map;const i=r.readU32();for(let o=0;o<i;o++){const c=yr(n,e,t.key,r),f=yr(n,e,t.value,r);s.set(c,f)}return s}return Mo(n,t,r)}catch(s){throw s instanceof Yt&&s.addToFieldPath(e),s}}function Mo(n,e,t){if(typeof e.borshDeserialize=="function")return e.borshDeserialize(t);const r=n.get(e);if(!r)throw new Yt(`Class ${e.name} is missing in schema`);if(r.kind==="struct"){const s={};for(const[i,o]of n.get(e).fields)s[i]=yr(n,i,o,t);return new e(s)}if(r.kind==="enum"){const s=t.readU8();if(s>=r.values.length)throw new Yt(`Enum index: ${s} is out of range`);const[i,o]=r.values[s],c=yr(n,i,o,t);return new e({[i]:c})}throw new Yt(`Unexpected schema kind: ${r.kind} for ${e.constructor.name}`)}function Cg(n,e,t,r=un){const s=new r(t),i=Mo(n,e,s);if(s.offset<t.length)throw new Yt(`Unexpected ${t.length-s.offset} bytes after deserialized data`);return i}var Gf=qt.deserialize=Cg;function Pg(n,e,t,r=un){const s=new r(t);return Mo(n,e,s)}qf=qt.deserializeUnchecked=Pg;var U={};Object.defineProperty(U,"__esModule",{value:!0});U.s16=U.s8=U.nu64be=U.u48be=U.u40be=U.u32be=U.u24be=U.u16be=Ft=U.nu64=U.u48=U.u40=Oe=U.u32=U.u24=hn=U.u16=lt=U.u8=mr=U.offset=U.greedy=U.Constant=U.UTF8=U.CString=U.Blob=U.Boolean=U.BitField=U.BitStructure=U.VariantLayout=U.Union=U.UnionLayoutDiscriminator=U.UnionDiscriminator=U.Structure=U.Sequence=U.DoubleBE=U.Double=U.FloatBE=U.Float=U.NearInt64BE=U.NearInt64=U.NearUInt64BE=U.NearUInt64=U.IntBE=U.Int=U.UIntBE=U.UInt=U.OffsetLayout=U.GreedyCount=U.ExternalLayout=U.bindConstructorLayout=U.nameWithProperty=U.Layout=U.uint8ArrayToBuffer=U.checkUint8Array=void 0;U.constant=U.utf8=U.cstr=bt=U.blob=U.unionLayoutDiscriminator=U.union=Vt=U.seq=U.bits=ke=U.struct=U.f64be=U.f64=U.f32be=U.f32=U.ns64be=U.s48be=U.s40be=U.s32be=U.s24be=U.s16be=an=U.ns64=U.s48=U.s40=U.s32=U.s24=void 0;const Uo=$e;function Wr(n){if(!(n instanceof Uint8Array))throw new TypeError("b must be a Uint8Array")}U.checkUint8Array=Wr;function ut(n){return Wr(n),Uo.Buffer.from(n.buffer,n.byteOffset,n.length)}U.uint8ArrayToBuffer=ut;class pt{constructor(e,t){if(!Number.isInteger(e))throw new TypeError("span must be an integer");this.span=e,this.property=t}makeDestinationObject(){return{}}getSpan(e,t){if(0>this.span)throw new RangeError("indeterminate span");return this.span}replicate(e){const t=Object.create(this.constructor.prototype);return Object.assign(t,this),t.property=e,t}fromArray(e){}}U.Layout=pt;function Do(n,e){return e.property?n+"["+e.property+"]":n}U.nameWithProperty=Do;function Lg(n,e){if(typeof n!="function")throw new TypeError("Class must be constructor");if(Object.prototype.hasOwnProperty.call(n,"layout_"))throw new Error("Class is already bound to a layout");if(!(e&&e instanceof pt))throw new TypeError("layout must be a Layout");if(Object.prototype.hasOwnProperty.call(e,"boundConstructor_"))throw new Error("layout is already bound to a constructor");n.layout_=e,e.boundConstructor_=n,e.makeDestinationObject=()=>new n,Object.defineProperty(n.prototype,"encode",{value(t,r){return e.encode(this,t,r)},writable:!0}),Object.defineProperty(n,"decode",{value(t,r){return e.decode(t,r)},writable:!0})}U.bindConstructorLayout=Lg;class en extends pt{isCount(){throw new Error("ExternalLayout is abstract")}}U.ExternalLayout=en;class Vf extends en{constructor(e=1,t){if(!Number.isInteger(e)||0>=e)throw new TypeError("elementSpan must be a (positive) integer");super(-1,t),this.elementSpan=e}isCount(){return!0}decode(e,t=0){Wr(e);const r=e.length-t;return Math.floor(r/this.elementSpan)}encode(e,t,r){return 0}}U.GreedyCount=Vf;class $o extends en{constructor(e,t=0,r){if(!(e instanceof pt))throw new TypeError("layout must be a Layout");if(!Number.isInteger(t))throw new TypeError("offset must be integer or undefined");super(e.span,r||e.property),this.layout=e,this.offset=t}isCount(){return this.layout instanceof pn||this.layout instanceof _n}decode(e,t=0){return this.layout.decode(e,t+this.offset)}encode(e,t,r=0){return this.layout.encode(e,t,r+this.offset)}}U.OffsetLayout=$o;class pn extends pt{constructor(e,t){if(super(e,t),6<this.span)throw new RangeError("span must not exceed 6 bytes")}decode(e,t=0){return ut(e).readUIntLE(t,this.span)}encode(e,t,r=0){return ut(t).writeUIntLE(e,r,this.span),this.span}}U.UInt=pn;class _n extends pt{constructor(e,t){if(super(e,t),6<this.span)throw new RangeError("span must not exceed 6 bytes")}decode(e,t=0){return ut(e).readUIntBE(t,this.span)}encode(e,t,r=0){return ut(t).writeUIntBE(e,r,this.span),this.span}}U.UIntBE=_n;class vr extends pt{constructor(e,t){if(super(e,t),6<this.span)throw new RangeError("span must not exceed 6 bytes")}decode(e,t=0){return ut(e).readIntLE(t,this.span)}encode(e,t,r=0){return ut(t).writeIntLE(e,r,this.span),this.span}}U.Int=vr;class Hr extends pt{constructor(e,t){if(super(e,t),6<this.span)throw new RangeError("span must not exceed 6 bytes")}decode(e,t=0){return ut(e).readIntBE(t,this.span)}encode(e,t,r=0){return ut(t).writeIntBE(e,r,this.span),this.span}}U.IntBE=Hr;const co=Math.pow(2,32);function ti(n){const e=Math.floor(n/co),t=n-e*co;return{hi32:e,lo32:t}}function ni(n,e){return n*co+e}class Yf extends pt{constructor(e){super(8,e)}decode(e,t=0){const r=ut(e),s=r.readUInt32LE(t),i=r.readUInt32LE(t+4);return ni(i,s)}encode(e,t,r=0){const s=ti(e),i=ut(t);return i.writeUInt32LE(s.lo32,r),i.writeUInt32LE(s.hi32,r+4),8}}U.NearUInt64=Yf;class Zf extends pt{constructor(e){super(8,e)}decode(e,t=0){const r=ut(e),s=r.readUInt32BE(t),i=r.readUInt32BE(t+4);return ni(s,i)}encode(e,t,r=0){const s=ti(e),i=ut(t);return i.writeUInt32BE(s.hi32,r),i.writeUInt32BE(s.lo32,r+4),8}}U.NearUInt64BE=Zf;class Xf extends pt{constructor(e){super(8,e)}decode(e,t=0){const r=ut(e),s=r.readUInt32LE(t),i=r.readInt32LE(t+4);return ni(i,s)}encode(e,t,r=0){const s=ti(e),i=ut(t);return i.writeUInt32LE(s.lo32,r),i.writeInt32LE(s.hi32,r+4),8}}U.NearInt64=Xf;class Jf extends pt{constructor(e){super(8,e)}decode(e,t=0){const r=ut(e),s=r.readInt32BE(t),i=r.readUInt32BE(t+4);return ni(s,i)}encode(e,t,r=0){const s=ti(e),i=ut(t);return i.writeInt32BE(s.hi32,r),i.writeUInt32BE(s.lo32,r+4),8}}U.NearInt64BE=Jf;class Qf extends pt{constructor(e){super(4,e)}decode(e,t=0){return ut(e).readFloatLE(t)}encode(e,t,r=0){return ut(t).writeFloatLE(e,r),4}}U.Float=Qf;class eu extends pt{constructor(e){super(4,e)}decode(e,t=0){return ut(e).readFloatBE(t)}encode(e,t,r=0){return ut(t).writeFloatBE(e,r),4}}U.FloatBE=eu;class tu extends pt{constructor(e){super(8,e)}decode(e,t=0){return ut(e).readDoubleLE(t)}encode(e,t,r=0){return ut(t).writeDoubleLE(e,r),8}}U.Double=tu;class nu extends pt{constructor(e){super(8,e)}decode(e,t=0){return ut(e).readDoubleBE(t)}encode(e,t,r=0){return ut(t).writeDoubleBE(e,r),8}}U.DoubleBE=nu;class ru extends pt{constructor(e,t,r){if(!(e instanceof pt))throw new TypeError("elementLayout must be a Layout");if(!(t instanceof en&&t.isCount()||Number.isInteger(t)&&0<=t))throw new TypeError("count must be non-negative integer or an unsigned integer ExternalLayout");let s=-1;!(t instanceof en)&&0<e.span&&(s=t*e.span),super(s,r),this.elementLayout=e,this.count=t}getSpan(e,t=0){if(0<=this.span)return this.span;let r=0,s=this.count;if(s instanceof en&&(s=s.decode(e,t)),0<this.elementLayout.span)r=s*this.elementLayout.span;else{let i=0;for(;i<s;)r+=this.elementLayout.getSpan(e,t+r),++i}return r}decode(e,t=0){const r=[];let s=0,i=this.count;for(i instanceof en&&(i=i.decode(e,t));s<i;)r.push(this.elementLayout.decode(e,t)),t+=this.elementLayout.getSpan(e,t),s+=1;return r}encode(e,t,r=0){const s=this.elementLayout,i=e.reduce((o,c)=>o+s.encode(c,t,r+o),0);return this.count instanceof en&&this.count.encode(e.length,t,r),i}}U.Sequence=ru;class su extends pt{constructor(e,t,r){if(!(Array.isArray(e)&&e.reduce((i,o)=>i&&o instanceof pt,!0)))throw new TypeError("fields must be array of Layout instances");typeof t=="boolean"&&r===void 0&&(r=t,t=void 0);for(const i of e)if(0>i.span&&i.property===void 0)throw new Error("fields cannot contain unnamed variable-length layout");let s=-1;try{s=e.reduce((i,o)=>i+o.getSpan(),0)}catch{}super(s,t),this.fields=e,this.decodePrefixes=!!r}getSpan(e,t=0){if(0<=this.span)return this.span;let r=0;try{r=this.fields.reduce((s,i)=>{const o=i.getSpan(e,t);return t+=o,s+o},0)}catch{throw new RangeError("indeterminate span")}return r}decode(e,t=0){Wr(e);const r=this.makeDestinationObject();for(const s of this.fields)if(s.property!==void 0&&(r[s.property]=s.decode(e,t)),t+=s.getSpan(e,t),this.decodePrefixes&&e.length===t)break;return r}encode(e,t,r=0){const s=r;let i=0,o=0;for(const c of this.fields){let f=c.span;if(o=0<f?f:0,c.property!==void 0){const l=e[c.property];l!==void 0&&(o=c.encode(l,t,r),0>f&&(f=c.getSpan(t,r)))}i=r,r+=f}return i+o-s}fromArray(e){const t=this.makeDestinationObject();for(const r of this.fields)r.property!==void 0&&0<e.length&&(t[r.property]=e.shift());return t}layoutFor(e){if(typeof e!="string")throw new TypeError("property must be string");for(const t of this.fields)if(t.property===e)return t}offsetOf(e){if(typeof e!="string")throw new TypeError("property must be string");let t=0;for(const r of this.fields){if(r.property===e)return t;0>r.span?t=-1:0<=t&&(t+=r.span)}}}U.Structure=su;class Fo{constructor(e){this.property=e}decode(e,t){throw new Error("UnionDiscriminator is abstract")}encode(e,t,r){throw new Error("UnionDiscriminator is abstract")}}U.UnionDiscriminator=Fo;class Us extends Fo{constructor(e,t){if(!(e instanceof en&&e.isCount()))throw new TypeError("layout must be an unsigned integer ExternalLayout");super(t||e.property||"variant"),this.layout=e}decode(e,t){return this.layout.decode(e,t)}encode(e,t,r){return this.layout.encode(e,t,r)}}U.UnionLayoutDiscriminator=Us;class qo extends pt{constructor(e,t,r){let s;if(e instanceof pn||e instanceof _n)s=new Us(new $o(e));else if(e instanceof en&&e.isCount())s=new Us(e);else if(e instanceof Fo)s=e;else throw new TypeError("discr must be a UnionDiscriminator or an unsigned integer layout");if(t===void 0&&(t=null),!(t===null||t instanceof pt))throw new TypeError("defaultLayout must be null or a Layout");if(t!==null){if(0>t.span)throw new Error("defaultLayout must have constant span");t.property===void 0&&(t=t.replicate("content"))}let i=-1;t&&(i=t.span,0<=i&&(e instanceof pn||e instanceof _n)&&(i+=s.layout.span)),super(i,r),this.discriminator=s,this.usesPrefixDiscriminator=e instanceof pn||e instanceof _n,this.defaultLayout=t,this.registry={};let o=this.defaultGetSourceVariant.bind(this);this.getSourceVariant=function(c){return o(c)},this.configGetSourceVariant=function(c){o=c.bind(this)}}getSpan(e,t=0){if(0<=this.span)return this.span;const r=this.getVariant(e,t);if(!r)throw new Error("unable to determine span for unrecognized variant");return r.getSpan(e,t)}defaultGetSourceVariant(e){if(Object.prototype.hasOwnProperty.call(e,this.discriminator.property)){if(this.defaultLayout&&this.defaultLayout.property&&Object.prototype.hasOwnProperty.call(e,this.defaultLayout.property))return;const t=this.registry[e[this.discriminator.property]];if(t&&(!t.layout||t.property&&Object.prototype.hasOwnProperty.call(e,t.property)))return t}else for(const t in this.registry){const r=this.registry[t];if(r.property&&Object.prototype.hasOwnProperty.call(e,r.property))return r}throw new Error("unable to infer src variant")}decode(e,t=0){let r;const s=this.discriminator,i=s.decode(e,t),o=this.registry[i];if(o===void 0){const c=this.defaultLayout;let f=0;this.usesPrefixDiscriminator&&(f=s.layout.span),r=this.makeDestinationObject(),r[s.property]=i,r[c.property]=c.decode(e,t+f)}else r=o.decode(e,t);return r}encode(e,t,r=0){const s=this.getSourceVariant(e);if(s===void 0){const i=this.discriminator,o=this.defaultLayout;let c=0;return this.usesPrefixDiscriminator&&(c=i.layout.span),i.encode(e[i.property],t,r),c+o.encode(e[o.property],t,r+c)}return s.encode(e,t,r)}addVariant(e,t,r){const s=new iu(this,e,t,r);return this.registry[e]=s,s}getVariant(e,t=0){let r;return e instanceof Uint8Array?r=this.discriminator.decode(e,t):r=e,this.registry[r]}}U.Union=qo;class iu extends pt{constructor(e,t,r,s){if(!(e instanceof qo))throw new TypeError("union must be a Union");if(!Number.isInteger(t)||0>t)throw new TypeError("variant must be a (non-negative) integer");if(typeof r=="string"&&s===void 0&&(s=r,r=null),r){if(!(r instanceof pt))throw new TypeError("layout must be a Layout");if(e.defaultLayout!==null&&0<=r.span&&r.span>e.defaultLayout.span)throw new Error("variant span exceeds span of containing union");if(typeof s!="string")throw new TypeError("variant must have a String property")}let i=e.span;0>e.span&&(i=r?r.span:0,0<=i&&e.usesPrefixDiscriminator&&(i+=e.discriminator.layout.span)),super(i,s),this.union=e,this.variant=t,this.layout=r||null}getSpan(e,t=0){if(0<=this.span)return this.span;let r=0;this.union.usesPrefixDiscriminator&&(r=this.union.discriminator.layout.span);let s=0;return this.layout&&(s=this.layout.getSpan(e,t+r)),r+s}decode(e,t=0){const r=this.makeDestinationObject();if(this!==this.union.getVariant(e,t))throw new Error("variant mismatch");let s=0;return this.union.usesPrefixDiscriminator&&(s=this.union.discriminator.layout.span),this.layout?r[this.property]=this.layout.decode(e,t+s):this.property?r[this.property]=!0:this.union.usesPrefixDiscriminator&&(r[this.union.discriminator.property]=this.variant),r}encode(e,t,r=0){let s=0;if(this.union.usesPrefixDiscriminator&&(s=this.union.discriminator.layout.span),this.layout&&!Object.prototype.hasOwnProperty.call(e,this.property))throw new TypeError("variant lacks property "+this.property);this.union.discriminator.encode(this.variant,t,r);let i=s;if(this.layout&&(this.layout.encode(e[this.property],t,r+s),i+=this.layout.getSpan(t,r+s),0<=this.union.span&&i>this.union.span))throw new Error("encoded variant overruns containing union");return i}fromArray(e){if(this.layout)return this.layout.fromArray(e)}}U.VariantLayout=iu;function Cr(n){return 0>n&&(n+=4294967296),n}class jo extends pt{constructor(e,t,r){if(!(e instanceof pn||e instanceof _n))throw new TypeError("word must be a UInt or UIntBE layout");if(typeof t=="string"&&r===void 0&&(r=t,t=!1),4<e.span)throw new RangeError("word cannot exceed 32 bits");super(e.span,r),this.word=e,this.msb=!!t,this.fields=[];let s=0;this._packedSetValue=function(i){return s=Cr(i),this},this._packedGetValue=function(){return s}}decode(e,t=0){const r=this.makeDestinationObject(),s=this.word.decode(e,t);this._packedSetValue(s);for(const i of this.fields)i.property!==void 0&&(r[i.property]=i.decode(e));return r}encode(e,t,r=0){const s=this.word.decode(t,r);this._packedSetValue(s);for(const i of this.fields)if(i.property!==void 0){const o=e[i.property];o!==void 0&&i.encode(o)}return this.word.encode(this._packedGetValue(),t,r)}addField(e,t){const r=new Ko(this,e,t);return this.fields.push(r),r}addBoolean(e){const t=new ou(this,e);return this.fields.push(t),t}fieldFor(e){if(typeof e!="string")throw new TypeError("property must be string");for(const t of this.fields)if(t.property===e)return t}}U.BitStructure=jo;class Ko{constructor(e,t,r){if(!(e instanceof jo))throw new TypeError("container must be a BitStructure");if(!Number.isInteger(t)||0>=t)throw new TypeError("bits must be positive integer");const s=8*e.span,i=e.fields.reduce((o,c)=>o+c.bits,0);if(t+i>s)throw new Error("bits too long for span remainder ("+(s-i)+" of "+s+" remain)");this.container=e,this.bits=t,this.valueMask=(1<<t)-1,t===32&&(this.valueMask=4294967295),this.start=i,this.container.msb&&(this.start=s-i-t),this.wordMask=Cr(this.valueMask<<this.start),this.property=r}decode(e,t){const r=this.container._packedGetValue();return Cr(r&this.wordMask)>>>this.start}encode(e){if(typeof e!="number"||!Number.isInteger(e)||e!==Cr(e&this.valueMask))throw new TypeError(Do("BitField.encode",this)+" value must be integer not exceeding "+this.valueMask);const t=this.container._packedGetValue(),r=Cr(e<<this.start);this.container._packedSetValue(Cr(t&~this.wordMask)|r)}}U.BitField=Ko;let ou=class extends Ko{constructor(e,t){super(e,1,t)}decode(e,t){return!!super.decode(e,t)}encode(e){typeof e=="boolean"&&(e=+e),super.encode(e)}};U.Boolean=ou;class au extends pt{constructor(e,t){if(!(e instanceof en&&e.isCount()||Number.isInteger(e)&&0<=e))throw new TypeError("length must be positive integer or an unsigned integer ExternalLayout");let r=-1;e instanceof en||(r=e),super(r,t),this.length=e}getSpan(e,t){let r=this.span;return 0>r&&(r=this.length.decode(e,t)),r}decode(e,t=0){let r=this.span;return 0>r&&(r=this.length.decode(e,t)),ut(e).slice(t,t+r)}encode(e,t,r){let s=this.length;if(this.length instanceof en&&(s=e.length),!(e instanceof Uint8Array&&s===e.length))throw new TypeError(Do("Blob.encode",this)+" requires (length "+s+") Uint8Array as src");if(r+s>t.length)throw new RangeError("encoding overruns Uint8Array");const i=ut(e);return ut(t).write(i.toString("hex"),r,s,"hex"),this.length instanceof en&&this.length.encode(s,t,r),s}}U.Blob=au;class cu extends pt{constructor(e){super(-1,e)}getSpan(e,t=0){Wr(e);let r=t;for(;r<e.length&&e[r]!==0;)r+=1;return 1+r-t}decode(e,t=0){const r=this.getSpan(e,t);return ut(e).slice(t,t+r-1).toString("utf-8")}encode(e,t,r=0){typeof e!="string"&&(e=String(e));const s=Uo.Buffer.from(e,"utf8"),i=s.length;if(r+i>t.length)throw new RangeError("encoding overruns Buffer");const o=ut(t);return s.copy(o,r),o[r+i]=0,i+1}}U.CString=cu;class fu extends pt{constructor(e,t){if(typeof e=="string"&&t===void 0&&(t=e,e=void 0),e===void 0)e=-1;else if(!Number.isInteger(e))throw new TypeError("maxSpan must be an integer");super(-1,t),this.maxSpan=e}getSpan(e,t=0){return Wr(e),e.length-t}decode(e,t=0){const r=this.getSpan(e,t);if(0<=this.maxSpan&&this.maxSpan<r)throw new RangeError("text length exceeds maxSpan");return ut(e).slice(t,t+r).toString("utf-8")}encode(e,t,r=0){typeof e!="string"&&(e=String(e));const s=Uo.Buffer.from(e,"utf8"),i=s.length;if(0<=this.maxSpan&&this.maxSpan<i)throw new RangeError("text length exceeds maxSpan");if(r+i>t.length)throw new RangeError("encoding overruns Buffer");return s.copy(ut(t),r),i}}U.UTF8=fu;class uu extends pt{constructor(e,t){super(0,t),this.value=e}decode(e,t){return this.value}encode(e,t,r){return 0}}U.Constant=uu;U.greedy=(n,e)=>new Vf(n,e);var mr=U.offset=(n,e,t)=>new $o(n,e,t),lt=U.u8=n=>new pn(1,n),hn=U.u16=n=>new pn(2,n);U.u24=n=>new pn(3,n);var Oe=U.u32=n=>new pn(4,n);U.u40=n=>new pn(5,n);U.u48=n=>new pn(6,n);var Ft=U.nu64=n=>new Yf(n);U.u16be=n=>new _n(2,n);U.u24be=n=>new _n(3,n);U.u32be=n=>new _n(4,n);U.u40be=n=>new _n(5,n);U.u48be=n=>new _n(6,n);U.nu64be=n=>new Zf(n);U.s8=n=>new vr(1,n);U.s16=n=>new vr(2,n);U.s24=n=>new vr(3,n);U.s32=n=>new vr(4,n);U.s40=n=>new vr(5,n);U.s48=n=>new vr(6,n);var an=U.ns64=n=>new Xf(n);U.s16be=n=>new Hr(2,n);U.s24be=n=>new Hr(3,n);U.s32be=n=>new Hr(4,n);U.s40be=n=>new Hr(5,n);U.s48be=n=>new Hr(6,n);U.ns64be=n=>new Jf(n);U.f32=n=>new Qf(n);U.f32be=n=>new eu(n);U.f64=n=>new tu(n);U.f64be=n=>new nu(n);var ke=U.struct=(n,e,t)=>new su(n,e,t);U.bits=(n,e,t)=>new jo(n,e,t);var Vt=U.seq=(n,e,t)=>new ru(n,e,t);U.union=(n,e,t)=>new qo(n,e,t);U.unionLayoutDiscriminator=(n,e)=>new Us(n,e);var bt=U.blob=(n,e)=>new au(n,e);U.cstr=n=>new cu(n);U.utf8=(n,e)=>new fu(n,e);U.constant=(n,e)=>new uu(n,e);class Og extends TypeError{constructor(e,t){let r;const{message:s,...i}=e,{path:o}=e,c=o.length===0?s:"At path: "+o.join(".")+" -- "+s;super(c),Object.assign(this,i),this.name=this.constructor.name,this.failures=()=>{var f;return(f=r)!=null?f:r=[e,...t()]}}}function Ng(n){return or(n)&&typeof n[Symbol.iterator]=="function"}function or(n){return typeof n=="object"&&n!=null}function Sn(n){return typeof n=="string"?JSON.stringify(n):""+n}function Mg(n){const{done:e,value:t}=n.next();return e?void 0:t}function Ug(n,e,t,r){if(n===!0)return;n===!1?n={}:typeof n=="string"&&(n={message:n});const{path:s,branch:i}=e,{type:o}=t,{refinement:c,message:f="Expected a value of type `"+o+"`"+(c?" with refinement `"+c+"`":"")+", but received: `"+Sn(r)+"`"}=n;return{value:r,type:o,refinement:c,key:s[s.length-1],path:s,branch:i,...n,message:f}}function*ac(n,e,t,r){Ng(n)||(n=[n]);for(const s of n){const i=Ug(s,e,t,r);i&&(yield i)}}function*Wo(n,e,t={}){const{path:r=[],branch:s=[n],coerce:i=!1,mask:o=!1}=t,c={path:r,branch:s};if(i&&(n=e.coercer(n,c),o&&e.type!=="type"&&or(e.schema)&&or(n)&&!Array.isArray(n)))for(const l in n)e.schema[l]===void 0&&delete n[l];let f=!0;for(const l of e.validator(n,c))f=!1,yield[l,void 0];for(let[l,p,x]of e.entries(n,c)){const k=Wo(p,x,{path:l===void 0?r:[...r,l],branch:l===void 0?s:[...s,p],coerce:i,mask:o});for(const E of k)E[0]?(f=!1,yield[E[0],void 0]):i&&(p=E[1],l===void 0?n=p:n instanceof Map?n.set(l,p):n instanceof Set?n.add(p):or(n)&&(n[l]=p))}if(f)for(const l of e.refiner(n,c))f=!1,yield[l,void 0];f&&(yield[void 0,n])}let On=class{constructor(e){const{type:t,schema:r,validator:s,refiner:i,coercer:o=f=>f,entries:c=function*(){}}=e;this.type=t,this.schema=r,this.entries=c,this.coercer=o,s?this.validator=(f,l)=>{const p=s(f,l);return ac(p,l,this,f)}:this.validator=()=>[],i?this.refiner=(f,l)=>{const p=i(f,l);return ac(p,l,this,f)}:this.refiner=()=>[]}assert(e){return Dg(e,this)}create(e){return le(e,this)}is(e){return lu(e,this)}mask(e){return $g(e,this)}validate(e,t={}){return ds(e,this,t)}};function Dg(n,e){const t=ds(n,e);if(t[0])throw t[0]}function le(n,e){const t=ds(n,e,{coerce:!0});if(t[0])throw t[0];return t[1]}function $g(n,e){const t=ds(n,e,{coerce:!0,mask:!0});if(t[0])throw t[0];return t[1]}function lu(n,e){return!ds(n,e)[0]}function ds(n,e,t={}){const r=Wo(n,e,t),s=Mg(r);return s[0]?[new Og(s[0],function*(){for(const o of r)o[0]&&(yield o[0])}),void 0]:[void 0,s[1]]}function Ar(n,e){return new On({type:n,schema:null,validator:e})}function Fg(){return Ar("any",()=>!0)}function ge(n){return new On({type:"array",schema:n,*entries(e){if(n&&Array.isArray(e))for(const[t,r]of e.entries())yield[t,r,n]},coercer(e){return Array.isArray(e)?e.slice():e},validator(e){return Array.isArray(e)||"Expected an array value, but received: "+Sn(e)}})}function Tn(){return Ar("boolean",n=>typeof n=="boolean")}function Ho(n){return Ar("instance",e=>e instanceof n||"Expected a `"+n.name+"` instance, but received: "+Sn(e))}function St(n){const e=Sn(n),t=typeof n;return new On({type:"literal",schema:t==="string"||t==="number"||t==="boolean"?n:null,validator(r){return r===n||"Expected the literal `"+e+"`, but received: "+Sn(r)}})}function qg(){return Ar("never",()=>!1)}function he(n){return new On({...n,validator:(e,t)=>e===null||n.validator(e,t),refiner:(e,t)=>e===null||n.refiner(e,t)})}function N(){return Ar("number",n=>typeof n=="number"&&!isNaN(n)||"Expected a number, but received: "+Sn(n))}function Ue(n){return new On({...n,validator:(e,t)=>e===void 0||n.validator(e,t),refiner:(e,t)=>e===void 0||n.refiner(e,t)})}function du(n,e){return new On({type:"record",schema:null,*entries(t){if(or(t))for(const r in t){const s=t[r];yield[r,r,n],yield[r,s,e]}},validator(t){return or(t)||"Expected an object, but received: "+Sn(t)}})}function ue(){return Ar("string",n=>typeof n=="string"||"Expected a string, but received: "+Sn(n))}function zo(n){const e=qg();return new On({type:"tuple",schema:null,*entries(t){if(Array.isArray(t)){const r=Math.max(n.length,t.length);for(let s=0;s<r;s++)yield[s,t[s],n[s]||e]}},validator(t){return Array.isArray(t)||"Expected an array, but received: "+Sn(t)}})}function ee(n){const e=Object.keys(n);return new On({type:"type",schema:n,*entries(t){if(or(t))for(const r of e)yield[r,t[r],n[r]]},validator(t){return or(t)||"Expected an object, but received: "+Sn(t)}})}function tn(n){const e=n.map(t=>t.type).join(" | ");return new On({type:"union",schema:null,validator(t,r){const s=[];for(const i of n){const[...o]=Wo(t,i,r),[c]=o;if(c[0])for(const[f]of o)f&&s.push(f);else return[]}return["Expected the value to satisfy a union of `"+e+"`, but received: "+Sn(t),...s]}})}function hs(){return Ar("unknown",()=>!0)}function ps(n,e,t){return new On({...n,coercer:(r,s)=>lu(r,e)?n.coercer(t(r,s),s):n.coercer(r,s)})}const jg=Mc.v4,Kg=function(n,e,t,r){if(typeof n!="string")throw new TypeError(n+" must be a string");r=r||{};const s=typeof r.version=="number"?r.version:2;if(s!==1&&s!==2)throw new TypeError(s+" must be 1 or 2");const i={method:n};if(s===2&&(i.jsonrpc="2.0"),e){if(typeof e!="object"&&!Array.isArray(e))throw new TypeError(e+" must be an object, array or omitted");i.params=e}if(typeof t>"u"){const o=typeof r.generator=="function"?r.generator:function(){return jg()};i.id=o(i,r)}else s===2&&t===null?r.notificationIdNull&&(i.id=null):i.id=t;return i};var Wg=Kg;const Hg=Mc.v4,zg=Wg,rs=function(n,e){if(!(this instanceof rs))return new rs(n,e);e||(e={}),this.options={reviver:typeof e.reviver<"u"?e.reviver:null,replacer:typeof e.replacer<"u"?e.replacer:null,generator:typeof e.generator<"u"?e.generator:function(){return Hg()},version:typeof e.version<"u"?e.version:2,notificationIdNull:typeof e.notificationIdNull=="boolean"?e.notificationIdNull:!1},this.callServer=n};var Gg=rs;rs.prototype.request=function(n,e,t,r){const s=this;let i=null;const o=Array.isArray(n)&&typeof e=="function";if(this.options.version===1&&o)throw new TypeError("JSON-RPC 1.0 does not support batching");if(o||!o&&n&&typeof n=="object"&&typeof e=="function")r=e,i=n;else{typeof t=="function"&&(r=t,t=void 0);const l=typeof r=="function";try{i=zg(n,e,t,{generator:this.options.generator,version:this.options.version,notificationIdNull:this.options.notificationIdNull})}catch(p){if(l)return r(p);throw p}if(!l)return i}let f;try{f=JSON.stringify(i,this.options.replacer)}catch(l){return r(l)}return this.callServer(f,function(l,p){s._parseResponse(l,p,r)}),i};rs.prototype._parseResponse=function(n,e,t){if(n){t(n);return}if(!e)return t();let r;try{r=JSON.parse(e,this.options.reviver)}catch(s){return t(s)}if(t.length===3)if(Array.isArray(r)){const s=function(o){return typeof o.error<"u"},i=function(o){return!s(o)};return t(null,r.filter(s),r.filter(i))}else return t(null,r.error,r.result);t(null,r)};const Vg=cs(Gg);var hu={},pu={exports:{}};(function(n){function e(t){return t&&t.__esModule?t:{default:t}}n.exports=e,n.exports.__esModule=!0,n.exports.default=n.exports})(pu);var Go=pu.exports,Li={exports:{}},cc;function Vo(){return cc||(cc=1,function(n){function e(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}n.exports=e,n.exports.__esModule=!0,n.exports.default=n.exports}(Li)),Li.exports}var Oi={exports:{}},Ni={exports:{}},Mi={exports:{}},fc;function Yg(){return fc||(fc=1,function(n){var e=fs().default;function t(r,s){if(e(r)!=="object"||r===null)return r;var i=r[Symbol.toPrimitive];if(i!==void 0){var o=i.call(r,s||"default");if(e(o)!=="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(r)}n.exports=t,n.exports.__esModule=!0,n.exports.default=n.exports}(Mi)),Mi.exports}var uc;function Zg(){return uc||(uc=1,function(n){var e=fs().default,t=Yg();function r(s){var i=t(s,"string");return e(i)==="symbol"?i:String(i)}n.exports=r,n.exports.__esModule=!0,n.exports.default=n.exports}(Ni)),Ni.exports}var lc;function Yo(){return lc||(lc=1,function(n){var e=Zg();function t(s,i){for(var o=0;o<i.length;o++){var c=i[o];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(s,e(c.key),c)}}function r(s,i,o){return i&&t(s.prototype,i),o&&t(s,o),Object.defineProperty(s,"prototype",{writable:!1}),s}n.exports=r,n.exports.__esModule=!0,n.exports.default=n.exports}(Oi)),Oi.exports}var Ui={exports:{}},Di={exports:{}},dc;function Xg(){return dc||(dc=1,function(n){function e(t,r){return n.exports=e=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,o){return i.__proto__=o,i},n.exports.__esModule=!0,n.exports.default=n.exports,e(t,r)}n.exports=e,n.exports.__esModule=!0,n.exports.default=n.exports}(Di)),Di.exports}var hc;function gu(){return hc||(hc=1,function(n){var e=Xg();function t(r,s){if(typeof s!="function"&&s!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(s&&s.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),s&&e(r,s)}n.exports=t,n.exports.__esModule=!0,n.exports.default=n.exports}(Ui)),Ui.exports}var $i={exports:{}},Fi={exports:{}},pc;function Jg(){return pc||(pc=1,function(n){function e(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}n.exports=e,n.exports.__esModule=!0,n.exports.default=n.exports}(Fi)),Fi.exports}var gc;function yu(){return gc||(gc=1,function(n){var e=fs().default,t=Jg();function r(s,i){if(i&&(e(i)==="object"||typeof i=="function"))return i;if(i!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return t(s)}n.exports=r,n.exports.__esModule=!0,n.exports.default=n.exports}($i)),$i.exports}var qi={exports:{}},yc;function bu(){return yc||(yc=1,function(n){function e(t){return n.exports=e=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(s){return s.__proto__||Object.getPrototypeOf(s)},n.exports.__esModule=!0,n.exports.default=n.exports,e(t)}n.exports=e,n.exports.__esModule=!0,n.exports.default=n.exports}(qi)),qi.exports}var Br={},bc;function Qg(){if(bc)return Br;bc=1;var n=Go;Object.defineProperty(Br,"__esModule",{value:!0}),Br.DefaultDataPack=void 0,Br.createError=i;var e=n(Vo()),t=n(Yo()),r=new Map([[-32e3,"Event not provided"],[-32600,"Invalid Request"],[-32601,"Method not found"],[-32602,"Invalid params"],[-32603,"Internal error"],[-32604,"Params not found"],[-32605,"Method forbidden"],[-32606,"Event forbidden"],[-32700,"Parse error"]]),s=function(){function o(){(0,e.default)(this,o)}return(0,t.default)(o,[{key:"encode",value:function(f){return JSON.stringify(f)}},{key:"decode",value:function(f){return JSON.parse(f)}}]),o}();Br.DefaultDataPack=s;function i(o,c){var f={code:o,message:r.get(o)||"Internal Server Error"};return c&&(f.data=c),f}return Br}(function(n){var e=Go;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=e(ql()),r=e($l()),s=e(fs()),i=e(Vo()),o=e(Yo()),c=e(gu()),f=e(yu()),l=e(bu()),p=Uc(),x=Qg();function k(v){var I=E();return function(){var T=(0,l.default)(v),$;if(I){var D=(0,l.default)(this).constructor;$=Reflect.construct(T,arguments,D)}else $=T.apply(this,arguments);return(0,f.default)(this,$)}}function E(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var b=function(v,I){var A={};for(var T in v)Object.prototype.hasOwnProperty.call(v,T)&&I.indexOf(T)<0&&(A[T]=v[T]);if(v!=null&&typeof Object.getOwnPropertySymbols=="function")for(var $=0,T=Object.getOwnPropertySymbols(v);$<T.length;$++)I.indexOf(T[$])<0&&Object.prototype.propertyIsEnumerable.call(v,T[$])&&(A[T[$]]=v[T[$]]);return A},_=function(v){(0,c.default)(A,v);var I=k(A);function A(T){var $,D=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"ws://localhost:8080",P=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},H=arguments.length>3?arguments[3]:void 0,K=arguments.length>4?arguments[4]:void 0;(0,i.default)(this,A);var ie=P.autoconnect,F=ie===void 0?!0:ie,oe=P.reconnect,Pe=oe===void 0?!0:oe,ve=P.reconnect_interval,Me=ve===void 0?1e3:ve,W=P.max_reconnects,te=W===void 0?5:W,be=b(P,["autoconnect","reconnect","reconnect_interval","max_reconnects"]);return $=I.call(this),$.webSocketFactory=T,$.queue={},$.rpc_id=0,$.address=D,$.autoconnect=F,$.ready=!1,$.reconnect=Pe,$.reconnect_timer_id=void 0,$.reconnect_interval=Me,$.max_reconnects=te,$.rest_options=be,$.current_reconnects=0,$.generate_request_id=H||function(){return++$.rpc_id},K?$.dataPack=K:$.dataPack=new x.DefaultDataPack,$.autoconnect&&$._connect($.address,Object.assign({autoconnect:$.autoconnect,reconnect:$.reconnect,reconnect_interval:$.reconnect_interval,max_reconnects:$.max_reconnects},$.rest_options)),$}return(0,o.default)(A,[{key:"connect",value:function(){this.socket||this._connect(this.address,Object.assign({autoconnect:this.autoconnect,reconnect:this.reconnect,reconnect_interval:this.reconnect_interval,max_reconnects:this.max_reconnects},this.rest_options))}},{key:"call",value:function($,D,P,H){var K=this;return!H&&(0,s.default)(P)==="object"&&(H=P,P=null),new Promise(function(ie,F){if(!K.ready)return F(new Error("socket not ready"));var oe=K.generate_request_id($,D),Pe={jsonrpc:"2.0",method:$,params:D||void 0,id:oe};K.socket.send(K.dataPack.encode(Pe),H,function(ve){if(ve)return F(ve);K.queue[oe]={promise:[ie,F]},P&&(K.queue[oe].timeout=setTimeout(function(){delete K.queue[oe],F(new Error("reply timeout"))},P))})})}},{key:"login",value:function(){var T=(0,r.default)(t.default.mark(function D(P){var H;return t.default.wrap(function(ie){for(;;)switch(ie.prev=ie.next){case 0:return ie.next=2,this.call("rpc.login",P);case 2:if(H=ie.sent,H){ie.next=5;break}throw new Error("authentication failed");case 5:return ie.abrupt("return",H);case 6:case"end":return ie.stop()}},D,this)}));function $(D){return T.apply(this,arguments)}return $}()},{key:"listMethods",value:function(){var T=(0,r.default)(t.default.mark(function D(){return t.default.wrap(function(H){for(;;)switch(H.prev=H.next){case 0:return H.next=2,this.call("__listMethods");case 2:return H.abrupt("return",H.sent);case 3:case"end":return H.stop()}},D,this)}));function $(){return T.apply(this,arguments)}return $}()},{key:"notify",value:function($,D){var P=this;return new Promise(function(H,K){if(!P.ready)return K(new Error("socket not ready"));var ie={jsonrpc:"2.0",method:$,params:D};P.socket.send(P.dataPack.encode(ie),function(F){if(F)return K(F);H()})})}},{key:"subscribe",value:function(){var T=(0,r.default)(t.default.mark(function D(P){var H;return t.default.wrap(function(ie){for(;;)switch(ie.prev=ie.next){case 0:return typeof P=="string"&&(P=[P]),ie.next=3,this.call("rpc.on",P);case 3:if(H=ie.sent,!(typeof P=="string"&&H[P]!=="ok")){ie.next=6;break}throw new Error("Failed subscribing to an event '"+P+"' with: "+H[P]);case 6:return ie.abrupt("return",H);case 7:case"end":return ie.stop()}},D,this)}));function $(D){return T.apply(this,arguments)}return $}()},{key:"unsubscribe",value:function(){var T=(0,r.default)(t.default.mark(function D(P){var H;return t.default.wrap(function(ie){for(;;)switch(ie.prev=ie.next){case 0:return typeof P=="string"&&(P=[P]),ie.next=3,this.call("rpc.off",P);case 3:if(H=ie.sent,!(typeof P=="string"&&H[P]!=="ok")){ie.next=6;break}throw new Error("Failed unsubscribing from an event with: "+H);case 6:return ie.abrupt("return",H);case 7:case"end":return ie.stop()}},D,this)}));function $(D){return T.apply(this,arguments)}return $}()},{key:"close",value:function($,D){this.socket.close($||1e3,D)}},{key:"_connect",value:function($,D){var P=this;clearTimeout(this.reconnect_timer_id),this.socket=this.webSocketFactory($,D),this.socket.addEventListener("open",function(){P.ready=!0,P.emit("open"),P.current_reconnects=0}),this.socket.addEventListener("message",function(H){var K=H.data;K instanceof ArrayBuffer&&(K=mt.Buffer.from(K).toString());try{K=P.dataPack.decode(K)}catch{return}if(K.notification&&P.listeners(K.notification).length){if(!Object.keys(K.params).length)return P.emit(K.notification);var ie=[K.notification];if(K.params.constructor===Object)ie.push(K.params);else for(var F=0;F<K.params.length;F++)ie.push(K.params[F]);return Promise.resolve().then(function(){P.emit.apply(P,ie)})}if(!P.queue[K.id])return K.method&&K.params?Promise.resolve().then(function(){P.emit(K.method,K.params)}):void 0;"error"in K=="result"in K&&P.queue[K.id].promise[1](new Error('Server response malformed. Response must include either "result" or "error", but not both.')),P.queue[K.id].timeout&&clearTimeout(P.queue[K.id].timeout),K.error?P.queue[K.id].promise[1](K.error):P.queue[K.id].promise[0](K.result),delete P.queue[K.id]}),this.socket.addEventListener("error",function(H){return P.emit("error",H)}),this.socket.addEventListener("close",function(H){var K=H.code,ie=H.reason;P.ready&&setTimeout(function(){return P.emit("close",K,ie)},0),P.ready=!1,P.socket=void 0,K!==1e3&&(P.current_reconnects++,P.reconnect&&(P.max_reconnects>P.current_reconnects||P.max_reconnects===0)&&(P.reconnect_timer_id=setTimeout(function(){return P._connect($,D)},P.reconnect_interval)))})}}]),A}(p.EventEmitter);n.default=_})(hu);const e0=cs(hu);var wu={};(function(n){var e=Go;Object.defineProperty(n,"__esModule",{value:!0}),n.default=x;var t=e(Vo()),r=e(Yo()),s=e(gu()),i=e(yu()),o=e(bu()),c=Uc();function f(k){var E=l();return function(){var _=(0,o.default)(k),v;if(E){var I=(0,o.default)(this).constructor;v=Reflect.construct(_,arguments,I)}else v=_.apply(this,arguments);return(0,i.default)(this,v)}}function l(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var p=function(k){(0,s.default)(b,k);var E=f(b);function b(_,v,I){var A;return(0,t.default)(this,b),A=E.call(this),A.socket=new window.WebSocket(_,I),A.socket.onopen=function(){return A.emit("open")},A.socket.onmessage=function(T){return A.emit("message",T.data)},A.socket.onerror=function(T){return A.emit("error",T)},A.socket.onclose=function(T){A.emit("close",T.code,T.reason)},A}return(0,r.default)(b,[{key:"send",value:function(v,I,A){var T=A||I;try{this.socket.send(v),T()}catch($){T($)}}},{key:"close",value:function(v,I){this.socket.close(v,I)}},{key:"addEventListener",value:function(v,I,A){this.socket.addEventListener(v,I,A)}}]),b}(c.EventEmitter);function x(k,E){return new p(k,E)}})(wu);const t0=cs(wu);Kr.utils.randomPrivateKey;const wc=()=>{const n=Kr.utils.randomPrivateKey(),e=fo(n),t=new Uint8Array(64);return t.set(n),t.set(e,32),{publicKey:e,secretKey:t}},fo=Kr.getPublicKey;function mc(n){try{return Kr.ExtendedPoint.fromHex(n),!0}catch{return!1}}const mu=(n,e)=>Kr.sign(n,e.slice(0,32)),n0=Kr.verify,$r=n=>$e.Buffer.isBuffer(n)?n:n instanceof Uint8Array?$e.Buffer.from(n.buffer,n.byteOffset,n.byteLength):$e.Buffer.from(n);class r0{constructor(e){Object.assign(this,e)}encode(){return $e.Buffer.from(zf(Es,this))}static decode(e){return Gf(Es,this,e)}static decodeUnchecked(e){return qf(Es,this,e)}}const Es=new Map;var xu;let _u;const s0=32,Rn=32;function i0(n){return n._bn!==void 0}let xc=1;_u=Symbol.toStringTag;class Ne extends r0{constructor(e){if(super({}),this._bn=void 0,i0(e))this._bn=e._bn;else{if(typeof e=="string"){const t=jt.decode(e);if(t.length!=Rn)throw new Error("Invalid public key input");this._bn=new aa(t)}else this._bn=new aa(e);if(this._bn.byteLength()>Rn)throw new Error("Invalid public key input")}}static unique(){const e=new Ne(xc);return xc+=1,new Ne(e.toBuffer())}equals(e){return this._bn.eq(e._bn)}toBase58(){return jt.encode(this.toBytes())}toJSON(){return this.toBase58()}toBytes(){const e=this.toBuffer();return new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}toBuffer(){const e=this._bn.toArrayLike($e.Buffer);if(e.length===Rn)return e;const t=$e.Buffer.alloc(32);return e.copy(t,32-e.length),t}get[_u](){return`PublicKey(${this.toString()})`}toString(){return this.toBase58()}static async createWithSeed(e,t,r){const s=$e.Buffer.concat([e.toBuffer(),$e.Buffer.from(t),r.toBuffer()]),i=zi(s);return new Ne(i)}static createProgramAddressSync(e,t){let r=$e.Buffer.alloc(0);e.forEach(function(i){if(i.length>s0)throw new TypeError("Max seed length exceeded");r=$e.Buffer.concat([r,$r(i)])}),r=$e.Buffer.concat([r,t.toBuffer(),$e.Buffer.from("ProgramDerivedAddress")]);const s=zi(r);if(mc(s))throw new Error("Invalid seeds, address must fall off the curve");return new Ne(s)}static async createProgramAddress(e,t){return this.createProgramAddressSync(e,t)}static findProgramAddressSync(e,t){let r=255,s;for(;r!=0;){try{const i=e.concat($e.Buffer.from([r]));s=this.createProgramAddressSync(i,t)}catch(i){if(i instanceof TypeError)throw i;r--;continue}return[s,r]}throw new Error("Unable to find a viable program address nonce")}static async findProgramAddress(e,t){return this.findProgramAddressSync(e,t)}static isOnCurve(e){const t=new Ne(e);return mc(t.toBytes())}}xu=Ne;Ne.default=new xu("11111111111111111111111111111111");Es.set(Ne,{kind:"struct",fields:[["_bn","u256"]]});new Ne("BPFLoader1111111111111111111111111111111111");const Nr=1232,Zo=127,ss=64;class Su extends Error{constructor(e){super(`Signature ${e} has expired: block height exceeded.`),this.signature=void 0,this.signature=e}}Object.defineProperty(Su.prototype,"name",{value:"TransactionExpiredBlockheightExceededError"});class Eu extends Error{constructor(e,t){super(`Transaction was not confirmed in ${t.toFixed(2)} seconds. It is unknown if it succeeded or failed. Check signature ${e} using the Solana Explorer or CLI tools.`),this.signature=void 0,this.signature=e}}Object.defineProperty(Eu.prototype,"name",{value:"TransactionExpiredTimeoutError"});class Xr extends Error{constructor(e){super(`Signature ${e} has expired: the nonce is no longer valid.`),this.signature=void 0,this.signature=e}}Object.defineProperty(Xr.prototype,"name",{value:"TransactionExpiredNonceInvalidError"});class Ds{constructor(e,t){this.staticAccountKeys=void 0,this.accountKeysFromLookups=void 0,this.staticAccountKeys=e,this.accountKeysFromLookups=t}keySegments(){const e=[this.staticAccountKeys];return this.accountKeysFromLookups&&(e.push(this.accountKeysFromLookups.writable),e.push(this.accountKeysFromLookups.readonly)),e}get(e){for(const t of this.keySegments()){if(e<t.length)return t[e];e-=t.length}}get length(){return this.keySegments().flat().length}compileInstructions(e){if(this.length>256)throw new Error("Account index overflow encountered during compilation");const r=new Map;this.keySegments().flat().forEach((i,o)=>{r.set(i.toBase58(),o)});const s=i=>{const o=r.get(i.toBase58());if(o===void 0)throw new Error("Encountered an unknown instruction account key during compilation");return o};return e.map(i=>({programIdIndex:s(i.programId),accountKeyIndexes:i.keys.map(o=>s(o.pubkey)),data:i.data}))}}const nt=(n="publicKey")=>bt(32,n),o0=(n="signature")=>bt(64,n),Lr=(n="string")=>{const e=ke([Oe("length"),Oe("lengthPadding"),bt(mr(Oe(),-8),"chars")],n),t=e.decode.bind(e),r=e.encode.bind(e),s=e;return s.decode=(i,o)=>t(i,o).chars.toString(),s.encode=(i,o,c)=>{const f={chars:$e.Buffer.from(i,"utf8")};return r(f,o,c)},s.alloc=i=>Oe().span+Oe().span+$e.Buffer.from(i,"utf8").length,s},a0=(n="authorized")=>ke([nt("staker"),nt("withdrawer")],n),c0=(n="lockup")=>ke([an("unixTimestamp"),an("epoch"),nt("custodian")],n),f0=(n="voteInit")=>ke([nt("nodePubkey"),nt("authorizedVoter"),nt("authorizedWithdrawer"),lt("commission")],n),u0=(n="voteAuthorizeWithSeedArgs")=>ke([Oe("voteAuthorizationType"),nt("currentAuthorityDerivedKeyOwnerPubkey"),Lr("currentAuthorityDerivedKeySeed"),nt("newAuthorized")],n);function cn(n){let e=0,t=0;for(;;){let r=n.shift();if(e|=(r&127)<<t*7,t+=1,!(r&128))break}return e}function fn(n,e){let t=e;for(;;){let r=t&127;if(t>>=7,t==0){n.push(r);break}else r|=128,n.push(r)}}function xt(n,e){if(!n)throw new Error(e||"Assertion failed")}class ri{constructor(e,t){this.payer=void 0,this.keyMetaMap=void 0,this.payer=e,this.keyMetaMap=t}static compile(e,t){const r=new Map,s=o=>{const c=o.toBase58();let f=r.get(c);return f===void 0&&(f={isSigner:!1,isWritable:!1,isInvoked:!1},r.set(c,f)),f},i=s(t);i.isSigner=!0,i.isWritable=!0;for(const o of e){s(o.programId).isInvoked=!0;for(const c of o.keys){const f=s(c.pubkey);f.isSigner||(f.isSigner=c.isSigner),f.isWritable||(f.isWritable=c.isWritable)}}return new ri(t,r)}getMessageComponents(){const e=[...this.keyMetaMap.entries()];xt(e.length<=256,"Max static account keys length exceeded");const t=e.filter(([,f])=>f.isSigner&&f.isWritable),r=e.filter(([,f])=>f.isSigner&&!f.isWritable),s=e.filter(([,f])=>!f.isSigner&&f.isWritable),i=e.filter(([,f])=>!f.isSigner&&!f.isWritable),o={numRequiredSignatures:t.length+r.length,numReadonlySignedAccounts:r.length,numReadonlyUnsignedAccounts:i.length};{xt(t.length>0,"Expected at least one writable signer key");const[f]=t[0];xt(f===this.payer.toBase58(),"Expected first writable signer key to be the fee payer")}const c=[...t.map(([f])=>new Ne(f)),...r.map(([f])=>new Ne(f)),...s.map(([f])=>new Ne(f)),...i.map(([f])=>new Ne(f))];return[o,c]}extractTableLookup(e){const[t,r]=this.drainKeysFoundInLookupTable(e.state.addresses,o=>!o.isSigner&&!o.isInvoked&&o.isWritable),[s,i]=this.drainKeysFoundInLookupTable(e.state.addresses,o=>!o.isSigner&&!o.isInvoked&&!o.isWritable);if(!(t.length===0&&s.length===0))return[{accountKey:e.key,writableIndexes:t,readonlyIndexes:s},{writable:r,readonly:i}]}drainKeysFoundInLookupTable(e,t){const r=new Array,s=new Array;for(const[i,o]of this.keyMetaMap.entries())if(t(o)){const c=new Ne(i),f=e.findIndex(l=>l.equals(c));f>=0&&(xt(f<256,"Max lookup table index exceeded"),r.push(f),s.push(c),this.keyMetaMap.delete(i))}return[r,s]}}class Wn{constructor(e){this.header=void 0,this.accountKeys=void 0,this.recentBlockhash=void 0,this.instructions=void 0,this.indexToProgramIds=new Map,this.header=e.header,this.accountKeys=e.accountKeys.map(t=>new Ne(t)),this.recentBlockhash=e.recentBlockhash,this.instructions=e.instructions,this.instructions.forEach(t=>this.indexToProgramIds.set(t.programIdIndex,this.accountKeys[t.programIdIndex]))}get version(){return"legacy"}get staticAccountKeys(){return this.accountKeys}get compiledInstructions(){return this.instructions.map(e=>({programIdIndex:e.programIdIndex,accountKeyIndexes:e.accounts,data:jt.decode(e.data)}))}get addressTableLookups(){return[]}getAccountKeys(){return new Ds(this.staticAccountKeys)}static compile(e){const t=ri.compile(e.instructions,e.payerKey),[r,s]=t.getMessageComponents(),o=new Ds(s).compileInstructions(e.instructions).map(c=>({programIdIndex:c.programIdIndex,accounts:c.accountKeyIndexes,data:jt.encode(c.data)}));return new Wn({header:r,accountKeys:s,recentBlockhash:e.recentBlockhash,instructions:o})}isAccountSigner(e){return e<this.header.numRequiredSignatures}isAccountWritable(e){const t=this.header.numRequiredSignatures;if(e>=this.header.numRequiredSignatures){const r=e-t,i=this.accountKeys.length-t-this.header.numReadonlyUnsignedAccounts;return r<i}else{const r=t-this.header.numReadonlySignedAccounts;return e<r}}isProgramId(e){return this.indexToProgramIds.has(e)}programIds(){return[...this.indexToProgramIds.values()]}nonProgramIds(){return this.accountKeys.filter((e,t)=>!this.isProgramId(t))}serialize(){const e=this.accountKeys.length;let t=[];fn(t,e);const r=this.instructions.map(x=>{const{accounts:k,programIdIndex:E}=x,b=Array.from(jt.decode(x.data));let _=[];fn(_,k.length);let v=[];return fn(v,b.length),{programIdIndex:E,keyIndicesCount:$e.Buffer.from(_),keyIndices:k,dataLength:$e.Buffer.from(v),data:b}});let s=[];fn(s,r.length);let i=$e.Buffer.alloc(Nr);$e.Buffer.from(s).copy(i);let o=s.length;r.forEach(x=>{const E=ke([lt("programIdIndex"),bt(x.keyIndicesCount.length,"keyIndicesCount"),Vt(lt("keyIndex"),x.keyIndices.length,"keyIndices"),bt(x.dataLength.length,"dataLength"),Vt(lt("userdatum"),x.data.length,"data")]).encode(x,i,o);o+=E}),i=i.slice(0,o);const c=ke([bt(1,"numRequiredSignatures"),bt(1,"numReadonlySignedAccounts"),bt(1,"numReadonlyUnsignedAccounts"),bt(t.length,"keyCount"),Vt(nt("key"),e,"keys"),nt("recentBlockhash")]),f={numRequiredSignatures:$e.Buffer.from([this.header.numRequiredSignatures]),numReadonlySignedAccounts:$e.Buffer.from([this.header.numReadonlySignedAccounts]),numReadonlyUnsignedAccounts:$e.Buffer.from([this.header.numReadonlyUnsignedAccounts]),keyCount:$e.Buffer.from(t),keys:this.accountKeys.map(x=>$r(x.toBytes())),recentBlockhash:jt.decode(this.recentBlockhash)};let l=$e.Buffer.alloc(2048);const p=c.encode(f,l);return i.copy(l,p),l.slice(0,p+i.length)}static from(e){let t=[...e];const r=t.shift();if(r!==(r&Zo))throw new Error("Versioned messages must be deserialized with VersionedMessage.deserialize()");const s=t.shift(),i=t.shift(),o=cn(t);let c=[];for(let k=0;k<o;k++){const E=t.slice(0,Rn);t=t.slice(Rn),c.push(new Ne($e.Buffer.from(E)))}const f=t.slice(0,Rn);t=t.slice(Rn);const l=cn(t);let p=[];for(let k=0;k<l;k++){const E=t.shift(),b=cn(t),_=t.slice(0,b);t=t.slice(b);const v=cn(t),I=t.slice(0,v),A=jt.encode($e.Buffer.from(I));t=t.slice(v),p.push({programIdIndex:E,accounts:_,data:A})}const x={header:{numRequiredSignatures:r,numReadonlySignedAccounts:s,numReadonlyUnsignedAccounts:i},recentBlockhash:jt.encode($e.Buffer.from(f)),accountKeys:c,instructions:p};return new Wn(x)}}class is{constructor(e){this.header=void 0,this.staticAccountKeys=void 0,this.recentBlockhash=void 0,this.compiledInstructions=void 0,this.addressTableLookups=void 0,this.header=e.header,this.staticAccountKeys=e.staticAccountKeys,this.recentBlockhash=e.recentBlockhash,this.compiledInstructions=e.compiledInstructions,this.addressTableLookups=e.addressTableLookups}get version(){return 0}get numAccountKeysFromLookups(){let e=0;for(const t of this.addressTableLookups)e+=t.readonlyIndexes.length+t.writableIndexes.length;return e}getAccountKeys(e){let t;if(e&&"accountKeysFromLookups"in e&&e.accountKeysFromLookups){if(this.numAccountKeysFromLookups!=e.accountKeysFromLookups.writable.length+e.accountKeysFromLookups.readonly.length)throw new Error("Failed to get account keys because of a mismatch in the number of account keys from lookups");t=e.accountKeysFromLookups}else if(e&&"addressLookupTableAccounts"in e&&e.addressLookupTableAccounts)t=this.resolveAddressTableLookups(e.addressLookupTableAccounts);else if(this.addressTableLookups.length>0)throw new Error("Failed to get account keys because address table lookups were not resolved");return new Ds(this.staticAccountKeys,t)}isAccountSigner(e){return e<this.header.numRequiredSignatures}isAccountWritable(e){const t=this.header.numRequiredSignatures,r=this.staticAccountKeys.length;if(e>=r){const s=e-r,i=this.addressTableLookups.reduce((o,c)=>o+c.writableIndexes.length,0);return s<i}else if(e>=this.header.numRequiredSignatures){const s=e-t,o=r-t-this.header.numReadonlyUnsignedAccounts;return s<o}else{const s=t-this.header.numReadonlySignedAccounts;return e<s}}resolveAddressTableLookups(e){const t={writable:[],readonly:[]};for(const r of this.addressTableLookups){const s=e.find(i=>i.key.equals(r.accountKey));if(!s)throw new Error(`Failed to find address lookup table account for table key ${r.accountKey.toBase58()}`);for(const i of r.writableIndexes)if(i<s.state.addresses.length)t.writable.push(s.state.addresses[i]);else throw new Error(`Failed to find address for index ${i} in address lookup table ${r.accountKey.toBase58()}`);for(const i of r.readonlyIndexes)if(i<s.state.addresses.length)t.readonly.push(s.state.addresses[i]);else throw new Error(`Failed to find address for index ${i} in address lookup table ${r.accountKey.toBase58()}`)}return t}static compile(e){const t=ri.compile(e.instructions,e.payerKey),r=new Array,s={writable:new Array,readonly:new Array},i=e.addressLookupTableAccounts||[];for(const p of i){const x=t.extractTableLookup(p);if(x!==void 0){const[k,{writable:E,readonly:b}]=x;r.push(k),s.writable.push(...E),s.readonly.push(...b)}}const[o,c]=t.getMessageComponents(),l=new Ds(c,s).compileInstructions(e.instructions);return new is({header:o,staticAccountKeys:c,recentBlockhash:e.recentBlockhash,compiledInstructions:l,addressTableLookups:r})}serialize(){const e=Array();fn(e,this.staticAccountKeys.length);const t=this.serializeInstructions(),r=Array();fn(r,this.compiledInstructions.length);const s=this.serializeAddressTableLookups(),i=Array();fn(i,this.addressTableLookups.length);const o=ke([lt("prefix"),ke([lt("numRequiredSignatures"),lt("numReadonlySignedAccounts"),lt("numReadonlyUnsignedAccounts")],"header"),bt(e.length,"staticAccountKeysLength"),Vt(nt(),this.staticAccountKeys.length,"staticAccountKeys"),nt("recentBlockhash"),bt(r.length,"instructionsLength"),bt(t.length,"serializedInstructions"),bt(i.length,"addressTableLookupsLength"),bt(s.length,"serializedAddressTableLookups")]),c=new Uint8Array(Nr),f=128,l=o.encode({prefix:f,header:this.header,staticAccountKeysLength:new Uint8Array(e),staticAccountKeys:this.staticAccountKeys.map(p=>p.toBytes()),recentBlockhash:jt.decode(this.recentBlockhash),instructionsLength:new Uint8Array(r),serializedInstructions:t,addressTableLookupsLength:new Uint8Array(i),serializedAddressTableLookups:s},c);return c.slice(0,l)}serializeInstructions(){let e=0;const t=new Uint8Array(Nr);for(const r of this.compiledInstructions){const s=Array();fn(s,r.accountKeyIndexes.length);const i=Array();fn(i,r.data.length);const o=ke([lt("programIdIndex"),bt(s.length,"encodedAccountKeyIndexesLength"),Vt(lt(),r.accountKeyIndexes.length,"accountKeyIndexes"),bt(i.length,"encodedDataLength"),bt(r.data.length,"data")]);e+=o.encode({programIdIndex:r.programIdIndex,encodedAccountKeyIndexesLength:new Uint8Array(s),accountKeyIndexes:r.accountKeyIndexes,encodedDataLength:new Uint8Array(i),data:r.data},t,e)}return t.slice(0,e)}serializeAddressTableLookups(){let e=0;const t=new Uint8Array(Nr);for(const r of this.addressTableLookups){const s=Array();fn(s,r.writableIndexes.length);const i=Array();fn(i,r.readonlyIndexes.length);const o=ke([nt("accountKey"),bt(s.length,"encodedWritableIndexesLength"),Vt(lt(),r.writableIndexes.length,"writableIndexes"),bt(i.length,"encodedReadonlyIndexesLength"),Vt(lt(),r.readonlyIndexes.length,"readonlyIndexes")]);e+=o.encode({accountKey:r.accountKey.toBytes(),encodedWritableIndexesLength:new Uint8Array(s),writableIndexes:r.writableIndexes,encodedReadonlyIndexesLength:new Uint8Array(i),readonlyIndexes:r.readonlyIndexes},t,e)}return t.slice(0,e)}static deserialize(e){let t=[...e];const r=t.shift(),s=r&Zo;xt(r!==s,"Expected versioned message but received legacy message");const i=s;xt(i===0,`Expected versioned message with version 0 but found version ${i}`);const o={numRequiredSignatures:t.shift(),numReadonlySignedAccounts:t.shift(),numReadonlyUnsignedAccounts:t.shift()},c=[],f=cn(t);for(let b=0;b<f;b++)c.push(new Ne(t.splice(0,Rn)));const l=jt.encode(t.splice(0,Rn)),p=cn(t),x=[];for(let b=0;b<p;b++){const _=t.shift(),v=cn(t),I=t.splice(0,v),A=cn(t),T=new Uint8Array(t.splice(0,A));x.push({programIdIndex:_,accountKeyIndexes:I,data:T})}const k=cn(t),E=[];for(let b=0;b<k;b++){const _=new Ne(t.splice(0,Rn)),v=cn(t),I=t.splice(0,v),A=cn(t),T=t.splice(0,A);E.push({accountKey:_,writableIndexes:I,readonlyIndexes:T})}return new is({header:o,staticAccountKeys:c,recentBlockhash:l,compiledInstructions:x,addressTableLookups:E})}}const vu={deserializeMessageVersion(n){const e=n[0],t=e&Zo;return t===e?"legacy":t},deserialize:n=>{const e=vu.deserializeMessageVersion(n);if(e==="legacy")return Wn.from(n);if(e===0)return is.deserialize(n);throw new Error(`Transaction message version ${e} deserialization is not supported`)}};let nr=function(n){return n[n.BLOCKHEIGHT_EXCEEDED=0]="BLOCKHEIGHT_EXCEEDED",n[n.PROCESSED=1]="PROCESSED",n[n.TIMED_OUT=2]="TIMED_OUT",n[n.NONCE_INVALID=3]="NONCE_INVALID",n}({});const l0=$e.Buffer.alloc(ss).fill(0);class _c{constructor(e){this.keys=void 0,this.programId=void 0,this.data=$e.Buffer.alloc(0),this.programId=e.programId,this.keys=e.keys,e.data&&(this.data=e.data)}toJSON(){return{keys:this.keys.map(({pubkey:e,isSigner:t,isWritable:r})=>({pubkey:e.toJSON(),isSigner:t,isWritable:r})),programId:this.programId.toJSON(),data:[...this.data]}}}class sr{get signature(){return this.signatures.length>0?this.signatures[0].signature:null}constructor(e){if(this.signatures=[],this.feePayer=void 0,this.instructions=[],this.recentBlockhash=void 0,this.lastValidBlockHeight=void 0,this.nonceInfo=void 0,this.minNonceContextSlot=void 0,this._message=void 0,this._json=void 0,!!e)if(e.feePayer&&(this.feePayer=e.feePayer),e.signatures&&(this.signatures=e.signatures),Object.prototype.hasOwnProperty.call(e,"nonceInfo")){const{minContextSlot:t,nonceInfo:r}=e;this.minNonceContextSlot=t,this.nonceInfo=r}else if(Object.prototype.hasOwnProperty.call(e,"lastValidBlockHeight")){const{blockhash:t,lastValidBlockHeight:r}=e;this.recentBlockhash=t,this.lastValidBlockHeight=r}else{const{recentBlockhash:t,nonceInfo:r}=e;r&&(this.nonceInfo=r),this.recentBlockhash=t}}toJSON(){return{recentBlockhash:this.recentBlockhash||null,feePayer:this.feePayer?this.feePayer.toJSON():null,nonceInfo:this.nonceInfo?{nonce:this.nonceInfo.nonce,nonceInstruction:this.nonceInfo.nonceInstruction.toJSON()}:null,instructions:this.instructions.map(e=>e.toJSON()),signers:this.signatures.map(({publicKey:e})=>e.toJSON())}}add(...e){if(e.length===0)throw new Error("No instructions");return e.forEach(t=>{"instructions"in t?this.instructions=this.instructions.concat(t.instructions):"data"in t&&"programId"in t&&"keys"in t?this.instructions.push(t):this.instructions.push(new _c(t))}),this}compileMessage(){if(this._message&&JSON.stringify(this.toJSON())===JSON.stringify(this._json))return this._message;let e,t;if(this.nonceInfo?(e=this.nonceInfo.nonce,this.instructions[0]!=this.nonceInfo.nonceInstruction?t=[this.nonceInfo.nonceInstruction,...this.instructions]:t=this.instructions):(e=this.recentBlockhash,t=this.instructions),!e)throw new Error("Transaction recentBlockhash required");t.length<1&&console.warn("No instructions provided");let r;if(this.feePayer)r=this.feePayer;else if(this.signatures.length>0&&this.signatures[0].publicKey)r=this.signatures[0].publicKey;else throw new Error("Transaction fee payer required");for(let _=0;_<t.length;_++)if(t[_].programId===void 0)throw new Error(`Transaction instruction index ${_} has undefined program id`);const s=[],i=[];t.forEach(_=>{_.keys.forEach(I=>{i.push({...I})});const v=_.programId.toString();s.includes(v)||s.push(v)}),s.forEach(_=>{i.push({pubkey:new Ne(_),isSigner:!1,isWritable:!1})});const o=[];i.forEach(_=>{const v=_.pubkey.toString(),I=o.findIndex(A=>A.pubkey.toString()===v);I>-1?(o[I].isWritable=o[I].isWritable||_.isWritable,o[I].isSigner=o[I].isSigner||_.isSigner):o.push(_)}),o.sort(function(_,v){if(_.isSigner!==v.isSigner)return _.isSigner?-1:1;if(_.isWritable!==v.isWritable)return _.isWritable?-1:1;const I={localeMatcher:"best fit",usage:"sort",sensitivity:"variant",ignorePunctuation:!1,numeric:!1,caseFirst:"lower"};return _.pubkey.toBase58().localeCompare(v.pubkey.toBase58(),"en",I)});const c=o.findIndex(_=>_.pubkey.equals(r));if(c>-1){const[_]=o.splice(c,1);_.isSigner=!0,_.isWritable=!0,o.unshift(_)}else o.unshift({pubkey:r,isSigner:!0,isWritable:!0});for(const _ of this.signatures){const v=o.findIndex(I=>I.pubkey.equals(_.publicKey));if(v>-1)o[v].isSigner||(o[v].isSigner=!0,console.warn("Transaction references a signature that is unnecessary, only the fee payer and instruction signer accounts should sign a transaction. This behavior is deprecated and will throw an error in the next major version release."));else throw new Error(`unknown signer: ${_.publicKey.toString()}`)}let f=0,l=0,p=0;const x=[],k=[];o.forEach(({pubkey:_,isSigner:v,isWritable:I})=>{v?(x.push(_.toString()),f+=1,I||(l+=1)):(k.push(_.toString()),I||(p+=1))});const E=x.concat(k),b=t.map(_=>{const{data:v,programId:I}=_;return{programIdIndex:E.indexOf(I.toString()),accounts:_.keys.map(A=>E.indexOf(A.pubkey.toString())),data:jt.encode(v)}});return b.forEach(_=>{xt(_.programIdIndex>=0),_.accounts.forEach(v=>xt(v>=0))}),new Wn({header:{numRequiredSignatures:f,numReadonlySignedAccounts:l,numReadonlyUnsignedAccounts:p},accountKeys:E,recentBlockhash:e,instructions:b})}_compile(){const e=this.compileMessage(),t=e.accountKeys.slice(0,e.header.numRequiredSignatures);return this.signatures.length===t.length&&this.signatures.every((s,i)=>t[i].equals(s.publicKey))||(this.signatures=t.map(r=>({signature:null,publicKey:r}))),e}serializeMessage(){return this._compile().serialize()}async getEstimatedFee(e){return(await e.getFeeForMessage(this.compileMessage())).value}setSigners(...e){if(e.length===0)throw new Error("No signers");const t=new Set;this.signatures=e.filter(r=>{const s=r.toString();return t.has(s)?!1:(t.add(s),!0)}).map(r=>({signature:null,publicKey:r}))}sign(...e){if(e.length===0)throw new Error("No signers");const t=new Set,r=[];for(const i of e){const o=i.publicKey.toString();t.has(o)||(t.add(o),r.push(i))}this.signatures=r.map(i=>({signature:null,publicKey:i.publicKey}));const s=this._compile();this._partialSign(s,...r)}partialSign(...e){if(e.length===0)throw new Error("No signers");const t=new Set,r=[];for(const i of e){const o=i.publicKey.toString();t.has(o)||(t.add(o),r.push(i))}const s=this._compile();this._partialSign(s,...r)}_partialSign(e,...t){const r=e.serialize();t.forEach(s=>{const i=mu(r,s.secretKey);this._addSignature(s.publicKey,$r(i))})}addSignature(e,t){this._compile(),this._addSignature(e,t)}_addSignature(e,t){xt(t.length===64);const r=this.signatures.findIndex(s=>e.equals(s.publicKey));if(r<0)throw new Error(`unknown signer: ${e.toString()}`);this.signatures[r].signature=$e.Buffer.from(t)}verifySignatures(e){return this._verifySignatures(this.serializeMessage(),e===void 0?!0:e)}_verifySignatures(e,t){for(const{signature:r,publicKey:s}of this.signatures)if(r===null){if(t)return!1}else if(!n0(r,e,s.toBytes()))return!1;return!0}serialize(e){const{requireAllSignatures:t,verifySignatures:r}=Object.assign({requireAllSignatures:!0,verifySignatures:!0},e),s=this.serializeMessage();if(r&&!this._verifySignatures(s,t))throw new Error("Signature verification failed");return this._serialize(s)}_serialize(e){const{signatures:t}=this,r=[];fn(r,t.length);const s=r.length+t.length*64+e.length,i=$e.Buffer.alloc(s);return xt(t.length<256),$e.Buffer.from(r).copy(i,0),t.forEach(({signature:o},c)=>{o!==null&&(xt(o.length===64,"signature has invalid length"),$e.Buffer.from(o).copy(i,r.length+c*64))}),e.copy(i,r.length+t.length*64),xt(i.length<=Nr,`Transaction too large: ${i.length} > ${Nr}`),i}get keys(){return xt(this.instructions.length===1),this.instructions[0].keys.map(e=>e.pubkey)}get programId(){return xt(this.instructions.length===1),this.instructions[0].programId}get data(){return xt(this.instructions.length===1),this.instructions[0].data}static from(e){let t=[...e];const r=cn(t);let s=[];for(let i=0;i<r;i++){const o=t.slice(0,ss);t=t.slice(ss),s.push(jt.encode($e.Buffer.from(o)))}return sr.populate(Wn.from(t),s)}static populate(e,t=[]){const r=new sr;return r.recentBlockhash=e.recentBlockhash,e.header.numRequiredSignatures>0&&(r.feePayer=e.accountKeys[0]),t.forEach((s,i)=>{const o={signature:s==jt.encode(l0)?null:jt.decode(s),publicKey:e.accountKeys[i]};r.signatures.push(o)}),e.instructions.forEach(s=>{const i=s.accounts.map(o=>{const c=e.accountKeys[o];return{pubkey:c,isSigner:r.signatures.some(f=>f.publicKey.toString()===c.toString())||e.isAccountSigner(o),isWritable:e.isAccountWritable(o)}});r.instructions.push(new _c({keys:i,programId:e.accountKeys[s.programIdIndex],data:jt.decode(s.data)}))}),r._message=e,r._json=r.toJSON(),r}}class Mr{get version(){return this.message.version}constructor(e,t){if(this.signatures=void 0,this.message=void 0,t!==void 0)xt(t.length===e.header.numRequiredSignatures,"Expected signatures length to be equal to the number of required signatures"),this.signatures=t;else{const r=[];for(let s=0;s<e.header.numRequiredSignatures;s++)r.push(new Uint8Array(ss));this.signatures=r}this.message=e}serialize(){const e=this.message.serialize(),t=Array();fn(t,this.signatures.length);const r=ke([bt(t.length,"encodedSignaturesLength"),Vt(o0(),this.signatures.length,"signatures"),bt(e.length,"serializedMessage")]),s=new Uint8Array(2048),i=r.encode({encodedSignaturesLength:new Uint8Array(t),signatures:this.signatures,serializedMessage:e},s);return s.slice(0,i)}static deserialize(e){let t=[...e];const r=[],s=cn(t);for(let o=0;o<s;o++)r.push(new Uint8Array(t.splice(0,ss)));const i=vu.deserialize(new Uint8Array(t));return new Mr(i,r)}sign(e){const t=this.message.serialize(),r=this.message.staticAccountKeys.slice(0,this.message.header.numRequiredSignatures);for(const s of e){const i=r.findIndex(o=>o.equals(s.publicKey));xt(i>=0,`Cannot sign with non signer key ${s.publicKey.toBase58()}`),this.signatures[i]=mu(t,s.secretKey)}}addSignature(e,t){xt(t.byteLength===64,"Signature must be 64 bytes long");const s=this.message.staticAccountKeys.slice(0,this.message.header.numRequiredSignatures).findIndex(i=>i.equals(e));xt(s>=0,`Can not add signature; \`${e.toBase58()}\` is not required to sign this transaction`),this.signatures[s]=t}}const d0=160,h0=64,p0=d0/h0,g0=1e3/p0;new Ne("SysvarC1ock11111111111111111111111111111111");new Ne("SysvarEpochSchedu1e111111111111111111111111");new Ne("Sysvar1nstructions1111111111111111111111111");new Ne("SysvarRecentB1ockHashes11111111111111111111");new Ne("SysvarRent111111111111111111111111111111111");new Ne("SysvarRewards111111111111111111111111111111");new Ne("SysvarS1otHashes111111111111111111111111111");new Ne("SysvarS1otHistory11111111111111111111111111");new Ne("SysvarStakeHistory1111111111111111111111111");function Pr(n){return new Promise(e=>setTimeout(e,n))}const y0=Ft("lamportsPerSignature"),Au=ke([Oe("version"),Oe("state"),nt("authorizedPubkey"),nt("nonce"),ke([y0],"feeCalculator")]);Au.span;class Xo{constructor(e){this.authorizedPubkey=void 0,this.nonce=void 0,this.feeCalculator=void 0,this.authorizedPubkey=e.authorizedPubkey,this.nonce=e.nonce,this.feeCalculator=e.feeCalculator}static fromAccountData(e){const t=Au.decode($r(e),0);return new Xo({authorizedPubkey:new Ne(t.authorizedPubkey),nonce:new Ne(t.nonce).toString(),feeCalculator:t.feeCalculator})}}const b0=n=>{const e=n.decode.bind(n),t=n.encode.bind(n);return{decode:e,encode:t}},w0=n=>e=>{const t=bt(n,e),{encode:r,decode:s}=b0(t),i=t;return i.decode=(o,c)=>{const f=s(o,c);return al($e.Buffer.from(f))},i.encode=(o,c,f)=>{const l=cl(o,n);return r(l,c,f)},i},Fr=w0(8);Object.freeze({Create:{index:0,layout:ke([Oe("instruction"),an("lamports"),an("space"),nt("programId")])},Assign:{index:1,layout:ke([Oe("instruction"),nt("programId")])},Transfer:{index:2,layout:ke([Oe("instruction"),Fr("lamports")])},CreateWithSeed:{index:3,layout:ke([Oe("instruction"),nt("base"),Lr("seed"),an("lamports"),an("space"),nt("programId")])},AdvanceNonceAccount:{index:4,layout:ke([Oe("instruction")])},WithdrawNonceAccount:{index:5,layout:ke([Oe("instruction"),an("lamports")])},InitializeNonceAccount:{index:6,layout:ke([Oe("instruction"),nt("authorized")])},AuthorizeNonceAccount:{index:7,layout:ke([Oe("instruction"),nt("authorized")])},Allocate:{index:8,layout:ke([Oe("instruction"),an("space")])},AllocateWithSeed:{index:9,layout:ke([Oe("instruction"),nt("base"),Lr("seed"),an("space"),nt("programId")])},AssignWithSeed:{index:10,layout:ke([Oe("instruction"),nt("base"),Lr("seed"),nt("programId")])},TransferWithSeed:{index:11,layout:ke([Oe("instruction"),Fr("lamports"),Lr("seed"),nt("programId")])},UpgradeNonceAccount:{index:12,layout:ke([Oe("instruction")])}});new Ne("11111111111111111111111111111111");new Ne("BPFLoader2111111111111111111111111111111111");function m0(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var x0=Object.prototype.toString,_0=Object.keys||function(n){var e=[];for(var t in n)e.push(t);return e};function Jr(n,e){var t,r,s,i,o,c,f;if(n===!0)return"true";if(n===!1)return"false";switch(typeof n){case"object":if(n===null)return null;if(n.toJSON&&typeof n.toJSON=="function")return Jr(n.toJSON(),e);if(f=x0.call(n),f==="[object Array]"){for(s="[",r=n.length-1,t=0;t<r;t++)s+=Jr(n[t],!0)+",";return r>-1&&(s+=Jr(n[t],!0)),s+"]"}else if(f==="[object Object]"){for(i=_0(n).sort(),r=i.length,s="",t=0;t<r;)o=i[t],c=Jr(n[o],!1),c!==void 0&&(s&&(s+=","),s+=JSON.stringify(o)+":"+c),t++;return"{"+s+"}"}else return JSON.stringify(n);case"function":case"undefined":return e?null:void 0;case"string":return JSON.stringify(n);default:return isFinite(n)?n:null}}var S0=function(n){var e=Jr(n,!1);if(e!==void 0)return""+e},Sc=m0(S0);const Vr=32;function ji(n){let e=0;for(;n>1;)n/=2,e++;return e}function E0(n){return n===0?1:(n--,n|=n>>1,n|=n>>2,n|=n>>4,n|=n>>8,n|=n>>16,n|=n>>32,n+1)}class v0{constructor(e,t,r,s,i){this.slotsPerEpoch=void 0,this.leaderScheduleSlotOffset=void 0,this.warmup=void 0,this.firstNormalEpoch=void 0,this.firstNormalSlot=void 0,this.slotsPerEpoch=e,this.leaderScheduleSlotOffset=t,this.warmup=r,this.firstNormalEpoch=s,this.firstNormalSlot=i}getEpoch(e){return this.getEpochAndSlotIndex(e)[0]}getEpochAndSlotIndex(e){if(e<this.firstNormalSlot){const t=ji(E0(e+Vr+1))-ji(Vr)-1,r=this.getSlotsInEpoch(t),s=e-(r-Vr);return[t,s]}else{const t=e-this.firstNormalSlot,r=Math.floor(t/this.slotsPerEpoch),s=this.firstNormalEpoch+r,i=t%this.slotsPerEpoch;return[s,i]}}getFirstSlotInEpoch(e){return e<=this.firstNormalEpoch?(Math.pow(2,e)-1)*Vr:(e-this.firstNormalEpoch)*this.slotsPerEpoch+this.firstNormalSlot}getLastSlotInEpoch(e){return this.getFirstSlotInEpoch(e)+this.getSlotsInEpoch(e)-1}getSlotsInEpoch(e){return e<this.firstNormalEpoch?Math.pow(2,e+ji(Vr)):this.slotsPerEpoch}}class Ec extends Error{constructor(e,t){super(e),this.logs=void 0,this.logs=t}}class Be extends Error{constructor({code:e,message:t,data:r},s){super(s!=null?`${s}: ${t}`:t),this.code=void 0,this.data=void 0,this.code=e,this.data=r,this.name="SolanaJSONRPCError"}}var A0=globalThis.fetch;class R0 extends e0{constructor(e,t,r){const s=i=>{const o=t0(i,{autoconnect:!0,max_reconnects:5,reconnect:!0,reconnect_interval:1e3,...t});return"socket"in o?this.underlyingSocket=o.socket:this.underlyingSocket=o,o};super(s,e,t,r),this.underlyingSocket=void 0}call(...e){var r;const t=(r=this.underlyingSocket)==null?void 0:r.readyState;return t===1?super.call(...e):Promise.reject(new Error("Tried to call a JSON-RPC method `"+e[0]+"` but the socket was not `CONNECTING` or `OPEN` (`readyState` was "+t+")"))}notify(...e){var r;const t=(r=this.underlyingSocket)==null?void 0:r.readyState;return t===1?super.notify(...e):Promise.reject(new Error("Tried to send a JSON-RPC notification `"+e[0]+"` but the socket was not `CONNECTING` or `OPEN` (`readyState` was "+t+")"))}}function I0(n,e){let t;try{t=n.layout.decode(e)}catch(r){throw new Error("invalid instruction; "+r)}if(t.typeIndex!==n.index)throw new Error(`invalid account data; account type mismatch ${t.typeIndex} != ${n.index}`);return t}const vc=56;class Ac{constructor(e){this.key=void 0,this.state=void 0,this.key=e.key,this.state=e.state}isActive(){const e=BigInt("0xffffffffffffffff");return this.state.deactivationSlot===e}static deserialize(e){const t=I0(k0,e),r=e.length-vc;xt(r>=0,"lookup table is invalid"),xt(r%32===0,"lookup table is invalid");const s=r/32,{addresses:i}=ke([Vt(nt(),s,"addresses")]).decode(e.slice(vc));return{deactivationSlot:t.deactivationSlot,lastExtendedSlot:t.lastExtendedSlot,lastExtendedSlotStartIndex:t.lastExtendedStartIndex,authority:t.authority.length!==0?new Ne(t.authority[0]):void 0,addresses:i.map(o=>new Ne(o))}}}const k0={index:1,layout:ke([Oe("typeIndex"),Fr("deactivationSlot"),Ft("lastExtendedSlot"),lt("lastExtendedStartIndex"),lt(),Vt(nt(),mr(lt(),-1),"authority")])},B0=/^[^:]+:\/\/([^:[]+|\[[^\]]+\])(:\d+)?(.*)/i;function T0(n){const e=n.match(B0);if(e==null)throw TypeError(`Failed to validate endpoint URL \`${n}\``);const[t,r,s,i]=e,o=n.startsWith("https:")?"wss:":"ws:",c=s==null?null:parseInt(s.slice(1),10),f=c==null?"":`:${c+1}`;return`${o}//${r}${f}${i}`}const Ct=ps(Ho(Ne),ue(),n=>new Ne(n)),Ru=zo([ue(),St("base64")]),Jo=ps(Ho($e.Buffer),Ru,n=>$e.Buffer.from(n[0],"base64")),C0=30*1e3;function P0(n){if(/^https?:/.test(n)===!1)throw new TypeError("Endpoint URL must start with `http:` or `https:`.");return n}function wt(n){let e,t;if(typeof n=="string")e=n;else if(n){const{commitment:r,...s}=n;e=r,t=s}return{commitment:e,config:t}}function Iu(n){return tn([ee({jsonrpc:St("2.0"),id:ue(),result:n}),ee({jsonrpc:St("2.0"),id:ue(),error:ee({code:hs(),message:ue(),data:Ue(Fg())})})])}const L0=Iu(hs());function Je(n){return ps(Iu(n),L0,e=>"error"in e?e:{...e,result:le(e.result,n)})}function kt(n){return Je(ee({context:ee({slot:N()}),value:n}))}function si(n){return ee({context:ee({slot:N()}),value:n})}function Ki(n,e){return n===0?new is({header:e.header,staticAccountKeys:e.accountKeys.map(t=>new Ne(t)),recentBlockhash:e.recentBlockhash,compiledInstructions:e.instructions.map(t=>({programIdIndex:t.programIdIndex,accountKeyIndexes:t.accounts,data:jt.decode(t.data)})),addressTableLookups:e.addressTableLookups}):new Wn(e)}const O0=ee({foundation:N(),foundationTerm:N(),initial:N(),taper:N(),terminal:N()}),N0=Je(ge(he(ee({epoch:N(),effectiveSlot:N(),amount:N(),postBalance:N(),commission:Ue(he(N()))})))),M0=ge(ee({slot:N(),prioritizationFee:N()})),U0=ee({total:N(),validator:N(),foundation:N(),epoch:N()}),D0=ee({epoch:N(),slotIndex:N(),slotsInEpoch:N(),absoluteSlot:N(),blockHeight:Ue(N()),transactionCount:Ue(N())}),$0=ee({slotsPerEpoch:N(),leaderScheduleSlotOffset:N(),warmup:Tn(),firstNormalEpoch:N(),firstNormalSlot:N()}),F0=du(ue(),ge(N())),Rr=he(tn([ee({}),ue()])),q0=ee({err:Rr}),j0=St("receivedSignature"),K0=ee({"solana-core":ue(),"feature-set":Ue(N())}),Rc=kt(ee({err:he(tn([ee({}),ue()])),logs:he(ge(ue())),accounts:Ue(he(ge(he(ee({executable:Tn(),owner:ue(),lamports:N(),data:ge(ue()),rentEpoch:Ue(N())}))))),unitsConsumed:Ue(N()),returnData:Ue(he(ee({programId:ue(),data:zo([ue(),St("base64")])})))})),W0=kt(ee({byIdentity:du(ue(),ge(N())),range:ee({firstSlot:N(),lastSlot:N()})}));function H0(n,e,t,r,s,i){const o=t||A0;let c;i!=null&&console.warn("You have supplied an `httpAgent` when creating a `Connection` in a browser environment.It has been ignored; `httpAgent` is only used in Node environments.");let f;return r&&(f=async(p,x)=>{const k=await new Promise((E,b)=>{try{r(p,x,(_,v)=>E([_,v]))}catch(_){b(_)}});return await o(...k)}),new Vg(async(p,x)=>{const k={method:"POST",body:p,agent:c,headers:Object.assign({"Content-Type":"application/json"},e||{},zy)};try{let E=5,b,_=500;for(;f?b=await f(n,k):b=await o(n,k),!(b.status!==429||s===!0||(E-=1,E===0));)console.log(`Server responded with ${b.status} ${b.statusText}.  Retrying after ${_}ms delay...`),await Pr(_),_*=2;const v=await b.text();b.ok?x(null,v):x(new Error(`${b.status} ${b.statusText}: ${v}`))}catch(E){E instanceof Error&&x(E)}},{})}function z0(n){return(e,t)=>new Promise((r,s)=>{n.request(e,t,(i,o)=>{if(i){s(i);return}r(o)})})}function G0(n){return e=>new Promise((t,r)=>{e.length===0&&t([]);const s=e.map(i=>n.request(i.methodName,i.args));n.request(s,(i,o)=>{if(i){r(i);return}t(o)})})}const V0=Je(O0),Y0=Je(U0),Z0=Je(M0),X0=Je(D0),J0=Je($0),Q0=Je(F0),ey=Je(N()),ty=kt(ee({total:N(),circulating:N(),nonCirculating:N(),nonCirculatingAccounts:ge(Ct)})),uo=ee({amount:ue(),uiAmount:he(N()),decimals:N(),uiAmountString:Ue(ue())}),ny=kt(ge(ee({address:Ct,amount:ue(),uiAmount:he(N()),decimals:N(),uiAmountString:Ue(ue())}))),ry=kt(ge(ee({pubkey:Ct,account:ee({executable:Tn(),owner:Ct,lamports:N(),data:Jo,rentEpoch:N()})}))),lo=ee({program:ue(),parsed:hs(),space:N()}),sy=kt(ge(ee({pubkey:Ct,account:ee({executable:Tn(),owner:Ct,lamports:N(),data:lo,rentEpoch:N()})}))),iy=kt(ge(ee({lamports:N(),address:Ct}))),os=ee({executable:Tn(),owner:Ct,lamports:N(),data:Jo,rentEpoch:N()}),oy=ee({pubkey:Ct,account:os}),ay=ps(tn([Ho($e.Buffer),lo]),tn([Ru,lo]),n=>Array.isArray(n)?le(n,Jo):n),ho=ee({executable:Tn(),owner:Ct,lamports:N(),data:ay,rentEpoch:N()}),cy=ee({pubkey:Ct,account:ho}),fy=ee({state:tn([St("active"),St("inactive"),St("activating"),St("deactivating")]),active:N(),inactive:N()}),uy=Je(ge(ee({signature:ue(),slot:N(),err:Rr,memo:he(ue()),blockTime:Ue(he(N()))}))),ly=Je(ge(ee({signature:ue(),slot:N(),err:Rr,memo:he(ue()),blockTime:Ue(he(N()))}))),dy=ee({subscription:N(),result:si(os)}),hy=ee({pubkey:Ct,account:os}),py=ee({subscription:N(),result:si(hy)}),gy=ee({parent:N(),slot:N(),root:N()}),yy=ee({subscription:N(),result:gy}),by=tn([ee({type:tn([St("firstShredReceived"),St("completed"),St("optimisticConfirmation"),St("root")]),slot:N(),timestamp:N()}),ee({type:St("createdBank"),parent:N(),slot:N(),timestamp:N()}),ee({type:St("frozen"),slot:N(),timestamp:N(),stats:ee({numTransactionEntries:N(),numSuccessfulTransactions:N(),numFailedTransactions:N(),maxTransactionsPerEntry:N()})}),ee({type:St("dead"),slot:N(),timestamp:N(),err:ue()})]),wy=ee({subscription:N(),result:by}),my=ee({subscription:N(),result:si(tn([q0,j0]))}),xy=ee({subscription:N(),result:N()}),_y=ee({pubkey:ue(),gossip:he(ue()),tpu:he(ue()),rpc:he(ue()),version:he(ue())}),Ic=ee({votePubkey:ue(),nodePubkey:ue(),activatedStake:N(),epochVoteAccount:Tn(),epochCredits:ge(zo([N(),N(),N()])),commission:N(),lastVote:N(),rootSlot:he(N())}),Sy=Je(ee({current:ge(Ic),delinquent:ge(Ic)})),Ey=tn([St("processed"),St("confirmed"),St("finalized")]),vy=ee({slot:N(),confirmations:he(N()),err:Rr,confirmationStatus:Ue(Ey)}),Ay=kt(ge(he(vy))),Ry=Je(N()),ku=ee({accountKey:Ct,writableIndexes:ge(N()),readonlyIndexes:ge(N())}),Qo=ee({signatures:ge(ue()),message:ee({accountKeys:ge(ue()),header:ee({numRequiredSignatures:N(),numReadonlySignedAccounts:N(),numReadonlyUnsignedAccounts:N()}),instructions:ge(ee({accounts:ge(N()),data:ue(),programIdIndex:N()})),recentBlockhash:ue(),addressTableLookups:Ue(ge(ku))})}),Bu=ee({pubkey:Ct,signer:Tn(),writable:Tn(),source:Ue(tn([St("transaction"),St("lookupTable")]))}),Tu=ee({accountKeys:ge(Bu),signatures:ge(ue())}),Cu=ee({parsed:hs(),program:ue(),programId:Ct}),Pu=ee({accounts:ge(Ct),data:ue(),programId:Ct}),Iy=tn([Pu,Cu]),ky=tn([ee({parsed:hs(),program:ue(),programId:ue()}),ee({accounts:ge(ue()),data:ue(),programId:ue()})]),Lu=ps(Iy,ky,n=>"accounts"in n?le(n,Pu):le(n,Cu)),Ou=ee({signatures:ge(ue()),message:ee({accountKeys:ge(Bu),instructions:ge(Lu),recentBlockhash:ue(),addressTableLookups:Ue(he(ge(ku)))})}),$s=ee({accountIndex:N(),mint:ue(),owner:Ue(ue()),uiTokenAmount:uo}),Nu=ee({writable:ge(Ct),readonly:ge(Ct)}),ii=ee({err:Rr,fee:N(),innerInstructions:Ue(he(ge(ee({index:N(),instructions:ge(ee({accounts:ge(N()),data:ue(),programIdIndex:N()}))})))),preBalances:ge(N()),postBalances:ge(N()),logMessages:Ue(he(ge(ue()))),preTokenBalances:Ue(he(ge($s))),postTokenBalances:Ue(he(ge($s))),loadedAddresses:Ue(Nu),computeUnitsConsumed:Ue(N())}),ea=ee({err:Rr,fee:N(),innerInstructions:Ue(he(ge(ee({index:N(),instructions:ge(Lu)})))),preBalances:ge(N()),postBalances:ge(N()),logMessages:Ue(he(ge(ue()))),preTokenBalances:Ue(he(ge($s))),postTokenBalances:Ue(he(ge($s))),loadedAddresses:Ue(Nu),computeUnitsConsumed:Ue(N())}),zr=tn([St(0),St("legacy")]),Ir=ee({pubkey:ue(),lamports:N(),postBalance:he(N()),rewardType:he(ue()),commission:Ue(he(N()))}),By=Je(he(ee({blockhash:ue(),previousBlockhash:ue(),parentSlot:N(),transactions:ge(ee({transaction:Qo,meta:he(ii),version:Ue(zr)})),rewards:Ue(ge(Ir)),blockTime:he(N()),blockHeight:he(N())}))),Ty=Je(he(ee({blockhash:ue(),previousBlockhash:ue(),parentSlot:N(),rewards:Ue(ge(Ir)),blockTime:he(N()),blockHeight:he(N())}))),Cy=Je(he(ee({blockhash:ue(),previousBlockhash:ue(),parentSlot:N(),transactions:ge(ee({transaction:Tu,meta:he(ii),version:Ue(zr)})),rewards:Ue(ge(Ir)),blockTime:he(N()),blockHeight:he(N())}))),Py=Je(he(ee({blockhash:ue(),previousBlockhash:ue(),parentSlot:N(),transactions:ge(ee({transaction:Ou,meta:he(ea),version:Ue(zr)})),rewards:Ue(ge(Ir)),blockTime:he(N()),blockHeight:he(N())}))),Ly=Je(he(ee({blockhash:ue(),previousBlockhash:ue(),parentSlot:N(),transactions:ge(ee({transaction:Tu,meta:he(ea),version:Ue(zr)})),rewards:Ue(ge(Ir)),blockTime:he(N()),blockHeight:he(N())}))),Oy=Je(he(ee({blockhash:ue(),previousBlockhash:ue(),parentSlot:N(),rewards:Ue(ge(Ir)),blockTime:he(N()),blockHeight:he(N())}))),Ny=Je(he(ee({blockhash:ue(),previousBlockhash:ue(),parentSlot:N(),transactions:ge(ee({transaction:Qo,meta:he(ii)})),rewards:Ue(ge(Ir)),blockTime:he(N())}))),kc=Je(he(ee({blockhash:ue(),previousBlockhash:ue(),parentSlot:N(),signatures:ge(ue()),blockTime:he(N())}))),Wi=Je(he(ee({slot:N(),meta:he(ii),blockTime:Ue(he(N())),transaction:Qo,version:Ue(zr)}))),xs=Je(he(ee({slot:N(),transaction:Ou,meta:he(ea),blockTime:Ue(he(N())),version:Ue(zr)}))),My=kt(ee({blockhash:ue(),feeCalculator:ee({lamportsPerSignature:N()})})),Uy=kt(ee({blockhash:ue(),lastValidBlockHeight:N()})),Dy=kt(Tn()),$y=ee({slot:N(),numTransactions:N(),numSlots:N(),samplePeriodSecs:N()}),Fy=Je(ge($y)),qy=kt(he(ee({feeCalculator:ee({lamportsPerSignature:N()})}))),jy=Je(ue()),Ky=Je(ue()),Wy=ee({err:Rr,logs:ge(ue()),signature:ue()}),Hy=ee({result:si(Wy),subscription:N()}),zy={"solana-client":"js/0.0.0-development"};class Mu{constructor(e,t){this._commitment=void 0,this._confirmTransactionInitialTimeout=void 0,this._rpcEndpoint=void 0,this._rpcWsEndpoint=void 0,this._rpcClient=void 0,this._rpcRequest=void 0,this._rpcBatchRequest=void 0,this._rpcWebSocket=void 0,this._rpcWebSocketConnected=!1,this._rpcWebSocketHeartbeat=null,this._rpcWebSocketIdleTimeout=null,this._rpcWebSocketGeneration=0,this._disableBlockhashCaching=!1,this._pollingBlockhash=!1,this._blockhashInfo={latestBlockhash:null,lastFetch:0,transactionSignatures:[],simulatedSignatures:[]},this._nextClientSubscriptionId=0,this._subscriptionDisposeFunctionsByClientSubscriptionId={},this._subscriptionHashByClientSubscriptionId={},this._subscriptionStateChangeCallbacksByHash={},this._subscriptionCallbacksByServerSubscriptionId={},this._subscriptionsByHash={},this._subscriptionsAutoDisposedByRpc=new Set,this.getBlockHeight=(()=>{const l={};return async p=>{const{commitment:x,config:k}=wt(p),E=this._buildArgs([],x,void 0,k),b=Sc(E);return l[b]=l[b]??(async()=>{try{const _=await this._rpcRequest("getBlockHeight",E),v=le(_,Je(N()));if("error"in v)throw new Be(v.error,"failed to get block height information");return v.result}finally{delete l[b]}})(),await l[b]}})();let r,s,i,o,c,f;t&&typeof t=="string"?this._commitment=t:t&&(this._commitment=t.commitment,this._confirmTransactionInitialTimeout=t.confirmTransactionInitialTimeout,r=t.wsEndpoint,s=t.httpHeaders,i=t.fetch,o=t.fetchMiddleware,c=t.disableRetryOnRateLimit,f=t.httpAgent),this._rpcEndpoint=P0(e),this._rpcWsEndpoint=r||T0(e),this._rpcClient=H0(e,s,i,o,c,f),this._rpcRequest=z0(this._rpcClient),this._rpcBatchRequest=G0(this._rpcClient),this._rpcWebSocket=new R0(this._rpcWsEndpoint,{autoconnect:!1,max_reconnects:1/0}),this._rpcWebSocket.on("open",this._wsOnOpen.bind(this)),this._rpcWebSocket.on("error",this._wsOnError.bind(this)),this._rpcWebSocket.on("close",this._wsOnClose.bind(this)),this._rpcWebSocket.on("accountNotification",this._wsOnAccountNotification.bind(this)),this._rpcWebSocket.on("programNotification",this._wsOnProgramAccountNotification.bind(this)),this._rpcWebSocket.on("slotNotification",this._wsOnSlotNotification.bind(this)),this._rpcWebSocket.on("slotsUpdatesNotification",this._wsOnSlotUpdatesNotification.bind(this)),this._rpcWebSocket.on("signatureNotification",this._wsOnSignatureNotification.bind(this)),this._rpcWebSocket.on("rootNotification",this._wsOnRootNotification.bind(this)),this._rpcWebSocket.on("logsNotification",this._wsOnLogsNotification.bind(this))}get commitment(){return this._commitment}get rpcEndpoint(){return this._rpcEndpoint}async getBalanceAndContext(e,t){const{commitment:r,config:s}=wt(t),i=this._buildArgs([e.toBase58()],r,void 0,s),o=await this._rpcRequest("getBalance",i),c=le(o,kt(N()));if("error"in c)throw new Be(c.error,`failed to get balance for ${e.toBase58()}`);return c.result}async getBalance(e,t){return await this.getBalanceAndContext(e,t).then(r=>r.value).catch(r=>{throw new Error("failed to get balance of account "+e.toBase58()+": "+r)})}async getBlockTime(e){const t=await this._rpcRequest("getBlockTime",[e]),r=le(t,Je(he(N())));if("error"in r)throw new Be(r.error,`failed to get block time for slot ${e}`);return r.result}async getMinimumLedgerSlot(){const e=await this._rpcRequest("minimumLedgerSlot",[]),t=le(e,Je(N()));if("error"in t)throw new Be(t.error,"failed to get minimum ledger slot");return t.result}async getFirstAvailableBlock(){const e=await this._rpcRequest("getFirstAvailableBlock",[]),t=le(e,ey);if("error"in t)throw new Be(t.error,"failed to get first available block");return t.result}async getSupply(e){let t={};typeof e=="string"?t={commitment:e}:e?t={...e,commitment:e&&e.commitment||this.commitment}:t={commitment:this.commitment};const r=await this._rpcRequest("getSupply",[t]),s=le(r,ty);if("error"in s)throw new Be(s.error,"failed to get supply");return s.result}async getTokenSupply(e,t){const r=this._buildArgs([e.toBase58()],t),s=await this._rpcRequest("getTokenSupply",r),i=le(s,kt(uo));if("error"in i)throw new Be(i.error,"failed to get token supply");return i.result}async getTokenAccountBalance(e,t){const r=this._buildArgs([e.toBase58()],t),s=await this._rpcRequest("getTokenAccountBalance",r),i=le(s,kt(uo));if("error"in i)throw new Be(i.error,"failed to get token account balance");return i.result}async getTokenAccountsByOwner(e,t,r){const{commitment:s,config:i}=wt(r);let o=[e.toBase58()];"mint"in t?o.push({mint:t.mint.toBase58()}):o.push({programId:t.programId.toBase58()});const c=this._buildArgs(o,s,"base64",i),f=await this._rpcRequest("getTokenAccountsByOwner",c),l=le(f,ry);if("error"in l)throw new Be(l.error,`failed to get token accounts owned by account ${e.toBase58()}`);return l.result}async getParsedTokenAccountsByOwner(e,t,r){let s=[e.toBase58()];"mint"in t?s.push({mint:t.mint.toBase58()}):s.push({programId:t.programId.toBase58()});const i=this._buildArgs(s,r,"jsonParsed"),o=await this._rpcRequest("getTokenAccountsByOwner",i),c=le(o,sy);if("error"in c)throw new Be(c.error,`failed to get token accounts owned by account ${e.toBase58()}`);return c.result}async getLargestAccounts(e){const t={...e,commitment:e&&e.commitment||this.commitment},r=t.filter||t.commitment?[t]:[],s=await this._rpcRequest("getLargestAccounts",r),i=le(s,iy);if("error"in i)throw new Be(i.error,"failed to get largest accounts");return i.result}async getTokenLargestAccounts(e,t){const r=this._buildArgs([e.toBase58()],t),s=await this._rpcRequest("getTokenLargestAccounts",r),i=le(s,ny);if("error"in i)throw new Be(i.error,"failed to get token largest accounts");return i.result}async getAccountInfoAndContext(e,t){const{commitment:r,config:s}=wt(t),i=this._buildArgs([e.toBase58()],r,"base64",s),o=await this._rpcRequest("getAccountInfo",i),c=le(o,kt(he(os)));if("error"in c)throw new Be(c.error,`failed to get info about account ${e.toBase58()}`);return c.result}async getParsedAccountInfo(e,t){const{commitment:r,config:s}=wt(t),i=this._buildArgs([e.toBase58()],r,"jsonParsed",s),o=await this._rpcRequest("getAccountInfo",i),c=le(o,kt(he(ho)));if("error"in c)throw new Be(c.error,`failed to get info about account ${e.toBase58()}`);return c.result}async getAccountInfo(e,t){try{return(await this.getAccountInfoAndContext(e,t)).value}catch(r){throw new Error("failed to get info about account "+e.toBase58()+": "+r)}}async getMultipleParsedAccounts(e,t){const{commitment:r,config:s}=wt(t),i=e.map(l=>l.toBase58()),o=this._buildArgs([i],r,"jsonParsed",s),c=await this._rpcRequest("getMultipleAccounts",o),f=le(c,kt(ge(he(ho))));if("error"in f)throw new Be(f.error,`failed to get info for accounts ${i}`);return f.result}async getMultipleAccountsInfoAndContext(e,t){const{commitment:r,config:s}=wt(t),i=e.map(l=>l.toBase58()),o=this._buildArgs([i],r,"base64",s),c=await this._rpcRequest("getMultipleAccounts",o),f=le(c,kt(ge(he(os))));if("error"in f)throw new Be(f.error,`failed to get info for accounts ${i}`);return f.result}async getMultipleAccountsInfo(e,t){return(await this.getMultipleAccountsInfoAndContext(e,t)).value}async getStakeActivation(e,t,r){const{commitment:s,config:i}=wt(t),o=this._buildArgs([e.toBase58()],s,void 0,{...i,epoch:r??(i==null?void 0:i.epoch)}),c=await this._rpcRequest("getStakeActivation",o),f=le(c,Je(fy));if("error"in f)throw new Be(f.error,`failed to get Stake Activation ${e.toBase58()}`);return f.result}async getProgramAccounts(e,t){const{commitment:r,config:s}=wt(t),{encoding:i,...o}=s||{},c=this._buildArgs([e.toBase58()],r,i||"base64",o),f=await this._rpcRequest("getProgramAccounts",c),l=ge(oy),p=o.withContext===!0?le(f,kt(l)):le(f,Je(l));if("error"in p)throw new Be(p.error,`failed to get accounts owned by program ${e.toBase58()}`);return p.result}async getParsedProgramAccounts(e,t){const{commitment:r,config:s}=wt(t),i=this._buildArgs([e.toBase58()],r,"jsonParsed",s),o=await this._rpcRequest("getProgramAccounts",i),c=le(o,Je(ge(cy)));if("error"in c)throw new Be(c.error,`failed to get accounts owned by program ${e.toBase58()}`);return c.result}async confirmTransaction(e,t){var i;let r;if(typeof e=="string")r=e;else{const o=e;if((i=o.abortSignal)!=null&&i.aborted)return Promise.reject(o.abortSignal.reason);r=o.signature}let s;try{s=jt.decode(r)}catch{throw new Error("signature must be base58 encoded: "+r)}return xt(s.length===64,"signature has invalid length"),typeof e=="string"?await this.confirmTransactionUsingLegacyTimeoutStrategy({commitment:t||this.commitment,signature:r}):"lastValidBlockHeight"in e?await this.confirmTransactionUsingBlockHeightExceedanceStrategy({commitment:t||this.commitment,strategy:e}):await this.confirmTransactionUsingDurableNonceStrategy({commitment:t||this.commitment,strategy:e})}getCancellationPromise(e){return new Promise((t,r)=>{e!=null&&(e.aborted?r(e.reason):e.addEventListener("abort",()=>{r(e.reason)}))})}getTransactionConfirmationPromise({commitment:e,signature:t}){let r,s,i=!1;const o=new Promise((f,l)=>{try{r=this.onSignature(t,(x,k)=>{r=void 0;const E={context:k,value:x};f({__type:nr.PROCESSED,response:E})},e);const p=new Promise(x=>{r==null?x():s=this._onSubscriptionStateChange(r,k=>{k==="subscribed"&&x()})});(async()=>{if(await p,i)return;const x=await this.getSignatureStatus(t);if(i||x==null)return;const{context:k,value:E}=x;if(E!=null)if(E!=null&&E.err)l(E.err);else{switch(e){case"confirmed":case"single":case"singleGossip":{if(E.confirmationStatus==="processed")return;break}case"finalized":case"max":case"root":{if(E.confirmationStatus==="processed"||E.confirmationStatus==="confirmed")return;break}case"processed":case"recent":}i=!0,f({__type:nr.PROCESSED,response:{context:k,value:E}})}})()}catch(p){l(p)}});return{abortConfirmation:()=>{s&&(s(),s=void 0),r!=null&&(this.removeSignatureListener(r),r=void 0)},confirmationPromise:o}}async confirmTransactionUsingBlockHeightExceedanceStrategy({commitment:e,strategy:{abortSignal:t,lastValidBlockHeight:r,signature:s}}){let i=!1;const o=new Promise(x=>{const k=async()=>{try{return await this.getBlockHeight(e)}catch{return-1}};(async()=>{let E=await k();if(!i){for(;E<=r;)if(await Pr(1e3),i||(E=await k(),i))return;x({__type:nr.BLOCKHEIGHT_EXCEEDED})}})()}),{abortConfirmation:c,confirmationPromise:f}=this.getTransactionConfirmationPromise({commitment:e,signature:s}),l=this.getCancellationPromise(t);let p;try{const x=await Promise.race([l,f,o]);if(x.__type===nr.PROCESSED)p=x.response;else throw new Su(s)}finally{i=!0,c()}return p}async confirmTransactionUsingDurableNonceStrategy({commitment:e,strategy:{abortSignal:t,minContextSlot:r,nonceAccountPubkey:s,nonceValue:i,signature:o}}){let c=!1;const f=new Promise(E=>{let b=i,_=null;const v=async()=>{try{const{context:I,value:A}=await this.getNonceAndContext(s,{commitment:e,minContextSlot:r});return _=I.slot,A==null?void 0:A.nonce}catch{return b}};(async()=>{if(b=await v(),!c)for(;;){if(i!==b){E({__type:nr.NONCE_INVALID,slotInWhichNonceDidAdvance:_});return}if(await Pr(2e3),c||(b=await v(),c))return}})()}),{abortConfirmation:l,confirmationPromise:p}=this.getTransactionConfirmationPromise({commitment:e,signature:o}),x=this.getCancellationPromise(t);let k;try{const E=await Promise.race([x,p,f]);if(E.__type===nr.PROCESSED)k=E.response;else{let b;for(;;){const _=await this.getSignatureStatus(o);if(_==null)break;if(_.context.slot<(E.slotInWhichNonceDidAdvance??r)){await Pr(400);continue}b=_;break}if(b!=null&&b.value){const _=e||"finalized",{confirmationStatus:v}=b.value;switch(_){case"processed":case"recent":if(v!=="processed"&&v!=="confirmed"&&v!=="finalized")throw new Xr(o);break;case"confirmed":case"single":case"singleGossip":if(v!=="confirmed"&&v!=="finalized")throw new Xr(o);break;case"finalized":case"max":case"root":if(v!=="finalized")throw new Xr(o);break;default:}k={context:b.context,value:{err:b.value.err}}}else throw new Xr(o)}}finally{c=!0,l()}return k}async confirmTransactionUsingLegacyTimeoutStrategy({commitment:e,signature:t}){let r;const s=new Promise(f=>{let l=this._confirmTransactionInitialTimeout||6e4;switch(e){case"processed":case"recent":case"single":case"confirmed":case"singleGossip":{l=this._confirmTransactionInitialTimeout||3e4;break}}r=setTimeout(()=>f({__type:nr.TIMED_OUT,timeoutMs:l}),l)}),{abortConfirmation:i,confirmationPromise:o}=this.getTransactionConfirmationPromise({commitment:e,signature:t});let c;try{const f=await Promise.race([o,s]);if(f.__type===nr.PROCESSED)c=f.response;else throw new Eu(t,f.timeoutMs/1e3)}finally{clearTimeout(r),i()}return c}async getClusterNodes(){const e=await this._rpcRequest("getClusterNodes",[]),t=le(e,Je(ge(_y)));if("error"in t)throw new Be(t.error,"failed to get cluster nodes");return t.result}async getVoteAccounts(e){const t=this._buildArgs([],e),r=await this._rpcRequest("getVoteAccounts",t),s=le(r,Sy);if("error"in s)throw new Be(s.error,"failed to get vote accounts");return s.result}async getSlot(e){const{commitment:t,config:r}=wt(e),s=this._buildArgs([],t,void 0,r),i=await this._rpcRequest("getSlot",s),o=le(i,Je(N()));if("error"in o)throw new Be(o.error,"failed to get slot");return o.result}async getSlotLeader(e){const{commitment:t,config:r}=wt(e),s=this._buildArgs([],t,void 0,r),i=await this._rpcRequest("getSlotLeader",s),o=le(i,Je(ue()));if("error"in o)throw new Be(o.error,"failed to get slot leader");return o.result}async getSlotLeaders(e,t){const r=[e,t],s=await this._rpcRequest("getSlotLeaders",r),i=le(s,Je(ge(Ct)));if("error"in i)throw new Be(i.error,"failed to get slot leaders");return i.result}async getSignatureStatus(e,t){const{context:r,value:s}=await this.getSignatureStatuses([e],t);xt(s.length===1);const i=s[0];return{context:r,value:i}}async getSignatureStatuses(e,t){const r=[e];t&&r.push(t);const s=await this._rpcRequest("getSignatureStatuses",r),i=le(s,Ay);if("error"in i)throw new Be(i.error,"failed to get signature status");return i.result}async getTransactionCount(e){const{commitment:t,config:r}=wt(e),s=this._buildArgs([],t,void 0,r),i=await this._rpcRequest("getTransactionCount",s),o=le(i,Je(N()));if("error"in o)throw new Be(o.error,"failed to get transaction count");return o.result}async getTotalSupply(e){return(await this.getSupply({commitment:e,excludeNonCirculatingAccountsList:!0})).value.total}async getInflationGovernor(e){const t=this._buildArgs([],e),r=await this._rpcRequest("getInflationGovernor",t),s=le(r,V0);if("error"in s)throw new Be(s.error,"failed to get inflation");return s.result}async getInflationReward(e,t,r){const{commitment:s,config:i}=wt(r),o=this._buildArgs([e.map(l=>l.toBase58())],s,void 0,{...i,epoch:t??(i==null?void 0:i.epoch)}),c=await this._rpcRequest("getInflationReward",o),f=le(c,N0);if("error"in f)throw new Be(f.error,"failed to get inflation reward");return f.result}async getInflationRate(){const e=await this._rpcRequest("getInflationRate",[]),t=le(e,Y0);if("error"in t)throw new Be(t.error,"failed to get inflation rate");return t.result}async getEpochInfo(e){const{commitment:t,config:r}=wt(e),s=this._buildArgs([],t,void 0,r),i=await this._rpcRequest("getEpochInfo",s),o=le(i,X0);if("error"in o)throw new Be(o.error,"failed to get epoch info");return o.result}async getEpochSchedule(){const e=await this._rpcRequest("getEpochSchedule",[]),t=le(e,J0);if("error"in t)throw new Be(t.error,"failed to get epoch schedule");const r=t.result;return new v0(r.slotsPerEpoch,r.leaderScheduleSlotOffset,r.warmup,r.firstNormalEpoch,r.firstNormalSlot)}async getLeaderSchedule(){const e=await this._rpcRequest("getLeaderSchedule",[]),t=le(e,Q0);if("error"in t)throw new Be(t.error,"failed to get leader schedule");return t.result}async getMinimumBalanceForRentExemption(e,t){const r=this._buildArgs([e],t),s=await this._rpcRequest("getMinimumBalanceForRentExemption",r),i=le(s,Ry);return"error"in i?(console.warn("Unable to fetch minimum balance for rent exemption"),0):i.result}async getRecentBlockhashAndContext(e){const t=this._buildArgs([],e),r=await this._rpcRequest("getRecentBlockhash",t),s=le(r,My);if("error"in s)throw new Be(s.error,"failed to get recent blockhash");return s.result}async getRecentPerformanceSamples(e){const t=await this._rpcRequest("getRecentPerformanceSamples",e?[e]:[]),r=le(t,Fy);if("error"in r)throw new Be(r.error,"failed to get recent performance samples");return r.result}async getFeeCalculatorForBlockhash(e,t){const r=this._buildArgs([e],t),s=await this._rpcRequest("getFeeCalculatorForBlockhash",r),i=le(s,qy);if("error"in i)throw new Be(i.error,"failed to get fee calculator");const{context:o,value:c}=i.result;return{context:o,value:c!==null?c.feeCalculator:null}}async getFeeForMessage(e,t){const r=$r(e.serialize()).toString("base64"),s=this._buildArgs([r],t),i=await this._rpcRequest("getFeeForMessage",s),o=le(i,kt(he(N())));if("error"in o)throw new Be(o.error,"failed to get fee for message");if(o.result===null)throw new Error("invalid blockhash");return o.result}async getRecentPrioritizationFees(e){var o;const t=(o=e==null?void 0:e.lockedWritableAccounts)==null?void 0:o.map(c=>c.toBase58()),r=t!=null&&t.length?[t]:[],s=await this._rpcRequest("getRecentPrioritizationFees",r),i=le(s,Z0);if("error"in i)throw new Be(i.error,"failed to get recent prioritization fees");return i.result}async getRecentBlockhash(e){try{return(await this.getRecentBlockhashAndContext(e)).value}catch(t){throw new Error("failed to get recent blockhash: "+t)}}async getLatestBlockhash(e){try{return(await this.getLatestBlockhashAndContext(e)).value}catch(t){throw new Error("failed to get recent blockhash: "+t)}}async getLatestBlockhashAndContext(e){const{commitment:t,config:r}=wt(e),s=this._buildArgs([],t,void 0,r),i=await this._rpcRequest("getLatestBlockhash",s),o=le(i,Uy);if("error"in o)throw new Be(o.error,"failed to get latest blockhash");return o.result}async isBlockhashValid(e,t){const{commitment:r,config:s}=wt(t),i=this._buildArgs([e],r,void 0,s),o=await this._rpcRequest("isBlockhashValid",i),c=le(o,Dy);if("error"in c)throw new Be(c.error,"failed to determine if the blockhash `"+e+"`is valid");return c.result}async getVersion(){const e=await this._rpcRequest("getVersion",[]),t=le(e,Je(K0));if("error"in t)throw new Be(t.error,"failed to get version");return t.result}async getGenesisHash(){const e=await this._rpcRequest("getGenesisHash",[]),t=le(e,Je(ue()));if("error"in t)throw new Be(t.error,"failed to get genesis hash");return t.result}async getBlock(e,t){const{commitment:r,config:s}=wt(t),i=this._buildArgsAtLeastConfirmed([e],r,void 0,s),o=await this._rpcRequest("getBlock",i);try{switch(s==null?void 0:s.transactionDetails){case"accounts":{const c=le(o,Cy);if("error"in c)throw c.error;return c.result}case"none":{const c=le(o,Ty);if("error"in c)throw c.error;return c.result}default:{const c=le(o,By);if("error"in c)throw c.error;const{result:f}=c;return f?{...f,transactions:f.transactions.map(({transaction:l,meta:p,version:x})=>({meta:p,transaction:{...l,message:Ki(x,l.message)},version:x}))}:null}}}catch(c){throw new Be(c,"failed to get confirmed block")}}async getParsedBlock(e,t){const{commitment:r,config:s}=wt(t),i=this._buildArgsAtLeastConfirmed([e],r,"jsonParsed",s),o=await this._rpcRequest("getBlock",i);try{switch(s==null?void 0:s.transactionDetails){case"accounts":{const c=le(o,Ly);if("error"in c)throw c.error;return c.result}case"none":{const c=le(o,Oy);if("error"in c)throw c.error;return c.result}default:{const c=le(o,Py);if("error"in c)throw c.error;return c.result}}}catch(c){throw new Be(c,"failed to get block")}}async getBlockProduction(e){let t,r;if(typeof e=="string")r=e;else if(e){const{commitment:c,...f}=e;r=c,t=f}const s=this._buildArgs([],r,"base64",t),i=await this._rpcRequest("getBlockProduction",s),o=le(i,W0);if("error"in o)throw new Be(o.error,"failed to get block production information");return o.result}async getTransaction(e,t){const{commitment:r,config:s}=wt(t),i=this._buildArgsAtLeastConfirmed([e],r,void 0,s),o=await this._rpcRequest("getTransaction",i),c=le(o,Wi);if("error"in c)throw new Be(c.error,"failed to get transaction");const f=c.result;return f&&{...f,transaction:{...f.transaction,message:Ki(f.version,f.transaction.message)}}}async getParsedTransaction(e,t){const{commitment:r,config:s}=wt(t),i=this._buildArgsAtLeastConfirmed([e],r,"jsonParsed",s),o=await this._rpcRequest("getTransaction",i),c=le(o,xs);if("error"in c)throw new Be(c.error,"failed to get transaction");return c.result}async getParsedTransactions(e,t){const{commitment:r,config:s}=wt(t),i=e.map(f=>({methodName:"getTransaction",args:this._buildArgsAtLeastConfirmed([f],r,"jsonParsed",s)}));return(await this._rpcBatchRequest(i)).map(f=>{const l=le(f,xs);if("error"in l)throw new Be(l.error,"failed to get transactions");return l.result})}async getTransactions(e,t){const{commitment:r,config:s}=wt(t),i=e.map(f=>({methodName:"getTransaction",args:this._buildArgsAtLeastConfirmed([f],r,void 0,s)}));return(await this._rpcBatchRequest(i)).map(f=>{const l=le(f,Wi);if("error"in l)throw new Be(l.error,"failed to get transactions");const p=l.result;return p&&{...p,transaction:{...p.transaction,message:Ki(p.version,p.transaction.message)}}})}async getConfirmedBlock(e,t){const r=this._buildArgsAtLeastConfirmed([e],t),s=await this._rpcRequest("getConfirmedBlock",r),i=le(s,Ny);if("error"in i)throw new Be(i.error,"failed to get confirmed block");const o=i.result;if(!o)throw new Error("Confirmed block "+e+" not found");const c={...o,transactions:o.transactions.map(({transaction:f,meta:l})=>{const p=new Wn(f.message);return{meta:l,transaction:{...f,message:p}}})};return{...c,transactions:c.transactions.map(({transaction:f,meta:l})=>({meta:l,transaction:sr.populate(f.message,f.signatures)}))}}async getBlocks(e,t,r){const s=this._buildArgsAtLeastConfirmed(t!==void 0?[e,t]:[e],r),i=await this._rpcRequest("getBlocks",s),o=le(i,Je(ge(N())));if("error"in o)throw new Be(o.error,"failed to get blocks");return o.result}async getBlockSignatures(e,t){const r=this._buildArgsAtLeastConfirmed([e],t,void 0,{transactionDetails:"signatures",rewards:!1}),s=await this._rpcRequest("getBlock",r),i=le(s,kc);if("error"in i)throw new Be(i.error,"failed to get block");const o=i.result;if(!o)throw new Error("Block "+e+" not found");return o}async getConfirmedBlockSignatures(e,t){const r=this._buildArgsAtLeastConfirmed([e],t,void 0,{transactionDetails:"signatures",rewards:!1}),s=await this._rpcRequest("getConfirmedBlock",r),i=le(s,kc);if("error"in i)throw new Be(i.error,"failed to get confirmed block");const o=i.result;if(!o)throw new Error("Confirmed block "+e+" not found");return o}async getConfirmedTransaction(e,t){const r=this._buildArgsAtLeastConfirmed([e],t),s=await this._rpcRequest("getConfirmedTransaction",r),i=le(s,Wi);if("error"in i)throw new Be(i.error,"failed to get transaction");const o=i.result;if(!o)return o;const c=new Wn(o.transaction.message),f=o.transaction.signatures;return{...o,transaction:sr.populate(c,f)}}async getParsedConfirmedTransaction(e,t){const r=this._buildArgsAtLeastConfirmed([e],t,"jsonParsed"),s=await this._rpcRequest("getConfirmedTransaction",r),i=le(s,xs);if("error"in i)throw new Be(i.error,"failed to get confirmed transaction");return i.result}async getParsedConfirmedTransactions(e,t){const r=e.map(o=>({methodName:"getConfirmedTransaction",args:this._buildArgsAtLeastConfirmed([o],t,"jsonParsed")}));return(await this._rpcBatchRequest(r)).map(o=>{const c=le(o,xs);if("error"in c)throw new Be(c.error,"failed to get confirmed transactions");return c.result})}async getConfirmedSignaturesForAddress(e,t,r){let s={},i=await this.getFirstAvailableBlock();for(;!("until"in s)&&(t--,!(t<=0||t<i));)try{const f=await this.getConfirmedBlockSignatures(t,"finalized");f.signatures.length>0&&(s.until=f.signatures[f.signatures.length-1].toString())}catch(f){if(f instanceof Error&&f.message.includes("skipped"))continue;throw f}let o=await this.getSlot("finalized");for(;!("before"in s)&&(r++,!(r>o));)try{const f=await this.getConfirmedBlockSignatures(r);f.signatures.length>0&&(s.before=f.signatures[f.signatures.length-1].toString())}catch(f){if(f instanceof Error&&f.message.includes("skipped"))continue;throw f}return(await this.getConfirmedSignaturesForAddress2(e,s)).map(f=>f.signature)}async getConfirmedSignaturesForAddress2(e,t,r){const s=this._buildArgsAtLeastConfirmed([e.toBase58()],r,void 0,t),i=await this._rpcRequest("getConfirmedSignaturesForAddress2",s),o=le(i,uy);if("error"in o)throw new Be(o.error,"failed to get confirmed signatures for address");return o.result}async getSignaturesForAddress(e,t,r){const s=this._buildArgsAtLeastConfirmed([e.toBase58()],r,void 0,t),i=await this._rpcRequest("getSignaturesForAddress",s),o=le(i,ly);if("error"in o)throw new Be(o.error,"failed to get signatures for address");return o.result}async getAddressLookupTable(e,t){const{context:r,value:s}=await this.getAccountInfoAndContext(e,t);let i=null;return s!==null&&(i=new Ac({key:e,state:Ac.deserialize(s.data)})),{context:r,value:i}}async getNonceAndContext(e,t){const{context:r,value:s}=await this.getAccountInfoAndContext(e,t);let i=null;return s!==null&&(i=Xo.fromAccountData(s.data)),{context:r,value:i}}async getNonce(e,t){return await this.getNonceAndContext(e,t).then(r=>r.value).catch(r=>{throw new Error("failed to get nonce for account "+e.toBase58()+": "+r)})}async requestAirdrop(e,t){const r=await this._rpcRequest("requestAirdrop",[e.toBase58(),t]),s=le(r,jy);if("error"in s)throw new Be(s.error,`airdrop to ${e.toBase58()} failed`);return s.result}async _blockhashWithExpiryBlockHeight(e){if(!e){for(;this._pollingBlockhash;)await Pr(100);const r=Date.now()-this._blockhashInfo.lastFetch>=C0;if(this._blockhashInfo.latestBlockhash!==null&&!r)return this._blockhashInfo.latestBlockhash}return await this._pollNewBlockhash()}async _pollNewBlockhash(){this._pollingBlockhash=!0;try{const e=Date.now(),t=this._blockhashInfo.latestBlockhash,r=t?t.blockhash:null;for(let s=0;s<50;s++){const i=await this.getLatestBlockhash("finalized");if(r!==i.blockhash)return this._blockhashInfo={latestBlockhash:i,lastFetch:Date.now(),transactionSignatures:[],simulatedSignatures:[]},i;await Pr(g0/2)}throw new Error(`Unable to obtain a new blockhash after ${Date.now()-e}ms`)}finally{this._pollingBlockhash=!1}}async getStakeMinimumDelegation(e){const{commitment:t,config:r}=wt(e),s=this._buildArgs([],t,"base64",r),i=await this._rpcRequest("getStakeMinimumDelegation",s),o=le(i,kt(N()));if("error"in o)throw new Be(o.error,"failed to get stake minimum delegation");return o.result}async simulateTransaction(e,t,r){if("message"in e){const _=e.serialize(),v=$e.Buffer.from(_).toString("base64");if(Array.isArray(t)||r!==void 0)throw new Error("Invalid arguments");const I=t||{};I.encoding="base64","commitment"in I||(I.commitment=this.commitment);const A=[v,I],T=await this._rpcRequest("simulateTransaction",A),$=le(T,Rc);if("error"in $)throw new Error("failed to simulate transaction: "+$.error.message);return $.result}let s;if(e instanceof sr){let b=e;s=new sr,s.feePayer=b.feePayer,s.instructions=e.instructions,s.nonceInfo=b.nonceInfo,s.signatures=b.signatures}else s=sr.populate(e),s._message=s._json=void 0;if(t!==void 0&&!Array.isArray(t))throw new Error("Invalid arguments");const i=t;if(s.nonceInfo&&i)s.sign(...i);else{let b=this._disableBlockhashCaching;for(;;){const _=await this._blockhashWithExpiryBlockHeight(b);if(s.lastValidBlockHeight=_.lastValidBlockHeight,s.recentBlockhash=_.blockhash,!i)break;if(s.sign(...i),!s.signature)throw new Error("!signature");const v=s.signature.toString("base64");if(!this._blockhashInfo.simulatedSignatures.includes(v)&&!this._blockhashInfo.transactionSignatures.includes(v)){this._blockhashInfo.simulatedSignatures.push(v);break}else b=!0}}const o=s._compile(),c=o.serialize(),l=s._serialize(c).toString("base64"),p={encoding:"base64",commitment:this.commitment};if(r){const b=(Array.isArray(r)?r:o.nonProgramIds()).map(_=>_.toBase58());p.accounts={encoding:"base64",addresses:b}}i&&(p.sigVerify=!0);const x=[l,p],k=await this._rpcRequest("simulateTransaction",x),E=le(k,Rc);if("error"in E){let b;if("data"in E.error&&(b=E.error.data.logs,b&&Array.isArray(b))){const _=`
    `,v=_+b.join(_);console.error(E.error.message,v)}throw new Ec("failed to simulate transaction: "+E.error.message,b)}return E.result}async sendTransaction(e,t,r){if("version"in e){if(t&&Array.isArray(t))throw new Error("Invalid arguments");const o=e.serialize();return await this.sendRawTransaction(o,t)}if(t===void 0||!Array.isArray(t))throw new Error("Invalid arguments");const s=t;if(e.nonceInfo)e.sign(...s);else{let o=this._disableBlockhashCaching;for(;;){const c=await this._blockhashWithExpiryBlockHeight(o);if(e.lastValidBlockHeight=c.lastValidBlockHeight,e.recentBlockhash=c.blockhash,e.sign(...s),!e.signature)throw new Error("!signature");const f=e.signature.toString("base64");if(this._blockhashInfo.transactionSignatures.includes(f))o=!0;else{this._blockhashInfo.transactionSignatures.push(f);break}}}const i=e.serialize();return await this.sendRawTransaction(i,r)}async sendRawTransaction(e,t){const r=$r(e).toString("base64");return await this.sendEncodedTransaction(r,t)}async sendEncodedTransaction(e,t){const r={encoding:"base64"},s=t&&t.skipPreflight,i=t&&t.preflightCommitment||this.commitment;t&&t.maxRetries!=null&&(r.maxRetries=t.maxRetries),t&&t.minContextSlot!=null&&(r.minContextSlot=t.minContextSlot),s&&(r.skipPreflight=s),i&&(r.preflightCommitment=i);const o=[e,r],c=await this._rpcRequest("sendTransaction",o),f=le(c,Ky);if("error"in f){let l;throw"data"in f.error&&(l=f.error.data.logs),new Ec("failed to send transaction: "+f.error.message,l)}return f.result}_wsOnOpen(){this._rpcWebSocketConnected=!0,this._rpcWebSocketHeartbeat=setInterval(()=>{(async()=>{try{await this._rpcWebSocket.notify("ping")}catch{}})()},5e3),this._updateSubscriptions()}_wsOnError(e){this._rpcWebSocketConnected=!1,console.error("ws error:",e.message)}_wsOnClose(e){if(this._rpcWebSocketConnected=!1,this._rpcWebSocketGeneration=(this._rpcWebSocketGeneration+1)%Number.MAX_SAFE_INTEGER,this._rpcWebSocketIdleTimeout&&(clearTimeout(this._rpcWebSocketIdleTimeout),this._rpcWebSocketIdleTimeout=null),this._rpcWebSocketHeartbeat&&(clearInterval(this._rpcWebSocketHeartbeat),this._rpcWebSocketHeartbeat=null),e===1e3){this._updateSubscriptions();return}this._subscriptionCallbacksByServerSubscriptionId={},Object.entries(this._subscriptionsByHash).forEach(([t,r])=>{this._setSubscription(t,{...r,state:"pending"})})}_setSubscription(e,t){var s;const r=(s=this._subscriptionsByHash[e])==null?void 0:s.state;if(this._subscriptionsByHash[e]=t,r!==t.state){const i=this._subscriptionStateChangeCallbacksByHash[e];i&&i.forEach(o=>{try{o(t.state)}catch{}})}}_onSubscriptionStateChange(e,t){var i;const r=this._subscriptionHashByClientSubscriptionId[e];if(r==null)return()=>{};const s=(i=this._subscriptionStateChangeCallbacksByHash)[r]||(i[r]=new Set);return s.add(t),()=>{s.delete(t),s.size===0&&delete this._subscriptionStateChangeCallbacksByHash[r]}}async _updateSubscriptions(){if(Object.keys(this._subscriptionsByHash).length===0){this._rpcWebSocketConnected&&(this._rpcWebSocketConnected=!1,this._rpcWebSocketIdleTimeout=setTimeout(()=>{this._rpcWebSocketIdleTimeout=null;try{this._rpcWebSocket.close()}catch(r){r instanceof Error&&console.log(`Error when closing socket connection: ${r.message}`)}},500));return}if(this._rpcWebSocketIdleTimeout!==null&&(clearTimeout(this._rpcWebSocketIdleTimeout),this._rpcWebSocketIdleTimeout=null,this._rpcWebSocketConnected=!0),!this._rpcWebSocketConnected){this._rpcWebSocket.connect();return}const e=this._rpcWebSocketGeneration,t=()=>e===this._rpcWebSocketGeneration;await Promise.all(Object.keys(this._subscriptionsByHash).map(async r=>{const s=this._subscriptionsByHash[r];if(s!==void 0)switch(s.state){case"pending":case"unsubscribed":if(s.callbacks.size===0){delete this._subscriptionsByHash[r],s.state==="unsubscribed"&&delete this._subscriptionCallbacksByServerSubscriptionId[s.serverSubscriptionId],await this._updateSubscriptions();return}await(async()=>{const{args:i,method:o}=s;try{this._setSubscription(r,{...s,state:"subscribing"});const c=await this._rpcWebSocket.call(o,i);this._setSubscription(r,{...s,serverSubscriptionId:c,state:"subscribed"}),this._subscriptionCallbacksByServerSubscriptionId[c]=s.callbacks,await this._updateSubscriptions()}catch(c){if(c instanceof Error&&console.error(`${o} error for argument`,i,c.message),!t())return;this._setSubscription(r,{...s,state:"pending"}),await this._updateSubscriptions()}})();break;case"subscribed":s.callbacks.size===0&&await(async()=>{const{serverSubscriptionId:i,unsubscribeMethod:o}=s;if(this._subscriptionsAutoDisposedByRpc.has(i))this._subscriptionsAutoDisposedByRpc.delete(i);else{this._setSubscription(r,{...s,state:"unsubscribing"}),this._setSubscription(r,{...s,state:"unsubscribing"});try{await this._rpcWebSocket.call(o,[i])}catch(c){if(c instanceof Error&&console.error(`${o} error:`,c.message),!t())return;this._setSubscription(r,{...s,state:"subscribed"}),await this._updateSubscriptions();return}}this._setSubscription(r,{...s,state:"unsubscribed"}),await this._updateSubscriptions()})();break}}))}_handleServerNotification(e,t){const r=this._subscriptionCallbacksByServerSubscriptionId[e];r!==void 0&&r.forEach(s=>{try{s(...t)}catch(i){console.error(i)}})}_wsOnAccountNotification(e){const{result:t,subscription:r}=le(e,dy);this._handleServerNotification(r,[t.value,t.context])}_makeSubscription(e,t){const r=this._nextClientSubscriptionId++,s=Sc([e.method,t],!0),i=this._subscriptionsByHash[s];return i===void 0?this._subscriptionsByHash[s]={...e,args:t,callbacks:new Set([e.callback]),state:"pending"}:i.callbacks.add(e.callback),this._subscriptionHashByClientSubscriptionId[r]=s,this._subscriptionDisposeFunctionsByClientSubscriptionId[r]=async()=>{delete this._subscriptionDisposeFunctionsByClientSubscriptionId[r],delete this._subscriptionHashByClientSubscriptionId[r];const o=this._subscriptionsByHash[s];xt(o!==void 0,`Could not find a \`Subscription\` when tearing down client subscription #${r}`),o.callbacks.delete(e.callback),await this._updateSubscriptions()},this._updateSubscriptions(),r}onAccountChange(e,t,r){const s=this._buildArgs([e.toBase58()],r||this._commitment||"finalized","base64");return this._makeSubscription({callback:t,method:"accountSubscribe",unsubscribeMethod:"accountUnsubscribe"},s)}async removeAccountChangeListener(e){await this._unsubscribeClientSubscription(e,"account change")}_wsOnProgramAccountNotification(e){const{result:t,subscription:r}=le(e,py);this._handleServerNotification(r,[{accountId:t.value.pubkey,accountInfo:t.value.account},t.context])}onProgramAccountChange(e,t,r,s){const i=this._buildArgs([e.toBase58()],r||this._commitment||"finalized","base64",s?{filters:s}:void 0);return this._makeSubscription({callback:t,method:"programSubscribe",unsubscribeMethod:"programUnsubscribe"},i)}async removeProgramAccountChangeListener(e){await this._unsubscribeClientSubscription(e,"program account change")}onLogs(e,t,r){const s=this._buildArgs([typeof e=="object"?{mentions:[e.toString()]}:e],r||this._commitment||"finalized");return this._makeSubscription({callback:t,method:"logsSubscribe",unsubscribeMethod:"logsUnsubscribe"},s)}async removeOnLogsListener(e){await this._unsubscribeClientSubscription(e,"logs")}_wsOnLogsNotification(e){const{result:t,subscription:r}=le(e,Hy);this._handleServerNotification(r,[t.value,t.context])}_wsOnSlotNotification(e){const{result:t,subscription:r}=le(e,yy);this._handleServerNotification(r,[t])}onSlotChange(e){return this._makeSubscription({callback:e,method:"slotSubscribe",unsubscribeMethod:"slotUnsubscribe"},[])}async removeSlotChangeListener(e){await this._unsubscribeClientSubscription(e,"slot change")}_wsOnSlotUpdatesNotification(e){const{result:t,subscription:r}=le(e,wy);this._handleServerNotification(r,[t])}onSlotUpdate(e){return this._makeSubscription({callback:e,method:"slotsUpdatesSubscribe",unsubscribeMethod:"slotsUpdatesUnsubscribe"},[])}async removeSlotUpdateListener(e){await this._unsubscribeClientSubscription(e,"slot update")}async _unsubscribeClientSubscription(e,t){const r=this._subscriptionDisposeFunctionsByClientSubscriptionId[e];r?await r():console.warn(`Ignored unsubscribe request because an active subscription with id \`${e}\` for '${t}' events could not be found.`)}_buildArgs(e,t,r,s){const i=t||this._commitment;if(i||r||s){let o={};r&&(o.encoding=r),i&&(o.commitment=i),s&&(o=Object.assign(o,s)),e.push(o)}return e}_buildArgsAtLeastConfirmed(e,t,r,s){const i=t||this._commitment;if(i&&!["confirmed","finalized"].includes(i))throw new Error("Using Connection with default commitment: `"+this._commitment+"`, but method requires at least `confirmed`");return this._buildArgs(e,t,r,s)}_wsOnSignatureNotification(e){const{result:t,subscription:r}=le(e,my);t.value!=="receivedSignature"&&this._subscriptionsAutoDisposedByRpc.add(r),this._handleServerNotification(r,t.value==="receivedSignature"?[{type:"received"},t.context]:[{type:"status",result:t.value},t.context])}onSignature(e,t,r){const s=this._buildArgs([e],r||this._commitment||"finalized"),i=this._makeSubscription({callback:(o,c)=>{if(o.type==="status"){t(o.result,c);try{this.removeSignatureListener(i)}catch{}}},method:"signatureSubscribe",unsubscribeMethod:"signatureUnsubscribe"},s);return i}onSignatureWithOptions(e,t,r){const{commitment:s,...i}={...r,commitment:r&&r.commitment||this._commitment||"finalized"},o=this._buildArgs([e],s,void 0,i),c=this._makeSubscription({callback:(f,l)=>{t(f,l);try{this.removeSignatureListener(c)}catch{}},method:"signatureSubscribe",unsubscribeMethod:"signatureUnsubscribe"},o);return c}async removeSignatureListener(e){await this._unsubscribeClientSubscription(e,"signature result")}_wsOnRootNotification(e){const{result:t,subscription:r}=le(e,xy);this._handleServerNotification(r,[t])}onRootChange(e){return this._makeSubscription({callback:e,method:"rootSubscribe",unsubscribeMethod:"rootUnsubscribe"},[])}async removeRootChangeListener(e){await this._unsubscribeClientSubscription(e,"root change")}}class ts{constructor(e){this._keypair=void 0,this._keypair=e??wc()}static generate(){return new ts(wc())}static fromSecretKey(e,t){if(e.byteLength!==64)throw new Error("bad secret key size");const r=e.slice(32,64);if(!t||!t.skipValidation){const s=e.slice(0,32),i=fo(s);for(let o=0;o<32;o++)if(r[o]!==i[o])throw new Error("provided secretKey is invalid")}return new ts({publicKey:r,secretKey:e})}static fromSeed(e){const t=fo(e),r=new Uint8Array(64);return r.set(e),r.set(t,32),new ts({publicKey:t,secretKey:r})}get publicKey(){return new Ne(this._keypair.publicKey)}get secretKey(){return new Uint8Array(this._keypair.secretKey)}}Object.freeze({CreateLookupTable:{index:0,layout:ke([Oe("instruction"),Fr("recentSlot"),lt("bumpSeed")])},FreezeLookupTable:{index:1,layout:ke([Oe("instruction")])},ExtendLookupTable:{index:2,layout:ke([Oe("instruction"),Fr(),Vt(nt(),mr(Oe(),-8),"addresses")])},DeactivateLookupTable:{index:3,layout:ke([Oe("instruction")])},CloseLookupTable:{index:4,layout:ke([Oe("instruction")])}});new Ne("AddressLookupTab1e1111111111111111111111111");Object.freeze({RequestUnits:{index:0,layout:ke([lt("instruction"),Oe("units"),Oe("additionalFee")])},RequestHeapFrame:{index:1,layout:ke([lt("instruction"),Oe("bytes")])},SetComputeUnitLimit:{index:2,layout:ke([lt("instruction"),Oe("units")])},SetComputeUnitPrice:{index:3,layout:ke([lt("instruction"),Fr("microLamports")])}});new Ne("ComputeBudget111111111111111111111111111111");ke([lt("numSignatures"),lt("padding"),hn("signatureOffset"),hn("signatureInstructionIndex"),hn("publicKeyOffset"),hn("publicKeyInstructionIndex"),hn("messageDataOffset"),hn("messageDataSize"),hn("messageInstructionIndex")]);new Ne("Ed25519SigVerify111111111111111111111111111");bo.utils.isValidPrivateKey;bo.getPublicKey;ke([lt("numSignatures"),hn("signatureOffset"),lt("signatureInstructionIndex"),hn("ethAddressOffset"),lt("ethAddressInstructionIndex"),hn("messageDataOffset"),hn("messageDataSize"),lt("messageInstructionIndex"),bt(20,"ethAddress"),bt(64,"signature"),lt("recoveryId")]);new Ne("KeccakSecp256k11111111111111111111111111111");var Uu;new Ne("StakeConfig11111111111111111111111111111111");class Du{constructor(e,t,r){this.unixTimestamp=void 0,this.epoch=void 0,this.custodian=void 0,this.unixTimestamp=e,this.epoch=t,this.custodian=r}}Uu=Du;Du.default=new Uu(0,0,Ne.default);Object.freeze({Initialize:{index:0,layout:ke([Oe("instruction"),a0(),c0()])},Authorize:{index:1,layout:ke([Oe("instruction"),nt("newAuthorized"),Oe("stakeAuthorizationType")])},Delegate:{index:2,layout:ke([Oe("instruction")])},Split:{index:3,layout:ke([Oe("instruction"),an("lamports")])},Withdraw:{index:4,layout:ke([Oe("instruction"),an("lamports")])},Deactivate:{index:5,layout:ke([Oe("instruction")])},Merge:{index:7,layout:ke([Oe("instruction")])},AuthorizeWithSeed:{index:8,layout:ke([Oe("instruction"),nt("newAuthorized"),Oe("stakeAuthorizationType"),Lr("authoritySeed"),nt("authorityOwner")])}});new Ne("Stake11111111111111111111111111111111111111");Object.freeze({InitializeAccount:{index:0,layout:ke([Oe("instruction"),f0()])},Authorize:{index:1,layout:ke([Oe("instruction"),nt("newAuthorized"),Oe("voteAuthorizationType")])},Withdraw:{index:3,layout:ke([Oe("instruction"),an("lamports")])},AuthorizeWithSeed:{index:10,layout:ke([Oe("instruction"),u0()])}});new Ne("Vote111111111111111111111111111111111111111");new Ne("Va1idator1nfo111111111111111111111111111111");ee({name:ue(),website:Ue(ue()),details:Ue(ue()),keybaseUsername:Ue(ue())});new Ne("Vote111111111111111111111111111111111111111");ke([nt("nodePubkey"),nt("authorizedWithdrawer"),lt("commission"),Ft(),Vt(ke([Ft("slot"),Oe("confirmationCount")]),mr(Oe(),-8),"votes"),lt("rootSlotValid"),Ft("rootSlot"),Ft(),Vt(ke([Ft("epoch"),nt("authorizedVoter")]),mr(Oe(),-8),"authorizedVoters"),ke([Vt(ke([nt("authorizedPubkey"),Ft("epochOfLastAuthorizedSwitch"),Ft("targetEpoch")]),32,"buf"),Ft("idx"),lt("isEmpty")],"priorVoters"),Ft(),Vt(ke([Ft("epoch"),Ft("credits"),Ft("prevCredits")]),mr(Oe(),-8),"epochCredits"),ke([Ft("slot"),Ft("timestamp")],"lastTimestamp")]);var $u={exports:{}};(function(n){(function(e){var t=function(u){var h,d=new Float64Array(16);if(u)for(h=0;h<u.length;h++)d[h]=u[h];return d},r=function(){throw new Error("no PRNG")},s=new Uint8Array(16),i=new Uint8Array(32);i[0]=9;var o=t(),c=t([1]),f=t([56129,1]),l=t([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),p=t([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),x=t([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),k=t([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),E=t([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function b(u,h,d,a){u[h]=d>>24&255,u[h+1]=d>>16&255,u[h+2]=d>>8&255,u[h+3]=d&255,u[h+4]=a>>24&255,u[h+5]=a>>16&255,u[h+6]=a>>8&255,u[h+7]=a&255}function _(u,h,d,a,g){var C,O=0;for(C=0;C<g;C++)O|=u[h+C]^d[a+C];return(1&O-1>>>8)-1}function v(u,h,d,a){return _(u,h,d,a,16)}function I(u,h,d,a){return _(u,h,d,a,32)}function A(u,h,d,a){for(var g=a[0]&255|(a[1]&255)<<8|(a[2]&255)<<16|(a[3]&255)<<24,C=d[0]&255|(d[1]&255)<<8|(d[2]&255)<<16|(d[3]&255)<<24,O=d[4]&255|(d[5]&255)<<8|(d[6]&255)<<16|(d[7]&255)<<24,V=d[8]&255|(d[9]&255)<<8|(d[10]&255)<<16|(d[11]&255)<<24,ae=d[12]&255|(d[13]&255)<<8|(d[14]&255)<<16|(d[15]&255)<<24,Ie=a[4]&255|(a[5]&255)<<8|(a[6]&255)<<16|(a[7]&255)<<24,pe=h[0]&255|(h[1]&255)<<8|(h[2]&255)<<16|(h[3]&255)<<24,at=h[4]&255|(h[5]&255)<<8|(h[6]&255)<<16|(h[7]&255)<<24,me=h[8]&255|(h[9]&255)<<8|(h[10]&255)<<16|(h[11]&255)<<24,De=h[12]&255|(h[13]&255)<<8|(h[14]&255)<<16|(h[15]&255)<<24,Fe=a[8]&255|(a[9]&255)<<8|(a[10]&255)<<16|(a[11]&255)<<24,ze=d[16]&255|(d[17]&255)<<8|(d[18]&255)<<16|(d[19]&255)<<24,He=d[20]&255|(d[21]&255)<<8|(d[22]&255)<<16|(d[23]&255)<<24,qe=d[24]&255|(d[25]&255)<<8|(d[26]&255)<<16|(d[27]&255)<<24,We=d[28]&255|(d[29]&255)<<8|(d[30]&255)<<16|(d[31]&255)<<24,je=a[12]&255|(a[13]&255)<<8|(a[14]&255)<<16|(a[15]&255)<<24,Se=g,Ce=C,ye=O,Ee=V,Re=ae,de=Ie,q=pe,j=at,J=me,G=De,Y=Fe,se=ze,Le=He,Ge=qe,Ye=We,Ve=je,S,Qe=0;Qe<20;Qe+=2)S=Se+Le|0,Re^=S<<7|S>>>25,S=Re+Se|0,J^=S<<9|S>>>23,S=J+Re|0,Le^=S<<13|S>>>19,S=Le+J|0,Se^=S<<18|S>>>14,S=de+Ce|0,G^=S<<7|S>>>25,S=G+de|0,Ge^=S<<9|S>>>23,S=Ge+G|0,Ce^=S<<13|S>>>19,S=Ce+Ge|0,de^=S<<18|S>>>14,S=Y+q|0,Ye^=S<<7|S>>>25,S=Ye+Y|0,ye^=S<<9|S>>>23,S=ye+Ye|0,q^=S<<13|S>>>19,S=q+ye|0,Y^=S<<18|S>>>14,S=Ve+se|0,Ee^=S<<7|S>>>25,S=Ee+Ve|0,j^=S<<9|S>>>23,S=j+Ee|0,se^=S<<13|S>>>19,S=se+j|0,Ve^=S<<18|S>>>14,S=Se+Ee|0,Ce^=S<<7|S>>>25,S=Ce+Se|0,ye^=S<<9|S>>>23,S=ye+Ce|0,Ee^=S<<13|S>>>19,S=Ee+ye|0,Se^=S<<18|S>>>14,S=de+Re|0,q^=S<<7|S>>>25,S=q+de|0,j^=S<<9|S>>>23,S=j+q|0,Re^=S<<13|S>>>19,S=Re+j|0,de^=S<<18|S>>>14,S=Y+G|0,se^=S<<7|S>>>25,S=se+Y|0,J^=S<<9|S>>>23,S=J+se|0,G^=S<<13|S>>>19,S=G+J|0,Y^=S<<18|S>>>14,S=Ve+Ye|0,Le^=S<<7|S>>>25,S=Le+Ve|0,Ge^=S<<9|S>>>23,S=Ge+Le|0,Ye^=S<<13|S>>>19,S=Ye+Ge|0,Ve^=S<<18|S>>>14;Se=Se+g|0,Ce=Ce+C|0,ye=ye+O|0,Ee=Ee+V|0,Re=Re+ae|0,de=de+Ie|0,q=q+pe|0,j=j+at|0,J=J+me|0,G=G+De|0,Y=Y+Fe|0,se=se+ze|0,Le=Le+He|0,Ge=Ge+qe|0,Ye=Ye+We|0,Ve=Ve+je|0,u[0]=Se>>>0&255,u[1]=Se>>>8&255,u[2]=Se>>>16&255,u[3]=Se>>>24&255,u[4]=Ce>>>0&255,u[5]=Ce>>>8&255,u[6]=Ce>>>16&255,u[7]=Ce>>>24&255,u[8]=ye>>>0&255,u[9]=ye>>>8&255,u[10]=ye>>>16&255,u[11]=ye>>>24&255,u[12]=Ee>>>0&255,u[13]=Ee>>>8&255,u[14]=Ee>>>16&255,u[15]=Ee>>>24&255,u[16]=Re>>>0&255,u[17]=Re>>>8&255,u[18]=Re>>>16&255,u[19]=Re>>>24&255,u[20]=de>>>0&255,u[21]=de>>>8&255,u[22]=de>>>16&255,u[23]=de>>>24&255,u[24]=q>>>0&255,u[25]=q>>>8&255,u[26]=q>>>16&255,u[27]=q>>>24&255,u[28]=j>>>0&255,u[29]=j>>>8&255,u[30]=j>>>16&255,u[31]=j>>>24&255,u[32]=J>>>0&255,u[33]=J>>>8&255,u[34]=J>>>16&255,u[35]=J>>>24&255,u[36]=G>>>0&255,u[37]=G>>>8&255,u[38]=G>>>16&255,u[39]=G>>>24&255,u[40]=Y>>>0&255,u[41]=Y>>>8&255,u[42]=Y>>>16&255,u[43]=Y>>>24&255,u[44]=se>>>0&255,u[45]=se>>>8&255,u[46]=se>>>16&255,u[47]=se>>>24&255,u[48]=Le>>>0&255,u[49]=Le>>>8&255,u[50]=Le>>>16&255,u[51]=Le>>>24&255,u[52]=Ge>>>0&255,u[53]=Ge>>>8&255,u[54]=Ge>>>16&255,u[55]=Ge>>>24&255,u[56]=Ye>>>0&255,u[57]=Ye>>>8&255,u[58]=Ye>>>16&255,u[59]=Ye>>>24&255,u[60]=Ve>>>0&255,u[61]=Ve>>>8&255,u[62]=Ve>>>16&255,u[63]=Ve>>>24&255}function T(u,h,d,a){for(var g=a[0]&255|(a[1]&255)<<8|(a[2]&255)<<16|(a[3]&255)<<24,C=d[0]&255|(d[1]&255)<<8|(d[2]&255)<<16|(d[3]&255)<<24,O=d[4]&255|(d[5]&255)<<8|(d[6]&255)<<16|(d[7]&255)<<24,V=d[8]&255|(d[9]&255)<<8|(d[10]&255)<<16|(d[11]&255)<<24,ae=d[12]&255|(d[13]&255)<<8|(d[14]&255)<<16|(d[15]&255)<<24,Ie=a[4]&255|(a[5]&255)<<8|(a[6]&255)<<16|(a[7]&255)<<24,pe=h[0]&255|(h[1]&255)<<8|(h[2]&255)<<16|(h[3]&255)<<24,at=h[4]&255|(h[5]&255)<<8|(h[6]&255)<<16|(h[7]&255)<<24,me=h[8]&255|(h[9]&255)<<8|(h[10]&255)<<16|(h[11]&255)<<24,De=h[12]&255|(h[13]&255)<<8|(h[14]&255)<<16|(h[15]&255)<<24,Fe=a[8]&255|(a[9]&255)<<8|(a[10]&255)<<16|(a[11]&255)<<24,ze=d[16]&255|(d[17]&255)<<8|(d[18]&255)<<16|(d[19]&255)<<24,He=d[20]&255|(d[21]&255)<<8|(d[22]&255)<<16|(d[23]&255)<<24,qe=d[24]&255|(d[25]&255)<<8|(d[26]&255)<<16|(d[27]&255)<<24,We=d[28]&255|(d[29]&255)<<8|(d[30]&255)<<16|(d[31]&255)<<24,je=a[12]&255|(a[13]&255)<<8|(a[14]&255)<<16|(a[15]&255)<<24,Se=g,Ce=C,ye=O,Ee=V,Re=ae,de=Ie,q=pe,j=at,J=me,G=De,Y=Fe,se=ze,Le=He,Ge=qe,Ye=We,Ve=je,S,Qe=0;Qe<20;Qe+=2)S=Se+Le|0,Re^=S<<7|S>>>25,S=Re+Se|0,J^=S<<9|S>>>23,S=J+Re|0,Le^=S<<13|S>>>19,S=Le+J|0,Se^=S<<18|S>>>14,S=de+Ce|0,G^=S<<7|S>>>25,S=G+de|0,Ge^=S<<9|S>>>23,S=Ge+G|0,Ce^=S<<13|S>>>19,S=Ce+Ge|0,de^=S<<18|S>>>14,S=Y+q|0,Ye^=S<<7|S>>>25,S=Ye+Y|0,ye^=S<<9|S>>>23,S=ye+Ye|0,q^=S<<13|S>>>19,S=q+ye|0,Y^=S<<18|S>>>14,S=Ve+se|0,Ee^=S<<7|S>>>25,S=Ee+Ve|0,j^=S<<9|S>>>23,S=j+Ee|0,se^=S<<13|S>>>19,S=se+j|0,Ve^=S<<18|S>>>14,S=Se+Ee|0,Ce^=S<<7|S>>>25,S=Ce+Se|0,ye^=S<<9|S>>>23,S=ye+Ce|0,Ee^=S<<13|S>>>19,S=Ee+ye|0,Se^=S<<18|S>>>14,S=de+Re|0,q^=S<<7|S>>>25,S=q+de|0,j^=S<<9|S>>>23,S=j+q|0,Re^=S<<13|S>>>19,S=Re+j|0,de^=S<<18|S>>>14,S=Y+G|0,se^=S<<7|S>>>25,S=se+Y|0,J^=S<<9|S>>>23,S=J+se|0,G^=S<<13|S>>>19,S=G+J|0,Y^=S<<18|S>>>14,S=Ve+Ye|0,Le^=S<<7|S>>>25,S=Le+Ve|0,Ge^=S<<9|S>>>23,S=Ge+Le|0,Ye^=S<<13|S>>>19,S=Ye+Ge|0,Ve^=S<<18|S>>>14;u[0]=Se>>>0&255,u[1]=Se>>>8&255,u[2]=Se>>>16&255,u[3]=Se>>>24&255,u[4]=de>>>0&255,u[5]=de>>>8&255,u[6]=de>>>16&255,u[7]=de>>>24&255,u[8]=Y>>>0&255,u[9]=Y>>>8&255,u[10]=Y>>>16&255,u[11]=Y>>>24&255,u[12]=Ve>>>0&255,u[13]=Ve>>>8&255,u[14]=Ve>>>16&255,u[15]=Ve>>>24&255,u[16]=q>>>0&255,u[17]=q>>>8&255,u[18]=q>>>16&255,u[19]=q>>>24&255,u[20]=j>>>0&255,u[21]=j>>>8&255,u[22]=j>>>16&255,u[23]=j>>>24&255,u[24]=J>>>0&255,u[25]=J>>>8&255,u[26]=J>>>16&255,u[27]=J>>>24&255,u[28]=G>>>0&255,u[29]=G>>>8&255,u[30]=G>>>16&255,u[31]=G>>>24&255}function $(u,h,d,a){A(u,h,d,a)}function D(u,h,d,a){T(u,h,d,a)}var P=new Uint8Array([101,120,112,97,110,100,32,51,50,45,98,121,116,101,32,107]);function H(u,h,d,a,g,C,O){var V=new Uint8Array(16),ae=new Uint8Array(64),Ie,pe;for(pe=0;pe<16;pe++)V[pe]=0;for(pe=0;pe<8;pe++)V[pe]=C[pe];for(;g>=64;){for($(ae,V,O,P),pe=0;pe<64;pe++)u[h+pe]=d[a+pe]^ae[pe];for(Ie=1,pe=8;pe<16;pe++)Ie=Ie+(V[pe]&255)|0,V[pe]=Ie&255,Ie>>>=8;g-=64,h+=64,a+=64}if(g>0)for($(ae,V,O,P),pe=0;pe<g;pe++)u[h+pe]=d[a+pe]^ae[pe];return 0}function K(u,h,d,a,g){var C=new Uint8Array(16),O=new Uint8Array(64),V,ae;for(ae=0;ae<16;ae++)C[ae]=0;for(ae=0;ae<8;ae++)C[ae]=a[ae];for(;d>=64;){for($(O,C,g,P),ae=0;ae<64;ae++)u[h+ae]=O[ae];for(V=1,ae=8;ae<16;ae++)V=V+(C[ae]&255)|0,C[ae]=V&255,V>>>=8;d-=64,h+=64}if(d>0)for($(O,C,g,P),ae=0;ae<d;ae++)u[h+ae]=O[ae];return 0}function ie(u,h,d,a,g){var C=new Uint8Array(32);D(C,a,g,P);for(var O=new Uint8Array(8),V=0;V<8;V++)O[V]=a[V+16];return K(u,h,d,O,C)}function F(u,h,d,a,g,C,O){var V=new Uint8Array(32);D(V,C,O,P);for(var ae=new Uint8Array(8),Ie=0;Ie<8;Ie++)ae[Ie]=C[Ie+16];return H(u,h,d,a,g,ae,V)}var oe=function(u){this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.leftover=0,this.fin=0;var h,d,a,g,C,O,V,ae;h=u[0]&255|(u[1]&255)<<8,this.r[0]=h&8191,d=u[2]&255|(u[3]&255)<<8,this.r[1]=(h>>>13|d<<3)&8191,a=u[4]&255|(u[5]&255)<<8,this.r[2]=(d>>>10|a<<6)&7939,g=u[6]&255|(u[7]&255)<<8,this.r[3]=(a>>>7|g<<9)&8191,C=u[8]&255|(u[9]&255)<<8,this.r[4]=(g>>>4|C<<12)&255,this.r[5]=C>>>1&8190,O=u[10]&255|(u[11]&255)<<8,this.r[6]=(C>>>14|O<<2)&8191,V=u[12]&255|(u[13]&255)<<8,this.r[7]=(O>>>11|V<<5)&8065,ae=u[14]&255|(u[15]&255)<<8,this.r[8]=(V>>>8|ae<<8)&8191,this.r[9]=ae>>>5&127,this.pad[0]=u[16]&255|(u[17]&255)<<8,this.pad[1]=u[18]&255|(u[19]&255)<<8,this.pad[2]=u[20]&255|(u[21]&255)<<8,this.pad[3]=u[22]&255|(u[23]&255)<<8,this.pad[4]=u[24]&255|(u[25]&255)<<8,this.pad[5]=u[26]&255|(u[27]&255)<<8,this.pad[6]=u[28]&255|(u[29]&255)<<8,this.pad[7]=u[30]&255|(u[31]&255)<<8};oe.prototype.blocks=function(u,h,d){for(var a=this.fin?0:2048,g,C,O,V,ae,Ie,pe,at,me,De,Fe,ze,He,qe,We,je,Se,Ce,ye,Ee=this.h[0],Re=this.h[1],de=this.h[2],q=this.h[3],j=this.h[4],J=this.h[5],G=this.h[6],Y=this.h[7],se=this.h[8],Le=this.h[9],Ge=this.r[0],Ye=this.r[1],Ve=this.r[2],S=this.r[3],Qe=this.r[4],ct=this.r[5],ft=this.r[6],Ze=this.r[7],it=this.r[8],ot=this.r[9];d>=16;)g=u[h+0]&255|(u[h+1]&255)<<8,Ee+=g&8191,C=u[h+2]&255|(u[h+3]&255)<<8,Re+=(g>>>13|C<<3)&8191,O=u[h+4]&255|(u[h+5]&255)<<8,de+=(C>>>10|O<<6)&8191,V=u[h+6]&255|(u[h+7]&255)<<8,q+=(O>>>7|V<<9)&8191,ae=u[h+8]&255|(u[h+9]&255)<<8,j+=(V>>>4|ae<<12)&8191,J+=ae>>>1&8191,Ie=u[h+10]&255|(u[h+11]&255)<<8,G+=(ae>>>14|Ie<<2)&8191,pe=u[h+12]&255|(u[h+13]&255)<<8,Y+=(Ie>>>11|pe<<5)&8191,at=u[h+14]&255|(u[h+15]&255)<<8,se+=(pe>>>8|at<<8)&8191,Le+=at>>>5|a,me=0,De=me,De+=Ee*Ge,De+=Re*(5*ot),De+=de*(5*it),De+=q*(5*Ze),De+=j*(5*ft),me=De>>>13,De&=8191,De+=J*(5*ct),De+=G*(5*Qe),De+=Y*(5*S),De+=se*(5*Ve),De+=Le*(5*Ye),me+=De>>>13,De&=8191,Fe=me,Fe+=Ee*Ye,Fe+=Re*Ge,Fe+=de*(5*ot),Fe+=q*(5*it),Fe+=j*(5*Ze),me=Fe>>>13,Fe&=8191,Fe+=J*(5*ft),Fe+=G*(5*ct),Fe+=Y*(5*Qe),Fe+=se*(5*S),Fe+=Le*(5*Ve),me+=Fe>>>13,Fe&=8191,ze=me,ze+=Ee*Ve,ze+=Re*Ye,ze+=de*Ge,ze+=q*(5*ot),ze+=j*(5*it),me=ze>>>13,ze&=8191,ze+=J*(5*Ze),ze+=G*(5*ft),ze+=Y*(5*ct),ze+=se*(5*Qe),ze+=Le*(5*S),me+=ze>>>13,ze&=8191,He=me,He+=Ee*S,He+=Re*Ve,He+=de*Ye,He+=q*Ge,He+=j*(5*ot),me=He>>>13,He&=8191,He+=J*(5*it),He+=G*(5*Ze),He+=Y*(5*ft),He+=se*(5*ct),He+=Le*(5*Qe),me+=He>>>13,He&=8191,qe=me,qe+=Ee*Qe,qe+=Re*S,qe+=de*Ve,qe+=q*Ye,qe+=j*Ge,me=qe>>>13,qe&=8191,qe+=J*(5*ot),qe+=G*(5*it),qe+=Y*(5*Ze),qe+=se*(5*ft),qe+=Le*(5*ct),me+=qe>>>13,qe&=8191,We=me,We+=Ee*ct,We+=Re*Qe,We+=de*S,We+=q*Ve,We+=j*Ye,me=We>>>13,We&=8191,We+=J*Ge,We+=G*(5*ot),We+=Y*(5*it),We+=se*(5*Ze),We+=Le*(5*ft),me+=We>>>13,We&=8191,je=me,je+=Ee*ft,je+=Re*ct,je+=de*Qe,je+=q*S,je+=j*Ve,me=je>>>13,je&=8191,je+=J*Ye,je+=G*Ge,je+=Y*(5*ot),je+=se*(5*it),je+=Le*(5*Ze),me+=je>>>13,je&=8191,Se=me,Se+=Ee*Ze,Se+=Re*ft,Se+=de*ct,Se+=q*Qe,Se+=j*S,me=Se>>>13,Se&=8191,Se+=J*Ve,Se+=G*Ye,Se+=Y*Ge,Se+=se*(5*ot),Se+=Le*(5*it),me+=Se>>>13,Se&=8191,Ce=me,Ce+=Ee*it,Ce+=Re*Ze,Ce+=de*ft,Ce+=q*ct,Ce+=j*Qe,me=Ce>>>13,Ce&=8191,Ce+=J*S,Ce+=G*Ve,Ce+=Y*Ye,Ce+=se*Ge,Ce+=Le*(5*ot),me+=Ce>>>13,Ce&=8191,ye=me,ye+=Ee*ot,ye+=Re*it,ye+=de*Ze,ye+=q*ft,ye+=j*ct,me=ye>>>13,ye&=8191,ye+=J*Qe,ye+=G*S,ye+=Y*Ve,ye+=se*Ye,ye+=Le*Ge,me+=ye>>>13,ye&=8191,me=(me<<2)+me|0,me=me+De|0,De=me&8191,me=me>>>13,Fe+=me,Ee=De,Re=Fe,de=ze,q=He,j=qe,J=We,G=je,Y=Se,se=Ce,Le=ye,h+=16,d-=16;this.h[0]=Ee,this.h[1]=Re,this.h[2]=de,this.h[3]=q,this.h[4]=j,this.h[5]=J,this.h[6]=G,this.h[7]=Y,this.h[8]=se,this.h[9]=Le},oe.prototype.finish=function(u,h){var d=new Uint16Array(10),a,g,C,O;if(this.leftover){for(O=this.leftover,this.buffer[O++]=1;O<16;O++)this.buffer[O]=0;this.fin=1,this.blocks(this.buffer,0,16)}for(a=this.h[1]>>>13,this.h[1]&=8191,O=2;O<10;O++)this.h[O]+=a,a=this.h[O]>>>13,this.h[O]&=8191;for(this.h[0]+=a*5,a=this.h[0]>>>13,this.h[0]&=8191,this.h[1]+=a,a=this.h[1]>>>13,this.h[1]&=8191,this.h[2]+=a,d[0]=this.h[0]+5,a=d[0]>>>13,d[0]&=8191,O=1;O<10;O++)d[O]=this.h[O]+a,a=d[O]>>>13,d[O]&=8191;for(d[9]-=8192,g=(a^1)-1,O=0;O<10;O++)d[O]&=g;for(g=~g,O=0;O<10;O++)this.h[O]=this.h[O]&g|d[O];for(this.h[0]=(this.h[0]|this.h[1]<<13)&65535,this.h[1]=(this.h[1]>>>3|this.h[2]<<10)&65535,this.h[2]=(this.h[2]>>>6|this.h[3]<<7)&65535,this.h[3]=(this.h[3]>>>9|this.h[4]<<4)&65535,this.h[4]=(this.h[4]>>>12|this.h[5]<<1|this.h[6]<<14)&65535,this.h[5]=(this.h[6]>>>2|this.h[7]<<11)&65535,this.h[6]=(this.h[7]>>>5|this.h[8]<<8)&65535,this.h[7]=(this.h[8]>>>8|this.h[9]<<5)&65535,C=this.h[0]+this.pad[0],this.h[0]=C&65535,O=1;O<8;O++)C=(this.h[O]+this.pad[O]|0)+(C>>>16)|0,this.h[O]=C&65535;u[h+0]=this.h[0]>>>0&255,u[h+1]=this.h[0]>>>8&255,u[h+2]=this.h[1]>>>0&255,u[h+3]=this.h[1]>>>8&255,u[h+4]=this.h[2]>>>0&255,u[h+5]=this.h[2]>>>8&255,u[h+6]=this.h[3]>>>0&255,u[h+7]=this.h[3]>>>8&255,u[h+8]=this.h[4]>>>0&255,u[h+9]=this.h[4]>>>8&255,u[h+10]=this.h[5]>>>0&255,u[h+11]=this.h[5]>>>8&255,u[h+12]=this.h[6]>>>0&255,u[h+13]=this.h[6]>>>8&255,u[h+14]=this.h[7]>>>0&255,u[h+15]=this.h[7]>>>8&255},oe.prototype.update=function(u,h,d){var a,g;if(this.leftover){for(g=16-this.leftover,g>d&&(g=d),a=0;a<g;a++)this.buffer[this.leftover+a]=u[h+a];if(d-=g,h+=g,this.leftover+=g,this.leftover<16)return;this.blocks(this.buffer,0,16),this.leftover=0}if(d>=16&&(g=d-d%16,this.blocks(u,h,g),h+=g,d-=g),d){for(a=0;a<d;a++)this.buffer[this.leftover+a]=u[h+a];this.leftover+=d}};function Pe(u,h,d,a,g,C){var O=new oe(C);return O.update(d,a,g),O.finish(u,h),0}function ve(u,h,d,a,g,C){var O=new Uint8Array(16);return Pe(O,0,d,a,g,C),v(u,h,O,0)}function Me(u,h,d,a,g){var C;if(d<32)return-1;for(F(u,0,h,0,d,a,g),Pe(u,16,u,32,d-32,u),C=0;C<16;C++)u[C]=0;return 0}function W(u,h,d,a,g){var C,O=new Uint8Array(32);if(d<32||(ie(O,0,32,a,g),ve(h,16,h,32,d-32,O)!==0))return-1;for(F(u,0,h,0,d,a,g),C=0;C<32;C++)u[C]=0;return 0}function te(u,h){var d;for(d=0;d<16;d++)u[d]=h[d]|0}function be(u){var h,d,a=1;for(h=0;h<16;h++)d=u[h]+a+65535,a=Math.floor(d/65536),u[h]=d-a*65536;u[0]+=a-1+37*(a-1)}function z(u,h,d){for(var a,g=~(d-1),C=0;C<16;C++)a=g&(u[C]^h[C]),u[C]^=a,h[C]^=a}function R(u,h){var d,a,g,C=t(),O=t();for(d=0;d<16;d++)O[d]=h[d];for(be(O),be(O),be(O),a=0;a<2;a++){for(C[0]=O[0]-65517,d=1;d<15;d++)C[d]=O[d]-65535-(C[d-1]>>16&1),C[d-1]&=65535;C[15]=O[15]-32767-(C[14]>>16&1),g=C[15]>>16&1,C[14]&=65535,z(O,C,1-g)}for(d=0;d<16;d++)u[2*d]=O[d]&255,u[2*d+1]=O[d]>>8}function m(u,h){var d=new Uint8Array(32),a=new Uint8Array(32);return R(d,u),R(a,h),I(d,0,a,0)}function M(u){var h=new Uint8Array(32);return R(h,u),h[0]&1}function Z(u,h){var d;for(d=0;d<16;d++)u[d]=h[2*d]+(h[2*d+1]<<8);u[15]&=32767}function ne(u,h,d){for(var a=0;a<16;a++)u[a]=h[a]+d[a]}function Q(u,h,d){for(var a=0;a<16;a++)u[a]=h[a]-d[a]}function re(u,h,d){var a,g,C=0,O=0,V=0,ae=0,Ie=0,pe=0,at=0,me=0,De=0,Fe=0,ze=0,He=0,qe=0,We=0,je=0,Se=0,Ce=0,ye=0,Ee=0,Re=0,de=0,q=0,j=0,J=0,G=0,Y=0,se=0,Le=0,Ge=0,Ye=0,Ve=0,S=d[0],Qe=d[1],ct=d[2],ft=d[3],Ze=d[4],it=d[5],ot=d[6],Bt=d[7],ht=d[8],vt=d[9],At=d[10],Rt=d[11],Pt=d[12],Ht=d[13],zt=d[14],Gt=d[15];a=h[0],C+=a*S,O+=a*Qe,V+=a*ct,ae+=a*ft,Ie+=a*Ze,pe+=a*it,at+=a*ot,me+=a*Bt,De+=a*ht,Fe+=a*vt,ze+=a*At,He+=a*Rt,qe+=a*Pt,We+=a*Ht,je+=a*zt,Se+=a*Gt,a=h[1],O+=a*S,V+=a*Qe,ae+=a*ct,Ie+=a*ft,pe+=a*Ze,at+=a*it,me+=a*ot,De+=a*Bt,Fe+=a*ht,ze+=a*vt,He+=a*At,qe+=a*Rt,We+=a*Pt,je+=a*Ht,Se+=a*zt,Ce+=a*Gt,a=h[2],V+=a*S,ae+=a*Qe,Ie+=a*ct,pe+=a*ft,at+=a*Ze,me+=a*it,De+=a*ot,Fe+=a*Bt,ze+=a*ht,He+=a*vt,qe+=a*At,We+=a*Rt,je+=a*Pt,Se+=a*Ht,Ce+=a*zt,ye+=a*Gt,a=h[3],ae+=a*S,Ie+=a*Qe,pe+=a*ct,at+=a*ft,me+=a*Ze,De+=a*it,Fe+=a*ot,ze+=a*Bt,He+=a*ht,qe+=a*vt,We+=a*At,je+=a*Rt,Se+=a*Pt,Ce+=a*Ht,ye+=a*zt,Ee+=a*Gt,a=h[4],Ie+=a*S,pe+=a*Qe,at+=a*ct,me+=a*ft,De+=a*Ze,Fe+=a*it,ze+=a*ot,He+=a*Bt,qe+=a*ht,We+=a*vt,je+=a*At,Se+=a*Rt,Ce+=a*Pt,ye+=a*Ht,Ee+=a*zt,Re+=a*Gt,a=h[5],pe+=a*S,at+=a*Qe,me+=a*ct,De+=a*ft,Fe+=a*Ze,ze+=a*it,He+=a*ot,qe+=a*Bt,We+=a*ht,je+=a*vt,Se+=a*At,Ce+=a*Rt,ye+=a*Pt,Ee+=a*Ht,Re+=a*zt,de+=a*Gt,a=h[6],at+=a*S,me+=a*Qe,De+=a*ct,Fe+=a*ft,ze+=a*Ze,He+=a*it,qe+=a*ot,We+=a*Bt,je+=a*ht,Se+=a*vt,Ce+=a*At,ye+=a*Rt,Ee+=a*Pt,Re+=a*Ht,de+=a*zt,q+=a*Gt,a=h[7],me+=a*S,De+=a*Qe,Fe+=a*ct,ze+=a*ft,He+=a*Ze,qe+=a*it,We+=a*ot,je+=a*Bt,Se+=a*ht,Ce+=a*vt,ye+=a*At,Ee+=a*Rt,Re+=a*Pt,de+=a*Ht,q+=a*zt,j+=a*Gt,a=h[8],De+=a*S,Fe+=a*Qe,ze+=a*ct,He+=a*ft,qe+=a*Ze,We+=a*it,je+=a*ot,Se+=a*Bt,Ce+=a*ht,ye+=a*vt,Ee+=a*At,Re+=a*Rt,de+=a*Pt,q+=a*Ht,j+=a*zt,J+=a*Gt,a=h[9],Fe+=a*S,ze+=a*Qe,He+=a*ct,qe+=a*ft,We+=a*Ze,je+=a*it,Se+=a*ot,Ce+=a*Bt,ye+=a*ht,Ee+=a*vt,Re+=a*At,de+=a*Rt,q+=a*Pt,j+=a*Ht,J+=a*zt,G+=a*Gt,a=h[10],ze+=a*S,He+=a*Qe,qe+=a*ct,We+=a*ft,je+=a*Ze,Se+=a*it,Ce+=a*ot,ye+=a*Bt,Ee+=a*ht,Re+=a*vt,de+=a*At,q+=a*Rt,j+=a*Pt,J+=a*Ht,G+=a*zt,Y+=a*Gt,a=h[11],He+=a*S,qe+=a*Qe,We+=a*ct,je+=a*ft,Se+=a*Ze,Ce+=a*it,ye+=a*ot,Ee+=a*Bt,Re+=a*ht,de+=a*vt,q+=a*At,j+=a*Rt,J+=a*Pt,G+=a*Ht,Y+=a*zt,se+=a*Gt,a=h[12],qe+=a*S,We+=a*Qe,je+=a*ct,Se+=a*ft,Ce+=a*Ze,ye+=a*it,Ee+=a*ot,Re+=a*Bt,de+=a*ht,q+=a*vt,j+=a*At,J+=a*Rt,G+=a*Pt,Y+=a*Ht,se+=a*zt,Le+=a*Gt,a=h[13],We+=a*S,je+=a*Qe,Se+=a*ct,Ce+=a*ft,ye+=a*Ze,Ee+=a*it,Re+=a*ot,de+=a*Bt,q+=a*ht,j+=a*vt,J+=a*At,G+=a*Rt,Y+=a*Pt,se+=a*Ht,Le+=a*zt,Ge+=a*Gt,a=h[14],je+=a*S,Se+=a*Qe,Ce+=a*ct,ye+=a*ft,Ee+=a*Ze,Re+=a*it,de+=a*ot,q+=a*Bt,j+=a*ht,J+=a*vt,G+=a*At,Y+=a*Rt,se+=a*Pt,Le+=a*Ht,Ge+=a*zt,Ye+=a*Gt,a=h[15],Se+=a*S,Ce+=a*Qe,ye+=a*ct,Ee+=a*ft,Re+=a*Ze,de+=a*it,q+=a*ot,j+=a*Bt,J+=a*ht,G+=a*vt,Y+=a*At,se+=a*Rt,Le+=a*Pt,Ge+=a*Ht,Ye+=a*zt,Ve+=a*Gt,C+=38*Ce,O+=38*ye,V+=38*Ee,ae+=38*Re,Ie+=38*de,pe+=38*q,at+=38*j,me+=38*J,De+=38*G,Fe+=38*Y,ze+=38*se,He+=38*Le,qe+=38*Ge,We+=38*Ye,je+=38*Ve,g=1,a=C+g+65535,g=Math.floor(a/65536),C=a-g*65536,a=O+g+65535,g=Math.floor(a/65536),O=a-g*65536,a=V+g+65535,g=Math.floor(a/65536),V=a-g*65536,a=ae+g+65535,g=Math.floor(a/65536),ae=a-g*65536,a=Ie+g+65535,g=Math.floor(a/65536),Ie=a-g*65536,a=pe+g+65535,g=Math.floor(a/65536),pe=a-g*65536,a=at+g+65535,g=Math.floor(a/65536),at=a-g*65536,a=me+g+65535,g=Math.floor(a/65536),me=a-g*65536,a=De+g+65535,g=Math.floor(a/65536),De=a-g*65536,a=Fe+g+65535,g=Math.floor(a/65536),Fe=a-g*65536,a=ze+g+65535,g=Math.floor(a/65536),ze=a-g*65536,a=He+g+65535,g=Math.floor(a/65536),He=a-g*65536,a=qe+g+65535,g=Math.floor(a/65536),qe=a-g*65536,a=We+g+65535,g=Math.floor(a/65536),We=a-g*65536,a=je+g+65535,g=Math.floor(a/65536),je=a-g*65536,a=Se+g+65535,g=Math.floor(a/65536),Se=a-g*65536,C+=g-1+37*(g-1),g=1,a=C+g+65535,g=Math.floor(a/65536),C=a-g*65536,a=O+g+65535,g=Math.floor(a/65536),O=a-g*65536,a=V+g+65535,g=Math.floor(a/65536),V=a-g*65536,a=ae+g+65535,g=Math.floor(a/65536),ae=a-g*65536,a=Ie+g+65535,g=Math.floor(a/65536),Ie=a-g*65536,a=pe+g+65535,g=Math.floor(a/65536),pe=a-g*65536,a=at+g+65535,g=Math.floor(a/65536),at=a-g*65536,a=me+g+65535,g=Math.floor(a/65536),me=a-g*65536,a=De+g+65535,g=Math.floor(a/65536),De=a-g*65536,a=Fe+g+65535,g=Math.floor(a/65536),Fe=a-g*65536,a=ze+g+65535,g=Math.floor(a/65536),ze=a-g*65536,a=He+g+65535,g=Math.floor(a/65536),He=a-g*65536,a=qe+g+65535,g=Math.floor(a/65536),qe=a-g*65536,a=We+g+65535,g=Math.floor(a/65536),We=a-g*65536,a=je+g+65535,g=Math.floor(a/65536),je=a-g*65536,a=Se+g+65535,g=Math.floor(a/65536),Se=a-g*65536,C+=g-1+37*(g-1),u[0]=C,u[1]=O,u[2]=V,u[3]=ae,u[4]=Ie,u[5]=pe,u[6]=at,u[7]=me,u[8]=De,u[9]=Fe,u[10]=ze,u[11]=He,u[12]=qe,u[13]=We,u[14]=je,u[15]=Se}function we(u,h){re(u,h,h)}function Te(u,h){var d=t(),a;for(a=0;a<16;a++)d[a]=h[a];for(a=253;a>=0;a--)we(d,d),a!==2&&a!==4&&re(d,d,h);for(a=0;a<16;a++)u[a]=d[a]}function et(u,h){var d=t(),a;for(a=0;a<16;a++)d[a]=h[a];for(a=250;a>=0;a--)we(d,d),a!==1&&re(d,d,h);for(a=0;a<16;a++)u[a]=d[a]}function Ke(u,h,d){var a=new Uint8Array(32),g=new Float64Array(80),C,O,V=t(),ae=t(),Ie=t(),pe=t(),at=t(),me=t();for(O=0;O<31;O++)a[O]=h[O];for(a[31]=h[31]&127|64,a[0]&=248,Z(g,d),O=0;O<16;O++)ae[O]=g[O],pe[O]=V[O]=Ie[O]=0;for(V[0]=pe[0]=1,O=254;O>=0;--O)C=a[O>>>3]>>>(O&7)&1,z(V,ae,C),z(Ie,pe,C),ne(at,V,Ie),Q(V,V,Ie),ne(Ie,ae,pe),Q(ae,ae,pe),we(pe,at),we(me,V),re(V,Ie,V),re(Ie,ae,at),ne(at,V,Ie),Q(V,V,Ie),we(ae,V),Q(Ie,pe,me),re(V,Ie,f),ne(V,V,pe),re(Ie,Ie,V),re(V,pe,me),re(pe,ae,g),we(ae,at),z(V,ae,C),z(Ie,pe,C);for(O=0;O<16;O++)g[O+16]=V[O],g[O+32]=Ie[O],g[O+48]=ae[O],g[O+64]=pe[O];var De=g.subarray(32),Fe=g.subarray(16);return Te(De,De),re(Fe,Fe,De),R(u,Fe),0}function rt(u,h){return Ke(u,h,i)}function gt(u,h){return r(h,32),rt(u,h)}function yt(u,h,d){var a=new Uint8Array(32);return Ke(a,d,h),D(u,s,a,P)}var B=Me,L=W;function X(u,h,d,a,g,C){var O=new Uint8Array(32);return yt(O,g,C),B(u,h,d,a,O)}function xe(u,h,d,a,g,C){var O=new Uint8Array(32);return yt(O,g,C),L(u,h,d,a,O)}var Ae=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function dt(u,h,d,a){for(var g=new Int32Array(16),C=new Int32Array(16),O,V,ae,Ie,pe,at,me,De,Fe,ze,He,qe,We,je,Se,Ce,ye,Ee,Re,de,q,j,J,G,Y,se,Le=u[0],Ge=u[1],Ye=u[2],Ve=u[3],S=u[4],Qe=u[5],ct=u[6],ft=u[7],Ze=h[0],it=h[1],ot=h[2],Bt=h[3],ht=h[4],vt=h[5],At=h[6],Rt=h[7],Pt=0;a>=128;){for(Re=0;Re<16;Re++)de=8*Re+Pt,g[Re]=d[de+0]<<24|d[de+1]<<16|d[de+2]<<8|d[de+3],C[Re]=d[de+4]<<24|d[de+5]<<16|d[de+6]<<8|d[de+7];for(Re=0;Re<80;Re++)if(O=Le,V=Ge,ae=Ye,Ie=Ve,pe=S,at=Qe,me=ct,De=ft,Fe=Ze,ze=it,He=ot,qe=Bt,We=ht,je=vt,Se=At,Ce=Rt,q=ft,j=Rt,J=j&65535,G=j>>>16,Y=q&65535,se=q>>>16,q=(S>>>14|ht<<18)^(S>>>18|ht<<14)^(ht>>>9|S<<23),j=(ht>>>14|S<<18)^(ht>>>18|S<<14)^(S>>>9|ht<<23),J+=j&65535,G+=j>>>16,Y+=q&65535,se+=q>>>16,q=S&Qe^~S&ct,j=ht&vt^~ht&At,J+=j&65535,G+=j>>>16,Y+=q&65535,se+=q>>>16,q=Ae[Re*2],j=Ae[Re*2+1],J+=j&65535,G+=j>>>16,Y+=q&65535,se+=q>>>16,q=g[Re%16],j=C[Re%16],J+=j&65535,G+=j>>>16,Y+=q&65535,se+=q>>>16,G+=J>>>16,Y+=G>>>16,se+=Y>>>16,ye=Y&65535|se<<16,Ee=J&65535|G<<16,q=ye,j=Ee,J=j&65535,G=j>>>16,Y=q&65535,se=q>>>16,q=(Le>>>28|Ze<<4)^(Ze>>>2|Le<<30)^(Ze>>>7|Le<<25),j=(Ze>>>28|Le<<4)^(Le>>>2|Ze<<30)^(Le>>>7|Ze<<25),J+=j&65535,G+=j>>>16,Y+=q&65535,se+=q>>>16,q=Le&Ge^Le&Ye^Ge&Ye,j=Ze&it^Ze&ot^it&ot,J+=j&65535,G+=j>>>16,Y+=q&65535,se+=q>>>16,G+=J>>>16,Y+=G>>>16,se+=Y>>>16,De=Y&65535|se<<16,Ce=J&65535|G<<16,q=Ie,j=qe,J=j&65535,G=j>>>16,Y=q&65535,se=q>>>16,q=ye,j=Ee,J+=j&65535,G+=j>>>16,Y+=q&65535,se+=q>>>16,G+=J>>>16,Y+=G>>>16,se+=Y>>>16,Ie=Y&65535|se<<16,qe=J&65535|G<<16,Ge=O,Ye=V,Ve=ae,S=Ie,Qe=pe,ct=at,ft=me,Le=De,it=Fe,ot=ze,Bt=He,ht=qe,vt=We,At=je,Rt=Se,Ze=Ce,Re%16===15)for(de=0;de<16;de++)q=g[de],j=C[de],J=j&65535,G=j>>>16,Y=q&65535,se=q>>>16,q=g[(de+9)%16],j=C[(de+9)%16],J+=j&65535,G+=j>>>16,Y+=q&65535,se+=q>>>16,ye=g[(de+1)%16],Ee=C[(de+1)%16],q=(ye>>>1|Ee<<31)^(ye>>>8|Ee<<24)^ye>>>7,j=(Ee>>>1|ye<<31)^(Ee>>>8|ye<<24)^(Ee>>>7|ye<<25),J+=j&65535,G+=j>>>16,Y+=q&65535,se+=q>>>16,ye=g[(de+14)%16],Ee=C[(de+14)%16],q=(ye>>>19|Ee<<13)^(Ee>>>29|ye<<3)^ye>>>6,j=(Ee>>>19|ye<<13)^(ye>>>29|Ee<<3)^(Ee>>>6|ye<<26),J+=j&65535,G+=j>>>16,Y+=q&65535,se+=q>>>16,G+=J>>>16,Y+=G>>>16,se+=Y>>>16,g[de]=Y&65535|se<<16,C[de]=J&65535|G<<16;q=Le,j=Ze,J=j&65535,G=j>>>16,Y=q&65535,se=q>>>16,q=u[0],j=h[0],J+=j&65535,G+=j>>>16,Y+=q&65535,se+=q>>>16,G+=J>>>16,Y+=G>>>16,se+=Y>>>16,u[0]=Le=Y&65535|se<<16,h[0]=Ze=J&65535|G<<16,q=Ge,j=it,J=j&65535,G=j>>>16,Y=q&65535,se=q>>>16,q=u[1],j=h[1],J+=j&65535,G+=j>>>16,Y+=q&65535,se+=q>>>16,G+=J>>>16,Y+=G>>>16,se+=Y>>>16,u[1]=Ge=Y&65535|se<<16,h[1]=it=J&65535|G<<16,q=Ye,j=ot,J=j&65535,G=j>>>16,Y=q&65535,se=q>>>16,q=u[2],j=h[2],J+=j&65535,G+=j>>>16,Y+=q&65535,se+=q>>>16,G+=J>>>16,Y+=G>>>16,se+=Y>>>16,u[2]=Ye=Y&65535|se<<16,h[2]=ot=J&65535|G<<16,q=Ve,j=Bt,J=j&65535,G=j>>>16,Y=q&65535,se=q>>>16,q=u[3],j=h[3],J+=j&65535,G+=j>>>16,Y+=q&65535,se+=q>>>16,G+=J>>>16,Y+=G>>>16,se+=Y>>>16,u[3]=Ve=Y&65535|se<<16,h[3]=Bt=J&65535|G<<16,q=S,j=ht,J=j&65535,G=j>>>16,Y=q&65535,se=q>>>16,q=u[4],j=h[4],J+=j&65535,G+=j>>>16,Y+=q&65535,se+=q>>>16,G+=J>>>16,Y+=G>>>16,se+=Y>>>16,u[4]=S=Y&65535|se<<16,h[4]=ht=J&65535|G<<16,q=Qe,j=vt,J=j&65535,G=j>>>16,Y=q&65535,se=q>>>16,q=u[5],j=h[5],J+=j&65535,G+=j>>>16,Y+=q&65535,se+=q>>>16,G+=J>>>16,Y+=G>>>16,se+=Y>>>16,u[5]=Qe=Y&65535|se<<16,h[5]=vt=J&65535|G<<16,q=ct,j=At,J=j&65535,G=j>>>16,Y=q&65535,se=q>>>16,q=u[6],j=h[6],J+=j&65535,G+=j>>>16,Y+=q&65535,se+=q>>>16,G+=J>>>16,Y+=G>>>16,se+=Y>>>16,u[6]=ct=Y&65535|se<<16,h[6]=At=J&65535|G<<16,q=ft,j=Rt,J=j&65535,G=j>>>16,Y=q&65535,se=q>>>16,q=u[7],j=h[7],J+=j&65535,G+=j>>>16,Y+=q&65535,se+=q>>>16,G+=J>>>16,Y+=G>>>16,se+=Y>>>16,u[7]=ft=Y&65535|se<<16,h[7]=Rt=J&65535|G<<16,Pt+=128,a-=128}return a}function st(u,h,d){var a=new Int32Array(8),g=new Int32Array(8),C=new Uint8Array(256),O,V=d;for(a[0]=1779033703,a[1]=3144134277,a[2]=1013904242,a[3]=2773480762,a[4]=1359893119,a[5]=2600822924,a[6]=528734635,a[7]=1541459225,g[0]=4089235720,g[1]=2227873595,g[2]=4271175723,g[3]=1595750129,g[4]=2917565137,g[5]=725511199,g[6]=4215389547,g[7]=327033209,dt(a,g,h,d),d%=128,O=0;O<d;O++)C[O]=h[V-d+O];for(C[d]=128,d=256-128*(d<112?1:0),C[d-9]=0,b(C,d-8,V/536870912|0,V<<3),dt(a,g,C,d),O=0;O<8;O++)b(u,8*O,a[O],g[O]);return 0}function $t(u,h){var d=t(),a=t(),g=t(),C=t(),O=t(),V=t(),ae=t(),Ie=t(),pe=t();Q(d,u[1],u[0]),Q(pe,h[1],h[0]),re(d,d,pe),ne(a,u[0],u[1]),ne(pe,h[0],h[1]),re(a,a,pe),re(g,u[3],h[3]),re(g,g,p),re(C,u[2],h[2]),ne(C,C,C),Q(O,a,d),Q(V,C,g),ne(ae,C,g),ne(Ie,a,d),re(u[0],O,V),re(u[1],Ie,ae),re(u[2],ae,V),re(u[3],O,Ie)}function yn(u,h,d){var a;for(a=0;a<4;a++)z(u[a],h[a],d)}function rn(u,h){var d=t(),a=t(),g=t();Te(g,h[2]),re(d,h[0],g),re(a,h[1],g),R(u,a),u[31]^=M(d)<<7}function Wt(u,h,d){var a,g;for(te(u[0],o),te(u[1],c),te(u[2],c),te(u[3],o),g=255;g>=0;--g)a=d[g/8|0]>>(g&7)&1,yn(u,h,a),$t(h,u),$t(u,u),yn(u,h,a)}function bn(u,h){var d=[t(),t(),t(),t()];te(d[0],x),te(d[1],k),te(d[2],c),re(d[3],x,k),Wt(u,d,h)}function y(u,h,d){var a=new Uint8Array(64),g=[t(),t(),t(),t()],C;for(d||r(h,32),st(a,h,32),a[0]&=248,a[31]&=127,a[31]|=64,bn(g,a),rn(u,g),C=0;C<32;C++)h[C+32]=u[C];return 0}var w=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function ce(u,h){var d,a,g,C;for(a=63;a>=32;--a){for(d=0,g=a-32,C=a-12;g<C;++g)h[g]+=d-16*h[a]*w[g-(a-32)],d=Math.floor((h[g]+128)/256),h[g]-=d*256;h[g]+=d,h[a]=0}for(d=0,g=0;g<32;g++)h[g]+=d-(h[31]>>4)*w[g],d=h[g]>>8,h[g]&=255;for(g=0;g<32;g++)h[g]-=d*w[g];for(a=0;a<32;a++)h[a+1]+=h[a]>>8,u[a]=h[a]&255}function fe(u){var h=new Float64Array(64),d;for(d=0;d<64;d++)h[d]=u[d];for(d=0;d<64;d++)u[d]=0;ce(u,h)}function _e(u,h,d,a){var g=new Uint8Array(64),C=new Uint8Array(64),O=new Uint8Array(64),V,ae,Ie=new Float64Array(64),pe=[t(),t(),t(),t()];st(g,a,32),g[0]&=248,g[31]&=127,g[31]|=64;var at=d+64;for(V=0;V<d;V++)u[64+V]=h[V];for(V=0;V<32;V++)u[32+V]=g[32+V];for(st(O,u.subarray(32),d+32),fe(O),bn(pe,O),rn(u,pe),V=32;V<64;V++)u[V]=a[V];for(st(C,u,d+64),fe(C),V=0;V<64;V++)Ie[V]=0;for(V=0;V<32;V++)Ie[V]=O[V];for(V=0;V<32;V++)for(ae=0;ae<32;ae++)Ie[V+ae]+=C[V]*g[ae];return ce(u.subarray(32),Ie),at}function Tt(u,h){var d=t(),a=t(),g=t(),C=t(),O=t(),V=t(),ae=t();return te(u[2],c),Z(u[1],h),we(g,u[1]),re(C,g,l),Q(g,g,u[2]),ne(C,u[2],C),we(O,C),we(V,O),re(ae,V,O),re(d,ae,g),re(d,d,C),et(d,d),re(d,d,g),re(d,d,C),re(d,d,C),re(u[0],d,C),we(a,u[0]),re(a,a,C),m(a,g)&&re(u[0],u[0],E),we(a,u[0]),re(a,a,C),m(a,g)?-1:(M(u[0])===h[31]>>7&&Q(u[0],o,u[0]),re(u[3],u[0],u[1]),0)}function Mt(u,h,d,a){var g,C=new Uint8Array(32),O=new Uint8Array(64),V=[t(),t(),t(),t()],ae=[t(),t(),t(),t()];if(d<64||Tt(ae,a))return-1;for(g=0;g<d;g++)u[g]=h[g];for(g=0;g<32;g++)u[g+32]=a[g];if(st(O,u,d),fe(O),Wt(V,ae,O),bn(ae,h.subarray(32)),$t(V,ae),rn(C,V),d-=64,I(h,0,C,0)){for(g=0;g<d;g++)u[g]=0;return-1}for(g=0;g<d;g++)u[g]=h[g+64];return d}var Gn=32,Jt=24,Vn=32,Yn=16,Zn=32,cr=32,Nn=32,Mn=32,fr=32,Xn=Jt,Un=Vn,wn=Yn,Dn=64,ur=32,kr=64,oi=32,ai=64;e.lowlevel={crypto_core_hsalsa20:D,crypto_stream_xor:F,crypto_stream:ie,crypto_stream_salsa20_xor:H,crypto_stream_salsa20:K,crypto_onetimeauth:Pe,crypto_onetimeauth_verify:ve,crypto_verify_16:v,crypto_verify_32:I,crypto_secretbox:Me,crypto_secretbox_open:W,crypto_scalarmult:Ke,crypto_scalarmult_base:rt,crypto_box_beforenm:yt,crypto_box_afternm:B,crypto_box:X,crypto_box_open:xe,crypto_box_keypair:gt,crypto_hash:st,crypto_sign:_e,crypto_sign_keypair:y,crypto_sign_open:Mt,crypto_secretbox_KEYBYTES:Gn,crypto_secretbox_NONCEBYTES:Jt,crypto_secretbox_ZEROBYTES:Vn,crypto_secretbox_BOXZEROBYTES:Yn,crypto_scalarmult_BYTES:Zn,crypto_scalarmult_SCALARBYTES:cr,crypto_box_PUBLICKEYBYTES:Nn,crypto_box_SECRETKEYBYTES:Mn,crypto_box_BEFORENMBYTES:fr,crypto_box_NONCEBYTES:Xn,crypto_box_ZEROBYTES:Un,crypto_box_BOXZEROBYTES:wn,crypto_sign_BYTES:Dn,crypto_sign_PUBLICKEYBYTES:ur,crypto_sign_SECRETKEYBYTES:kr,crypto_sign_SEEDBYTES:oi,crypto_hash_BYTES:ai,gf:t,D:l,L:w,pack:rn,pack25519:R,unpack25519:Z,M:re,A:ne,S:we,Z:Q,pow2523:et,add:$t,set25519:te,modL:ce,scalarmult:Wt,scalarbase:bn};function sa(u,h){if(u.length!==Gn)throw new Error("bad key size");if(h.length!==Jt)throw new Error("bad nonce size")}function Hu(u,h){if(u.length!==Nn)throw new Error("bad public key size");if(h.length!==Mn)throw new Error("bad secret key size")}function sn(){for(var u=0;u<arguments.length;u++)if(!(arguments[u]instanceof Uint8Array))throw new TypeError("unexpected type, use Uint8Array")}function ia(u){for(var h=0;h<u.length;h++)u[h]=0}e.randomBytes=function(u){var h=new Uint8Array(u);return r(h,u),h},e.secretbox=function(u,h,d){sn(u,h,d),sa(d,h);for(var a=new Uint8Array(Vn+u.length),g=new Uint8Array(a.length),C=0;C<u.length;C++)a[C+Vn]=u[C];return Me(g,a,a.length,h,d),g.subarray(Yn)},e.secretbox.open=function(u,h,d){sn(u,h,d),sa(d,h);for(var a=new Uint8Array(Yn+u.length),g=new Uint8Array(a.length),C=0;C<u.length;C++)a[C+Yn]=u[C];return a.length<32||W(g,a,a.length,h,d)!==0?null:g.subarray(Vn)},e.secretbox.keyLength=Gn,e.secretbox.nonceLength=Jt,e.secretbox.overheadLength=Yn,e.scalarMult=function(u,h){if(sn(u,h),u.length!==cr)throw new Error("bad n size");if(h.length!==Zn)throw new Error("bad p size");var d=new Uint8Array(Zn);return Ke(d,u,h),d},e.scalarMult.base=function(u){if(sn(u),u.length!==cr)throw new Error("bad n size");var h=new Uint8Array(Zn);return rt(h,u),h},e.scalarMult.scalarLength=cr,e.scalarMult.groupElementLength=Zn,e.box=function(u,h,d,a){var g=e.box.before(d,a);return e.secretbox(u,h,g)},e.box.before=function(u,h){sn(u,h),Hu(u,h);var d=new Uint8Array(fr);return yt(d,u,h),d},e.box.after=e.secretbox,e.box.open=function(u,h,d,a){var g=e.box.before(d,a);return e.secretbox.open(u,h,g)},e.box.open.after=e.secretbox.open,e.box.keyPair=function(){var u=new Uint8Array(Nn),h=new Uint8Array(Mn);return gt(u,h),{publicKey:u,secretKey:h}},e.box.keyPair.fromSecretKey=function(u){if(sn(u),u.length!==Mn)throw new Error("bad secret key size");var h=new Uint8Array(Nn);return rt(h,u),{publicKey:h,secretKey:new Uint8Array(u)}},e.box.publicKeyLength=Nn,e.box.secretKeyLength=Mn,e.box.sharedKeyLength=fr,e.box.nonceLength=Xn,e.box.overheadLength=e.secretbox.overheadLength,e.sign=function(u,h){if(sn(u,h),h.length!==kr)throw new Error("bad secret key size");var d=new Uint8Array(Dn+u.length);return _e(d,u,u.length,h),d},e.sign.open=function(u,h){if(sn(u,h),h.length!==ur)throw new Error("bad public key size");var d=new Uint8Array(u.length),a=Mt(d,u,u.length,h);if(a<0)return null;for(var g=new Uint8Array(a),C=0;C<g.length;C++)g[C]=d[C];return g},e.sign.detached=function(u,h){for(var d=e.sign(u,h),a=new Uint8Array(Dn),g=0;g<a.length;g++)a[g]=d[g];return a},e.sign.detached.verify=function(u,h,d){if(sn(u,h,d),h.length!==Dn)throw new Error("bad signature size");if(d.length!==ur)throw new Error("bad public key size");var a=new Uint8Array(Dn+u.length),g=new Uint8Array(Dn+u.length),C;for(C=0;C<Dn;C++)a[C]=h[C];for(C=0;C<u.length;C++)a[C+Dn]=u[C];return Mt(g,a,a.length,d)>=0},e.sign.keyPair=function(){var u=new Uint8Array(ur),h=new Uint8Array(kr);return y(u,h),{publicKey:u,secretKey:h}},e.sign.keyPair.fromSecretKey=function(u){if(sn(u),u.length!==kr)throw new Error("bad secret key size");for(var h=new Uint8Array(ur),d=0;d<h.length;d++)h[d]=u[32+d];return{publicKey:h,secretKey:new Uint8Array(u)}},e.sign.keyPair.fromSeed=function(u){if(sn(u),u.length!==oi)throw new Error("bad seed size");for(var h=new Uint8Array(ur),d=new Uint8Array(kr),a=0;a<32;a++)d[a]=u[a];return y(h,d,!0),{publicKey:h,secretKey:d}},e.sign.publicKeyLength=ur,e.sign.secretKeyLength=kr,e.sign.seedLength=oi,e.sign.signatureLength=Dn,e.hash=function(u){sn(u);var h=new Uint8Array(ai);return st(h,u,u.length),h},e.hash.hashLength=ai,e.verify=function(u,h){return sn(u,h),u.length===0||h.length===0||u.length!==h.length?!1:_(u,0,h,0,u.length)===0},e.setPRNG=function(u){r=u},function(){var u=typeof self<"u"?self.crypto||self.msCrypto:null;if(u&&u.getRandomValues){var h=65536;e.setPRNG(function(d,a){var g,C=new Uint8Array(a);for(g=0;g<a;g+=h)u.getRandomValues(C.subarray(g,g+Math.min(a-g,h)));for(g=0;g<a;g++)d[g]=C[g];ia(C)})}else typeof fl<"u"&&(u=ul(),u&&u.randomBytes&&e.setPRNG(function(d,a){var g,C=u.randomBytes(a);for(g=0;g<a;g++)d[g]=C[g];ia(C)}))}()})(n.exports?n.exports:self.nacl=self.nacl||{})})($u);var Gy=$u.exports;const Fu=cs(Gy),dr=Fu.lowlevel;function Vy(n){let e;typeof n=="string"?e=mt.Buffer.from(n,"hex"):e=n;const t=new Uint8Array(64),r=[dr.gf(),dr.gf(),dr.gf(),dr.gf()],s=new Uint8Array([...new Uint8Array(e),...new Uint8Array(32)]),i=new Uint8Array(32);dr.crypto_hash(t,s,32),t[0]&=248,t[31]&=127,t[31]|=64,dr.scalarbase(r,t),dr.pack(i,r);for(let o=0;o<32;o+=1)s[o+32]=i[o];return{sk:mt.Buffer.from(s),pk:mt.Buffer.from(i)}}function Yy(n){return(e,t,r,s)=>e.method==="solana_chainId"?(t.result=n,s()):r()}function Zy(n){return(e,t,r,s)=>e.method==="solana_provider_config"?(t.result=n,s()):r()}function qu(n){const{chainId:e}=n;return ls([Yy(e),Zy(n)])}function Xy(n){const{rpcTarget:e}=n,t=ll({rpcTarget:e});return{networkMiddleware:ls([qu(n),t]),fetchMiddleware:t}}function Jy(n){let{getAccounts:e}=n;return Js(async(t,r,s)=>{const{method:i}=t;if(i!=="getAccounts")return s();if(!e)throw new Error("WalletMiddleware - opts.getAccounts not provided");const o=await e(t);r.result=o})}function Qy(n){let{requestAccounts:e}=n;return Js(async(t,r,s)=>{const{method:i}=t;if(i!=="requestAccounts")return s();if(!e)throw new Error("WalletMiddleware - opts.requestAccounts not provided");const o=await e(t);r.result=o})}function An(n,e){return Js(async(t,r,s)=>{const{method:i}=t;if(i!==n)return s();if(!e)throw new Error(`WalletMiddleware - ${n} not provided`);const o=await e(t);r.result=o})}function ta(n){const{getAccounts:e,requestAccounts:t,signTransaction:r,signAndSendTransaction:s,signAllTransactions:i,signMessage:o,getPrivateKey:c,getSecretKey:f}=n;return ls([Qy({requestAccounts:t}),Jy({getAccounts:e}),An("signTransaction",r),An("signAndSendTransaction",s),An("signAllTransactions",i),An("signMessage",o),An("solanaPrivateKey",c),An("private_key",c),An("solanaSecretKey",f)])}function eb(n){let{addNewChainConfig:e,switchSolanaChain:t}=n;return ls([An("addSolanaChain",e),An("switchSolanaChain",t)])}function tb(n){let{updatePrivatekey:e}=n;return ls([An("updateAccount",e)])}class na extends go{constructor(e){let{config:t,state:r}=e;super({config:{chainConfig:Ot(Ot({},t.chainConfig),{},{chainNamespace:Cs.SOLANA})},state:r})}async switchChain(e){throw Qt.unsupportedOperation("Chain switching is not supported by this adapter")}async setupProvider(e){const t=new dn,r=this.getProviderHandlers(e),s=ta(r);t.push(s);const i=qu(this.config.chainConfig);t.push(i);const o=this.getInjectedProviderProxy(e);o&&t.push(o);const c=To(t);this.updateProviderEngineProxy(c),await this.lookupNetwork()}async lookupNetwork(){const{chainConfig:e}=this.config;return this.update({chainId:e.chainId}),e.chainId||""}getInjectedProviderProxy(e){}}const ju=n=>({requestAccounts:async()=>n.publicKey?[vn.encode(n.publicKey.toBytes())]:[],getAccounts:async()=>n.publicKey?[vn.encode(n.publicKey.toBytes())]:[],getPrivateKey:async()=>{throw tt.rpcErrors.methodNotSupported()},getSecretKey:async()=>{throw tt.rpcErrors.methodNotSupported()},signTransaction:async t=>await n.signTransaction(t.params.message),signMessage:async t=>(await n.signMessage(t.params.message,t.params.display)).signature,signAllTransactions:async t=>{var r,s;if(!((r=t.params)!==null&&r!==void 0&&r.message)||!((s=t.params)!==null&&s!==void 0&&s.message.length))throw tt.rpcErrors.invalidParams("message");return await n.signAllTransactions(t.params.message)},signAndSendTransaction:async t=>({signature:(await n.signAndSendTransaction(t.params.message)).signature})});function Ku(n){return Js(async(e,t,r)=>{const s=await n.request(e);t.result=s})}class nb extends na{getProviderHandlers(e){return ju(e)}getInjectedProviderProxy(e){return Ku(e)}}const Hi=n=>n.version!==void 0||n instanceof Mr,rb=(n,e)=>({requestAccounts:async()=>{const{data:r}=await n.connect();return[r.publicKey]},getAccounts:async()=>{const{data:r}=await n.connect();return[r.publicKey]},getPrivateKey:async()=>{throw tt.rpcErrors.methodNotSupported()},getSecretKey:async()=>{throw tt.rpcErrors.methodNotSupported()},signTransaction:async r=>{const s=r.params.message;if(!s)throw tt.rpcErrors.invalidRequest({message:"Invalid transaction message"});const i=Hi(s)?s.message.serialize():s.serializeMessage(),{data:o}=await n.signTransaction(vn.encode(i));if(!o.publicKey||!o.signature)throw new Error("Invalid signature from slope wallet");const c=new Ne(o.publicKey),f=vn.decode(o.signature);return s.addSignature(c,mt.Buffer.from(f)),s},signMessage:async r=>{const s=await n.signMessage(r.params.message);return vn.decode(s.data.signature)},signAndSendTransaction:async r=>{const s=e();if(!s)throw tt.providerErrors.custom({message:"Provider is not initialized",code:4902});const i=r.params.message;if(!i)throw tt.rpcErrors.invalidRequest({message:"Invalid transaction message"});const o=Hi(i)?i.message.serialize():i.serializeMessage(),{data:c}=await n.signTransaction(vn.encode(o));if(!c.publicKey||!c.signature)throw new Error("Invalid signature from slope wallet");const f=new Ne(c.publicKey),l=vn.decode(c.signature);i.addSignature(f,mt.Buffer.from(l));const p=await s.request({method:"solana_provider_config"});return{signature:await new Mu(p.rpcTarget).sendRawTransaction(i.serialize())}},signAllTransactions:async r=>{var s,i,o;if(!((s=r.params)!==null&&s!==void 0&&s.message)||!((i=r.params)!==null&&i!==void 0&&i.message.length))throw tt.rpcErrors.invalidParams("message");const c=r.params.message,{length:f}=c,l=[];for(let E=0;E<f;E++){const b=c[E],_=Hi(b)?b.message.serialize():b.serializeMessage();l.push(vn.encode(_))}const{msg:p,data:x}=await n.signAllTransactions(l);if(!x.publicKey||((o=x.signatures)===null||o===void 0?void 0:o.length)!==f)throw new Error(p);const k=new Ne(x.publicKey);for(let E=0;E<f;E++){const b=vn.decode(x.signatures[E]);c[E].addSignature(k,mt.Buffer.from(b))}return c}});class sb extends na{getProviderHandlers(e){return rb(e,this.getProviderEngineProxy.bind(this))}}const ib=(n,e)=>{const t=ju(n);return t.signAndSendTransaction=async r=>{const s=e();if(!s)throw tt.providerErrors.custom({message:"Provider is not initialized",code:4902});const i=await n.signTransaction(r.params.message),o=await s.request({method:"solana_provider_config"});return{signature:await new Mu(o.rpcTarget).sendRawTransaction(i.serialize())}},t.signMessage=async r=>await n.signMessage(r.params.message,r.params.display),t};class ob extends na{getProviderHandlers(e){return ib(e,this.getProviderEngineProxy.bind(this))}}const ab=n=>({requestAccounts:async()=>await n.request({method:"solana_requestAccounts",params:{}}),getAccounts:async()=>await n.request({method:"solana_requestAccounts",params:{}}),getPrivateKey:async()=>{throw tt.rpcErrors.methodNotSupported()},getSecretKey:async()=>{throw tt.rpcErrors.methodNotSupported()},signMessage:async t=>{var r;if(!((r=t.params)!==null&&r!==void 0&&r.message))throw tt.rpcErrors.invalidParams("message");return await n.signMessage(t.params.message)},signTransaction:async t=>{var r;if(!((r=t.params)!==null&&r!==void 0&&r.message))throw tt.rpcErrors.invalidParams("message");const s=t.params.message;return await n.signTransaction(s)},signAndSendTransaction:async t=>{var r;if(!((r=t.params)!==null&&r!==void 0&&r.message))throw tt.rpcErrors.invalidParams("message");const s=t.params.message;return{signature:await n.sendTransaction(s)}},signAllTransactions:async t=>{var r,s;if(!((r=t.params)!==null&&r!==void 0&&r.message)||!((s=t.params)!==null&&s!==void 0&&s.message.length))throw tt.rpcErrors.invalidParams("message");const i=t.params.message;return await n.signAllTransactions(i)}});class cb extends go{constructor(e){let{config:t,state:r}=e;super({config:{chainConfig:Ot(Ot({},t.chainConfig),{},{chainNamespace:Cs.SOLANA})},state:r})}async switchChain(e){await this.provider.request({method:"switchSolanaChain",params:[{chainId:e.chainId}]})}async addChain(e){super.addChain(e),await this.provider.request({method:"addNewChainConfig",params:[{chainId:e.chainId,chainName:e.displayName,rpcUrls:[e.rpcTarget],blockExplorerUrls:[e.blockExplorer],nativeCurrency:{name:e.tickerName,symbol:e.ticker,decimals:e.decimals||18}}]})}async setupProvider(e){this.handleInjectedProviderUpdate(e),await this.setupEngine(e)}async lookupNetwork(){if(!this.provider)throw tt.providerErrors.custom({message:"Torus solana provider is not initialized",code:4902});const{chainId:e}=this.config.chainConfig,t=await this.provider.request({method:"solana_chainId"}),r=rc(t.toString())?t:`0x${parseInt(t,10).toString(16)}`;if(e!==r)throw Lt.rpcConnectionError(`Invalid network, net_version is: ${r}, expected: ${e}`);return this.update({chainId:r}),this.emit("connect",{chainId:this.state.chainId}),this.emit("chainChanged",this.state.chainId),this.state.chainId}async setupEngine(e){const t=ab(e),r=ta(t),s=Ku(e),i=new dn;i.push(r),i.push(s);const o=To(i);this.updateProviderEngineProxy(o),await this.lookupNetwork()}async handleInjectedProviderUpdate(e){e.on("accountsChanged",async t=>{this.emit("accountsChanged",t)}),e.on("chainChanged",async t=>{const r=rc(t)?t:`0x${parseInt(t,10).toString(16)}`;this.configure({chainConfig:Ot(Ot({},this.config.chainConfig),{},{chainId:r})}),await this.setupProvider(e)})}}async function fb(n){let{privKey:e,getProviderEngineProxy:t}=n;const r=()=>ts.fromSecretKey(mt.Buffer.from(e,"hex"));if(typeof e!="string")throw Lt.invalidParams("privKey must be a string");const s=r();return{requestAccounts:async()=>[s.publicKey.toBase58()],getAccounts:async()=>[s.publicKey.toBase58()],getPrivateKey:async()=>e,getSecretKey:async()=>vn.encode(s.secretKey),signTransaction:async o=>{var c;if(!((c=o.params)!==null&&c!==void 0&&c.message))throw tt.rpcErrors.invalidParams("message");const f=o.params.message;return f.version!==void 0||f instanceof Mr?f.sign([s]):f.partialSign(s),f},signMessage:async o=>{var c;if(!((c=o.params)!==null&&c!==void 0&&c.message))throw tt.rpcErrors.invalidParams("message");return Fu.sign.detached(o.params.message,s.secretKey)},signAndSendTransaction:async o=>{var c;if(!((c=o.params)!==null&&c!==void 0&&c.message))throw tt.rpcErrors.invalidParams("message");const f=t();if(!f)throw tt.providerErrors.custom({message:"Provider is not initialized",code:4902});const l=o.params.message;return l.version!==void 0||l instanceof Mr?l.sign([s]):l.partialSign(s),{signature:await f.request({method:"sendTransaction",params:[mt.Buffer.from(l.serialize()).toString("base64"),{encoding:"base64",preflightCommitment:"confirmed"}]})}},signAllTransactions:async o=>{var c,f,l;if(!((c=o.params)!==null&&c!==void 0&&c.message)||!((f=o.params)!==null&&f!==void 0&&f.message.length))throw tt.rpcErrors.invalidParams("message");const p=(l=o.params)===null||l===void 0?void 0:l.message;for(const x of p||[]){const k=x;k.version!==void 0||k instanceof Mr?k.sign([s]):k.partialSign(s)}return p}}}var Wu;class ra extends go{constructor(e){let{config:t,state:r}=e;super({config:{chainConfig:Ot(Ot({},t.chainConfig),{},{chainNamespace:Cs.SOLANA})},state:r})}async enable(){if(!this.state.privateKey)throw tt.providerErrors.custom({message:"Private key is not found in state, plz pass it in constructor state param",code:4902});return await this.setupProvider(this.state.privateKey),this._providerEngineProxy.request({method:"eth_accounts"})}getEd25519Key(e){return Vy(e).sk.toString("hex").padStart(128,"0")}async setupProvider(e){const t=await fb({privKey:e,getProviderEngineProxy:this.getProviderEngineProxy.bind(this)}),r=ta(t),s=new dn,{networkMiddleware:i}=Xy(this.config.chainConfig);s.push(this.getChainSwitchMiddleware()),s.push(this.getAccountMiddleware()),s.push(r),s.push(i);const o=To(s);this.updateProviderEngineProxy(o),await this.lookupNetwork()}async updateAccount(e){if(!this._providerEngineProxy)throw tt.providerErrors.custom({message:"Provider is not initialized",code:4902});await this._providerEngineProxy.request({method:"solanaPrivateKey"})!==e.privateKey&&(await this.setupProvider(e.privateKey),this.emit("accountsChanged",{accounts:await this._providerEngineProxy.request({method:"requestAccounts"})}))}async switchChain(e){if(!this._providerEngineProxy)throw tt.providerErrors.custom({message:"Provider is not initialized",code:4902});const t=this.getChainConfig(e.chainId);this.update({chainId:"loading"}),this.configure({chainConfig:t});const r=await this._providerEngineProxy.request({method:"solanaPrivateKey"});await this.setupProvider(r)}async lookupNetwork(){if(!this._providerEngineProxy)throw tt.providerErrors.custom({message:"Provider is not initialized",code:4902});const e=await this._providerEngineProxy.request({method:"getHealth",params:[]}),{chainConfig:t}=this.config;if(e!=="ok")throw Lt.rpcConnectionError(`Failed to lookup network for following rpc target: ${t.rpcTarget}`);return this.update({chainId:t.chainId}),this.state.chainId!==t.chainId&&(this.emit("chainChanged",this.state.chainId),this.emit("connect",{chainId:this.state.chainId})),this.state.chainId}getChainSwitchMiddleware(){return eb({addNewChainConfig:async r=>{if(!r.params)throw tt.rpcErrors.invalidParams("Missing request params");const{chainId:s,chainName:i,rpcUrls:o,blockExplorerUrls:c,nativeCurrency:f}=r.params;if(!s)throw tt.rpcErrors.invalidParams("Missing chainId in chainParams");if(!o||o.length===0)throw tt.rpcErrors.invalidParams("Missing rpcUrls in chainParams");if(!f)throw tt.rpcErrors.invalidParams("Missing nativeCurrency in chainParams");this.addChain({chainNamespace:Cs.SOLANA,chainId:s,ticker:(f==null?void 0:f.symbol)||"SOL",tickerName:(f==null?void 0:f.name)||"Solana",displayName:i,rpcTarget:o[0],blockExplorer:(c==null?void 0:c[0])||"",decimals:(f==null?void 0:f.decimals)||9})},switchSolanaChain:async r=>{if(!r.params)throw tt.rpcErrors.invalidParams("Missing request params");if(!r.params.chainId)throw tt.rpcErrors.invalidParams("Missing chainId");await this.switchChain(r.params)}})}getAccountMiddleware(){return tb({updatePrivatekey:async t=>{if(!t.params)throw tt.rpcErrors.invalidParams("Missing request params");if(!t.params.privateKey)throw tt.rpcErrors.invalidParams("Missing privateKey");const{privateKey:r}=t.params;await this.updateAccount({privateKey:r})}})}}Wu=ra;Zt(ra,"getProviderInstance",async n=>{const e=new Wu({config:{chainConfig:n.chainConfig}});return await e.setupProvider(n.privKey),e});class ub{constructor(e){Zt(this,"provider",void 0),this.provider=e}async requestAccounts(){return await this.provider.request({method:"requestAccounts"})}async signAndSendTransaction(e){const{signature:t}=await this.provider.request({method:"signAndSendTransaction",params:{message:e}});return{signature:t}}async signTransaction(e){return await this.provider.request({method:"signTransaction",params:{message:e}})}async signAllTransactions(e){return await this.provider.request({method:"signAllTransactions",params:{message:e}})}async signMessage(e){return await this.provider.request({method:"signMessage",params:{message:e}})}async request(e){return await this.provider.request(e)}}const bb=Object.freeze(Object.defineProperty({__proto__:null,PhantomInjectedProvider:nb,SlopeInjectedProxyProvider:sb,SolanaPrivateKeyProvider:ra,SolanaWallet:ub,SolflareInjectedProvider:ob,TorusInjectedProvider:cb},Symbol.toStringTag,{value:"Module"}));export{Ne as P,cb as T,nb as a,bb as s};
