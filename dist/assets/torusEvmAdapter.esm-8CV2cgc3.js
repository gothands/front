import{l as wn,a as aa,_ as J,m as sa,b as we,c as Se,e as mt,s as la,r as Mt,d as M,f as nt,o as qs,g as Ei,p as vr,h as Ys,i as Xs,T as zs,j as Zs,C as Js}from"./index-L3ozMu8u.js";import{d as Qs}from"./index-mW-rGalf.js";import{B as el}from"./baseEvmAdapter.esm-bhfdtaJk.js";function tl(e,t){if(e==null)return{};var n={},r=Object.keys(e),o,s;for(s=0;s<r.length;s++)o=r[s],!(t.indexOf(o)>=0)&&(n[o]=e[o]);return n}function nl(e,t){if(e==null)return{};var n=tl(e,t),r,o;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(o=0;o<s.length;o++)r=s[o],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}const Cr=wn.getLogger("http-helpers");Cr.setLevel(aa.levels.INFO);let $r="torus-default";const rl="x-api-key";function il(e){$r=e}async function ol(e,t){let n=null;try{n=new URL(e)}catch{}return fetch(e,t)}function al(){const e={};return $r&&(e[rl]=$r),e}function sl(e){Cr.info(`Response: ${e.status} ${e.statusText}`),Cr.info(`Url: ${e.url}`)}const da=async function(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const r={mode:"cors",headers:{}};n.useAPIKey&&(r.headers=J(J({},r.headers),al()));const o=sa(r,t,{method:"GET"}),s=await ol(e,o);if(s.ok){const l=s.headers.get("content-type");return l!=null&&l.includes("application/json")?s.json():s.text()}throw sl(s),s};var ua={exports:{}},Gn={exports:{}},le={ArrayIsArray(e){return Array.isArray(e)},ArrayPrototypeIncludes(e,t){return e.includes(t)},ArrayPrototypeIndexOf(e,t){return e.indexOf(t)},ArrayPrototypeJoin(e,t){return e.join(t)},ArrayPrototypeMap(e,t){return e.map(t)},ArrayPrototypePop(e,t){return e.pop(t)},ArrayPrototypePush(e,t){return e.push(t)},ArrayPrototypeSlice(e,t,n){return e.slice(t,n)},Error,FunctionPrototypeCall(e,t,...n){return e.call(t,...n)},FunctionPrototypeSymbolHasInstance(e,t){return Function.prototype[Symbol.hasInstance].call(e,t)},MathFloor:Math.floor,Number,NumberIsInteger:Number.isInteger,NumberIsNaN:Number.isNaN,NumberMAX_SAFE_INTEGER:Number.MAX_SAFE_INTEGER,NumberMIN_SAFE_INTEGER:Number.MIN_SAFE_INTEGER,NumberParseInt:Number.parseInt,ObjectDefineProperties(e,t){return Object.defineProperties(e,t)},ObjectDefineProperty(e,t,n){return Object.defineProperty(e,t,n)},ObjectGetOwnPropertyDescriptor(e,t){return Object.getOwnPropertyDescriptor(e,t)},ObjectKeys(e){return Object.keys(e)},ObjectSetPrototypeOf(e,t){return Object.setPrototypeOf(e,t)},Promise,PromisePrototypeCatch(e,t){return e.catch(t)},PromisePrototypeThen(e,t,n){return e.then(t,n)},PromiseReject(e){return Promise.reject(e)},ReflectApply:Reflect.apply,RegExpPrototypeTest(e,t){return e.test(t)},SafeSet:Set,String,StringPrototypeSlice(e,t,n){return e.slice(t,n)},StringPrototypeToLowerCase(e){return e.toLowerCase()},StringPrototypeToUpperCase(e){return e.toUpperCase()},StringPrototypeTrim(e){return e.trim()},Symbol,SymbolFor:Symbol.for,SymbolAsyncIterator:Symbol.asyncIterator,SymbolHasInstance:Symbol.hasInstance,SymbolIterator:Symbol.iterator,TypedArrayPrototypeSet(e,t,n){return e.set(t,n)},Uint8Array},fa={exports:{}};(function(e){const t=we,n=Object.getPrototypeOf(async function(){}).constructor,r=globalThis.Blob||t.Blob,o=typeof r<"u"?function(h){return h instanceof r}:function(h){return!1};class s extends Error{constructor(h){if(!Array.isArray(h))throw new TypeError(`Expected input to be an Array, got ${typeof h}`);let b="";for(let f=0;f<h.length;f++)b+=`    ${h[f].stack}
`;super(b),this.name="AggregateError",this.errors=h}}e.exports={AggregateError:s,kEmptyObject:Object.freeze({}),once(l){let h=!1;return function(...b){h||(h=!0,l.apply(this,b))}},createDeferredPromise:function(){let l,h;return{promise:new Promise((f,c)=>{l=f,h=c}),resolve:l,reject:h}},promisify(l){return new Promise((h,b)=>{l((f,...c)=>f?b(f):h(...c))})},debuglog(){return function(){}},format(l,...h){return l.replace(/%([sdifj])/g,function(...[b,f]){const c=h.shift();return f==="f"?c.toFixed(6):f==="j"?JSON.stringify(c):f==="s"&&typeof c=="object"?`${c.constructor!==Object?c.constructor.name:""} {}`.trim():c.toString()})},inspect(l){switch(typeof l){case"string":if(l.includes("'"))if(l.includes('"')){if(!l.includes("`")&&!l.includes("${"))return`\`${l}\``}else return`"${l}"`;return`'${l}'`;case"number":return isNaN(l)?"NaN":Object.is(l,-0)?String(l):l;case"bigint":return`${String(l)}n`;case"boolean":case"undefined":return String(l);case"object":return"{}"}},types:{isAsyncFunction(l){return l instanceof n},isArrayBufferView(l){return ArrayBuffer.isView(l)}},isBlob:o},e.exports.promisify.custom=Symbol.for("nodejs.util.promisify.custom")})(fa);var ze=fa.exports,Zr={};const{format:ll,inspect:cn,AggregateError:dl}=ze,ul=globalThis.AggregateError||dl,fl=Symbol("kIsNodeError"),cl=["string","function","number","object","Function","Object","boolean","bigint","symbol"],hl=/^([A-Z][a-z0-9]*)+$/,bl="__node_internal_",Sn={};function yt(e,t){if(!e)throw new Sn.ERR_INTERNAL_ASSERTION(t)}function Ri(e){let t="",n=e.length;const r=e[0]==="-"?1:0;for(;n>=r+4;n-=3)t=`_${e.slice(n-3,n)}${t}`;return`${e.slice(0,n)}${t}`}function pl(e,t,n){if(typeof t=="function")return yt(t.length<=n.length,`Code: ${e}; The provided arguments length (${n.length}) does not match the required ones (${t.length}).`),t(...n);const r=(t.match(/%[dfijoOs]/g)||[]).length;return yt(r===n.length,`Code: ${e}; The provided arguments length (${n.length}) does not match the required ones (${r}).`),n.length===0?t:ll(t,...n)}function fe(e,t,n){n||(n=Error);class r extends n{constructor(...s){super(pl(e,t,s))}toString(){return`${this.name} [${e}]: ${this.message}`}}Object.defineProperties(r.prototype,{name:{value:n.name,writable:!0,enumerable:!1,configurable:!0},toString:{value(){return`${this.name} [${e}]: ${this.message}`},writable:!0,enumerable:!1,configurable:!0}}),r.prototype.code=e,r.prototype[fl]=!0,Sn[e]=r}function Ai(e){const t=bl+e.name;return Object.defineProperty(e,"name",{value:t}),e}function gl(e,t){if(e&&t&&e!==t){if(Array.isArray(t.errors))return t.errors.push(e),t;const n=new ul([t,e],t.message);return n.code=t.code,n}return e||t}let yl=class extends Error{constructor(t="The operation was aborted",n=void 0){if(n!==void 0&&typeof n!="object")throw new Sn.ERR_INVALID_ARG_TYPE("options","Object",n);super(t,n),this.code="ABORT_ERR",this.name="AbortError"}};fe("ERR_ASSERTION","%s",Error);fe("ERR_INVALID_ARG_TYPE",(e,t,n)=>{yt(typeof e=="string","'name' must be a string"),Array.isArray(t)||(t=[t]);let r="The ";e.endsWith(" argument")?r+=`${e} `:r+=`"${e}" ${e.includes(".")?"property":"argument"} `,r+="must be ";const o=[],s=[],l=[];for(const b of t)yt(typeof b=="string","All expected entries have to be of type string"),cl.includes(b)?o.push(b.toLowerCase()):hl.test(b)?s.push(b):(yt(b!=="object",'The value "object" should be written as "Object"'),l.push(b));if(s.length>0){const b=o.indexOf("object");b!==-1&&(o.splice(o,b,1),s.push("Object"))}if(o.length>0){switch(o.length){case 1:r+=`of type ${o[0]}`;break;case 2:r+=`one of type ${o[0]} or ${o[1]}`;break;default:{const b=o.pop();r+=`one of type ${o.join(", ")}, or ${b}`}}(s.length>0||l.length>0)&&(r+=" or ")}if(s.length>0){switch(s.length){case 1:r+=`an instance of ${s[0]}`;break;case 2:r+=`an instance of ${s[0]} or ${s[1]}`;break;default:{const b=s.pop();r+=`an instance of ${s.join(", ")}, or ${b}`}}l.length>0&&(r+=" or ")}switch(l.length){case 0:break;case 1:l[0].toLowerCase()!==l[0]&&(r+="an "),r+=`${l[0]}`;break;case 2:r+=`one of ${l[0]} or ${l[1]}`;break;default:{const b=l.pop();r+=`one of ${l.join(", ")}, or ${b}`}}if(n==null)r+=`. Received ${n}`;else if(typeof n=="function"&&n.name)r+=`. Received function ${n.name}`;else if(typeof n=="object"){var h;if((h=n.constructor)!==null&&h!==void 0&&h.name)r+=`. Received an instance of ${n.constructor.name}`;else{const b=cn(n,{depth:-1});r+=`. Received ${b}`}}else{let b=cn(n,{colors:!1});b.length>25&&(b=`${b.slice(0,25)}...`),r+=`. Received type ${typeof n} (${b})`}return r},TypeError);fe("ERR_INVALID_ARG_VALUE",(e,t,n="is invalid")=>{let r=cn(t);return r.length>128&&(r=r.slice(0,128)+"..."),`The ${e.includes(".")?"property":"argument"} '${e}' ${n}. Received ${r}`},TypeError);fe("ERR_INVALID_RETURN_VALUE",(e,t,n)=>{var r;const o=n!=null&&(r=n.constructor)!==null&&r!==void 0&&r.name?`instance of ${n.constructor.name}`:`type ${typeof n}`;return`Expected ${e} to be returned from the "${t}" function but got ${o}.`},TypeError);fe("ERR_MISSING_ARGS",(...e)=>{yt(e.length>0,"At least one arg needs to be specified");let t;const n=e.length;switch(e=(Array.isArray(e)?e:[e]).map(r=>`"${r}"`).join(" or "),n){case 1:t+=`The ${e[0]} argument`;break;case 2:t+=`The ${e[0]} and ${e[1]} arguments`;break;default:{const r=e.pop();t+=`The ${e.join(", ")}, and ${r} arguments`}break}return`${t} must be specified`},TypeError);fe("ERR_OUT_OF_RANGE",(e,t,n)=>{yt(t,'Missing "range" argument');let r;return Number.isInteger(n)&&Math.abs(n)>2**32?r=Ri(String(n)):typeof n=="bigint"?(r=String(n),(n>2n**32n||n<-(2n**32n))&&(r=Ri(r)),r+="n"):r=cn(n),`The value of "${e}" is out of range. It must be ${t}. Received ${r}`},RangeError);fe("ERR_MULTIPLE_CALLBACK","Callback called multiple times",Error);fe("ERR_METHOD_NOT_IMPLEMENTED","The %s method is not implemented",Error);fe("ERR_STREAM_ALREADY_FINISHED","Cannot call %s after a stream was finished",Error);fe("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable",Error);fe("ERR_STREAM_DESTROYED","Cannot call %s after a stream was destroyed",Error);fe("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError);fe("ERR_STREAM_PREMATURE_CLOSE","Premature close",Error);fe("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF",Error);fe("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event",Error);fe("ERR_STREAM_WRITE_AFTER_END","write after end",Error);fe("ERR_UNKNOWN_ENCODING","Unknown encoding: %s",TypeError);var me={AbortError:yl,aggregateTwoErrors:Ai(gl),hideStackFrames:Ai,codes:Sn};const{ArrayIsArray:Jr,ArrayPrototypeIncludes:ca,ArrayPrototypeJoin:ha,ArrayPrototypeMap:_l,NumberIsInteger:Qr,NumberIsNaN:wl,NumberMAX_SAFE_INTEGER:Sl,NumberMIN_SAFE_INTEGER:ml,NumberParseInt:El,ObjectPrototypeHasOwnProperty:Rl,RegExpPrototypeExec:ba,String:Al,StringPrototypeToUpperCase:Tl,StringPrototypeTrim:Il}=le,{hideStackFrames:ve,codes:{ERR_SOCKET_BAD_PORT:Nl,ERR_INVALID_ARG_TYPE:ye,ERR_INVALID_ARG_VALUE:Dt,ERR_OUT_OF_RANGE:wt,ERR_UNKNOWN_SIGNAL:Ti}}=me,{normalizeEncoding:vl}=ze,{isAsyncFunction:Cl,isArrayBufferView:$l}=ze.types,Ii={};function Ml(e){return e===(e|0)}function Dl(e){return e===e>>>0}const Pl=/^[0-7]+$/,Ol="must be a 32-bit unsigned integer or an octal string";function Ll(e,t,n){if(typeof e>"u"&&(e=n),typeof e=="string"){if(ba(Pl,e)===null)throw new Dt(t,e,Ol);e=El(e,8)}return pa(e,t),e}const kl=ve((e,t,n=ml,r=Sl)=>{if(typeof e!="number")throw new ye(t,"number",e);if(!Qr(e))throw new wt(t,"an integer",e);if(e<n||e>r)throw new wt(t,`>= ${n} && <= ${r}`,e)}),xl=ve((e,t,n=-2147483648,r=2147483647)=>{if(typeof e!="number")throw new ye(t,"number",e);if(!Qr(e))throw new wt(t,"an integer",e);if(e<n||e>r)throw new wt(t,`>= ${n} && <= ${r}`,e)}),pa=ve((e,t,n=!1)=>{if(typeof e!="number")throw new ye(t,"number",e);if(!Qr(e))throw new wt(t,"an integer",e);const r=n?1:0,o=4294967295;if(e<r||e>o)throw new wt(t,`>= ${r} && <= ${o}`,e)});function ei(e,t){if(typeof e!="string")throw new ye(t,"string",e)}function Wl(e,t,n=void 0,r){if(typeof e!="number")throw new ye(t,"number",e);if(n!=null&&e<n||r!=null&&e>r||(n!=null||r!=null)&&wl(e))throw new wt(t,`${n!=null?`>= ${n}`:""}${n!=null&&r!=null?" && ":""}${r!=null?`<= ${r}`:""}`,e)}const Ul=ve((e,t,n)=>{if(!ca(n,e)){const o="must be one of: "+ha(_l(n,s=>typeof s=="string"?`'${s}'`:Al(s)),", ");throw new Dt(t,e,o)}});function ga(e,t){if(typeof e!="boolean")throw new ye(t,"boolean",e)}function Kn(e,t,n){return e==null||!Rl(e,t)?n:e[t]}const Bl=ve((e,t,n=null)=>{const r=Kn(n,"allowArray",!1),o=Kn(n,"allowFunction",!1);if(!Kn(n,"nullable",!1)&&e===null||!r&&Jr(e)||typeof e!="object"&&(!o||typeof e!="function"))throw new ye(t,"Object",e)}),Fl=ve((e,t)=>{if(e!=null&&typeof e!="object"&&typeof e!="function")throw new ye(t,"a dictionary",e)}),ti=ve((e,t,n=0)=>{if(!Jr(e))throw new ye(t,"Array",e);if(e.length<n){const r=`must be longer than ${n}`;throw new Dt(t,e,r)}});function jl(e,t){ti(e,t);for(let n=0;n<e.length;n++)ei(e[n],`${t}[${n}]`)}function Hl(e,t){ti(e,t);for(let n=0;n<e.length;n++)ga(e[n],`${t}[${n}]`)}function Vl(e,t="signal"){if(ei(e,t),Ii[e]===void 0)throw Ii[Tl(e)]!==void 0?new Ti(e+" (signals must use all capital letters)"):new Ti(e)}const Gl=ve((e,t="buffer")=>{if(!$l(e))throw new ye(t,["Buffer","TypedArray","DataView"],e)});function Kl(e,t){const n=vl(t),r=e.length;if(n==="hex"&&r%2!==0)throw new Dt("encoding",t,`is invalid for data of length ${r}`)}function ql(e,t="Port",n=!0){if(typeof e!="number"&&typeof e!="string"||typeof e=="string"&&Il(e).length===0||+e!==+e>>>0||e>65535||e===0&&!n)throw new Nl(t,e,n);return e|0}const Yl=ve((e,t)=>{if(e!==void 0&&(e===null||typeof e!="object"||!("aborted"in e)))throw new ye(t,"AbortSignal",e)}),Xl=ve((e,t)=>{if(typeof e!="function")throw new ye(t,"Function",e)}),zl=ve((e,t)=>{if(typeof e!="function"||Cl(e))throw new ye(t,"Function",e)}),Zl=ve((e,t)=>{if(e!==void 0)throw new ye(t,"undefined",e)});function Jl(e,t,n){if(!ca(n,e))throw new ye(t,`('${ha(n,"|")}')`,e)}const Ql=/^(?:<[^>]*>)(?:\s*;\s*[^;"\s]+(?:=(")?[^;"\s]*\1)?)*$/;function Ni(e,t){if(typeof e>"u"||!ba(Ql,e))throw new Dt(t,e,'must be an array or string of format "</styles.css>; rel=preload; as=style"')}function ed(e){if(typeof e=="string")return Ni(e,"hints"),e;if(Jr(e)){const t=e.length;let n="";if(t===0)return n;for(let r=0;r<t;r++){const o=e[r];Ni(o,"hints"),n+=o,r!==t-1&&(n+=", ")}return n}throw new Dt("hints",e,'must be an array or string of format "</styles.css>; rel=preload; as=style"')}var mn={isInt32:Ml,isUint32:Dl,parseFileMode:Ll,validateArray:ti,validateStringArray:jl,validateBooleanArray:Hl,validateBoolean:ga,validateBuffer:Gl,validateDictionary:Fl,validateEncoding:Kl,validateFunction:Xl,validateInt32:xl,validateInteger:kl,validateNumber:Wl,validateObject:Bl,validateOneOf:Ul,validatePlainFunction:zl,validatePort:ql,validateSignalName:Vl,validateString:ei,validateUint32:pa,validateUndefined:Zl,validateUnion:Jl,validateAbortSignal:Yl,validateLinkHeaderValue:ed},ni={exports:{}};const{Symbol:En,SymbolAsyncIterator:vi,SymbolIterator:Ci,SymbolFor:ya}=le,_a=En("kDestroyed"),wa=En("kIsErrored"),Mr=En("kIsReadable"),Sa=En("kIsDisturbed"),td=ya("nodejs.webstream.isClosedPromise"),nd=ya("nodejs.webstream.controllerErrorFunction");function Rn(e,t=!1){var n;return!!(e&&typeof e.pipe=="function"&&typeof e.on=="function"&&(!t||typeof e.pause=="function"&&typeof e.resume=="function")&&(!e._writableState||((n=e._readableState)===null||n===void 0?void 0:n.readable)!==!1)&&(!e._writableState||e._readableState))}function An(e){var t;return!!(e&&typeof e.write=="function"&&typeof e.on=="function"&&(!e._readableState||((t=e._writableState)===null||t===void 0?void 0:t.writable)!==!1))}function rd(e){return!!(e&&typeof e.pipe=="function"&&e._readableState&&typeof e.on=="function"&&typeof e.write=="function")}function He(e){return e&&(e._readableState||e._writableState||typeof e.write=="function"&&typeof e.on=="function"||typeof e.pipe=="function"&&typeof e.on=="function")}function ma(e){return!!(e&&!He(e)&&typeof e.pipeThrough=="function"&&typeof e.getReader=="function"&&typeof e.cancel=="function")}function Ea(e){return!!(e&&!He(e)&&typeof e.getWriter=="function"&&typeof e.abort=="function")}function Ra(e){return!!(e&&!He(e)&&typeof e.readable=="object"&&typeof e.writable=="object")}function id(e){return ma(e)||Ea(e)||Ra(e)}function od(e,t){return e==null?!1:t===!0?typeof e[vi]=="function":t===!1?typeof e[Ci]=="function":typeof e[vi]=="function"||typeof e[Ci]=="function"}function Tn(e){if(!He(e))return null;const t=e._writableState,n=e._readableState,r=t||n;return!!(e.destroyed||e[_a]||r!=null&&r.destroyed)}function Aa(e){if(!An(e))return null;if(e.writableEnded===!0)return!0;const t=e._writableState;return t!=null&&t.errored?!1:typeof(t==null?void 0:t.ended)!="boolean"?null:t.ended}function ad(e,t){if(!An(e))return null;if(e.writableFinished===!0)return!0;const n=e._writableState;return n!=null&&n.errored?!1:typeof(n==null?void 0:n.finished)!="boolean"?null:!!(n.finished||t===!1&&n.ended===!0&&n.length===0)}function sd(e){if(!Rn(e))return null;if(e.readableEnded===!0)return!0;const t=e._readableState;return!t||t.errored?!1:typeof(t==null?void 0:t.ended)!="boolean"?null:t.ended}function Ta(e,t){if(!Rn(e))return null;const n=e._readableState;return n!=null&&n.errored?!1:typeof(n==null?void 0:n.endEmitted)!="boolean"?null:!!(n.endEmitted||t===!1&&n.ended===!0&&n.length===0)}function Ia(e){return e&&e[Mr]!=null?e[Mr]:typeof(e==null?void 0:e.readable)!="boolean"?null:Tn(e)?!1:Rn(e)&&e.readable&&!Ta(e)}function Na(e){return typeof(e==null?void 0:e.writable)!="boolean"?null:Tn(e)?!1:An(e)&&e.writable&&!Aa(e)}function ld(e,t){return He(e)?Tn(e)?!0:!((t==null?void 0:t.readable)!==!1&&Ia(e)||(t==null?void 0:t.writable)!==!1&&Na(e)):null}function dd(e){var t,n;return He(e)?e.writableErrored?e.writableErrored:(t=(n=e._writableState)===null||n===void 0?void 0:n.errored)!==null&&t!==void 0?t:null:null}function ud(e){var t,n;return He(e)?e.readableErrored?e.readableErrored:(t=(n=e._readableState)===null||n===void 0?void 0:n.errored)!==null&&t!==void 0?t:null:null}function fd(e){if(!He(e))return null;if(typeof e.closed=="boolean")return e.closed;const t=e._writableState,n=e._readableState;return typeof(t==null?void 0:t.closed)=="boolean"||typeof(n==null?void 0:n.closed)=="boolean"?(t==null?void 0:t.closed)||(n==null?void 0:n.closed):typeof e._closed=="boolean"&&va(e)?e._closed:null}function va(e){return typeof e._closed=="boolean"&&typeof e._defaultKeepAlive=="boolean"&&typeof e._removedConnection=="boolean"&&typeof e._removedContLen=="boolean"}function Ca(e){return typeof e._sent100=="boolean"&&va(e)}function cd(e){var t;return typeof e._consuming=="boolean"&&typeof e._dumped=="boolean"&&((t=e.req)===null||t===void 0?void 0:t.upgradeOrConnect)===void 0}function hd(e){if(!He(e))return null;const t=e._writableState,n=e._readableState,r=t||n;return!r&&Ca(e)||!!(r&&r.autoDestroy&&r.emitClose&&r.closed===!1)}function bd(e){var t;return!!(e&&((t=e[Sa])!==null&&t!==void 0?t:e.readableDidRead||e.readableAborted))}function pd(e){var t,n,r,o,s,l,h,b,f,c;return!!(e&&((t=(n=(r=(o=(s=(l=e[wa])!==null&&l!==void 0?l:e.readableErrored)!==null&&s!==void 0?s:e.writableErrored)!==null&&o!==void 0?o:(h=e._readableState)===null||h===void 0?void 0:h.errorEmitted)!==null&&r!==void 0?r:(b=e._writableState)===null||b===void 0?void 0:b.errorEmitted)!==null&&n!==void 0?n:(f=e._readableState)===null||f===void 0?void 0:f.errored)!==null&&t!==void 0?t:!((c=e._writableState)===null||c===void 0)&&c.errored))}var Ze={kDestroyed:_a,isDisturbed:bd,kIsDisturbed:Sa,isErrored:pd,kIsErrored:wa,isReadable:Ia,kIsReadable:Mr,kIsClosedPromise:td,kControllerErrorFunction:nd,isClosed:fd,isDestroyed:Tn,isDuplexNodeStream:rd,isFinished:ld,isIterable:od,isReadableNodeStream:Rn,isReadableStream:ma,isReadableEnded:sd,isReadableFinished:Ta,isReadableErrored:ud,isNodeStream:He,isWebStream:id,isWritable:Na,isWritableNodeStream:An,isWritableStream:Ea,isWritableEnded:Aa,isWritableFinished:ad,isWritableErrored:dd,isServerRequest:cd,isServerResponse:Ca,willEmitClose:hd,isTransformStream:Ra};const et=Se,{AbortError:$a,codes:gd}=me,{ERR_INVALID_ARG_TYPE:yd,ERR_STREAM_PREMATURE_CLOSE:$i}=gd,{kEmptyObject:Dr,once:Pr}=ze,{validateAbortSignal:_d,validateFunction:wd,validateObject:Sd,validateBoolean:md}=mn,{Promise:Ed,PromisePrototypeThen:Rd}=le,{isClosed:Ad,isReadable:Mi,isReadableNodeStream:qn,isReadableStream:Td,isReadableFinished:Di,isReadableErrored:Pi,isWritable:Oi,isWritableNodeStream:Li,isWritableStream:Id,isWritableFinished:ki,isWritableErrored:xi,isNodeStream:Nd,willEmitClose:vd,kIsClosedPromise:Cd}=Ze;function $d(e){return e.setHeader&&typeof e.abort=="function"}const Or=()=>{};function Ma(e,t,n){var r,o;if(arguments.length===2?(n=t,t=Dr):t==null?t=Dr:Sd(t,"options"),wd(n,"callback"),_d(t.signal,"options.signal"),n=Pr(n),Td(e)||Id(e))return Md(e,t,n);if(!Nd(e))throw new yd("stream",["ReadableStream","WritableStream","Stream"],e);const s=(r=t.readable)!==null&&r!==void 0?r:qn(e),l=(o=t.writable)!==null&&o!==void 0?o:Li(e),h=e._writableState,b=e._readableState,f=()=>{e.writable||A()};let c=vd(e)&&qn(e)===s&&Li(e)===l,R=ki(e,!1);const A=()=>{R=!0,e.destroyed&&(c=!1),!(c&&(!e.readable||s))&&(!s||y)&&n.call(e)};let y=Di(e,!1);const p=()=>{y=!0,e.destroyed&&(c=!1),!(c&&(!e.writable||l))&&(!l||R)&&n.call(e)},P=D=>{n.call(e,D)};let $=Ad(e);const I=()=>{$=!0;const D=xi(e)||Pi(e);if(D&&typeof D!="boolean")return n.call(e,D);if(s&&!y&&qn(e,!0)&&!Di(e,!1))return n.call(e,new $i);if(l&&!R&&!ki(e,!1))return n.call(e,new $i);n.call(e)},_=()=>{$=!0;const D=xi(e)||Pi(e);if(D&&typeof D!="boolean")return n.call(e,D);n.call(e)},L=()=>{e.req.on("finish",A)};$d(e)?(e.on("complete",A),c||e.on("abort",I),e.req?L():e.on("request",L)):l&&!h&&(e.on("end",f),e.on("close",f)),!c&&typeof e.aborted=="boolean"&&e.on("aborted",I),e.on("end",p),e.on("finish",A),t.error!==!1&&e.on("error",P),e.on("close",I),$?et.nextTick(I):h!=null&&h.errorEmitted||b!=null&&b.errorEmitted?c||et.nextTick(_):(!s&&(!c||Mi(e))&&(R||Oi(e)===!1)||!l&&(!c||Oi(e))&&(y||Mi(e)===!1)||b&&e.req&&e.aborted)&&et.nextTick(_);const F=()=>{n=Or,e.removeListener("aborted",I),e.removeListener("complete",A),e.removeListener("abort",I),e.removeListener("request",L),e.req&&e.req.removeListener("finish",A),e.removeListener("end",f),e.removeListener("close",f),e.removeListener("finish",A),e.removeListener("end",p),e.removeListener("error",P),e.removeListener("close",I)};if(t.signal&&!$){const D=()=>{const K=n;F(),K.call(e,new $a(void 0,{cause:t.signal.reason}))};if(t.signal.aborted)et.nextTick(D);else{const K=n;n=Pr((...j)=>{t.signal.removeEventListener("abort",D),K.apply(e,j)}),t.signal.addEventListener("abort",D)}}return F}function Md(e,t,n){let r=!1,o=Or;if(t.signal)if(o=()=>{r=!0,n.call(e,new $a(void 0,{cause:t.signal.reason}))},t.signal.aborted)et.nextTick(o);else{const l=n;n=Pr((...h)=>{t.signal.removeEventListener("abort",o),l.apply(e,h)}),t.signal.addEventListener("abort",o)}const s=(...l)=>{r||et.nextTick(()=>n.apply(e,l))};return Rd(e[Cd].promise,s,s),Or}function Dd(e,t){var n;let r=!1;return t===null&&(t=Dr),(n=t)!==null&&n!==void 0&&n.cleanup&&(md(t.cleanup,"cleanup"),r=t.cleanup),new Ed((o,s)=>{const l=Ma(e,t,h=>{r&&l(),h?s(h):o()})})}ni.exports=Ma;ni.exports.finished=Dd;var rt=ni.exports;const Ue=Se,{aggregateTwoErrors:Pd,codes:{ERR_MULTIPLE_CALLBACK:Od},AbortError:Ld}=me,{Symbol:Da}=le,{kDestroyed:kd,isDestroyed:xd,isFinished:Wd,isServerRequest:Ud}=Ze,Pa=Da("kDestroy"),Lr=Da("kConstruct");function Oa(e,t,n){e&&(e.stack,t&&!t.errored&&(t.errored=e),n&&!n.errored&&(n.errored=e))}function Bd(e,t){const n=this._readableState,r=this._writableState,o=r||n;return r!=null&&r.destroyed||n!=null&&n.destroyed?(typeof t=="function"&&t(),this):(Oa(e,r,n),r&&(r.destroyed=!0),n&&(n.destroyed=!0),o.constructed?Wi(this,e,t):this.once(Pa,function(s){Wi(this,Pd(s,e),t)}),this)}function Wi(e,t,n){let r=!1;function o(s){if(r)return;r=!0;const l=e._readableState,h=e._writableState;Oa(s,h,l),h&&(h.closed=!0),l&&(l.closed=!0),typeof n=="function"&&n(s),s?Ue.nextTick(Fd,e,s):Ue.nextTick(La,e)}try{e._destroy(t||null,o)}catch(s){o(s)}}function Fd(e,t){kr(e,t),La(e)}function La(e){const t=e._readableState,n=e._writableState;n&&(n.closeEmitted=!0),t&&(t.closeEmitted=!0),(n!=null&&n.emitClose||t!=null&&t.emitClose)&&e.emit("close")}function kr(e,t){const n=e._readableState,r=e._writableState;r!=null&&r.errorEmitted||n!=null&&n.errorEmitted||(r&&(r.errorEmitted=!0),n&&(n.errorEmitted=!0),e.emit("error",t))}function jd(){const e=this._readableState,t=this._writableState;e&&(e.constructed=!0,e.closed=!1,e.closeEmitted=!1,e.destroyed=!1,e.errored=null,e.errorEmitted=!1,e.reading=!1,e.ended=e.readable===!1,e.endEmitted=e.readable===!1),t&&(t.constructed=!0,t.destroyed=!1,t.closed=!1,t.closeEmitted=!1,t.errored=null,t.errorEmitted=!1,t.finalCalled=!1,t.prefinished=!1,t.ended=t.writable===!1,t.ending=t.writable===!1,t.finished=t.writable===!1)}function xr(e,t,n){const r=e._readableState,o=e._writableState;if(o!=null&&o.destroyed||r!=null&&r.destroyed)return this;r!=null&&r.autoDestroy||o!=null&&o.autoDestroy?e.destroy(t):t&&(t.stack,o&&!o.errored&&(o.errored=t),r&&!r.errored&&(r.errored=t),n?Ue.nextTick(kr,e,t):kr(e,t))}function Hd(e,t){if(typeof e._construct!="function")return;const n=e._readableState,r=e._writableState;n&&(n.constructed=!1),r&&(r.constructed=!1),e.once(Lr,t),!(e.listenerCount(Lr)>1)&&Ue.nextTick(Vd,e)}function Vd(e){let t=!1;function n(r){if(t){xr(e,r??new Od);return}t=!0;const o=e._readableState,s=e._writableState,l=s||o;o&&(o.constructed=!0),s&&(s.constructed=!0),l.destroyed?e.emit(Pa,r):r?xr(e,r,!0):Ue.nextTick(Gd,e)}try{e._construct(r=>{Ue.nextTick(n,r)})}catch(r){Ue.nextTick(n,r)}}function Gd(e){e.emit(Lr)}function Ui(e){return(e==null?void 0:e.setHeader)&&typeof e.abort=="function"}function ka(e){e.emit("close")}function Kd(e,t){e.emit("error",t),Ue.nextTick(ka,e)}function qd(e,t){!e||xd(e)||(!t&&!Wd(e)&&(t=new Ld),Ud(e)?(e.socket=null,e.destroy(t)):Ui(e)?e.abort():Ui(e.req)?e.req.abort():typeof e.destroy=="function"?e.destroy(t):typeof e.close=="function"?e.close():t?Ue.nextTick(Kd,e,t):Ue.nextTick(ka,e),e.destroyed||(e[kd]=!0))}var Pt={construct:Hd,destroyer:qd,destroy:Bd,undestroy:jd,errorOrDestroy:xr};const{ArrayIsArray:Yd,ObjectSetPrototypeOf:xa}=le,{EventEmitter:In}=mt;function Nn(e){In.call(this,e)}xa(Nn.prototype,In.prototype);xa(Nn,In);Nn.prototype.pipe=function(e,t){const n=this;function r(c){e.writable&&e.write(c)===!1&&n.pause&&n.pause()}n.on("data",r);function o(){n.readable&&n.resume&&n.resume()}e.on("drain",o),!e._isStdio&&(!t||t.end!==!1)&&(n.on("end",l),n.on("close",h));let s=!1;function l(){s||(s=!0,e.end())}function h(){s||(s=!0,typeof e.destroy=="function"&&e.destroy())}function b(c){f(),In.listenerCount(this,"error")===0&&this.emit("error",c)}Wr(n,"error",b),Wr(e,"error",b);function f(){n.removeListener("data",r),e.removeListener("drain",o),n.removeListener("end",l),n.removeListener("close",h),n.removeListener("error",b),e.removeListener("error",b),n.removeListener("end",f),n.removeListener("close",f),e.removeListener("close",f)}return n.on("end",f),n.on("close",f),e.on("close",f),e.emit("pipe",n),e};function Wr(e,t,n){if(typeof e.prependListener=="function")return e.prependListener(t,n);!e._events||!e._events[t]?e.on(t,n):Yd(e._events[t])?e._events[t].unshift(n):e._events[t]=[n,e._events[t]]}var ri={Stream:Nn,prependListener:Wr},Wa={exports:{}};(function(e){const{AbortError:t,codes:n}=me,{isNodeStream:r,isWebStream:o,kControllerErrorFunction:s}=Ze,l=rt,{ERR_INVALID_ARG_TYPE:h}=n,b=(f,c)=>{if(typeof f!="object"||!("aborted"in f))throw new h(c,"AbortSignal",f)};e.exports.addAbortSignal=function(c,R){if(b(c,"signal"),!r(R)&&!o(R))throw new h("stream",["ReadableStream","WritableStream","Stream"],R);return e.exports.addAbortSignalNoValidate(c,R)},e.exports.addAbortSignalNoValidate=function(f,c){if(typeof f!="object"||!("aborted"in f))return c;const R=r(c)?()=>{c.destroy(new t(void 0,{cause:f.reason}))}:()=>{c[s](new t(void 0,{cause:f.reason}))};return f.aborted?R():(f.addEventListener("abort",R),l(c,()=>f.removeEventListener("abort",R))),c}})(Wa);var vn=Wa.exports;const{StringPrototypeSlice:Bi,SymbolIterator:Xd,TypedArrayPrototypeSet:Jt,Uint8Array:zd}=le,{Buffer:Yn}=we,{inspect:Zd}=ze;var Jd=class{constructor(){this.head=null,this.tail=null,this.length=0}push(t){const n={data:t,next:null};this.length>0?this.tail.next=n:this.head=n,this.tail=n,++this.length}unshift(t){const n={data:t,next:this.head};this.length===0&&(this.tail=n),this.head=n,++this.length}shift(){if(this.length===0)return;const t=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,t}clear(){this.head=this.tail=null,this.length=0}join(t){if(this.length===0)return"";let n=this.head,r=""+n.data;for(;(n=n.next)!==null;)r+=t+n.data;return r}concat(t){if(this.length===0)return Yn.alloc(0);const n=Yn.allocUnsafe(t>>>0);let r=this.head,o=0;for(;r;)Jt(n,r.data,o),o+=r.data.length,r=r.next;return n}consume(t,n){const r=this.head.data;if(t<r.length){const o=r.slice(0,t);return this.head.data=r.slice(t),o}return t===r.length?this.shift():n?this._getString(t):this._getBuffer(t)}first(){return this.head.data}*[Xd](){for(let t=this.head;t;t=t.next)yield t.data}_getString(t){let n="",r=this.head,o=0;do{const s=r.data;if(t>s.length)n+=s,t-=s.length;else{t===s.length?(n+=s,++o,r.next?this.head=r.next:this.head=this.tail=null):(n+=Bi(s,0,t),this.head=r,r.data=Bi(s,t));break}++o}while((r=r.next)!==null);return this.length-=o,n}_getBuffer(t){const n=Yn.allocUnsafe(t),r=t;let o=this.head,s=0;do{const l=o.data;if(t>l.length)Jt(n,l,r-t),t-=l.length;else{t===l.length?(Jt(n,l,r-t),++s,o.next?this.head=o.next:this.head=this.tail=null):(Jt(n,new zd(l.buffer,l.byteOffset,t),r-t),this.head=o,o.data=l.slice(t));break}++s}while((o=o.next)!==null);return this.length-=s,n}[Symbol.for("nodejs.util.inspect.custom")](t,n){return Zd(this,{...n,depth:0,customInspect:!1})}};const{MathFloor:Qd,NumberIsInteger:eu}=le,{ERR_INVALID_ARG_VALUE:tu}=me.codes;function nu(e,t,n){return e.highWaterMark!=null?e.highWaterMark:t?e[n]:null}function Ua(e){return e?16:16*1024}function ru(e,t,n,r){const o=nu(t,r,n);if(o!=null){if(!eu(o)||o<0){const s=r?`options.${n}`:"options.highWaterMark";throw new tu(s,o)}return Qd(o)}return Ua(e.objectMode)}var ii={getHighWaterMark:ru,getDefaultHighWaterMark:Ua};const Fi=Se,{PromisePrototypeThen:iu,SymbolAsyncIterator:ji,SymbolIterator:Hi}=le,{Buffer:ou}=we,{ERR_INVALID_ARG_TYPE:au,ERR_STREAM_NULL_VALUES:su}=me.codes;function lu(e,t,n){let r;if(typeof t=="string"||t instanceof ou)return new e({objectMode:!0,...n,read(){this.push(t),this.push(null)}});let o;if(t&&t[ji])o=!0,r=t[ji]();else if(t&&t[Hi])o=!1,r=t[Hi]();else throw new au("iterable",["Iterable"],t);const s=new e({objectMode:!0,highWaterMark:1,...n});let l=!1;s._read=function(){l||(l=!0,b())},s._destroy=function(f,c){iu(h(f),()=>Fi.nextTick(c,f),R=>Fi.nextTick(c,R||f))};async function h(f){const c=f!=null,R=typeof r.throw=="function";if(c&&R){const{value:A,done:y}=await r.throw(f);if(await A,y)return}if(typeof r.return=="function"){const{value:A}=await r.return();await A}}async function b(){for(;;){try{const{value:f,done:c}=o?await r.next():r.next();if(c)s.push(null);else{const R=f&&typeof f.then=="function"?await f:f;if(R===null)throw l=!1,new su;if(s.push(R))continue;l=!1}}catch(f){s.destroy(f)}break}}return s}var Ba=lu,Xn,Vi;function Cn(){if(Vi)return Xn;Vi=1;const e=Se,{ArrayPrototypeIndexOf:t,NumberIsInteger:n,NumberIsNaN:r,NumberParseInt:o,ObjectDefineProperties:s,ObjectKeys:l,ObjectSetPrototypeOf:h,Promise:b,SafeSet:f,SymbolAsyncIterator:c,Symbol:R}=le;Xn=S,S.ReadableState=te;const{EventEmitter:A}=mt,{Stream:y,prependListener:p}=ri,{Buffer:P}=we,{addAbortSignal:$}=vn,I=rt;let _=ze.debuglog("stream",i=>{_=i});const L=Jd,F=Pt,{getHighWaterMark:D,getDefaultHighWaterMark:K}=ii,{aggregateTwoErrors:j,codes:{ERR_INVALID_ARG_TYPE:G,ERR_METHOD_NOT_IMPLEMENTED:H,ERR_OUT_OF_RANGE:w,ERR_STREAM_PUSH_AFTER_EOF:O,ERR_STREAM_UNSHIFT_AFTER_END_EVENT:q}}=me,{validateObject:k}=mn,x=R("kPaused"),{StringDecoder:C}=la,V=Ba;h(S.prototype,y.prototype),h(S,y);const Y=()=>{},{errorOrDestroy:W}=F;function te(i,a,m){typeof m!="boolean"&&(m=a instanceof Ke()),this.objectMode=!!(i&&i.objectMode),m&&(this.objectMode=this.objectMode||!!(i&&i.readableObjectMode)),this.highWaterMark=i?D(this,i,"readableHighWaterMark",m):K(!1),this.buffer=new L,this.length=0,this.pipes=[],this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.constructed=!0,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this[x]=null,this.errorEmitted=!1,this.emitClose=!i||i.emitClose!==!1,this.autoDestroy=!i||i.autoDestroy!==!1,this.destroyed=!1,this.errored=null,this.closed=!1,this.closeEmitted=!1,this.defaultEncoding=i&&i.defaultEncoding||"utf8",this.awaitDrainWriters=null,this.multiAwaitDrain=!1,this.readingMore=!1,this.dataEmitted=!1,this.decoder=null,this.encoding=null,i&&i.encoding&&(this.decoder=new C(i.encoding),this.encoding=i.encoding)}function S(i){if(!(this instanceof S))return new S(i);const a=this instanceof Ke();this._readableState=new te(i,this,a),i&&(typeof i.read=="function"&&(this._read=i.read),typeof i.destroy=="function"&&(this._destroy=i.destroy),typeof i.construct=="function"&&(this._construct=i.construct),i.signal&&!a&&$(i.signal,this)),y.call(this,i),F.construct(this,()=>{this._readableState.needReadable&&ue(this,this._readableState)})}S.prototype.destroy=F.destroy,S.prototype._undestroy=F.undestroy,S.prototype._destroy=function(i,a){a(i)},S.prototype[A.captureRejectionSymbol]=function(i){this.destroy(i)},S.prototype.push=function(i,a){return z(this,i,a,!1)},S.prototype.unshift=function(i,a){return z(this,i,a,!0)};function z(i,a,m,E){_("readableAddChunk",a);const T=i._readableState;let X;if(T.objectMode||(typeof a=="string"?(m=m||T.defaultEncoding,T.encoding!==m&&(E&&T.encoding?a=P.from(a,m).toString(T.encoding):(a=P.from(a,m),m=""))):a instanceof P?m="":y._isUint8Array(a)?(a=y._uint8ArrayToBuffer(a),m=""):a!=null&&(X=new G("chunk",["string","Buffer","Uint8Array"],a))),X)W(i,X);else if(a===null)T.reading=!1,ot(i,T);else if(T.objectMode||a&&a.length>0)if(E)if(T.endEmitted)W(i,new q);else{if(T.destroyed||T.errored)return!1;oe(i,T,a,!0)}else if(T.ended)W(i,new O);else{if(T.destroyed||T.errored)return!1;T.reading=!1,T.decoder&&!m?(a=T.decoder.write(a),T.objectMode||a.length!==0?oe(i,T,a,!1):ue(i,T)):oe(i,T,a,!1)}else E||(T.reading=!1,ue(i,T));return!T.ended&&(T.length<T.highWaterMark||T.length===0)}function oe(i,a,m,E){a.flowing&&a.length===0&&!a.sync&&i.listenerCount("data")>0?(a.multiAwaitDrain?a.awaitDrainWriters.clear():a.awaitDrainWriters=null,a.dataEmitted=!0,i.emit("data",m)):(a.length+=a.objectMode?1:m.length,E?a.buffer.unshift(m):a.buffer.push(m),a.needReadable&&Re(i)),ue(i,a)}S.prototype.isPaused=function(){const i=this._readableState;return i[x]===!0||i.flowing===!1},S.prototype.setEncoding=function(i){const a=new C(i);this._readableState.decoder=a,this._readableState.encoding=this._readableState.decoder.encoding;const m=this._readableState.buffer;let E="";for(const T of m)E+=a.write(T);return m.clear(),E!==""&&m.push(E),this._readableState.length=E.length,this};const $e=1073741824;function Me(i){if(i>$e)throw new w("size","<= 1GiB",i);return i--,i|=i>>>1,i|=i>>>2,i|=i>>>4,i|=i>>>8,i|=i>>>16,i++,i}function he(i,a){return i<=0||a.length===0&&a.ended?0:a.objectMode?1:r(i)?a.flowing&&a.length?a.buffer.first().length:a.length:i<=a.length?i:a.ended?a.length:0}S.prototype.read=function(i){_("read",i),i===void 0?i=NaN:n(i)||(i=o(i,10));const a=this._readableState,m=i;if(i>a.highWaterMark&&(a.highWaterMark=Me(i)),i!==0&&(a.emittedReadable=!1),i===0&&a.needReadable&&((a.highWaterMark!==0?a.length>=a.highWaterMark:a.length>0)||a.ended))return _("read: emitReadable",a.length,a.ended),a.length===0&&a.ended?re(this):Re(this),null;if(i=he(i,a),i===0&&a.ended)return a.length===0&&re(this),null;let E=a.needReadable;if(_("need readable",E),(a.length===0||a.length-i<a.highWaterMark)&&(E=!0,_("length less than watermark",E)),a.ended||a.reading||a.destroyed||a.errored||!a.constructed)E=!1,_("reading, ended or constructing",E);else if(E){_("do read"),a.reading=!0,a.sync=!0,a.length===0&&(a.needReadable=!0);try{this._read(a.highWaterMark)}catch(X){W(this,X)}a.sync=!1,a.reading||(i=he(m,a))}let T;return i>0?T=B(i,a):T=null,T===null?(a.needReadable=a.length<=a.highWaterMark,i=0):(a.length-=i,a.multiAwaitDrain?a.awaitDrainWriters.clear():a.awaitDrainWriters=null),a.length===0&&(a.ended||(a.needReadable=!0),m!==i&&a.ended&&re(this)),T!==null&&!a.errorEmitted&&!a.closeEmitted&&(a.dataEmitted=!0,this.emit("data",T)),T};function ot(i,a){if(_("onEofChunk"),!a.ended){if(a.decoder){const m=a.decoder.end();m&&m.length&&(a.buffer.push(m),a.length+=a.objectMode?1:m.length)}a.ended=!0,a.sync?Re(i):(a.needReadable=!1,a.emittedReadable=!0,Ae(i))}}function Re(i){const a=i._readableState;_("emitReadable",a.needReadable,a.emittedReadable),a.needReadable=!1,a.emittedReadable||(_("emitReadable",a.flowing),a.emittedReadable=!0,e.nextTick(Ae,i))}function Ae(i){const a=i._readableState;_("emitReadable_",a.destroyed,a.length,a.ended),!a.destroyed&&!a.errored&&(a.length||a.ended)&&(i.emit("readable"),a.emittedReadable=!1),a.needReadable=!a.flowing&&!a.ended&&a.length<=a.highWaterMark,N(i)}function ue(i,a){!a.readingMore&&a.constructed&&(a.readingMore=!0,e.nextTick(at,i,a))}function at(i,a){for(;!a.reading&&!a.ended&&(a.length<a.highWaterMark||a.flowing&&a.length===0);){const m=a.length;if(_("maybeReadMore read 0"),i.read(0),m===a.length)break}a.readingMore=!1}S.prototype._read=function(i){throw new H("_read()")},S.prototype.pipe=function(i,a){const m=this,E=this._readableState;E.pipes.length===1&&(E.multiAwaitDrain||(E.multiAwaitDrain=!0,E.awaitDrainWriters=new f(E.awaitDrainWriters?[E.awaitDrainWriters]:[]))),E.pipes.push(i),_("pipe count=%d opts=%j",E.pipes.length,a);const X=(!a||a.end!==!1)&&i!==e.stdout&&i!==e.stderr?xt:Le;E.endEmitted?e.nextTick(X):m.once("end",X),i.on("unpipe",Q);function Q(pe,se){_("onunpipe"),pe===m&&se&&se.hasUnpiped===!1&&(se.hasUnpiped=!0,Vn())}function xt(){_("onend"),i.end()}let be,Wt=!1;function Vn(){_("cleanup"),i.removeListener("close",lt),i.removeListener("finish",dt),be&&i.removeListener("drain",be),i.removeListener("error",st),i.removeListener("unpipe",Q),m.removeListener("end",xt),m.removeListener("end",Le),m.removeListener("data",Bt),Wt=!0,be&&E.awaitDrainWriters&&(!i._writableState||i._writableState.needDrain)&&be()}function Ut(){Wt||(E.pipes.length===1&&E.pipes[0]===i?(_("false write response, pause",0),E.awaitDrainWriters=i,E.multiAwaitDrain=!1):E.pipes.length>1&&E.pipes.includes(i)&&(_("false write response, pause",E.awaitDrainWriters.size),E.awaitDrainWriters.add(i)),m.pause()),be||(be=De(m,i),i.on("drain",be))}m.on("data",Bt);function Bt(pe){_("ondata");const se=i.write(pe);_("dest.write",se),se===!1&&Ut()}function st(pe){if(_("onerror",pe),Le(),i.removeListener("error",st),i.listenerCount("error")===0){const se=i._writableState||i._readableState;se&&!se.errorEmitted?W(i,pe):i.emit("error",pe)}}p(i,"error",st);function lt(){i.removeListener("finish",dt),Le()}i.once("close",lt);function dt(){_("onfinish"),i.removeListener("close",lt),Le()}i.once("finish",dt);function Le(){_("unpipe"),m.unpipe(i)}return i.emit("pipe",m),i.writableNeedDrain===!0?E.flowing&&Ut():E.flowing||(_("pipe resume"),m.resume()),i};function De(i,a){return function(){const E=i._readableState;E.awaitDrainWriters===a?(_("pipeOnDrain",1),E.awaitDrainWriters=null):E.multiAwaitDrain&&(_("pipeOnDrain",E.awaitDrainWriters.size),E.awaitDrainWriters.delete(a)),(!E.awaitDrainWriters||E.awaitDrainWriters.size===0)&&i.listenerCount("data")&&i.resume()}}S.prototype.unpipe=function(i){const a=this._readableState,m={hasUnpiped:!1};if(a.pipes.length===0)return this;if(!i){const T=a.pipes;a.pipes=[],this.pause();for(let X=0;X<T.length;X++)T[X].emit("unpipe",this,{hasUnpiped:!1});return this}const E=t(a.pipes,i);return E===-1?this:(a.pipes.splice(E,1),a.pipes.length===0&&this.pause(),i.emit("unpipe",this,m),this)},S.prototype.on=function(i,a){const m=y.prototype.on.call(this,i,a),E=this._readableState;return i==="data"?(E.readableListening=this.listenerCount("readable")>0,E.flowing!==!1&&this.resume()):i==="readable"&&!E.endEmitted&&!E.readableListening&&(E.readableListening=E.needReadable=!0,E.flowing=!1,E.emittedReadable=!1,_("on readable",E.length,E.reading),E.length?Re(this):E.reading||e.nextTick(d,this)),m},S.prototype.addListener=S.prototype.on,S.prototype.removeListener=function(i,a){const m=y.prototype.removeListener.call(this,i,a);return i==="readable"&&e.nextTick(Pe,this),m},S.prototype.off=S.prototype.removeListener,S.prototype.removeAllListeners=function(i){const a=y.prototype.removeAllListeners.apply(this,arguments);return(i==="readable"||i===void 0)&&e.nextTick(Pe,this),a};function Pe(i){const a=i._readableState;a.readableListening=i.listenerCount("readable")>0,a.resumeScheduled&&a[x]===!1?a.flowing=!0:i.listenerCount("data")>0?i.resume():a.readableListening||(a.flowing=null)}function d(i){_("readable nexttick read 0"),i.read(0)}S.prototype.resume=function(){const i=this._readableState;return i.flowing||(_("resume"),i.flowing=!i.readableListening,u(this,i)),i[x]=!1,this};function u(i,a){a.resumeScheduled||(a.resumeScheduled=!0,e.nextTick(g,i,a))}function g(i,a){_("resume",a.reading),a.reading||i.read(0),a.resumeScheduled=!1,i.emit("resume"),N(i),a.flowing&&!a.reading&&i.read(0)}S.prototype.pause=function(){return _("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(_("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState[x]=!0,this};function N(i){const a=i._readableState;for(_("flow",a.flowing);a.flowing&&i.read()!==null;);}S.prototype.wrap=function(i){let a=!1;i.on("data",E=>{!this.push(E)&&i.pause&&(a=!0,i.pause())}),i.on("end",()=>{this.push(null)}),i.on("error",E=>{W(this,E)}),i.on("close",()=>{this.destroy()}),i.on("destroy",()=>{this.destroy()}),this._read=()=>{a&&i.resume&&(a=!1,i.resume())};const m=l(i);for(let E=1;E<m.length;E++){const T=m[E];this[T]===void 0&&typeof i[T]=="function"&&(this[T]=i[T].bind(i))}return this},S.prototype[c]=function(){return v(this)},S.prototype.iterator=function(i){return i!==void 0&&k(i,"options"),v(this,i)};function v(i,a){typeof i.read!="function"&&(i=S.wrap(i,{objectMode:!0}));const m=U(i,a);return m.stream=i,m}async function*U(i,a){let m=Y;function E(Q){this===i?(m(),m=Y):m=Q}i.on("readable",E);let T;const X=I(i,{writable:!1},Q=>{T=Q?j(T,Q):null,m(),m=Y});try{for(;;){const Q=i.destroyed?null:i.read();if(Q!==null)yield Q;else{if(T)throw T;if(T===null)return;await new b(E)}}}catch(Q){throw T=j(T,Q),T}finally{(T||(a==null?void 0:a.destroyOnReturn)!==!1)&&(T===void 0||i._readableState.autoDestroy)?F.destroyer(i,null):(i.off("readable",E),X())}}s(S.prototype,{readable:{__proto__:null,get(){const i=this._readableState;return!!i&&i.readable!==!1&&!i.destroyed&&!i.errorEmitted&&!i.endEmitted},set(i){this._readableState&&(this._readableState.readable=!!i)}},readableDidRead:{__proto__:null,enumerable:!1,get:function(){return this._readableState.dataEmitted}},readableAborted:{__proto__:null,enumerable:!1,get:function(){return!!(this._readableState.readable!==!1&&(this._readableState.destroyed||this._readableState.errored)&&!this._readableState.endEmitted)}},readableHighWaterMark:{__proto__:null,enumerable:!1,get:function(){return this._readableState.highWaterMark}},readableBuffer:{__proto__:null,enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}},readableFlowing:{__proto__:null,enumerable:!1,get:function(){return this._readableState.flowing},set:function(i){this._readableState&&(this._readableState.flowing=i)}},readableLength:{__proto__:null,enumerable:!1,get(){return this._readableState.length}},readableObjectMode:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.objectMode:!1}},readableEncoding:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.encoding:null}},errored:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.errored:null}},closed:{__proto__:null,get(){return this._readableState?this._readableState.closed:!1}},destroyed:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.destroyed:!1},set(i){this._readableState&&(this._readableState.destroyed=i)}},readableEnded:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.endEmitted:!1}}}),s(te.prototype,{pipesCount:{__proto__:null,get(){return this.pipes.length}},paused:{__proto__:null,get(){return this[x]!==!1},set(i){this[x]=!!i}}}),S._fromList=B;function B(i,a){if(a.length===0)return null;let m;return a.objectMode?m=a.buffer.shift():!i||i>=a.length?(a.decoder?m=a.buffer.join(""):a.buffer.length===1?m=a.buffer.first():m=a.buffer.concat(a.length),a.buffer.clear()):m=a.buffer.consume(i,a.decoder),m}function re(i){const a=i._readableState;_("endReadable",a.endEmitted),a.endEmitted||(a.ended=!0,e.nextTick(Te,a,i))}function Te(i,a){if(_("endReadableNT",i.endEmitted,i.length),!i.errored&&!i.closeEmitted&&!i.endEmitted&&i.length===0){if(i.endEmitted=!0,a.emit("end"),a.writable&&a.allowHalfOpen===!1)e.nextTick(Oe,a);else if(i.autoDestroy){const m=a._writableState;(!m||m.autoDestroy&&(m.finished||m.writable===!1))&&a.destroy()}}}function Oe(i){i.writable&&!i.writableEnded&&!i.destroyed&&i.end()}S.from=function(i,a){return V(S,i,a)};let ae;function kt(){return ae===void 0&&(ae={}),ae}return S.fromWeb=function(i,a){return kt().newStreamReadableFromReadableStream(i,a)},S.toWeb=function(i,a){return kt().newReadableStreamFromStreamReadable(i,a)},S.wrap=function(i,a){var m,E;return new S({objectMode:(m=(E=i.readableObjectMode)!==null&&E!==void 0?E:i.objectMode)!==null&&m!==void 0?m:!0,...a,destroy(T,X){F.destroyer(i,T),X(T)}}).wrap(i)},Xn}var zn,Gi;function Fa(){if(Gi)return zn;Gi=1;const e=Se,{ArrayPrototypeSlice:t,Error:n,FunctionPrototypeSymbolHasInstance:r,ObjectDefineProperty:o,ObjectDefineProperties:s,ObjectSetPrototypeOf:l,StringPrototypeToLowerCase:h,Symbol:b,SymbolHasInstance:f}=le;zn=C,C.WritableState=k;const{EventEmitter:c}=mt,R=ri.Stream,{Buffer:A}=we,y=Pt,{addAbortSignal:p}=vn,{getHighWaterMark:P,getDefaultHighWaterMark:$}=ii,{ERR_INVALID_ARG_TYPE:I,ERR_METHOD_NOT_IMPLEMENTED:_,ERR_MULTIPLE_CALLBACK:L,ERR_STREAM_CANNOT_PIPE:F,ERR_STREAM_DESTROYED:D,ERR_STREAM_ALREADY_FINISHED:K,ERR_STREAM_NULL_VALUES:j,ERR_STREAM_WRITE_AFTER_END:G,ERR_UNKNOWN_ENCODING:H}=me.codes,{errorOrDestroy:w}=y;l(C.prototype,R.prototype),l(C,R);function O(){}const q=b("kOnFinished");function k(d,u,g){typeof g!="boolean"&&(g=u instanceof Ke()),this.objectMode=!!(d&&d.objectMode),g&&(this.objectMode=this.objectMode||!!(d&&d.writableObjectMode)),this.highWaterMark=d?P(this,d,"writableHighWaterMark",g):$(!1),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;const N=!!(d&&d.decodeStrings===!1);this.decodeStrings=!N,this.defaultEncoding=d&&d.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=S.bind(void 0,u),this.writecb=null,this.writelen=0,this.afterWriteTickInfo=null,x(this),this.pendingcb=0,this.constructed=!0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!d||d.emitClose!==!1,this.autoDestroy=!d||d.autoDestroy!==!1,this.errored=null,this.closed=!1,this.closeEmitted=!1,this[q]=[]}function x(d){d.buffered=[],d.bufferedIndex=0,d.allBuffers=!0,d.allNoop=!0}k.prototype.getBuffer=function(){return t(this.buffered,this.bufferedIndex)},o(k.prototype,"bufferedRequestCount",{__proto__:null,get(){return this.buffered.length-this.bufferedIndex}});function C(d){const u=this instanceof Ke();if(!u&&!r(C,this))return new C(d);this._writableState=new k(d,this,u),d&&(typeof d.write=="function"&&(this._write=d.write),typeof d.writev=="function"&&(this._writev=d.writev),typeof d.destroy=="function"&&(this._destroy=d.destroy),typeof d.final=="function"&&(this._final=d.final),typeof d.construct=="function"&&(this._construct=d.construct),d.signal&&p(d.signal,this)),R.call(this,d),y.construct(this,()=>{const g=this._writableState;g.writing||Me(this,g),Ae(this,g)})}o(C,f,{__proto__:null,value:function(d){return r(this,d)?!0:this!==C?!1:d&&d._writableState instanceof k}}),C.prototype.pipe=function(){w(this,new F)};function V(d,u,g,N){const v=d._writableState;if(typeof g=="function")N=g,g=v.defaultEncoding;else{if(!g)g=v.defaultEncoding;else if(g!=="buffer"&&!A.isEncoding(g))throw new H(g);typeof N!="function"&&(N=O)}if(u===null)throw new j;if(!v.objectMode)if(typeof u=="string")v.decodeStrings!==!1&&(u=A.from(u,g),g="buffer");else if(u instanceof A)g="buffer";else if(R._isUint8Array(u))u=R._uint8ArrayToBuffer(u),g="buffer";else throw new I("chunk",["string","Buffer","Uint8Array"],u);let U;return v.ending?U=new G:v.destroyed&&(U=new D("write")),U?(e.nextTick(N,U),w(d,U,!0),U):(v.pendingcb++,Y(d,v,u,g,N))}C.prototype.write=function(d,u,g){return V(this,d,u,g)===!0},C.prototype.cork=function(){this._writableState.corked++},C.prototype.uncork=function(){const d=this._writableState;d.corked&&(d.corked--,d.writing||Me(this,d))},C.prototype.setDefaultEncoding=function(u){if(typeof u=="string"&&(u=h(u)),!A.isEncoding(u))throw new H(u);return this._writableState.defaultEncoding=u,this};function Y(d,u,g,N,v){const U=u.objectMode?1:g.length;u.length+=U;const B=u.length<u.highWaterMark;return B||(u.needDrain=!0),u.writing||u.corked||u.errored||!u.constructed?(u.buffered.push({chunk:g,encoding:N,callback:v}),u.allBuffers&&N!=="buffer"&&(u.allBuffers=!1),u.allNoop&&v!==O&&(u.allNoop=!1)):(u.writelen=U,u.writecb=v,u.writing=!0,u.sync=!0,d._write(g,N,u.onwrite),u.sync=!1),B&&!u.errored&&!u.destroyed}function W(d,u,g,N,v,U,B){u.writelen=N,u.writecb=B,u.writing=!0,u.sync=!0,u.destroyed?u.onwrite(new D("write")):g?d._writev(v,u.onwrite):d._write(v,U,u.onwrite),u.sync=!1}function te(d,u,g,N){--u.pendingcb,N(g),$e(u),w(d,g)}function S(d,u){const g=d._writableState,N=g.sync,v=g.writecb;if(typeof v!="function"){w(d,new L);return}g.writing=!1,g.writecb=null,g.length-=g.writelen,g.writelen=0,u?(u.stack,g.errored||(g.errored=u),d._readableState&&!d._readableState.errored&&(d._readableState.errored=u),N?e.nextTick(te,d,g,u,v):te(d,g,u,v)):(g.buffered.length>g.bufferedIndex&&Me(d,g),N?g.afterWriteTickInfo!==null&&g.afterWriteTickInfo.cb===v?g.afterWriteTickInfo.count++:(g.afterWriteTickInfo={count:1,cb:v,stream:d,state:g},e.nextTick(z,g.afterWriteTickInfo)):oe(d,g,1,v))}function z({stream:d,state:u,count:g,cb:N}){return u.afterWriteTickInfo=null,oe(d,u,g,N)}function oe(d,u,g,N){for(!u.ending&&!d.destroyed&&u.length===0&&u.needDrain&&(u.needDrain=!1,d.emit("drain"));g-- >0;)u.pendingcb--,N();u.destroyed&&$e(u),Ae(d,u)}function $e(d){if(d.writing)return;for(let v=d.bufferedIndex;v<d.buffered.length;++v){var u;const{chunk:U,callback:B}=d.buffered[v],re=d.objectMode?1:U.length;d.length-=re,B((u=d.errored)!==null&&u!==void 0?u:new D("write"))}const g=d[q].splice(0);for(let v=0;v<g.length;v++){var N;g[v]((N=d.errored)!==null&&N!==void 0?N:new D("end"))}x(d)}function Me(d,u){if(u.corked||u.bufferProcessing||u.destroyed||!u.constructed)return;const{buffered:g,bufferedIndex:N,objectMode:v}=u,U=g.length-N;if(!U)return;let B=N;if(u.bufferProcessing=!0,U>1&&d._writev){u.pendingcb-=U-1;const re=u.allNoop?O:Oe=>{for(let ae=B;ae<g.length;++ae)g[ae].callback(Oe)},Te=u.allNoop&&B===0?g:t(g,B);Te.allBuffers=u.allBuffers,W(d,u,!0,u.length,Te,"",re),x(u)}else{do{const{chunk:re,encoding:Te,callback:Oe}=g[B];g[B++]=null;const ae=v?1:re.length;W(d,u,!1,ae,re,Te,Oe)}while(B<g.length&&!u.writing);B===g.length?x(u):B>256?(g.splice(0,B),u.bufferedIndex=0):u.bufferedIndex=B}u.bufferProcessing=!1}C.prototype._write=function(d,u,g){if(this._writev)this._writev([{chunk:d,encoding:u}],g);else throw new _("_write()")},C.prototype._writev=null,C.prototype.end=function(d,u,g){const N=this._writableState;typeof d=="function"?(g=d,d=null,u=null):typeof u=="function"&&(g=u,u=null);let v;if(d!=null){const U=V(this,d,u);U instanceof n&&(v=U)}return N.corked&&(N.corked=1,this.uncork()),v||(!N.errored&&!N.ending?(N.ending=!0,Ae(this,N,!0),N.ended=!0):N.finished?v=new K("end"):N.destroyed&&(v=new D("end"))),typeof g=="function"&&(v||N.finished?e.nextTick(g,v):N[q].push(g)),this};function he(d){return d.ending&&!d.destroyed&&d.constructed&&d.length===0&&!d.errored&&d.buffered.length===0&&!d.finished&&!d.writing&&!d.errorEmitted&&!d.closeEmitted}function ot(d,u){let g=!1;function N(v){if(g){w(d,v??L());return}if(g=!0,u.pendingcb--,v){const U=u[q].splice(0);for(let B=0;B<U.length;B++)U[B](v);w(d,v,u.sync)}else he(u)&&(u.prefinished=!0,d.emit("prefinish"),u.pendingcb++,e.nextTick(ue,d,u))}u.sync=!0,u.pendingcb++;try{d._final(N)}catch(v){N(v)}u.sync=!1}function Re(d,u){!u.prefinished&&!u.finalCalled&&(typeof d._final=="function"&&!u.destroyed?(u.finalCalled=!0,ot(d,u)):(u.prefinished=!0,d.emit("prefinish")))}function Ae(d,u,g){he(u)&&(Re(d,u),u.pendingcb===0&&(g?(u.pendingcb++,e.nextTick((N,v)=>{he(v)?ue(N,v):v.pendingcb--},d,u)):he(u)&&(u.pendingcb++,ue(d,u))))}function ue(d,u){u.pendingcb--,u.finished=!0;const g=u[q].splice(0);for(let N=0;N<g.length;N++)g[N]();if(d.emit("finish"),u.autoDestroy){const N=d._readableState;(!N||N.autoDestroy&&(N.endEmitted||N.readable===!1))&&d.destroy()}}s(C.prototype,{closed:{__proto__:null,get(){return this._writableState?this._writableState.closed:!1}},destroyed:{__proto__:null,get(){return this._writableState?this._writableState.destroyed:!1},set(d){this._writableState&&(this._writableState.destroyed=d)}},writable:{__proto__:null,get(){const d=this._writableState;return!!d&&d.writable!==!1&&!d.destroyed&&!d.errored&&!d.ending&&!d.ended},set(d){this._writableState&&(this._writableState.writable=!!d)}},writableFinished:{__proto__:null,get(){return this._writableState?this._writableState.finished:!1}},writableObjectMode:{__proto__:null,get(){return this._writableState?this._writableState.objectMode:!1}},writableBuffer:{__proto__:null,get(){return this._writableState&&this._writableState.getBuffer()}},writableEnded:{__proto__:null,get(){return this._writableState?this._writableState.ending:!1}},writableNeedDrain:{__proto__:null,get(){const d=this._writableState;return d?!d.destroyed&&!d.ending&&d.needDrain:!1}},writableHighWaterMark:{__proto__:null,get(){return this._writableState&&this._writableState.highWaterMark}},writableCorked:{__proto__:null,get(){return this._writableState?this._writableState.corked:0}},writableLength:{__proto__:null,get(){return this._writableState&&this._writableState.length}},errored:{__proto__:null,enumerable:!1,get(){return this._writableState?this._writableState.errored:null}},writableAborted:{__proto__:null,enumerable:!1,get:function(){return!!(this._writableState.writable!==!1&&(this._writableState.destroyed||this._writableState.errored)&&!this._writableState.finished)}}});const at=y.destroy;C.prototype.destroy=function(d,u){const g=this._writableState;return!g.destroyed&&(g.bufferedIndex<g.buffered.length||g[q].length)&&e.nextTick($e,g),at.call(this,d,u),this},C.prototype._undestroy=y.undestroy,C.prototype._destroy=function(d,u){u(d)},C.prototype[c.captureRejectionSymbol]=function(d){this.destroy(d)};let De;function Pe(){return De===void 0&&(De={}),De}return C.fromWeb=function(d,u){return Pe().newStreamWritableFromWritableStream(d,u)},C.toWeb=function(d){return Pe().newWritableStreamFromStreamWritable(d)},zn}var Zn,Ki;function du(){if(Ki)return Zn;Ki=1;const e=Se,t=we,{isReadable:n,isWritable:r,isIterable:o,isNodeStream:s,isReadableNodeStream:l,isWritableNodeStream:h,isDuplexNodeStream:b}=Ze,f=rt,{AbortError:c,codes:{ERR_INVALID_ARG_TYPE:R,ERR_INVALID_RETURN_VALUE:A}}=me,{destroyer:y}=Pt,p=Ke(),P=Cn(),{createDeferredPromise:$}=ze,I=Ba,_=globalThis.Blob||t.Blob,L=typeof _<"u"?function(w){return w instanceof _}:function(w){return!1},F=globalThis.AbortController||Mt().AbortController,{FunctionPrototypeCall:D}=le;class K extends p{constructor(w){super(w),(w==null?void 0:w.readable)===!1&&(this._readableState.readable=!1,this._readableState.ended=!0,this._readableState.endEmitted=!0),(w==null?void 0:w.writable)===!1&&(this._writableState.writable=!1,this._writableState.ending=!0,this._writableState.ended=!0,this._writableState.finished=!0)}}Zn=function H(w,O){if(b(w))return w;if(l(w))return G({readable:w});if(h(w))return G({writable:w});if(s(w))return G({writable:!1,readable:!1});if(typeof w=="function"){const{value:k,write:x,final:C,destroy:V}=j(w);if(o(k))return I(K,k,{objectMode:!0,write:x,final:C,destroy:V});const Y=k==null?void 0:k.then;if(typeof Y=="function"){let W;const te=D(Y,k,S=>{if(S!=null)throw new A("nully","body",S)},S=>{y(W,S)});return W=new K({objectMode:!0,readable:!1,write:x,final(S){C(async()=>{try{await te,e.nextTick(S,null)}catch(z){e.nextTick(S,z)}})},destroy:V})}throw new A("Iterable, AsyncIterable or AsyncFunction",O,k)}if(L(w))return H(w.arrayBuffer());if(o(w))return I(K,w,{objectMode:!0,writable:!1});if(typeof(w==null?void 0:w.writable)=="object"||typeof(w==null?void 0:w.readable)=="object"){const k=w!=null&&w.readable?l(w==null?void 0:w.readable)?w==null?void 0:w.readable:H(w.readable):void 0,x=w!=null&&w.writable?h(w==null?void 0:w.writable)?w==null?void 0:w.writable:H(w.writable):void 0;return G({readable:k,writable:x})}const q=w==null?void 0:w.then;if(typeof q=="function"){let k;return D(q,w,x=>{x!=null&&k.push(x),k.push(null)},x=>{y(k,x)}),k=new K({objectMode:!0,writable:!1,read(){}})}throw new R(O,["Blob","ReadableStream","WritableStream","Stream","Iterable","AsyncIterable","Function","{ readable, writable } pair","Promise"],w)};function j(H){let{promise:w,resolve:O}=$();const q=new F,k=q.signal;return{value:H(async function*(){for(;;){const C=w;w=null;const{chunk:V,done:Y,cb:W}=await C;if(e.nextTick(W),Y)return;if(k.aborted)throw new c(void 0,{cause:k.reason});({promise:w,resolve:O}=$()),yield V}}(),{signal:k}),write(C,V,Y){const W=O;O=null,W({chunk:C,done:!1,cb:Y})},final(C){const V=O;O=null,V({done:!0,cb:C})},destroy(C,V){q.abort(),V(C)}}}function G(H){const w=H.readable&&typeof H.readable.read!="function"?P.wrap(H.readable):H.readable,O=H.writable;let q=!!n(w),k=!!r(O),x,C,V,Y,W;function te(S){const z=Y;Y=null,z?z(S):S&&W.destroy(S)}return W=new K({readableObjectMode:!!(w!=null&&w.readableObjectMode),writableObjectMode:!!(O!=null&&O.writableObjectMode),readable:q,writable:k}),k&&(f(O,S=>{k=!1,S&&y(w,S),te(S)}),W._write=function(S,z,oe){O.write(S,z)?oe():x=oe},W._final=function(S){O.end(),C=S},O.on("drain",function(){if(x){const S=x;x=null,S()}}),O.on("finish",function(){if(C){const S=C;C=null,S()}})),q&&(f(w,S=>{q=!1,S&&y(w,S),te(S)}),w.on("readable",function(){if(V){const S=V;V=null,S()}}),w.on("end",function(){W.push(null)}),W._read=function(){for(;;){const S=w.read();if(S===null){V=W._read;return}if(!W.push(S))return}}),W._destroy=function(S,z){!S&&Y!==null&&(S=new c),V=null,x=null,C=null,Y===null?z(S):(Y=z,y(O,S),y(w,S))},W}return Zn}var Jn,qi;function Ke(){if(qi)return Jn;qi=1;const{ObjectDefineProperties:e,ObjectGetOwnPropertyDescriptor:t,ObjectKeys:n,ObjectSetPrototypeOf:r}=le;Jn=l;const o=Cn(),s=Fa();r(l.prototype,o.prototype),r(l,o);{const c=n(s.prototype);for(let R=0;R<c.length;R++){const A=c[R];l.prototype[A]||(l.prototype[A]=s.prototype[A])}}function l(c){if(!(this instanceof l))return new l(c);o.call(this,c),s.call(this,c),c?(this.allowHalfOpen=c.allowHalfOpen!==!1,c.readable===!1&&(this._readableState.readable=!1,this._readableState.ended=!0,this._readableState.endEmitted=!0),c.writable===!1&&(this._writableState.writable=!1,this._writableState.ending=!0,this._writableState.ended=!0,this._writableState.finished=!0)):this.allowHalfOpen=!0}e(l.prototype,{writable:{__proto__:null,...t(s.prototype,"writable")},writableHighWaterMark:{__proto__:null,...t(s.prototype,"writableHighWaterMark")},writableObjectMode:{__proto__:null,...t(s.prototype,"writableObjectMode")},writableBuffer:{__proto__:null,...t(s.prototype,"writableBuffer")},writableLength:{__proto__:null,...t(s.prototype,"writableLength")},writableFinished:{__proto__:null,...t(s.prototype,"writableFinished")},writableCorked:{__proto__:null,...t(s.prototype,"writableCorked")},writableEnded:{__proto__:null,...t(s.prototype,"writableEnded")},writableNeedDrain:{__proto__:null,...t(s.prototype,"writableNeedDrain")},destroyed:{__proto__:null,get(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set(c){this._readableState&&this._writableState&&(this._readableState.destroyed=c,this._writableState.destroyed=c)}}});let h;function b(){return h===void 0&&(h={}),h}l.fromWeb=function(c,R){return b().newStreamDuplexFromReadableWritablePair(c,R)},l.toWeb=function(c){return b().newReadableWritablePairFromDuplex(c)};let f;return l.from=function(c){return f||(f=du()),f(c,"body")},Jn}const{ObjectSetPrototypeOf:ja,Symbol:uu}=le;var Ha=qe;const{ERR_METHOD_NOT_IMPLEMENTED:fu}=me.codes,oi=Ke(),{getHighWaterMark:cu}=ii;ja(qe.prototype,oi.prototype);ja(qe,oi);const Kt=uu("kCallback");function qe(e){if(!(this instanceof qe))return new qe(e);const t=e?cu(this,e,"readableHighWaterMark",!0):null;t===0&&(e={...e,highWaterMark:null,readableHighWaterMark:t,writableHighWaterMark:e.writableHighWaterMark||0}),oi.call(this,e),this._readableState.sync=!1,this[Kt]=null,e&&(typeof e.transform=="function"&&(this._transform=e.transform),typeof e.flush=="function"&&(this._flush=e.flush)),this.on("prefinish",hu)}function Ur(e){typeof this._flush=="function"&&!this.destroyed?this._flush((t,n)=>{if(t){e?e(t):this.destroy(t);return}n!=null&&this.push(n),this.push(null),e&&e()}):(this.push(null),e&&e())}function hu(){this._final!==Ur&&Ur.call(this)}qe.prototype._final=Ur;qe.prototype._transform=function(e,t,n){throw new fu("_transform()")};qe.prototype._write=function(e,t,n){const r=this._readableState,o=this._writableState,s=r.length;this._transform(e,t,(l,h)=>{if(l){n(l);return}h!=null&&this.push(h),o.ended||s===r.length||r.length<r.highWaterMark?n():this[Kt]=n})};qe.prototype._read=function(){if(this[Kt]){const e=this[Kt];this[Kt]=null,e()}};const{ObjectSetPrototypeOf:Va}=le;var Ga=Ct;const ai=Ha;Va(Ct.prototype,ai.prototype);Va(Ct,ai);function Ct(e){if(!(this instanceof Ct))return new Ct(e);ai.call(this,e)}Ct.prototype._transform=function(e,t,n){n(null,e)};const Ht=Se,{ArrayIsArray:bu,Promise:pu,SymbolAsyncIterator:gu}=le,hn=rt,{once:yu}=ze,_u=Pt,Yi=Ke(),{aggregateTwoErrors:wu,codes:{ERR_INVALID_ARG_TYPE:Br,ERR_INVALID_RETURN_VALUE:Qn,ERR_MISSING_ARGS:Su,ERR_STREAM_DESTROYED:mu,ERR_STREAM_PREMATURE_CLOSE:Eu},AbortError:Ru}=me,{validateFunction:Au,validateAbortSignal:Tu}=mn,{isIterable:ht,isReadable:er,isReadableNodeStream:dn,isNodeStream:Xi,isTransformStream:Nt,isWebStream:Iu,isReadableStream:tr,isReadableEnded:Nu}=Ze,vu=globalThis.AbortController||Mt().AbortController;let nr,rr;function zi(e,t,n){let r=!1;e.on("close",()=>{r=!0});const o=hn(e,{readable:t,writable:n},s=>{r=!s});return{destroy:s=>{r||(r=!0,_u.destroyer(e,s||new mu("pipe")))},cleanup:o}}function Cu(e){return Au(e[e.length-1],"streams[stream.length - 1]"),e.pop()}function ir(e){if(ht(e))return e;if(dn(e))return $u(e);throw new Br("val",["Readable","Iterable","AsyncIterable"],e)}async function*$u(e){rr||(rr=Cn()),yield*rr.prototype[gu].call(e)}async function Qt(e,t,n,{end:r}){let o,s=null;const l=f=>{if(f&&(o=f),s){const c=s;s=null,c()}},h=()=>new pu((f,c)=>{o?c(o):s=()=>{o?c(o):f()}});t.on("drain",l);const b=hn(t,{readable:!1},l);try{t.writableNeedDrain&&await h();for await(const f of e)t.write(f)||await h();r&&t.end(),await h(),n()}catch(f){n(o!==f?wu(o,f):f)}finally{b(),t.off("drain",l)}}async function or(e,t,n,{end:r}){Nt(t)&&(t=t.writable);const o=t.getWriter();try{for await(const s of e)await o.ready,o.write(s).catch(()=>{});await o.ready,r&&await o.close(),n()}catch(s){try{await o.abort(s),n(s)}catch(l){n(l)}}}function Mu(...e){return Ka(e,yu(Cu(e)))}function Ka(e,t,n){if(e.length===1&&bu(e[0])&&(e=e[0]),e.length<2)throw new Su("streams");const r=new vu,o=r.signal,s=n==null?void 0:n.signal,l=[];Tu(s,"options.signal");function h(){y(new Ru)}s==null||s.addEventListener("abort",h);let b,f;const c=[];let R=0;function A(I){y(I,--R===0)}function y(I,_){if(I&&(!b||b.code==="ERR_STREAM_PREMATURE_CLOSE")&&(b=I),!(!b&&!_)){for(;c.length;)c.shift()(b);s==null||s.removeEventListener("abort",h),r.abort(),_&&(b||l.forEach(L=>L()),Ht.nextTick(t,b,f))}}let p;for(let I=0;I<e.length;I++){const _=e[I],L=I<e.length-1,F=I>0,D=L||(n==null?void 0:n.end)!==!1,K=I===e.length-1;if(Xi(_)){let j=function(G){G&&G.name!=="AbortError"&&G.code!=="ERR_STREAM_PREMATURE_CLOSE"&&A(G)};if(D){const{destroy:G,cleanup:H}=zi(_,L,F);c.push(G),er(_)&&K&&l.push(H)}_.on("error",j),er(_)&&K&&l.push(()=>{_.removeListener("error",j)})}if(I===0)if(typeof _=="function"){if(p=_({signal:o}),!ht(p))throw new Qn("Iterable, AsyncIterable or Stream","source",p)}else ht(_)||dn(_)||Nt(_)?p=_:p=Yi.from(_);else if(typeof _=="function"){if(Nt(p)){var P;p=ir((P=p)===null||P===void 0?void 0:P.readable)}else p=ir(p);if(p=_(p,{signal:o}),L){if(!ht(p,!0))throw new Qn("AsyncIterable",`transform[${I-1}]`,p)}else{var $;nr||(nr=Ga);const j=new nr({objectMode:!0}),G=($=p)===null||$===void 0?void 0:$.then;if(typeof G=="function")R++,G.call(p,O=>{f=O,O!=null&&j.write(O),D&&j.end(),Ht.nextTick(A)},O=>{j.destroy(O),Ht.nextTick(A,O)});else if(ht(p,!0))R++,Qt(p,j,A,{end:D});else if(tr(p)||Nt(p)){const O=p.readable||p;R++,Qt(O,j,A,{end:D})}else throw new Qn("AsyncIterable or Promise","destination",p);p=j;const{destroy:H,cleanup:w}=zi(p,!1,!0);c.push(H),K&&l.push(w)}}else if(Xi(_)){if(dn(p)){R+=2;const j=Du(p,_,A,{end:D});er(_)&&K&&l.push(j)}else if(Nt(p)||tr(p)){const j=p.readable||p;R++,Qt(j,_,A,{end:D})}else if(ht(p))R++,Qt(p,_,A,{end:D});else throw new Br("val",["Readable","Iterable","AsyncIterable","ReadableStream","TransformStream"],p);p=_}else if(Iu(_)){if(dn(p))R++,or(ir(p),_,A,{end:D});else if(tr(p)||ht(p))R++,or(p,_,A,{end:D});else if(Nt(p))R++,or(p.readable,_,A,{end:D});else throw new Br("val",["Readable","Iterable","AsyncIterable","ReadableStream","TransformStream"],p);p=_}else p=Yi.from(_)}return(o!=null&&o.aborted||s!=null&&s.aborted)&&Ht.nextTick(h),p}function Du(e,t,n,{end:r}){let o=!1;if(t.on("close",()=>{o||n(new Eu)}),e.pipe(t,{end:!1}),r){let s=function(){o=!0,t.end()};Nu(e)?Ht.nextTick(s):e.once("end",s)}else n();return hn(e,{readable:!0,writable:!1},s=>{const l=e._readableState;s&&s.code==="ERR_STREAM_PREMATURE_CLOSE"&&l&&l.ended&&!l.errored&&!l.errorEmitted?e.once("end",n).once("error",n):n(s)}),hn(t,{readable:!1,writable:!0},n)}var si={pipelineImpl:Ka,pipeline:Mu};const{pipeline:Pu}=si,en=Ke(),{destroyer:Ou}=Pt,{isNodeStream:tn,isReadable:Zi,isWritable:Ji,isWebStream:ar,isTransformStream:ut,isWritableStream:Qi,isReadableStream:eo}=Ze,{AbortError:Lu,codes:{ERR_INVALID_ARG_VALUE:to,ERR_MISSING_ARGS:ku}}=me,xu=rt;var qa=function(...t){if(t.length===0)throw new ku("streams");if(t.length===1)return en.from(t[0]);const n=[...t];if(typeof t[0]=="function"&&(t[0]=en.from(t[0])),typeof t[t.length-1]=="function"){const y=t.length-1;t[y]=en.from(t[y])}for(let y=0;y<t.length;++y)if(!(!tn(t[y])&&!ar(t[y]))){if(y<t.length-1&&!(Zi(t[y])||eo(t[y])||ut(t[y])))throw new to(`streams[${y}]`,n[y],"must be readable");if(y>0&&!(Ji(t[y])||Qi(t[y])||ut(t[y])))throw new to(`streams[${y}]`,n[y],"must be writable")}let r,o,s,l,h;function b(y){const p=l;l=null,p?p(y):y?h.destroy(y):!A&&!R&&h.destroy()}const f=t[0],c=Pu(t,b),R=!!(Ji(f)||Qi(f)||ut(f)),A=!!(Zi(c)||eo(c)||ut(c));if(h=new en({writableObjectMode:!!(f!=null&&f.writableObjectMode),readableObjectMode:!!(c!=null&&c.writableObjectMode),writable:R,readable:A}),R){if(tn(f))h._write=function(p,P,$){f.write(p,P)?$():r=$},h._final=function(p){f.end(),o=p},f.on("drain",function(){if(r){const p=r;r=null,p()}});else if(ar(f)){const P=(ut(f)?f.writable:f).getWriter();h._write=async function($,I,_){try{await P.ready,P.write($).catch(()=>{}),_()}catch(L){_(L)}},h._final=async function($){try{await P.ready,P.close().catch(()=>{}),o=$}catch(I){$(I)}}}const y=ut(c)?c.readable:c;xu(y,()=>{if(o){const p=o;o=null,p()}})}if(A){if(tn(c))c.on("readable",function(){if(s){const y=s;s=null,y()}}),c.on("end",function(){h.push(null)}),h._read=function(){for(;;){const y=c.read();if(y===null){s=h._read;return}if(!h.push(y))return}};else if(ar(c)){const p=(ut(c)?c.readable:c).getReader();h._read=async function(){for(;;)try{const{value:P,done:$}=await p.read();if(!h.push(P))return;if($){h.push(null);return}}catch{return}}}}return h._destroy=function(y,p){!y&&l!==null&&(y=new Lu),s=null,r=null,o=null,l===null?p(y):(l=p,tn(c)&&Ou(c,y))},h};const Ya=globalThis.AbortController||Mt().AbortController,{codes:{ERR_INVALID_ARG_VALUE:Wu,ERR_INVALID_ARG_TYPE:Yt,ERR_MISSING_ARGS:Uu,ERR_OUT_OF_RANGE:Bu},AbortError:Fe}=me,{validateAbortSignal:Et,validateInteger:Fu,validateObject:Rt}=mn,ju=le.Symbol("kWeak"),{finished:Hu}=rt,Vu=qa,{addAbortSignalNoValidate:Gu}=vn,{isWritable:Ku,isNodeStream:qu}=Ze,{ArrayPrototypePush:Yu,MathFloor:Xu,Number:zu,NumberIsNaN:Zu,Promise:no,PromiseReject:ro,PromisePrototypeThen:Ju,Symbol:Xa}=le,bn=Xa("kEmpty"),io=Xa("kEof");function Qu(e,t){if(t!=null&&Rt(t,"options"),(t==null?void 0:t.signal)!=null&&Et(t.signal,"options.signal"),qu(e)&&!Ku(e))throw new Wu("stream",e,"must be writable");const n=Vu(this,e);return t!=null&&t.signal&&Gu(t.signal,n),n}function $n(e,t){if(typeof e!="function")throw new Yt("fn",["Function","AsyncFunction"],e);t!=null&&Rt(t,"options"),(t==null?void 0:t.signal)!=null&&Et(t.signal,"options.signal");let n=1;return(t==null?void 0:t.concurrency)!=null&&(n=Xu(t.concurrency)),Fu(n,"concurrency",1),(async function*(){var o,s;const l=new Ya,h=this,b=[],f=l.signal,c={signal:f},R=()=>l.abort();t!=null&&(o=t.signal)!==null&&o!==void 0&&o.aborted&&R(),t==null||(s=t.signal)===null||s===void 0||s.addEventListener("abort",R);let A,y,p=!1;function P(){p=!0}async function $(){try{for await(let L of h){var I;if(p)return;if(f.aborted)throw new Fe;try{L=e(L,c)}catch(F){L=ro(F)}L!==bn&&(typeof((I=L)===null||I===void 0?void 0:I.catch)=="function"&&L.catch(P),b.push(L),A&&(A(),A=null),!p&&b.length&&b.length>=n&&await new no(F=>{y=F}))}b.push(io)}catch(L){const F=ro(L);Ju(F,void 0,P),b.push(F)}finally{var _;p=!0,A&&(A(),A=null),t==null||(_=t.signal)===null||_===void 0||_.removeEventListener("abort",R)}}$();try{for(;;){for(;b.length>0;){const I=await b[0];if(I===io)return;if(f.aborted)throw new Fe;I!==bn&&(yield I),b.shift(),y&&(y(),y=null)}await new no(I=>{A=I})}}finally{l.abort(),p=!0,y&&(y(),y=null)}}).call(this)}function ef(e=void 0){return e!=null&&Rt(e,"options"),(e==null?void 0:e.signal)!=null&&Et(e.signal,"options.signal"),(async function*(){let n=0;for await(const o of this){var r;if(e!=null&&(r=e.signal)!==null&&r!==void 0&&r.aborted)throw new Fe({cause:e.signal.reason});yield[n++,o]}}).call(this)}async function za(e,t=void 0){for await(const n of li.call(this,e,t))return!0;return!1}async function tf(e,t=void 0){if(typeof e!="function")throw new Yt("fn",["Function","AsyncFunction"],e);return!await za.call(this,async(...n)=>!await e(...n),t)}async function nf(e,t){for await(const n of li.call(this,e,t))return n}async function rf(e,t){if(typeof e!="function")throw new Yt("fn",["Function","AsyncFunction"],e);async function n(r,o){return await e(r,o),bn}for await(const r of $n.call(this,n,t));}function li(e,t){if(typeof e!="function")throw new Yt("fn",["Function","AsyncFunction"],e);async function n(r,o){return await e(r,o)?r:bn}return $n.call(this,n,t)}let of=class extends Uu{constructor(){super("reduce"),this.message="Reduce of an empty stream requires an initial value"}};async function af(e,t,n){var r;if(typeof e!="function")throw new Yt("reducer",["Function","AsyncFunction"],e);n!=null&&Rt(n,"options"),(n==null?void 0:n.signal)!=null&&Et(n.signal,"options.signal");let o=arguments.length>1;if(n!=null&&(r=n.signal)!==null&&r!==void 0&&r.aborted){const f=new Fe(void 0,{cause:n.signal.reason});throw this.once("error",()=>{}),await Hu(this.destroy(f)),f}const s=new Ya,l=s.signal;if(n!=null&&n.signal){const f={once:!0,[ju]:this};n.signal.addEventListener("abort",()=>s.abort(),f)}let h=!1;try{for await(const f of this){var b;if(h=!0,n!=null&&(b=n.signal)!==null&&b!==void 0&&b.aborted)throw new Fe;o?t=await e(t,f,{signal:l}):(t=f,o=!0)}if(!h&&!o)throw new of}finally{s.abort()}return t}async function sf(e){e!=null&&Rt(e,"options"),(e==null?void 0:e.signal)!=null&&Et(e.signal,"options.signal");const t=[];for await(const r of this){var n;if(e!=null&&(n=e.signal)!==null&&n!==void 0&&n.aborted)throw new Fe(void 0,{cause:e.signal.reason});Yu(t,r)}return t}function lf(e,t){const n=$n.call(this,e,t);return(async function*(){for await(const o of n)yield*o}).call(this)}function Za(e){if(e=zu(e),Zu(e))return 0;if(e<0)throw new Bu("number",">= 0",e);return e}function df(e,t=void 0){return t!=null&&Rt(t,"options"),(t==null?void 0:t.signal)!=null&&Et(t.signal,"options.signal"),e=Za(e),(async function*(){var r;if(t!=null&&(r=t.signal)!==null&&r!==void 0&&r.aborted)throw new Fe;for await(const s of this){var o;if(t!=null&&(o=t.signal)!==null&&o!==void 0&&o.aborted)throw new Fe;e--<=0&&(yield s)}}).call(this)}function uf(e,t=void 0){return t!=null&&Rt(t,"options"),(t==null?void 0:t.signal)!=null&&Et(t.signal,"options.signal"),e=Za(e),(async function*(){var r;if(t!=null&&(r=t.signal)!==null&&r!==void 0&&r.aborted)throw new Fe;for await(const s of this){var o;if(t!=null&&(o=t.signal)!==null&&o!==void 0&&o.aborted)throw new Fe;if(e-- >0)yield s;else return}}).call(this)}Zr.streamReturningOperators={asIndexedPairs:ef,drop:df,filter:li,flatMap:lf,map:$n,take:uf,compose:Qu};Zr.promiseReturningOperators={every:tf,forEach:rf,reduce:af,toArray:sf,some:za,find:nf};var sr,oo;function Ja(){if(oo)return sr;oo=1;const{ArrayPrototypePop:e,Promise:t}=le,{isIterable:n,isNodeStream:r,isWebStream:o}=Ze,{pipelineImpl:s}=si,{finished:l}=rt;Qa();function h(...b){return new t((f,c)=>{let R,A;const y=b[b.length-1];if(y&&typeof y=="object"&&!r(y)&&!n(y)&&!o(y)){const p=e(b);R=p.signal,A=p.end}s(b,(p,P)=>{p?c(p):f(P)},{signal:R,end:A})})}return sr={finished:l,pipeline:h},sr}var ao;function Qa(){if(ao)return Gn.exports;ao=1;const{Buffer:e}=we,{ObjectDefineProperty:t,ObjectKeys:n,ReflectApply:r}=le,{promisify:{custom:o}}=ze,{streamReturningOperators:s,promiseReturningOperators:l}=Zr,{codes:{ERR_ILLEGAL_CONSTRUCTOR:h}}=me,b=qa,{pipeline:f}=si,{destroyer:c}=Pt,R=rt,A=Ja(),y=Ze,p=Gn.exports=ri.Stream;p.isDisturbed=y.isDisturbed,p.isErrored=y.isErrored,p.isReadable=y.isReadable,p.Readable=Cn();for(const $ of n(s)){let _=function(...L){if(new.target)throw h();return p.Readable.from(r(I,this,L))};const I=s[$];t(_,"name",{__proto__:null,value:I.name}),t(_,"length",{__proto__:null,value:I.length}),t(p.Readable.prototype,$,{__proto__:null,value:_,enumerable:!1,configurable:!0,writable:!0})}for(const $ of n(l)){let _=function(...L){if(new.target)throw h();return r(I,this,L)};const I=l[$];t(_,"name",{__proto__:null,value:I.name}),t(_,"length",{__proto__:null,value:I.length}),t(p.Readable.prototype,$,{__proto__:null,value:_,enumerable:!1,configurable:!0,writable:!0})}p.Writable=Fa(),p.Duplex=Ke(),p.Transform=Ha,p.PassThrough=Ga,p.pipeline=f;const{addAbortSignal:P}=vn;return p.addAbortSignal=P,p.finished=R,p.destroy=c,p.compose=b,t(p,"promises",{__proto__:null,configurable:!0,enumerable:!0,get(){return A}}),t(f,o,{__proto__:null,enumerable:!0,get(){return A.pipeline}}),t(R,o,{__proto__:null,enumerable:!0,get(){return A.finished}}),p.Stream=p,p._isUint8Array=function(I){return I instanceof Uint8Array},p._uint8ArrayToBuffer=function(I){return e.from(I.buffer,I.byteOffset,I.byteLength)},Gn.exports}(function(e){const t=Qa(),n=Ja(),r=t.Readable.destroy;e.exports=t.Readable,e.exports._uint8ArrayToBuffer=t._uint8ArrayToBuffer,e.exports._isUint8Array=t._isUint8Array,e.exports.isDisturbed=t.isDisturbed,e.exports.isErrored=t.isErrored,e.exports.isReadable=t.isReadable,e.exports.Readable=t.Readable,e.exports.Writable=t.Writable,e.exports.Duplex=t.Duplex,e.exports.Transform=t.Transform,e.exports.PassThrough=t.PassThrough,e.exports.addAbortSignal=t.addAbortSignal,e.exports.finished=t.finished,e.exports.destroy=t.destroy,e.exports.destroy=r,e.exports.pipeline=t.pipeline,e.exports.compose=t.compose,Object.defineProperty(t,"promises",{configurable:!0,enumerable:!0,get(){return n}}),e.exports.Stream=t.Stream,e.exports.default=e.exports})(ua);var Mn=ua.exports;function nn(){}const so="SYN",lr="ACK",lo="BRK";class uo extends Mn.Duplex{constructor(t){let{name:n,target:r,targetWindow:o=window,targetOrigin:s="*"}=t;if(super({objectMode:!0}),M(this,"_init",void 0),M(this,"_haveSyn",void 0),M(this,"_name",void 0),M(this,"_target",void 0),M(this,"_targetWindow",void 0),M(this,"_targetOrigin",void 0),M(this,"_onMessage",void 0),M(this,"_synIntervalId",void 0),!n||!r)throw new Error("Invalid input.");this._init=!1,this._haveSyn=!1,this._name=n,this._target=r,this._targetWindow=o,this._targetOrigin=s,this._onMessage=this.onMessage.bind(this),this._synIntervalId=null,window.addEventListener("message",this._onMessage,!1),this._handShake()}_break(){this.cork(),this._write(lo,null,nn),this._haveSyn=!1,this._init=!1}_handShake(){this._write(so,null,nn),this.cork()}_onData(t){if(!this._init)t===so?(this._haveSyn=!0,this._write(lr,null,nn)):t===lr&&(this._init=!0,this._haveSyn||this._write(lr,null,nn),this.uncork());else if(t===lo)this._break();else try{this.push(t)}catch(n){this.emit("error",n)}}_postMessage(t){const n=this._targetOrigin;this._targetWindow.postMessage({target:this._target,data:t},n)}onMessage(t){const n=t.data;this._targetOrigin!=="*"&&t.origin!==this._targetOrigin||t.source!==this._targetWindow||typeof n!="object"||n.target!==this._name||!n.data||this._onData(n.data)}_read(){}_write(t,n,r){this._postMessage(t),r()}_destroy(){window.removeEventListener("message",this._onMessage,!1)}}function fo(e,t,n){try{Reflect.apply(e,t,n)}catch(r){setTimeout(()=>{throw r})}}function ff(e){const t=e.length,n=new Array(t);for(let r=0;r<t;r+=1)n[r]=e[r];return n}class Xt extends mt.EventEmitter{emit(t){let n=t==="error";const r=this._events;if(r!==void 0)n=n&&r.error===void 0;else if(!n)return!1;for(var o=arguments.length,s=new Array(o>1?o-1:0),l=1;l<o;l++)s[l-1]=arguments[l];if(n){let b;if(s.length>0&&([b]=s),b instanceof Error)throw b;const f=new Error(`Unhandled error.${b?` (${b.message})`:""}`);throw f.context=b,f}const h=r[t];if(h===void 0)return!1;if(typeof h=="function")fo(h,this,s);else{const b=h.length,f=ff(h);for(let c=0;c<b;c+=1)fo(f[c],this,s)}return!0}}class Ft extends Error{constructor(t){let{code:n,message:r,data:o}=t;if(!Number.isInteger(n))throw new Error("code must be an integer");if(!r||typeof r!="string")throw new Error("message must be string");super(r),M(this,"code",void 0),M(this,"data",void 0),this.code=n,o!==void 0&&(this.data=o)}toString(){return Ys({code:this.code,message:this.message,data:this.data,stack:this.stack})}}function cf(){const e={};function t(){return!1}const n=new Xt;function r(b){const f=e[b.id];if(!f)throw new Error(`StreamMiddleware - Unknown response id "${b.id}"`);delete e[b.id],Object.assign(f.res,b),setTimeout(f.end)}function o(b){n.emit("notification",b)}function s(b,f,c){let R;try{!b.id?o(b):r(b)}catch(A){R=A}c(R)}const l=new Mn.Duplex({objectMode:!0,read:t,write:s});return{events:n,middleware:(b,f,c,R)=>{l.push(b),e[b.id]={req:b,res:f,next:c,end:R}},stream:l}}function hf(){return(e,t,n,r)=>{const o=e.id,s=Math.random().toString(36).slice(2);e.id=s,t.id=s,n(l=>{e.id=o,t.id=o,l()})}}class Ge extends Xt{constructor(){super(),M(this,"_middleware",void 0),this._middleware=[]}static async _runAllMiddleware(t,n,r){const o=[];let s=null,l=!1;for(const h of r)if([s,l]=await Ge._runMiddleware(t,n,h,o),l)break;return[s,l,o.reverse()]}static _runMiddleware(t,n,r,o){return new Promise(s=>{const l=b=>{const f=b||n.error;f&&(n.error=nt.serializeError(f)),s([f,!0])},h=b=>{n.error?l(n.error):(b&&(typeof b!="function"&&l(new Ft({code:-32603,message:"JRPCEngine: 'next' return handlers must be functions"})),o.push(b)),s([null,!1]))};try{r(t,n,h,l)}catch(b){l(b)}})}static async _runReturnHandlers(t){for(const n of t)await new Promise((r,o)=>{n(s=>s?o(s):r())})}static _checkForCompletion(t,n,r){if(!("result"in n)&&!("error"in n))throw new Ft({code:-32603,message:"Response has no error or result for request"});if(!r)throw new Ft({code:-32603,message:"Nothing ended request"})}push(t){this._middleware.push(t)}handle(t,n){if(n&&typeof n!="function")throw new Error('"callback" must be a function if provided.');return Array.isArray(t)?n?this._handleBatch(t,n):this._handleBatch(t):n?this._handle(t,n):this._promiseHandle(t)}asMiddleware(){return async(t,n,r,o)=>{try{const[s,l,h]=await Ge._runAllMiddleware(t,n,this._middleware);return l?(await Ge._runReturnHandlers(h),o(s)):r(async b=>{try{await Ge._runReturnHandlers(h)}catch(f){return b(f)}return b()})}catch(s){return o(s)}}}async _handleBatch(t,n){try{const r=await Promise.all(t.map(this._promiseHandle.bind(this)));return n?n(null,r):r}catch(r){if(n)return n(r);throw r}}_promiseHandle(t){return new Promise(n=>{this._handle(t,(r,o)=>{n(o)})})}async _handle(t,n){if(!t||Array.isArray(t)||typeof t!="object"){const l=new Ft({code:-32603,message:"request must be plain object"});return n(l,{id:void 0,jsonrpc:"2.0",error:l})}if(typeof t.method!="string"){const l=new Ft({code:-32603,message:"method must be string"});return n(l,{id:t.id,jsonrpc:"2.0",error:l})}const r=J({},t),o={id:r.id,jsonrpc:r.jsonrpc};let s=null;try{await this._processRequest(r,o)}catch(l){s=l}return s&&(delete o.result,o.error||(o.error=nt.serializeError(s))),n(s,o)}async _processRequest(t,n){const[r,o,s]=await Ge._runAllMiddleware(t,n,this._middleware);if(Ge._checkForCompletion(t,n,o),await Ge._runReturnHandlers(s),r)throw r}}class bf extends Mn.Duplex{constructor(t){let{parent:n,name:r}=t;super({objectMode:!0}),M(this,"_parent",void 0),M(this,"_name",void 0),this._parent=n,this._name=r}_read(){}_write(t,n,r){this._parent.push({name:this._name,data:t}),r()}}const co=Symbol("IGNORE_SUBSTREAM");class es extends Mn.Duplex{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};super(J(J({},t),{},{objectMode:!0})),M(this,"_substreams",void 0),M(this,"getStream",void 0),this._substreams={}}createStream(t){if(!t)throw new Error("ObjectMultiplex - name must not be empty");if(this._substreams[t])throw new Error(`ObjectMultiplex - Substream for name "${t}" already exists`);const n=new bf({parent:this,name:t});return this._substreams[t]=n,pf(this,r=>n.destroy(r||void 0)),n}ignoreStream(t){if(!t)throw new Error("ObjectMultiplex - name must not be empty");if(this._substreams[t])throw new Error(`ObjectMultiplex - Substream for name "${t}" already exists`);this._substreams[t]=co}_read(){}_write(t,n,r){const{name:o,data:s}=t;if(!o)return window.console.warn(`ObjectMultiplex - malformed chunk without name "${t}"`),r();const l=this._substreams[o];return l?(l!==co&&l.push(s),r()):(window.console.warn(`ObjectMultiplex - orphaned data for stream "${o}"`),r())}}function pf(e,t){const n=qs(t);Ei(e,{readable:!1},n),Ei(e,{writable:!1},n)}function gf(e){const t=new es;return t.getStream=function(r){return this._substreams[r]?this._substreams[r]:this.createStream(r)},vr(e,t,e,n=>{n&&window.console.error(n)}),t}const bt={GOOGLE:"google",FACEBOOK:"facebook",TWITCH:"twitch",REDDIT:"reddit",DISCORD:"discord",EMAIL_PASSWORDLESS:"torus-auth0-email-passwordless"},ho={[bt.GOOGLE]:"tkey-google",[bt.FACEBOOK]:"tkey-facebook",[bt.TWITCH]:"tkey-twitch",[bt.REDDIT]:"tkey-reddit",[bt.DISCORD]:"tkey-discord",[bt.EMAIL_PASSWORDLESS]:"tkey-auth0-email-passwordless"},ne={MOONPAY:"moonpay",WYRE:"wyre",RAMPNETWORK:"rampnetwork",XANPOOL:"xanpool",MERCURYO:"mercuryo",TRANSAK:"transak",BANXA:"banxa"},Z={MAINNET:"mainnet",MATIC:"matic",BSC_MAINNET:"bsc_mainnet",AVALANCHE_MAINNET:"avalanche_mainnet",XDAI:"xdai",ARBITRUM_MAINNET:"arbitrum_mainnet",OPTIMISM_MAINNET:"optimism_mainnet"},yf={PRODUCTION:"production",DEVELOPMENT:"development",BINANCE:"binance",TESTING:"testing",LRC:"lrc",BETA:"beta",BNB:"bnb",POLYGON:"polygon",ALPHA:"alpha"},It={BOTTOM_LEFT:"bottom-left",TOP_LEFT:"top-left",BOTTOM_RIGHT:"bottom-right",TOP_RIGHT:"top-right"},_f=["ETH","USDT","USDC","TUSD","EOSDT","USD","DAI","GUSD","DKKT","PAX","ILS","RUB","BYN","EUR","GBP","JPY","KRW","PLN","MXN","AUD","BRL","CAD","CHF","KPW","LAK","LBP","LKR","XOF","CNHT","DOGE","UAH","TRY","HKD","XJP","SGD","USC","NZD","NGN","RUR","COP","GHS","EGP","IDR","BHD","CRC","PEN","AED","DOP","PKR","HUF","VND","XAR","LTC","RON","OMR","MYR","DKK","UGX","ZMW","SAR","SEK","GEL","RWF","IRR","TZS","CNY","VEF","BDT","HRK","CLP","THB","XAF","ARS","UYU","SZL","KZT","NOK","KES","PAB","INR","CZK","MAD","TWD","PHP","ZAR","BOB","CDF","DASH","VES","ISK","MWK","BAM","TTD","XRP","JOD","RSD","HNL","BGN","GTQ","BWP","XMR","MMK","QAR","AOA","KWD","MUR","WUSD","WEUR","WAVES","WTRY","LRD","LSL","LYD","AWG","MDL","BTO","EURS","CHFT","MKD","MNT","MOP","MRO","MVR","VOLLAR","CKUSD","KHR","VUV","BITCNY","QC","BBD","NAD","NPR","PGK","PYG","BIF","BMD","BND","XLM","BNB","SCR","BAT","CRO","HT","KCS","LEO","LINK","MKR","NPXS","OMG","REP","ZB","ZIL","ZRX","BCH","BZD","CUP","CVE","DJF","DZD","ERN","ETB","FJD","FKP","BUSD","ANCT","ALL","AMD","ANG","CNYX","IQD","UZS","TND","GGP","XAU","KGS","GIP","JMD","ZEC","USDP","BSV","EMC2","SNT","GTO","POWR","EUSD","EURT","BCY","BTS","ATM","BLOCKPAY","ARDR","AMP","B2X","BITGOLD","BITEUR","ATB","BITUSD","AGRS","DFXT","HIKEN","BIX","KNC","EOS","COB","COSS","BMH","NANO","BDG","BNT","XVG","LKK1Y","LKK","USDK","EURN","NZDT","JSE","GMD","GNF","GYD","YER","XPF","HTG","SLL","SOS","WST","SVC","SYP","NEO","KMF","JUMP","AYA","BLAST","WGR","BCN","BTG","URALS","INN","USDQ","CNH","HUSD","BKRW","NZDX","EURX","CADX","USDEX","JPYX","AUDX","VNDC","EON","GBPX","CHFX","USDJ","IDRT","USDS","USDN","BIDR","IDK","BSD","BTN","KYD","NIO","SBD","SDG","SHP","TOP","XCD","XCHF","CNYT","GYEN","ZUSD","GOLD","TRX","TRYB","PLATC","STRAX","UST","GLM","VAI","BRZ","DDRST","XAUT","MIM"],wf={[ne.MOONPAY]:["AUD","BGN","BRL","CAD","CHF","CNY","COP","CZK","DKK","DOP","EGP","EUR","GBP","HKD","HRK","IDR","ILS","JPY","JOD","KES","KRW","KWD","LKR","MAD","MXN","MYR","NGN","NOK","NZD","OMR","PEN","PKR","PLN","RON","RUB","SEK","SGD","THB","TRY","TWD","USD","VND","ZAR"],[ne.WYRE]:["USD","EUR","GBP","AUD","CAD","NZD","CNY","ARS","BRL","CHF","CLP","COP","CZK","DKK","HKD","ILS","INR","ISK","JPY","KRW","MXN","MYR","NOK","PHP","PLN","SEK","SGD","THB","VND","ZAR"],[ne.RAMPNETWORK]:["USD","EUR","GBP","BMD","BAM","BWP","BRL","BGN","COP","CRC","CZK","DKK","DOP","GEL","GTQ","HNL","HUF","ISK","INR","ILS","KZT","KES","KWD","LAK","MKD","MYR","MXN","MDL","MZN","NZD","NGN","PYG","PEN","PLN","RON","RSD","SGD","ZAR","LKR","SEK","CHF","TJS","THB","UYU"],[ne.XANPOOL]:["SGD","HKD","THB","PHP","INR","IDR","MYR","AUD","NZD","KRW"],[ne.MERCURYO]:["EUR","USD","GBP","TRY","JPY","BRL","NGN","VND","MXN","KRW","PLN","SEK","CHF","CAD","CZK","DKK","BGN","HKD","AUD","INR"],[ne.TRANSAK]:["ARS","AUD","BBD","BGN","BMD","BRL","CAD","CHF","CLP","CRC","CZK","DKK","DOP","EUR","FJD","FKP","GBP","GIP","HRK","HUF","IDR","ILS","ISK","JMD","JPY","KES","KRW","MDL","MXN","MYR","NOK","NZD","PEN","PHP","PLN","PYG","RON","SEK","SGD","THB","TRY","TZS","USD","ZAR"],[ne.BANXA]:["AUD","CAD","CZK","DKK","EUR","GBP","HKD","JPY","NOK","NZD","NZD","PLN","RUB","SEK","SGD","TRY","USD"]},Sf=new Set(_f);function ft(e){return wf[e].filter(n=>Sf.has(n))}const mf={[ne.MOONPAY]:{line1:"Credit/ Debit Card/ Apple Pay",line2:"4.5% or 5 USD",line3:"2,000€/day, 10,000€/mo",supportPage:"https://help.moonpay.io/en/",minOrderValue:24.99,maxOrderValue:5e4,validCurrencies:ft(ne.MOONPAY),validCryptoCurrenciesByChain:{[Z.MAINNET]:[{value:"aave",display:"AAVE"},{value:"bat",display:"BAT"},{value:"dai",display:"DAI"},{value:"eth",display:"ETH"},{value:"mkr",display:"MKR"},{value:"matic",display:"MATIC"},{value:"usdt",display:"USDT"},{value:"uni",display:"UNI"},{value:"usdc",display:"USDC"},{value:"weth",display:"WETH"}],[Z.MATIC]:[{value:"eth_polygon",display:"ETH"},{value:"matic_polygon",display:"MATIC"},{value:"usdc_polygon",display:"USDC"},{value:"usdt_polygon",display:"USDT"}],[Z.BSC_MAINNET]:[{value:"bnb_bsc",display:"BNB"},{value:"busd_bsc",display:"BUSD"}],[Z.AVALANCHE_MAINNET]:[{value:"avax_cchain",display:"AVAX"},{value:"usdc_cchain",display:"USDC"}],[Z.ARBITRUM_MAINNET]:[{value:"eth_arbitrum",display:"ETH"},{value:"usdc_arbitrum",display:"USDC"}],[Z.OPTIMISM_MAINNET]:[{value:"eth_optimism",display:"ETH"},{value:"usdc_optimism",display:"USDC"}]},includeFees:!0,api:!0,enforceMax:!1},[ne.WYRE]:{line1:"Apple Pay/ Debit/ Credit Card",line2:"4.9% + 30¢ or 5 USD",line3:"$250/day",supportPage:"https://support.sendwyre.com/en/",minOrderValue:5,maxOrderValue:500,validCurrencies:ft(ne.WYRE),validCryptoCurrenciesByChain:{[Z.MAINNET]:[{value:"AAVE",display:"AAVE"},{value:"COMP",display:"COMP"},{value:"BAT",display:"BAT"},{value:"BUSD",display:"BUSD"},{value:"DAI",display:"DAI"},{value:"ETH",display:"ETH"},{value:"WBTC",display:"WBTC"},{value:"MKR",display:"MKR"},{value:"UNI",display:"UNI"},{value:"WETH",display:"WETH"},{value:"USDC",display:"USDC"},{value:"USDT",display:"USDT"}],[Z.MATIC]:[{value:"mUSDC",display:"USDC"},{value:"MATIC",display:"MATIC"},{value:"MWETH",display:"WETH"}],[Z.AVALANCHE_MAINNET]:[{value:"AVAXC",display:"AVAX"},{value:"AVAXCUSDC",display:"USDC"}],[Z.BSC_MAINNET]:[{value:"BNB",display:"BNB"},{value:"BBUSD",display:"BUSD"}]},includeFees:!1,api:!0,enforceMax:!1},[ne.RAMPNETWORK]:{line1:"Debit Card/ <br>Apple Pay/ Bank transfer",line2:"0.49% - 2.9%",line3:"5,000€/purchase, 20,000€/mo",supportPage:"https://instant.ramp.network/",minOrderValue:50,maxOrderValue:2e4,validCurrencies:ft(ne.RAMPNETWORK),validCryptoCurrenciesByChain:{[Z.MAINNET]:[{value:"ETH",display:"ETH"},{value:"DAI",display:"DAI"},{value:"BAT",display:"BAT"},{value:"USDC",display:"USDC"},{value:"USDT",display:"USDT"}],[Z.MATIC]:[{value:"MATIC_BAT",display:"BAT"},{value:"MATIC_DAI",display:"DAI"},{value:"MATIC_MATIC",display:"MATIC"},{value:"MATIC_USDC",display:"USDC"},{value:"MATIC_USDT",display:"USDT"}],[Z.AVALANCHE_MAINNET]:[{value:"AVAX_AVAX",display:"AVAX"},{value:"AVAX_USDC",display:"USDC"},{value:"AVAX_USDT",display:"USDT"}],[Z.ARBITRUM_MAINNET]:[{value:"ARBITRUM_ETH",display:"ETH"},{value:"ARBITRUM_USDC.e	",display:"USDC"},{value:"ARBITRUM_USDT",display:"USDT"}],[Z.OPTIMISM_MAINNET]:[{value:"OPTIMISM_DAI",display:"DAI"},{value:"OPTIMISM_OPTIMISM",display:"OPTIMISM"},{value:"OPTIMISM_USDC",display:"USDC"},{value:"OPTIMISM_USDT",display:"USDT"}],[Z.BSC_MAINNET]:[{value:"BSC_BNB",display:"BNB"},{value:"BSC_BUSD",display:"BUSD"}]},includeFees:!0,api:!0,receiveHint:"walletTopUp.receiveHintRamp",enforceMax:!1},[ne.XANPOOL]:{line1:"PayNow/ InstaPay/ FPS/ GoJekPay/ UPI/ PromptPay/ <br>ViettelPay/ DuitNow",line2:"2.5% buying, 3% selling",line3:"$2,500 / day",supportPage:"mailto:support@xanpool.com",minOrderValue:100,maxOrderValue:2500,validCurrencies:ft(ne.XANPOOL),validCryptoCurrenciesByChain:{[Z.MAINNET]:[{value:"ETH",display:"ETH"},{value:"USDT",display:"USDT"},{value:"USDC",display:"USDC"}]},includeFees:!0,api:!0,sell:!0,enforceMax:!1},[ne.MERCURYO]:{line1:"Credit/ Debit Card/ Apple Pay",line2:"3.95% or 4 USD",line3:"10,000€/day, 25,000€/mo",supportPage:"mailto:support@mercuryo.io",minOrderValue:30,maxOrderValue:5e3,validCurrencies:ft(ne.MERCURYO),validCryptoCurrenciesByChain:{[Z.MAINNET]:[{value:"ETH",display:"ETH"},{value:"BAT",display:"BAT"},{value:"USDT",display:"USDT"},{value:"DAI",display:"DAI"}],[Z.BSC_MAINNET]:[{value:"BNB",display:"BNB"},{value:"BUSD",display:"BUSD"},{value:"1INCH",display:"1INCH"}],[Z.AVALANCHE_MAINNET]:[{value:"AVAX",display:"AVAX"}],[Z.MATIC]:[{value:"MATIC",display:"MATIC"}]},includeFees:!0,api:!0,enforceMax:!1},[ne.TRANSAK]:{line1:"Apple & Google Pay / Credit/Debit Card<br/>Bangkok Bank Mobile & iPay<br/>Bank Transfer (sepa/gbp) / SCB Mobile & Easy",line2:"0.99% - 5.5% or 5 USD",line3:"$5,000/day, $28,000/mo",supportPage:"https://support.transak.com/hc/en-US",minOrderValue:30,maxOrderValue:500,validCurrencies:ft(ne.TRANSAK),validCryptoCurrenciesByChain:{[Z.MAINNET]:[{value:"1INCH",display:"1INCH"},{value:"BAT",display:"BAT"},{value:"AAVE",display:"AAVE"},{value:"DAI",display:"DAI"},{value:"ETH",display:"ETH"},{value:"USDC",display:"USDC"},{value:"USDT",display:"USDT"}],[Z.MATIC]:[{value:"BAT",display:"BAT"},{value:"AAVE",display:"AAVE"},{value:"DAI",display:"DAI"},{value:"MATIC",display:"MATIC"},{value:"USDC",display:"USDC"},{value:"USDT",display:"USDT"},{value:"WETH",display:"WETH"}],[Z.BSC_MAINNET]:[{value:"BAT",display:"BAT"},{value:"BNB",display:"BNB"},{value:"BUSD",display:"BUSD"}],[Z.AVALANCHE_MAINNET]:[{value:"AVAX",display:"AVAX"}],[Z.OPTIMISM_MAINNET]:[{value:"ETH",display:"ETH"},{value:"USDC",display:"USDC"}],[Z.ARBITRUM_MAINNET]:[{value:"USDC",display:"USDC"},{value:"ETH",display:"ETH"}]},includeFees:!0,enforceMax:!0},[ne.BANXA]:{line1:"Debit Card/ <br>Apple Pay/ Bank transfer",line2:"0.49% - 2.9%",line3:"5,000€/purchase, 20,000€/mo",supportPage:"https://support.banxa.com",minOrderValue:20,maxOrderValue:15e3,validCurrencies:ft(ne.BANXA),validCryptoCurrenciesByChain:{[Z.MAINNET]:[{value:"ETH",display:"ETH"},{value:"DAI",display:"DAI"},{value:"MKR",display:"MKR"},{value:"USDT",display:"USDT"},{value:"BUSD",display:"BUSD"},{value:"USDC",display:"USDC"},{value:"BAT",display:"BAT"},{value:"AAVE",display:"AAVE"},{value:"COMP",display:"COMP"},{value:"UNI",display:"UNI"}],[Z.MATIC]:[{value:"MATIC",display:"MATIC"}]},includeFees:!0,enforceMax:!0}},Ef={en:{embed:{continue:"Continue",actionRequired:"Authorization required",pendingAction:"Click continue to proceed with your request in a popup",cookiesRequired:"Cookies Required",enableCookies:"Please enable cookies in your browser preferences to access Torus",clickHere:"More Info"}},de:{embed:{continue:"Fortsetzen",actionRequired:"Autorisierung erforderlich",pendingAction:"Klicken Sie in einem Popup auf Weiter, um mit Ihrer Anfrage fortzufahren",cookiesRequired:"Cookies benötigt",enableCookies:"Bitte aktivieren Sie Cookies in Ihren Browsereinstellungen, um auf Torus zuzugreifen",clickHere:"Mehr Info"}},ja:{embed:{continue:"継続する",actionRequired:"認証が必要です",pendingAction:"続行をクリックして、ポップアップでリクエストを続行します",cookiesRequired:"必要なクッキー",enableCookies:"Torusにアクセスするには、ブラウザの設定でCookieを有効にしてください。",clickHere:"詳しくは"}},ko:{embed:{continue:"계속하다",actionRequired:"승인 필요",pendingAction:"팝업에서 요청을 진행하려면 계속을 클릭하십시오.",cookiesRequired:"쿠키 필요",enableCookies:"브라우저 환경 설정에서 쿠키를 활성화하여 Torus에 액세스하십시오.",clickHere:"더 많은 정보"}},zh:{embed:{continue:"继续",actionRequired:"需要授权",pendingAction:"单击继续以在弹出窗口中继续您的请求",cookiesRequired:"必填Cookie",enableCookies:"请在您的浏览器首选项中启用cookie以访问Torus。",clickHere:"更多信息"}}};var We={supportedVerifierList:Object.values(bt),paymentProviders:mf,api:"https://api.tor.us",translations:Ef,prodTorusUrl:"",localStorageKeyPrefix:"torus-"};const jt=e=>{const t=window.document.createElement("template"),n=e.trim();return t.innerHTML=n,t.content.firstChild},xe=(e,t,n)=>{const r=o=>{n(o),e.removeListener(t,r)};e.on(t,r)};function ts(e){return e!==null&&typeof e=="object"&&typeof e.pipe=="function"}function Rf(e){return ts(e)&&e.writable!==!1&&typeof e._write=="function"&&typeof e._writableState=="object"}function Af(e){return ts(e)&&e.readable!==!1&&typeof e._read=="function"&&typeof e._readableState=="object"}function Tf(e){return Rf(e)&&Af(e)}var ee=wn.getLogger("torus-embed"),Ie={errors:{disconnected:()=>"Torus: Lost connection to Torus.",permanentlyDisconnected:()=>"Torus: Disconnected from iframe. Page reload required.",sendSiteMetadata:()=>"Torus: Failed to send site metadata. This is an internal error, please report this bug.",unsupportedSync:e=>`Torus: The Torus Ethereum provider does not support synchronous methods like ${e} without a callback parameter.`,invalidDuplexStream:()=>"Must provide a Node.js-style duplex stream.",invalidOptions:(e,t)=>`Invalid options. Received: { maxEventListeners: ${e}, shouldSendMetadata: ${t} }`,invalidRequestArgs:()=>"Expected a single, non-array, object argument.",invalidRequestMethod:()=>"'args.method' must be a non-empty string.",invalidRequestParams:()=>"'args.params' must be an object or array if provided.",invalidLoggerObject:()=>"'args.logger' must be an object if provided.",invalidLoggerMethod:e=>`'args.logger' must include required method '${e}'.`},info:{connected:e=>`Torus: Connected to chain with ID "${e}".`},warnings:{enableDeprecation:'Torus: ""ethereum.enable()" is deprecated and may be removed in the future. Please use "ethereum.send("eth_requestAccounts")" instead. For more information, see: https://eips.ethereum.org/EIPS/eip-1102',sendDeprecation:`Torus: "ethereum.send(...)" is deprecated and may be removed in the future. Please use "ethereum.sendAsync(...)" or "ethereum.request(...)" instead.
For more information, see: https://eips.ethereum.org/EIPS/eip-1193`}};const{paymentProviders:bo}=We,If=(e,t)=>{const n={};if(!e)return{errors:n,isValid:!0};if(e&&!bo[e])return n.provider="Invalid Provider",{errors:n,isValid:Object.keys(n).length===0};const r=bo[e],o=t||{};if(o.fiatValue){const s=+parseFloat(o.fiatValue.toString())||0;s<r.minOrderValue&&(n.fiatValue="Requested amount is lower than supported"),s>r.maxOrderValue&&r.enforceMax&&(n.fiatValue="Requested amount is higher than supported")}if(o.selectedCurrency&&!r.validCurrencies.includes(o.selectedCurrency)&&(n.selectedCurrency="Unsupported currency"),o.selectedCryptoCurrency){const s=Object.values(r.validCryptoCurrenciesByChain).flat().map(h=>h.value),l=e===ne.MOONPAY?o.selectedCryptoCurrency.toLowerCase():o.selectedCryptoCurrency;s&&!s.includes(l)&&(n.selectedCryptoCurrency="Unsupported cryptoCurrency")}return{errors:n,isValid:Object.keys(n).length===0}};function Nf(){return(e,t,n)=>{(typeof e.method!="string"||!e.method)&&(t.error=nt.rpcErrors.invalidRequest({message:"The request 'method' must be a non-empty string.",data:J(J({},e||{}),{},{cause:"The request 'method' must be a non-empty string."})})),n(r=>{const{error:o}=t;return o&&ee.error(`MetaMask - RPC Error: ${o.message}`,o),r()})}}function vf(e,t,n){let r=`MetaMask: Lost connection to "${e}".`;t!=null&&t.stack&&(r+=`
${t.stack}`),ee.warn(r),n&&n.listenerCount("error")>0&&n.emit("error",r)}const pt=()=>Math.random().toString(36).slice(2),ns=async(e,t)=>{let n,r;const o="4.0.8";let s=t.version||o;try{if((e==="binance"||e==="production")&&!t.version){let l;We.prodTorusUrl?l={data:We.prodTorusUrl}:l=await da(`${We.api}/latestversion?name=@toruslabs/torus-embed&version=${o}`,{},{useAPIKey:!0}),s=l.data,We.prodTorusUrl=l.data}}catch(l){ee.error(l,"unable to fetch latest version")}switch(ee.info("version used: ",s),e){case"binance":n=`https://binance.tor.us/v${s}`,r="info";break;case"testing":n="https://testing.tor.us",r="debug";break;case"bnb":n="https://bnb.tor.us",r="error";break;case"polygon":n="https://polygon.tor.us",r="error";break;case"lrc":n="https://lrc.tor.us",r="debug";break;case"beta":n="https://beta.tor.us",r="debug";break;case"development":n="http://localhost:4050",r="debug";break;case"alpha":n="https://alpha.tor.us",r="debug";break;default:n=`https://app.tor.us/v${s}`,r="error";break}return{torusUrl:n,logLevel:r}},po=()=>{let e=window.navigator.language||"en-US";const t=e.split("-");return e=Object.prototype.hasOwnProperty.call(We.translations,t[0])?t[0]:"en",e},Cf=["eth_subscription"],rs=()=>{},go="directories=0,titlebar=0,toolbar=0,status=0,location=0,menubar=0,height=660,width=375",$f="directories=0,titlebar=0,toolbar=0,status=0,location=0,menubar=0,height=740,width=1315",yo="directories=0,titlebar=0,toolbar=0,status=0,location=0,menubar=0,height=700,width=450";function Mf(){const e=window.screenLeft!==void 0?window.screenLeft:window.screenX,t=window.screenTop!==void 0?window.screenTop:window.screenY,n=1200,r=700,o=window.innerWidth?window.innerWidth:document.documentElement.clientWidth?document.documentElement.clientWidth:window.screen.width,s=window.innerHeight?window.innerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:window.screen.height,l=1,h=Math.abs((o-n)/2/l+e),b=Math.abs((s-r)/2/l+t);return`titlebar=0,toolbar=0,status=0,location=0,menubar=0,height=${r/l},width=${n/l},top=${b},left=${h}`}Xt.defaultMaxListeners=100;const _o=function(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;return(r,o)=>r||o.error?t(r||o.error):!n||Array.isArray(o)?e(o):e(o.result)};class Dn extends Xt{constructor(t){let{maxEventListeners:n=100,shouldSendMetadata:r=!0,jsonRpcStreamName:o="provider"}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(super(),M(this,"chainId",void 0),M(this,"selectedAddress",void 0),M(this,"_rpcEngine",void 0),M(this,"networkVersion",void 0),M(this,"shouldSendMetadata",void 0),M(this,"isTorus",void 0),M(this,"tryPreopenHandle",void 0),M(this,"enable",void 0),M(this,"_state",void 0),M(this,"_jsonRpcConnection",void 0),!Tf(t))throw new Error(Ie.errors.invalidDuplexStream());this.isTorus=!0,this.setMaxListeners(n),this._state=J({},Dn._defaultState),this.selectedAddress=null,this.networkVersion=null,this.chainId=null,this.shouldSendMetadata=r,this._handleAccountsChanged=this._handleAccountsChanged.bind(this),this._handleChainChanged=this._handleChainChanged.bind(this),this._handleUnlockStateChanged=this._handleUnlockStateChanged.bind(this),this._handleConnect=this._handleConnect.bind(this),this._handleDisconnect=this._handleDisconnect.bind(this),this._handleStreamDisconnect=this._handleStreamDisconnect.bind(this),this._sendSync=this._sendSync.bind(this),this._rpcRequest=this._rpcRequest.bind(this),this._initializeState=this._initializeState.bind(this),this.request=this.request.bind(this),this.send=this.send.bind(this),this.sendAsync=this.sendAsync.bind(this);const s=new es;vr(t,s,t,this._handleStreamDisconnect.bind(this,"MetaMask")),s.ignoreStream("phishing"),this.on("connect",()=>{this._state.isConnected=!0});const l=cf();vr(l.stream,s.createStream(o),l.stream,this._handleStreamDisconnect.bind(this,"MetaMask RpcProvider"));const h=new Ge;h.push(hf()),h.push(Nf()),h.push(l.middleware),this._rpcEngine=h,l.events.on("notification",b=>{const{method:f,params:c}=b;f==="wallet_accountsChanged"?this._handleAccountsChanged(c):f==="wallet_unlockStateChanged"?this._handleUnlockStateChanged(c):f==="wallet_chainChanged"?this._handleChainChanged(c):Cf.includes(b.method)&&(this.emit("data",b),this.emit("notification",c.result),this.emit("message",{type:f,data:c}))})}isConnected(){return this._state.isConnected}async request(t){if(!t||typeof t!="object"||Array.isArray(t))throw nt.rpcErrors.invalidRequest({message:Ie.errors.invalidRequestArgs(),data:J(J({},t||{}),{},{cause:Ie.errors.invalidRequestArgs()})});const{method:n,params:r}=t;if(typeof n!="string"||n.length===0)throw nt.rpcErrors.invalidRequest({message:Ie.errors.invalidRequestMethod(),data:J(J({},t||{}),{},{cause:Ie.errors.invalidRequestArgs()})});if(r!==void 0&&!Array.isArray(r)&&(typeof r!="object"||r===null))throw nt.rpcErrors.invalidRequest({message:Ie.errors.invalidRequestParams(),data:J(J({},t||{}),{},{cause:Ie.errors.invalidRequestArgs()})});return new Promise((o,s)=>{this._rpcRequest({method:n,params:r},_o(o,s))})}sendAsync(t,n){this._rpcRequest(t,n)}async _initializeState(){try{const{accounts:t,chainId:n,isUnlocked:r,networkVersion:o}=await this.request({method:"wallet_getProviderState"});this.emit("connect",{chainId:n}),this._handleChainChanged({chainId:n,networkVersion:o}),this._handleUnlockStateChanged({accounts:t,isUnlocked:r}),this._handleAccountsChanged(t)}catch(t){ee.error("MetaMask: Failed to get initial state. Please report this bug.",t)}finally{ee.info("initialized state"),this._state.initialized=!0,this.emit("_initialized")}}_rpcRequest(t,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=n;const s=t;if(!Array.isArray(s)){if(s.jsonrpc||(s.jsonrpc="2.0"),s.method==="eth_accounts"||s.method==="eth_requestAccounts")o=(l,h)=>{this._handleAccountsChanged(h.result||[],s.method==="eth_accounts",r),n(l,h)};else if(s.method==="wallet_getProviderState"){this._rpcEngine.handle(t,o);return}}this.tryPreopenHandle(s,o)}send(t,n){return typeof t=="string"&&(!n||Array.isArray(n))?new Promise((r,o)=>{try{this._rpcRequest({method:t,params:n},_o(r,o,!1))}catch(s){o(s)}}):t&&typeof t=="object"&&typeof n=="function"?this._rpcRequest(t,n):this._sendSync(t)}_sendSync(t){let n;switch(t.method){case"eth_accounts":n=this.selectedAddress?[this.selectedAddress]:[];break;case"eth_coinbase":n=this.selectedAddress||null;break;case"eth_uninstallFilter":this._rpcRequest(t,rs),n=!0;break;case"net_version":n=this.networkVersion||null;break;default:throw new Error(Ie.errors.unsupportedSync(t.method))}return{id:t.id,jsonrpc:t.jsonrpc,result:n}}_handleConnect(t){this._state.isConnected||(this._state.isConnected=!0,this.emit("connect",{chainId:t}),ee.debug(Ie.info.connected(t)))}_handleDisconnect(t,n){if(this._state.isConnected||!this._state.isPermanentlyDisconnected&&!t){this._state.isConnected=!1;let r;t?(r=new nt.EthereumProviderError(1013,n||Ie.errors.disconnected()),ee.debug(r)):(r=new nt.EthereumProviderError(1011,n||Ie.errors.permanentlyDisconnected()),ee.error(r),this.chainId=null,this._state.accounts=null,this.selectedAddress=null,this._state.isUnlocked=!1,this._state.isPermanentlyDisconnected=!0),this.emit("disconnect",r)}}_handleStreamDisconnect(t,n){vf(t,n,this),this._handleDisconnect(!1,n?n.message:void 0)}_handleAccountsChanged(t){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=t;Array.isArray(o)||(ee.error("MetaMask: Received non-array accounts parameter. Please report this bug.",o),o=[]);for(const s of t)if(typeof s!="string"){ee.error("MetaMask: Received non-string account. Please report this bug.",t),o=[];break}Qs(this._state.accounts,o)||(n&&Array.isArray(this._state.accounts)&&this._state.accounts.length>0&&!r&&ee.error('MetaMask: "eth_accounts" unexpectedly updated accounts. Please report this bug.',o),this._state.accounts=o,this.emit("accountsChanged",o)),this.selectedAddress!==o[0]&&(this.selectedAddress=o[0]||null)}_handleChainChanged(){let{chainId:t,networkVersion:n}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!t||!n){ee.error("MetaMask: Received invalid network parameters. Please report this bug.",{chainId:t,networkVersion:n});return}n==="loading"?this._handleDisconnect(!0):(this._handleConnect(t),t!==this.chainId&&(this.chainId=t,this._state.initialized&&this.emit("chainChanged",this.chainId)))}_handleUnlockStateChanged(){let{accounts:t,isUnlocked:n}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(typeof n!="boolean"){ee.error("MetaMask: Received invalid isUnlocked parameter. Please report this bug.",{isUnlocked:n});return}n!==this._state.isUnlocked&&(this._state.isUnlocked=n,this._handleAccountsChanged(t||[]))}}M(Dn,"_defaultState",{accounts:null,isConnected:!1,isUnlocked:!1,initialized:!1,isPermanentlyDisconnected:!1,hasEmittedConnection:!1});class wo extends Xt{constructor(t){let{url:n,target:r,features:o,timeout:s=3e4}=t;super(),M(this,"url",void 0),M(this,"target",void 0),M(this,"features",void 0),M(this,"window",void 0),M(this,"windowTimer",void 0),M(this,"iClosedWindow",void 0),M(this,"timeout",void 0),this.url=n,this.target=r||"_blank",this.features=o||Mf(),this.window=void 0,this.windowTimer=void 0,this.iClosedWindow=!1,this.timeout=s,this._setupTimer()}_setupTimer(){this.windowTimer=Number(setInterval(()=>{this.window&&this.window.closed&&(clearInterval(this.windowTimer),setTimeout(()=>{this.iClosedWindow||this.emit("close"),this.iClosedWindow=!1,this.window=void 0},this.timeout)),this.window===void 0&&clearInterval(this.windowTimer)},500))}open(){var t;this.window=window.open(this.url.href,this.target,this.features),(t=this.window)!==null&&t!==void 0&&t.focus&&this.window.focus()}close(){this.iClosedWindow=!0,this.window&&this.window.close()}redirect(t){t?window.location.replace(this.url.href):window.location.href=this.url.href}}function So(e){return new Promise((t,n)=>{try{const r=document.createElement("img");r.onload=()=>t(!0),r.onerror=()=>t(!1),r.src=e}catch(r){n(r)}})}const Df=e=>{const{document:t}=e,n=t.querySelector('head > meta[property="og:site_name"]');if(n)return n.content;const r=t.querySelector('head > meta[name="title"]');return r?r.content:t.title&&t.title.length>0?t.title:e.location.hostname};async function Pf(e){const{document:t}=e;let n=t.querySelector('head > link[rel="shortcut icon"]');return n&&await So(n.href)||(n=Array.from(t.querySelectorAll('head > link[rel="icon"]')).find(r=>!!r.href),n&&await So(n.href))?n.href:null}const Of=async()=>({name:Df(window),icon:await Pf(window)});async function Lf(e){try{const t=await Of();e.handle({jsonrpc:"2.0",id:pt(),method:"wallet_sendDomainMetadata",params:t},rs)}catch(t){ee.error({message:Ie.errors.sendSiteMetadata(),originalError:t})}}const kf=["host","chainId","networkName"],xf=["eth_sendTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","personal_sign","eth_getEncryptionPublicKey","eth_decrypt","wallet_addEthereumChain","wallet_switchEthereumChain"];(async function(){try{if(typeof document>"u")return;const t=document.createElement("link"),{torusUrl:n}=await ns("production",{version:""});t.href=`${n}/popup`,t.crossOrigin="anonymous",t.type="text/html",t.rel="prefetch",t.relList&&t.relList.supports&&t.relList.supports("prefetch")&&document.head.appendChild(t)}catch(t){ee.warn(t)}})();class Wf{constructor(){let{buttonPosition:t=It.BOTTOM_LEFT,buttonSize:n=56,modalZIndex:r=99999,apiKey:o="torus-default"}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};M(this,"buttonPosition",It.BOTTOM_LEFT),M(this,"buttonSize",void 0),M(this,"torusUrl",void 0),M(this,"torusIframe",void 0),M(this,"styleLink",void 0),M(this,"isLoggedIn",void 0),M(this,"isInitialized",void 0),M(this,"torusWidgetVisibility",void 0),M(this,"torusAlert",void 0),M(this,"apiKey",void 0),M(this,"modalZIndex",void 0),M(this,"alertZIndex",void 0),M(this,"torusAlertContainer",void 0),M(this,"isIframeFullScreen",void 0),M(this,"whiteLabel",void 0),M(this,"requestedVerifier",void 0),M(this,"currentVerifier",void 0),M(this,"embedTranslations",void 0),M(this,"ethereum",void 0),M(this,"provider",void 0),M(this,"communicationMux",void 0),M(this,"isLoginCallback",void 0),M(this,"paymentProviders",We.paymentProviders),M(this,"loginHint",""),M(this,"useWalletConnect",void 0),M(this,"isCustomLogin",!1),this.buttonPosition=t,this.buttonSize=n,this.torusUrl="",this.isLoggedIn=!1,this.isInitialized=!1,this.torusWidgetVisibility=!0,this.requestedVerifier="",this.currentVerifier="",this.apiKey=o,il(o),this.modalZIndex=r,this.alertZIndex=r+1e3,this.isIframeFullScreen=!1}async init(){let{buildEnv:t=yf.PRODUCTION,enableLogging:n=!1,network:r={host:"mainnet",chainId:null,networkName:"",blockExplorer:"",ticker:"",tickerName:""},loginConfig:o={},showTorusButton:s=!0,integrity:l={version:""},whiteLabel:h,useWalletConnect:b=!1,mfaLevel:f="default"}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(this.isInitialized)throw new Error("Already initialized");const{torusUrl:c,logLevel:R}=await ns(t,l);ee.info(c,"url loaded"),this.torusUrl=c,this.whiteLabel=h,this.useWalletConnect=b,this.isCustomLogin=!!(o&&Object.keys(o).length>0)||!!(h&&Object.keys(h).length>0),ee.setDefaultLevel(R),n?ee.enableAll():ee.disableAll(),this.torusWidgetVisibility=s;const A=new URL(c);A.pathname.endsWith("/")?A.pathname+="popup":A.pathname+="/popup",A.hash=`#isCustomLogin=${this.isCustomLogin}`,this.torusIframe=jt(`<iframe
        id="torusIframe"
        allow=${b?"camera":""}
        class="torusIframe"
        src="${A.href}"
        style="display: none; position: fixed; top: 0; right: 0; width: 100%; color-scheme: none;
        height: 100%; border: none; border-radius: 0; z-index: ${this.modalZIndex}"
      ></iframe>`),this.torusAlertContainer=jt('<div id="torusAlertContainer"></div>'),this.torusAlertContainer.style.display="none",this.torusAlertContainer.style.setProperty("z-index",this.alertZIndex.toString());const y=window.document.createElement("link");y.setAttribute("rel","stylesheet"),y.setAttribute("type","text/css"),y.setAttribute("href",`${c}/css/widget.css`),this.styleLink=y;const{defaultLanguage:p=po(),customTranslations:P={}}=this.whiteLabel||{},I=sa(We.translations,P)[p]||We.translations[po()];return this.embedTranslations=I.embed,new Promise((_,L)=>{this.torusIframe.onload=async()=>{this._setupWeb3();const F=this.communicationMux.getStream("init_stream");F.on("data",D=>{const{name:K,data:j,error:G}=D;K==="init_complete"&&j.success?(this.isInitialized=!0,this._displayIframe(this.isIframeFullScreen),_(void 0)):G&&L(new Error(G))}),F.write({name:"init_stream",data:{loginConfig:o,whiteLabel:this.whiteLabel,buttonPosition:this.buttonPosition,buttonSize:this.buttonSize,torusWidgetVisibility:this.torusWidgetVisibility,apiKey:this.apiKey,network:r,mfaLevel:f}})},window.document.head.appendChild(this.styleLink),window.document.body.appendChild(this.torusIframe),window.document.body.appendChild(this.torusAlertContainer)})}login(){let{verifier:t="",login_hint:n=""}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!this.isInitialized)throw new Error("Call init() first");return this.requestedVerifier=t,this.loginHint=n,this.ethereum.enable()}logout(){return new Promise((t,n)=>{if(!this.isLoggedIn){n(new Error("User has not logged in yet"));return}this.communicationMux.getStream("logout").write({name:"logOut"});const o=this.communicationMux.getStream("status");xe(o,"data",l=>{l.loggedIn?n(new Error("Some Error Occured")):(this.isLoggedIn=!1,this.currentVerifier="",this.requestedVerifier="",t())})})}async cleanUp(){this.isLoggedIn&&await this.logout(),this.clearInit()}clearInit(){function t(n){return n instanceof Element||n instanceof HTMLDocument}t(this.styleLink)&&window.document.body.contains(this.styleLink)&&(this.styleLink.remove(),this.styleLink=void 0),t(this.torusIframe)&&window.document.body.contains(this.torusIframe)&&(this.torusIframe.remove(),this.torusIframe=void 0),t(this.torusAlertContainer)&&window.document.body.contains(this.torusAlertContainer)&&(this.torusAlert=void 0,this.torusAlertContainer.remove(),this.torusAlertContainer=void 0),this.isInitialized=!1}hideTorusButton(){this.torusWidgetVisibility=!1,this._sendWidgetVisibilityStatus(!1),this._displayIframe()}showTorusButton(){this.torusWidgetVisibility=!0,this._sendWidgetVisibilityStatus(!0),this._displayIframe()}setProvider(t){let{host:n="mainnet",chainId:r=null,networkName:o=""}=t,s=nl(t,kf);return new Promise((l,h)=>{const b=this.communicationMux.getStream("provider_change");xe(b,"data",R=>{const A=R,{err:y,success:p}=A.data;ee.info(A),y?h(y):p?l():h(new Error("some error occurred"))});const c=pt();this._handleWindow(c,{target:"_blank",features:go}),b.write({name:"show_provider_change",data:{network:J({host:n,chainId:r,networkName:o},s),preopenInstanceId:c,override:!1}})})}showWallet(t){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r=this.communicationMux.getStream("show_wallet"),o=t?`/${t}`:"";r.write({name:"show_wallet",data:{path:o}}),xe(r,"data",l=>{const h=l;if(h.name==="show_wallet_instance"){const{instanceId:b}=h.data,f=new URL(`${this.torusUrl}/wallet${o}`);f.searchParams.append("integrity","true"),f.searchParams.append("instanceId",b),Object.keys(n).forEach(R=>{f.searchParams.append(R,n[R])}),f.hash=`#isCustomLogin=${this.isCustomLogin}`,new wo({url:f,features:$f}).open()}})}async getPublicAddress(t){let{verifier:n,verifierId:r,isExtended:o=!1}=t;if(!We.supportedVerifierList.includes(n)||!ho[n])throw new Error("Unsupported verifier");const s=n,l=ho[n],h=new URL("https://api.tor.us/lookup/torus");return h.searchParams.append("verifier",l),h.searchParams.append("verifierId",r),h.searchParams.append("walletVerifier",s),h.searchParams.append("network","mainnet"),h.searchParams.append("isExtended",o.toString()),da(h.href,{headers:{"Content-Type":"application/json; charset=utf-8"}},{useAPIKey:!0})}getUserInfo(t){return new Promise((n,r)=>{if(this.isLoggedIn){const o=this.communicationMux.getStream("user_info_access");o.write({name:"user_info_access_request"}),xe(o,"data",l=>{const h=l,{name:b,data:{approved:f,payload:c,rejected:R,newRequest:A}}=h;if(b==="user_info_access_response"){if(f)n(c);else if(R)r(new Error("User rejected the request"));else if(A){const y=this.communicationMux.getStream("user_info");xe(y,"data",$=>{const I=$;I.name==="user_info_response"&&(I.data.approved?n(I.data.payload):r(new Error("User rejected the request")))});const P=pt();this._handleWindow(P,{target:"_blank",features:go}),y.write({name:"user_info_request",data:{message:t,preopenInstanceId:P}})}}})}else r(new Error("User has not logged in yet"))})}initiateTopup(t,n){return new Promise((r,o)=>{if(this.isInitialized){const{errors:s,isValid:l}=If(t,n);if(!l){o(new Error(JSON.stringify(s)));return}const h=this.communicationMux.getStream("topup");xe(h,"data",c=>{const R=c;R.name==="topup_response"&&(R.data.success?r(R.data.success):o(new Error(R.data.error)))});const f=pt();this._handleWindow(f),h.write({name:"topup_request",data:{provider:t,params:n,preopenInstanceId:f}})}else o(new Error("Torus is not initialized yet"))})}async loginWithPrivateKey(t){const{privateKey:n,userInfo:r}=t;return new Promise((o,s)=>{if(this.isInitialized){if(Xs.Buffer.from(n,"hex").length!==32){s(new Error("Invalid private key, Please provide a 32 byte valid secp25k1 private key"));return}const l=this.communicationMux.getStream("login_with_private_key");xe(l,"data",b=>{const f=b;f.name==="login_with_private_key_response"&&(f.data.success?o(f.data.success):s(new Error(f.data.error)))}),l.write({name:"login_with_private_key_request",data:{privateKey:n,userInfo:r}})}else s(new Error("Torus is not initialized yet"))})}async showWalletConnectScanner(){if(!this.useWalletConnect)throw new Error("Set `useWalletConnect` as true in init function options to use wallet connect scanner");return new Promise((t,n)=>{if(this.isLoggedIn){const r=this.communicationMux.getStream("wallet_connect_stream");xe(r,"data",s=>{const l=s;l.name==="wallet_connect_stream_res"&&(l.data.success?t(l.data.success):n(new Error(l.data.error)),this._displayIframe())}),r.write({name:"wallet_connect_stream_req"}),this._displayIframe(!0)}else n(new Error("User has not logged in yet"))})}_handleWindow(t){let{url:n,target:r,features:o}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t){const s=this.communicationMux.getStream("window"),l=new URL(n||`${this.torusUrl}/redirect?preopenInstanceId=${t}`);l.hash?l.hash+=`&isCustomLogin=${this.isCustomLogin}`:l.hash=`#isCustomLogin=${this.isCustomLogin}`;const h=new wo({url:l,target:r,features:o});if(h.open(),!h.window){this._createPopupBlockAlert(t,l.href);return}s.write({name:"opened_window",data:{preopenInstanceId:t}});const b=f=>{let{preopenInstanceId:c,close:R}=f;c===t&&R&&(h.close(),s.removeListener("data",b))};s.on("data",b),h.once("close",()=>{s.write({data:{preopenInstanceId:t,closed:!0}}),s.removeListener("data",b)})}}_setEmbedWhiteLabel(t){const{theme:n}=this.whiteLabel||{};if(n){const{isDark:r=!1,colors:o={}}=n;r&&t.classList.add("torus-dark"),o.torusBrand1&&t.style.setProperty("--torus-brand-1",o.torusBrand1),o.torusGray2&&t.style.setProperty("--torus-gray-2",o.torusGray2)}}_getLogoUrl(){var t;let n=`${this.torusUrl}/images/torus_icon-blue.svg`;if((t=this.whiteLabel)!==null&&t!==void 0&&(t=t.theme)!==null&&t!==void 0&&t.isDark){var r;n=((r=this.whiteLabel)===null||r===void 0?void 0:r.logoLight)||n}else{var o;n=((o=this.whiteLabel)===null||o===void 0?void 0:o.logoDark)||n}return n}_sendWidgetVisibilityStatus(t){this.communicationMux.getStream("torus-widget-visibility").write({data:t})}_displayIframe(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const n={},r=this.buttonSize+14;if(t)n.display="block",n.width="100%",n.height="100%",n.top="0px",n.right="0px",n.left="0px",n.bottom="0px";else switch(n.display=this.torusWidgetVisibility?"block":"none",n.height=`${r}px`,n.width=`${r}px`,this.buttonPosition){case It.TOP_LEFT:n.top="0px",n.left="0px",n.right="auto",n.bottom="auto";break;case It.TOP_RIGHT:n.top="0px",n.right="0px",n.left="auto",n.bottom="auto";break;case It.BOTTOM_RIGHT:n.bottom="0px",n.right="0px",n.top="auto",n.left="auto";break;case It.BOTTOM_LEFT:default:n.bottom="0px",n.left="0px",n.top="auto",n.right="auto";break}Object.assign(this.torusIframe.style,n),this.isIframeFullScreen=t}_setupWeb3(){ee.info("setupWeb3 running");const t=new uo({name:"embed_metamask",target:"iframe_metamask",targetWindow:this.torusIframe.contentWindow,targetOrigin:new URL(this.torusUrl).origin}),n=new uo({name:"embed_comm",target:"iframe_comm",targetWindow:this.torusIframe.contentWindow,targetOrigin:new URL(this.torusUrl).origin}),r=new Dn(t),o=c=>{const R=r[c];r[c]=function(y){if(y&&y==="eth_requestAccounts")return r.enable();for(var p=arguments.length,P=new Array(p>1?p-1:0),$=1;$<p;$++)P[$-1]=arguments[$];return R.apply(this,[y,...P])}};o("send"),o("sendAsync"),r.enable=()=>new Promise((c,R)=>{r.sendAsync({jsonrpc:"2.0",id:pt(),method:"eth_requestAccounts",params:[]},(A,y)=>{const{result:p}=y||{};if(A)setTimeout(()=>{R(A)},50);else if(Array.isArray(p)&&p.length>0){const P=()=>{if(this.requestedVerifier!==""&&this.currentVerifier!==this.requestedVerifier){const{requestedVerifier:$}=this;this.logout().then(I=>{this.requestedVerifier=$,this._showLoginPopup(!0,c,R)}).catch(I=>R(I))}else c(p)};this.isLoggedIn?P():this.isLoginCallback=P}else this._showLoginPopup(!0,c,R)})}),r.tryPreopenHandle=(c,R)=>{const A=c;if(!Array.isArray(A)&&xf.includes(A.method)){const y=pt();this._handleWindow(y,{target:"_blank",features:yo}),A.preopenInstanceId=y}r._rpcEngine.handle(A,R)};const s=new Proxy(r,{deleteProperty:()=>!0});this.ethereum=s;const l=gf(n);this.communicationMux=l,l.getStream("window").on("data",c=>{c.name==="create_window"&&this._createPopupBlockAlert(c.data.preopenInstanceId,c.data.url)}),l.getStream("widget").on("data",c=>{const{data:R}=c;this._displayIframe(R)}),l.getStream("status").on("data",c=>{c.loggedIn?(this.isLoggedIn=c.loggedIn,this.currentVerifier=c.verifier):this._displayIframe(),this.isLoginCallback&&(this.isLoginCallback(),delete this.isLoginCallback)}),this.provider=s,this.provider.shouldSendMetadata&&Lf(this.provider._rpcEngine),r._initializeState(),ee.debug("Torus - injected provider")}_showLoginPopup(t,n,r){const o=l=>{const h=l,{err:b,selectedAddress:f}=h;b?(ee.error(b),r&&r(b)):n&&n([f]),this.isIframeFullScreen&&this._displayIframe()},s=this.communicationMux.getStream("oauth");if(!this.requestedVerifier)this._displayIframe(!0),xe(s,"data",o),s.write({name:"oauth_modal",data:{calledFromEmbed:t}});else{xe(s,"data",o);const l=pt();this._handleWindow(l),s.write({name:"oauth",data:{calledFromEmbed:t,verifier:this.requestedVerifier,preopenInstanceId:l,login_hint:this.loginHint}})}}_createPopupBlockAlert(t,n){const r=this._getLogoUrl(),o=jt(`<div id="torusAlert" class="torus-alert--v2"><div id="torusAlert__logo"><img src="${r}" /></div><div><h1 id="torusAlert__title">${this.embedTranslations.actionRequired}</h1><p id="torusAlert__desc">${this.embedTranslations.pendingAction}</p></div></div>`),s=jt(`<div><a id="torusAlert__btn">${this.embedTranslations.continue}</a></div>`),l=jt('<div id="torusAlert__btn-container"></div>');l.appendChild(s),o.appendChild(l),this._setEmbedWhiteLabel(o),this.torusAlertContainer.style.display="block",this.torusAlertContainer.appendChild(o),s.addEventListener("click",()=>{this._handleWindow(t,{url:n,target:"_blank",features:yo}),o.remove(),this.torusAlertContainer.children.length===0&&(this.torusAlertContainer.style.display="none")})}}var Uf={exports:{}},dr={exports:{}},de={ArrayIsArray(e){return Array.isArray(e)},ArrayPrototypeIncludes(e,t){return e.includes(t)},ArrayPrototypeIndexOf(e,t){return e.indexOf(t)},ArrayPrototypeJoin(e,t){return e.join(t)},ArrayPrototypeMap(e,t){return e.map(t)},ArrayPrototypePop(e,t){return e.pop(t)},ArrayPrototypePush(e,t){return e.push(t)},ArrayPrototypeSlice(e,t,n){return e.slice(t,n)},Error,FunctionPrototypeCall(e,t,...n){return e.call(t,...n)},FunctionPrototypeSymbolHasInstance(e,t){return Function.prototype[Symbol.hasInstance].call(e,t)},MathFloor:Math.floor,Number,NumberIsInteger:Number.isInteger,NumberIsNaN:Number.isNaN,NumberMAX_SAFE_INTEGER:Number.MAX_SAFE_INTEGER,NumberMIN_SAFE_INTEGER:Number.MIN_SAFE_INTEGER,NumberParseInt:Number.parseInt,ObjectDefineProperties(e,t){return Object.defineProperties(e,t)},ObjectDefineProperty(e,t,n){return Object.defineProperty(e,t,n)},ObjectGetOwnPropertyDescriptor(e,t){return Object.getOwnPropertyDescriptor(e,t)},ObjectKeys(e){return Object.keys(e)},ObjectSetPrototypeOf(e,t){return Object.setPrototypeOf(e,t)},Promise,PromisePrototypeCatch(e,t){return e.catch(t)},PromisePrototypeThen(e,t,n){return e.then(t,n)},PromiseReject(e){return Promise.reject(e)},ReflectApply:Reflect.apply,RegExpPrototypeTest(e,t){return e.test(t)},SafeSet:Set,String,StringPrototypeSlice(e,t,n){return e.slice(t,n)},StringPrototypeToLowerCase(e){return e.toLowerCase()},StringPrototypeToUpperCase(e){return e.toUpperCase()},StringPrototypeTrim(e){return e.trim()},Symbol,SymbolFor:Symbol.for,SymbolAsyncIterator:Symbol.asyncIterator,SymbolHasInstance:Symbol.hasInstance,SymbolIterator:Symbol.iterator,TypedArrayPrototypeSet(e,t,n){return e.set(t,n)},Uint8Array},is={exports:{}};(function(e){const t=we,n=Object.getPrototypeOf(async function(){}).constructor,r=globalThis.Blob||t.Blob,o=typeof r<"u"?function(h){return h instanceof r}:function(h){return!1};class s extends Error{constructor(h){if(!Array.isArray(h))throw new TypeError(`Expected input to be an Array, got ${typeof h}`);let b="";for(let f=0;f<h.length;f++)b+=`    ${h[f].stack}
`;super(b),this.name="AggregateError",this.errors=h}}e.exports={AggregateError:s,kEmptyObject:Object.freeze({}),once(l){let h=!1;return function(...b){h||(h=!0,l.apply(this,b))}},createDeferredPromise:function(){let l,h;return{promise:new Promise((f,c)=>{l=f,h=c}),resolve:l,reject:h}},promisify(l){return new Promise((h,b)=>{l((f,...c)=>f?b(f):h(...c))})},debuglog(){return function(){}},format(l,...h){return l.replace(/%([sdifj])/g,function(...[b,f]){const c=h.shift();return f==="f"?c.toFixed(6):f==="j"?JSON.stringify(c):f==="s"&&typeof c=="object"?`${c.constructor!==Object?c.constructor.name:""} {}`.trim():c.toString()})},inspect(l){switch(typeof l){case"string":if(l.includes("'"))if(l.includes('"')){if(!l.includes("`")&&!l.includes("${"))return`\`${l}\``}else return`"${l}"`;return`'${l}'`;case"number":return isNaN(l)?"NaN":Object.is(l,-0)?String(l):l;case"bigint":return`${String(l)}n`;case"boolean":case"undefined":return String(l);case"object":return"{}"}},types:{isAsyncFunction(l){return l instanceof n},isArrayBufferView(l){return ArrayBuffer.isView(l)}},isBlob:o},e.exports.promisify.custom=Symbol.for("nodejs.util.promisify.custom")})(is);var Je=is.exports,di={};const{format:Bf,inspect:pn,AggregateError:Ff}=Je,jf=globalThis.AggregateError||Ff,Hf=Symbol("kIsNodeError"),Vf=["string","function","number","object","Function","Object","boolean","bigint","symbol"],Gf=/^([A-Z][a-z0-9]*)+$/,Kf="__node_internal_",Pn={};function _t(e,t){if(!e)throw new Pn.ERR_INTERNAL_ASSERTION(t)}function mo(e){let t="",n=e.length;const r=e[0]==="-"?1:0;for(;n>=r+4;n-=3)t=`_${e.slice(n-3,n)}${t}`;return`${e.slice(0,n)}${t}`}function qf(e,t,n){if(typeof t=="function")return _t(t.length<=n.length,`Code: ${e}; The provided arguments length (${n.length}) does not match the required ones (${t.length}).`),t(...n);const r=(t.match(/%[dfijoOs]/g)||[]).length;return _t(r===n.length,`Code: ${e}; The provided arguments length (${n.length}) does not match the required ones (${r}).`),n.length===0?t:Bf(t,...n)}function ce(e,t,n){n||(n=Error);class r extends n{constructor(...s){super(qf(e,t,s))}toString(){return`${this.name} [${e}]: ${this.message}`}}Object.defineProperties(r.prototype,{name:{value:n.name,writable:!0,enumerable:!1,configurable:!0},toString:{value(){return`${this.name} [${e}]: ${this.message}`},writable:!0,enumerable:!1,configurable:!0}}),r.prototype.code=e,r.prototype[Hf]=!0,Pn[e]=r}function Eo(e){const t=Kf+e.name;return Object.defineProperty(e,"name",{value:t}),e}function Yf(e,t){if(e&&t&&e!==t){if(Array.isArray(t.errors))return t.errors.push(e),t;const n=new jf([t,e],t.message);return n.code=t.code,n}return e||t}let Xf=class extends Error{constructor(t="The operation was aborted",n=void 0){if(n!==void 0&&typeof n!="object")throw new Pn.ERR_INVALID_ARG_TYPE("options","Object",n);super(t,n),this.code="ABORT_ERR",this.name="AbortError"}};ce("ERR_ASSERTION","%s",Error);ce("ERR_INVALID_ARG_TYPE",(e,t,n)=>{_t(typeof e=="string","'name' must be a string"),Array.isArray(t)||(t=[t]);let r="The ";e.endsWith(" argument")?r+=`${e} `:r+=`"${e}" ${e.includes(".")?"property":"argument"} `,r+="must be ";const o=[],s=[],l=[];for(const b of t)_t(typeof b=="string","All expected entries have to be of type string"),Vf.includes(b)?o.push(b.toLowerCase()):Gf.test(b)?s.push(b):(_t(b!=="object",'The value "object" should be written as "Object"'),l.push(b));if(s.length>0){const b=o.indexOf("object");b!==-1&&(o.splice(o,b,1),s.push("Object"))}if(o.length>0){switch(o.length){case 1:r+=`of type ${o[0]}`;break;case 2:r+=`one of type ${o[0]} or ${o[1]}`;break;default:{const b=o.pop();r+=`one of type ${o.join(", ")}, or ${b}`}}(s.length>0||l.length>0)&&(r+=" or ")}if(s.length>0){switch(s.length){case 1:r+=`an instance of ${s[0]}`;break;case 2:r+=`an instance of ${s[0]} or ${s[1]}`;break;default:{const b=s.pop();r+=`an instance of ${s.join(", ")}, or ${b}`}}l.length>0&&(r+=" or ")}switch(l.length){case 0:break;case 1:l[0].toLowerCase()!==l[0]&&(r+="an "),r+=`${l[0]}`;break;case 2:r+=`one of ${l[0]} or ${l[1]}`;break;default:{const b=l.pop();r+=`one of ${l.join(", ")}, or ${b}`}}if(n==null)r+=`. Received ${n}`;else if(typeof n=="function"&&n.name)r+=`. Received function ${n.name}`;else if(typeof n=="object"){var h;if((h=n.constructor)!==null&&h!==void 0&&h.name)r+=`. Received an instance of ${n.constructor.name}`;else{const b=pn(n,{depth:-1});r+=`. Received ${b}`}}else{let b=pn(n,{colors:!1});b.length>25&&(b=`${b.slice(0,25)}...`),r+=`. Received type ${typeof n} (${b})`}return r},TypeError);ce("ERR_INVALID_ARG_VALUE",(e,t,n="is invalid")=>{let r=pn(t);return r.length>128&&(r=r.slice(0,128)+"..."),`The ${e.includes(".")?"property":"argument"} '${e}' ${n}. Received ${r}`},TypeError);ce("ERR_INVALID_RETURN_VALUE",(e,t,n)=>{var r;const o=n!=null&&(r=n.constructor)!==null&&r!==void 0&&r.name?`instance of ${n.constructor.name}`:`type ${typeof n}`;return`Expected ${e} to be returned from the "${t}" function but got ${o}.`},TypeError);ce("ERR_MISSING_ARGS",(...e)=>{_t(e.length>0,"At least one arg needs to be specified");let t;const n=e.length;switch(e=(Array.isArray(e)?e:[e]).map(r=>`"${r}"`).join(" or "),n){case 1:t+=`The ${e[0]} argument`;break;case 2:t+=`The ${e[0]} and ${e[1]} arguments`;break;default:{const r=e.pop();t+=`The ${e.join(", ")}, and ${r} arguments`}break}return`${t} must be specified`},TypeError);ce("ERR_OUT_OF_RANGE",(e,t,n)=>{_t(t,'Missing "range" argument');let r;return Number.isInteger(n)&&Math.abs(n)>2**32?r=mo(String(n)):typeof n=="bigint"?(r=String(n),(n>2n**32n||n<-(2n**32n))&&(r=mo(r)),r+="n"):r=pn(n),`The value of "${e}" is out of range. It must be ${t}. Received ${r}`},RangeError);ce("ERR_MULTIPLE_CALLBACK","Callback called multiple times",Error);ce("ERR_METHOD_NOT_IMPLEMENTED","The %s method is not implemented",Error);ce("ERR_STREAM_ALREADY_FINISHED","Cannot call %s after a stream was finished",Error);ce("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable",Error);ce("ERR_STREAM_DESTROYED","Cannot call %s after a stream was destroyed",Error);ce("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError);ce("ERR_STREAM_PREMATURE_CLOSE","Premature close",Error);ce("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF",Error);ce("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event",Error);ce("ERR_STREAM_WRITE_AFTER_END","write after end",Error);ce("ERR_UNKNOWN_ENCODING","Unknown encoding: %s",TypeError);var Ee={AbortError:Xf,aggregateTwoErrors:Eo(Yf),hideStackFrames:Eo,codes:Pn};const{ArrayIsArray:ui,ArrayPrototypeIncludes:os,ArrayPrototypeJoin:as,ArrayPrototypeMap:zf,NumberIsInteger:fi,NumberIsNaN:Zf,NumberMAX_SAFE_INTEGER:Jf,NumberMIN_SAFE_INTEGER:Qf,NumberParseInt:ec,ObjectPrototypeHasOwnProperty:tc,RegExpPrototypeExec:ss,String:nc,StringPrototypeToUpperCase:rc,StringPrototypeTrim:ic}=de,{hideStackFrames:Ce,codes:{ERR_SOCKET_BAD_PORT:oc,ERR_INVALID_ARG_TYPE:_e,ERR_INVALID_ARG_VALUE:Ot,ERR_OUT_OF_RANGE:St,ERR_UNKNOWN_SIGNAL:Ro}}=Ee,{normalizeEncoding:ac}=Je,{isAsyncFunction:sc,isArrayBufferView:lc}=Je.types,Ao={};function dc(e){return e===(e|0)}function uc(e){return e===e>>>0}const fc=/^[0-7]+$/,cc="must be a 32-bit unsigned integer or an octal string";function hc(e,t,n){if(typeof e>"u"&&(e=n),typeof e=="string"){if(ss(fc,e)===null)throw new Ot(t,e,cc);e=ec(e,8)}return ls(e,t),e}const bc=Ce((e,t,n=Qf,r=Jf)=>{if(typeof e!="number")throw new _e(t,"number",e);if(!fi(e))throw new St(t,"an integer",e);if(e<n||e>r)throw new St(t,`>= ${n} && <= ${r}`,e)}),pc=Ce((e,t,n=-2147483648,r=2147483647)=>{if(typeof e!="number")throw new _e(t,"number",e);if(!fi(e))throw new St(t,"an integer",e);if(e<n||e>r)throw new St(t,`>= ${n} && <= ${r}`,e)}),ls=Ce((e,t,n=!1)=>{if(typeof e!="number")throw new _e(t,"number",e);if(!fi(e))throw new St(t,"an integer",e);const r=n?1:0,o=4294967295;if(e<r||e>o)throw new St(t,`>= ${r} && <= ${o}`,e)});function ci(e,t){if(typeof e!="string")throw new _e(t,"string",e)}function gc(e,t,n=void 0,r){if(typeof e!="number")throw new _e(t,"number",e);if(n!=null&&e<n||r!=null&&e>r||(n!=null||r!=null)&&Zf(e))throw new St(t,`${n!=null?`>= ${n}`:""}${n!=null&&r!=null?" && ":""}${r!=null?`<= ${r}`:""}`,e)}const yc=Ce((e,t,n)=>{if(!os(n,e)){const o="must be one of: "+as(zf(n,s=>typeof s=="string"?`'${s}'`:nc(s)),", ");throw new Ot(t,e,o)}});function ds(e,t){if(typeof e!="boolean")throw new _e(t,"boolean",e)}function ur(e,t,n){return e==null||!tc(e,t)?n:e[t]}const _c=Ce((e,t,n=null)=>{const r=ur(n,"allowArray",!1),o=ur(n,"allowFunction",!1);if(!ur(n,"nullable",!1)&&e===null||!r&&ui(e)||typeof e!="object"&&(!o||typeof e!="function"))throw new _e(t,"Object",e)}),wc=Ce((e,t)=>{if(e!=null&&typeof e!="object"&&typeof e!="function")throw new _e(t,"a dictionary",e)}),hi=Ce((e,t,n=0)=>{if(!ui(e))throw new _e(t,"Array",e);if(e.length<n){const r=`must be longer than ${n}`;throw new Ot(t,e,r)}});function Sc(e,t){hi(e,t);for(let n=0;n<e.length;n++)ci(e[n],`${t}[${n}]`)}function mc(e,t){hi(e,t);for(let n=0;n<e.length;n++)ds(e[n],`${t}[${n}]`)}function Ec(e,t="signal"){if(ci(e,t),Ao[e]===void 0)throw Ao[rc(e)]!==void 0?new Ro(e+" (signals must use all capital letters)"):new Ro(e)}const Rc=Ce((e,t="buffer")=>{if(!lc(e))throw new _e(t,["Buffer","TypedArray","DataView"],e)});function Ac(e,t){const n=ac(t),r=e.length;if(n==="hex"&&r%2!==0)throw new Ot("encoding",t,`is invalid for data of length ${r}`)}function Tc(e,t="Port",n=!0){if(typeof e!="number"&&typeof e!="string"||typeof e=="string"&&ic(e).length===0||+e!==+e>>>0||e>65535||e===0&&!n)throw new oc(t,e,n);return e|0}const Ic=Ce((e,t)=>{if(e!==void 0&&(e===null||typeof e!="object"||!("aborted"in e)))throw new _e(t,"AbortSignal",e)}),Nc=Ce((e,t)=>{if(typeof e!="function")throw new _e(t,"Function",e)}),vc=Ce((e,t)=>{if(typeof e!="function"||sc(e))throw new _e(t,"Function",e)}),Cc=Ce((e,t)=>{if(e!==void 0)throw new _e(t,"undefined",e)});function $c(e,t,n){if(!os(n,e))throw new _e(t,`('${as(n,"|")}')`,e)}const Mc=/^(?:<[^>]*>)(?:\s*;\s*[^;"\s]+(?:=(")?[^;"\s]*\1)?)*$/;function To(e,t){if(typeof e>"u"||!ss(Mc,e))throw new Ot(t,e,'must be an array or string of format "</styles.css>; rel=preload; as=style"')}function Dc(e){if(typeof e=="string")return To(e,"hints"),e;if(ui(e)){const t=e.length;let n="";if(t===0)return n;for(let r=0;r<t;r++){const o=e[r];To(o,"hints"),n+=o,r!==t-1&&(n+=", ")}return n}throw new Ot("hints",e,'must be an array or string of format "</styles.css>; rel=preload; as=style"')}var On={isInt32:dc,isUint32:uc,parseFileMode:hc,validateArray:hi,validateStringArray:Sc,validateBooleanArray:mc,validateBoolean:ds,validateBuffer:Rc,validateDictionary:wc,validateEncoding:Ac,validateFunction:Nc,validateInt32:pc,validateInteger:bc,validateNumber:gc,validateObject:_c,validateOneOf:yc,validatePlainFunction:vc,validatePort:Tc,validateSignalName:Ec,validateString:ci,validateUint32:ls,validateUndefined:Cc,validateUnion:$c,validateAbortSignal:Ic,validateLinkHeaderValue:Dc},bi={exports:{}};const{Symbol:Ln,SymbolAsyncIterator:Io,SymbolIterator:No,SymbolFor:us}=de,fs=Ln("kDestroyed"),cs=Ln("kIsErrored"),Fr=Ln("kIsReadable"),hs=Ln("kIsDisturbed"),Pc=us("nodejs.webstream.isClosedPromise"),Oc=us("nodejs.webstream.controllerErrorFunction");function kn(e,t=!1){var n;return!!(e&&typeof e.pipe=="function"&&typeof e.on=="function"&&(!t||typeof e.pause=="function"&&typeof e.resume=="function")&&(!e._writableState||((n=e._readableState)===null||n===void 0?void 0:n.readable)!==!1)&&(!e._writableState||e._readableState))}function xn(e){var t;return!!(e&&typeof e.write=="function"&&typeof e.on=="function"&&(!e._readableState||((t=e._writableState)===null||t===void 0?void 0:t.writable)!==!1))}function Lc(e){return!!(e&&typeof e.pipe=="function"&&e._readableState&&typeof e.on=="function"&&typeof e.write=="function")}function Ve(e){return e&&(e._readableState||e._writableState||typeof e.write=="function"&&typeof e.on=="function"||typeof e.pipe=="function"&&typeof e.on=="function")}function bs(e){return!!(e&&!Ve(e)&&typeof e.pipeThrough=="function"&&typeof e.getReader=="function"&&typeof e.cancel=="function")}function ps(e){return!!(e&&!Ve(e)&&typeof e.getWriter=="function"&&typeof e.abort=="function")}function gs(e){return!!(e&&!Ve(e)&&typeof e.readable=="object"&&typeof e.writable=="object")}function kc(e){return bs(e)||ps(e)||gs(e)}function xc(e,t){return e==null?!1:t===!0?typeof e[Io]=="function":t===!1?typeof e[No]=="function":typeof e[Io]=="function"||typeof e[No]=="function"}function Wn(e){if(!Ve(e))return null;const t=e._writableState,n=e._readableState,r=t||n;return!!(e.destroyed||e[fs]||r!=null&&r.destroyed)}function ys(e){if(!xn(e))return null;if(e.writableEnded===!0)return!0;const t=e._writableState;return t!=null&&t.errored?!1:typeof(t==null?void 0:t.ended)!="boolean"?null:t.ended}function Wc(e,t){if(!xn(e))return null;if(e.writableFinished===!0)return!0;const n=e._writableState;return n!=null&&n.errored?!1:typeof(n==null?void 0:n.finished)!="boolean"?null:!!(n.finished||t===!1&&n.ended===!0&&n.length===0)}function Uc(e){if(!kn(e))return null;if(e.readableEnded===!0)return!0;const t=e._readableState;return!t||t.errored?!1:typeof(t==null?void 0:t.ended)!="boolean"?null:t.ended}function _s(e,t){if(!kn(e))return null;const n=e._readableState;return n!=null&&n.errored?!1:typeof(n==null?void 0:n.endEmitted)!="boolean"?null:!!(n.endEmitted||t===!1&&n.ended===!0&&n.length===0)}function ws(e){return e&&e[Fr]!=null?e[Fr]:typeof(e==null?void 0:e.readable)!="boolean"?null:Wn(e)?!1:kn(e)&&e.readable&&!_s(e)}function Ss(e){return typeof(e==null?void 0:e.writable)!="boolean"?null:Wn(e)?!1:xn(e)&&e.writable&&!ys(e)}function Bc(e,t){return Ve(e)?Wn(e)?!0:!((t==null?void 0:t.readable)!==!1&&ws(e)||(t==null?void 0:t.writable)!==!1&&Ss(e)):null}function Fc(e){var t,n;return Ve(e)?e.writableErrored?e.writableErrored:(t=(n=e._writableState)===null||n===void 0?void 0:n.errored)!==null&&t!==void 0?t:null:null}function jc(e){var t,n;return Ve(e)?e.readableErrored?e.readableErrored:(t=(n=e._readableState)===null||n===void 0?void 0:n.errored)!==null&&t!==void 0?t:null:null}function Hc(e){if(!Ve(e))return null;if(typeof e.closed=="boolean")return e.closed;const t=e._writableState,n=e._readableState;return typeof(t==null?void 0:t.closed)=="boolean"||typeof(n==null?void 0:n.closed)=="boolean"?(t==null?void 0:t.closed)||(n==null?void 0:n.closed):typeof e._closed=="boolean"&&ms(e)?e._closed:null}function ms(e){return typeof e._closed=="boolean"&&typeof e._defaultKeepAlive=="boolean"&&typeof e._removedConnection=="boolean"&&typeof e._removedContLen=="boolean"}function Es(e){return typeof e._sent100=="boolean"&&ms(e)}function Vc(e){var t;return typeof e._consuming=="boolean"&&typeof e._dumped=="boolean"&&((t=e.req)===null||t===void 0?void 0:t.upgradeOrConnect)===void 0}function Gc(e){if(!Ve(e))return null;const t=e._writableState,n=e._readableState,r=t||n;return!r&&Es(e)||!!(r&&r.autoDestroy&&r.emitClose&&r.closed===!1)}function Kc(e){var t;return!!(e&&((t=e[hs])!==null&&t!==void 0?t:e.readableDidRead||e.readableAborted))}function qc(e){var t,n,r,o,s,l,h,b,f,c;return!!(e&&((t=(n=(r=(o=(s=(l=e[cs])!==null&&l!==void 0?l:e.readableErrored)!==null&&s!==void 0?s:e.writableErrored)!==null&&o!==void 0?o:(h=e._readableState)===null||h===void 0?void 0:h.errorEmitted)!==null&&r!==void 0?r:(b=e._writableState)===null||b===void 0?void 0:b.errorEmitted)!==null&&n!==void 0?n:(f=e._readableState)===null||f===void 0?void 0:f.errored)!==null&&t!==void 0?t:!((c=e._writableState)===null||c===void 0)&&c.errored))}var Qe={kDestroyed:fs,isDisturbed:Kc,kIsDisturbed:hs,isErrored:qc,kIsErrored:cs,isReadable:ws,kIsReadable:Fr,kIsClosedPromise:Pc,kControllerErrorFunction:Oc,isClosed:Hc,isDestroyed:Wn,isDuplexNodeStream:Lc,isFinished:Bc,isIterable:xc,isReadableNodeStream:kn,isReadableStream:bs,isReadableEnded:Uc,isReadableFinished:_s,isReadableErrored:jc,isNodeStream:Ve,isWebStream:kc,isWritable:Ss,isWritableNodeStream:xn,isWritableStream:ps,isWritableEnded:ys,isWritableFinished:Wc,isWritableErrored:Fc,isServerRequest:Vc,isServerResponse:Es,willEmitClose:Gc,isTransformStream:gs};const tt=Se,{AbortError:Rs,codes:Yc}=Ee,{ERR_INVALID_ARG_TYPE:Xc,ERR_STREAM_PREMATURE_CLOSE:vo}=Yc,{kEmptyObject:jr,once:Hr}=Je,{validateAbortSignal:zc,validateFunction:Zc,validateObject:Jc,validateBoolean:Qc}=On,{Promise:eh,PromisePrototypeThen:th}=de,{isClosed:nh,isReadable:Co,isReadableNodeStream:fr,isReadableStream:rh,isReadableFinished:$o,isReadableErrored:Mo,isWritable:Do,isWritableNodeStream:Po,isWritableStream:ih,isWritableFinished:Oo,isWritableErrored:Lo,isNodeStream:oh,willEmitClose:ah,kIsClosedPromise:sh}=Qe;function lh(e){return e.setHeader&&typeof e.abort=="function"}const Vr=()=>{};function As(e,t,n){var r,o;if(arguments.length===2?(n=t,t=jr):t==null?t=jr:Jc(t,"options"),Zc(n,"callback"),zc(t.signal,"options.signal"),n=Hr(n),rh(e)||ih(e))return dh(e,t,n);if(!oh(e))throw new Xc("stream",["ReadableStream","WritableStream","Stream"],e);const s=(r=t.readable)!==null&&r!==void 0?r:fr(e),l=(o=t.writable)!==null&&o!==void 0?o:Po(e),h=e._writableState,b=e._readableState,f=()=>{e.writable||A()};let c=ah(e)&&fr(e)===s&&Po(e)===l,R=Oo(e,!1);const A=()=>{R=!0,e.destroyed&&(c=!1),!(c&&(!e.readable||s))&&(!s||y)&&n.call(e)};let y=$o(e,!1);const p=()=>{y=!0,e.destroyed&&(c=!1),!(c&&(!e.writable||l))&&(!l||R)&&n.call(e)},P=D=>{n.call(e,D)};let $=nh(e);const I=()=>{$=!0;const D=Lo(e)||Mo(e);if(D&&typeof D!="boolean")return n.call(e,D);if(s&&!y&&fr(e,!0)&&!$o(e,!1))return n.call(e,new vo);if(l&&!R&&!Oo(e,!1))return n.call(e,new vo);n.call(e)},_=()=>{$=!0;const D=Lo(e)||Mo(e);if(D&&typeof D!="boolean")return n.call(e,D);n.call(e)},L=()=>{e.req.on("finish",A)};lh(e)?(e.on("complete",A),c||e.on("abort",I),e.req?L():e.on("request",L)):l&&!h&&(e.on("end",f),e.on("close",f)),!c&&typeof e.aborted=="boolean"&&e.on("aborted",I),e.on("end",p),e.on("finish",A),t.error!==!1&&e.on("error",P),e.on("close",I),$?tt.nextTick(I):h!=null&&h.errorEmitted||b!=null&&b.errorEmitted?c||tt.nextTick(_):(!s&&(!c||Co(e))&&(R||Do(e)===!1)||!l&&(!c||Do(e))&&(y||Co(e)===!1)||b&&e.req&&e.aborted)&&tt.nextTick(_);const F=()=>{n=Vr,e.removeListener("aborted",I),e.removeListener("complete",A),e.removeListener("abort",I),e.removeListener("request",L),e.req&&e.req.removeListener("finish",A),e.removeListener("end",f),e.removeListener("close",f),e.removeListener("finish",A),e.removeListener("end",p),e.removeListener("error",P),e.removeListener("close",I)};if(t.signal&&!$){const D=()=>{const K=n;F(),K.call(e,new Rs(void 0,{cause:t.signal.reason}))};if(t.signal.aborted)tt.nextTick(D);else{const K=n;n=Hr((...j)=>{t.signal.removeEventListener("abort",D),K.apply(e,j)}),t.signal.addEventListener("abort",D)}}return F}function dh(e,t,n){let r=!1,o=Vr;if(t.signal)if(o=()=>{r=!0,n.call(e,new Rs(void 0,{cause:t.signal.reason}))},t.signal.aborted)tt.nextTick(o);else{const l=n;n=Hr((...h)=>{t.signal.removeEventListener("abort",o),l.apply(e,h)}),t.signal.addEventListener("abort",o)}const s=(...l)=>{r||tt.nextTick(()=>n.apply(e,l))};return th(e[sh].promise,s,s),Vr}function uh(e,t){var n;let r=!1;return t===null&&(t=jr),(n=t)!==null&&n!==void 0&&n.cleanup&&(Qc(t.cleanup,"cleanup"),r=t.cleanup),new eh((o,s)=>{const l=As(e,t,h=>{r&&l(),h?s(h):o()})})}bi.exports=As;bi.exports.finished=uh;var it=bi.exports;const Be=Se,{aggregateTwoErrors:fh,codes:{ERR_MULTIPLE_CALLBACK:ch},AbortError:hh}=Ee,{Symbol:Ts}=de,{kDestroyed:bh,isDestroyed:ph,isFinished:gh,isServerRequest:yh}=Qe,Is=Ts("kDestroy"),Gr=Ts("kConstruct");function Ns(e,t,n){e&&(e.stack,t&&!t.errored&&(t.errored=e),n&&!n.errored&&(n.errored=e))}function _h(e,t){const n=this._readableState,r=this._writableState,o=r||n;return r!=null&&r.destroyed||n!=null&&n.destroyed?(typeof t=="function"&&t(),this):(Ns(e,r,n),r&&(r.destroyed=!0),n&&(n.destroyed=!0),o.constructed?ko(this,e,t):this.once(Is,function(s){ko(this,fh(s,e),t)}),this)}function ko(e,t,n){let r=!1;function o(s){if(r)return;r=!0;const l=e._readableState,h=e._writableState;Ns(s,h,l),h&&(h.closed=!0),l&&(l.closed=!0),typeof n=="function"&&n(s),s?Be.nextTick(wh,e,s):Be.nextTick(vs,e)}try{e._destroy(t||null,o)}catch(s){o(s)}}function wh(e,t){Kr(e,t),vs(e)}function vs(e){const t=e._readableState,n=e._writableState;n&&(n.closeEmitted=!0),t&&(t.closeEmitted=!0),(n!=null&&n.emitClose||t!=null&&t.emitClose)&&e.emit("close")}function Kr(e,t){const n=e._readableState,r=e._writableState;r!=null&&r.errorEmitted||n!=null&&n.errorEmitted||(r&&(r.errorEmitted=!0),n&&(n.errorEmitted=!0),e.emit("error",t))}function Sh(){const e=this._readableState,t=this._writableState;e&&(e.constructed=!0,e.closed=!1,e.closeEmitted=!1,e.destroyed=!1,e.errored=null,e.errorEmitted=!1,e.reading=!1,e.ended=e.readable===!1,e.endEmitted=e.readable===!1),t&&(t.constructed=!0,t.destroyed=!1,t.closed=!1,t.closeEmitted=!1,t.errored=null,t.errorEmitted=!1,t.finalCalled=!1,t.prefinished=!1,t.ended=t.writable===!1,t.ending=t.writable===!1,t.finished=t.writable===!1)}function qr(e,t,n){const r=e._readableState,o=e._writableState;if(o!=null&&o.destroyed||r!=null&&r.destroyed)return this;r!=null&&r.autoDestroy||o!=null&&o.autoDestroy?e.destroy(t):t&&(t.stack,o&&!o.errored&&(o.errored=t),r&&!r.errored&&(r.errored=t),n?Be.nextTick(Kr,e,t):Kr(e,t))}function mh(e,t){if(typeof e._construct!="function")return;const n=e._readableState,r=e._writableState;n&&(n.constructed=!1),r&&(r.constructed=!1),e.once(Gr,t),!(e.listenerCount(Gr)>1)&&Be.nextTick(Eh,e)}function Eh(e){let t=!1;function n(r){if(t){qr(e,r??new ch);return}t=!0;const o=e._readableState,s=e._writableState,l=s||o;o&&(o.constructed=!0),s&&(s.constructed=!0),l.destroyed?e.emit(Is,r):r?qr(e,r,!0):Be.nextTick(Rh,e)}try{e._construct(r=>{Be.nextTick(n,r)})}catch(r){Be.nextTick(n,r)}}function Rh(e){e.emit(Gr)}function xo(e){return(e==null?void 0:e.setHeader)&&typeof e.abort=="function"}function Cs(e){e.emit("close")}function Ah(e,t){e.emit("error",t),Be.nextTick(Cs,e)}function Th(e,t){!e||ph(e)||(!t&&!gh(e)&&(t=new hh),yh(e)?(e.socket=null,e.destroy(t)):xo(e)?e.abort():xo(e.req)?e.req.abort():typeof e.destroy=="function"?e.destroy(t):typeof e.close=="function"?e.close():t?Be.nextTick(Ah,e,t):Be.nextTick(Cs,e),e.destroyed||(e[bh]=!0))}var Lt={construct:mh,destroyer:Th,destroy:_h,undestroy:Sh,errorOrDestroy:qr};const{ArrayIsArray:Ih,ObjectSetPrototypeOf:$s}=de,{EventEmitter:Un}=mt;function Bn(e){Un.call(this,e)}$s(Bn.prototype,Un.prototype);$s(Bn,Un);Bn.prototype.pipe=function(e,t){const n=this;function r(c){e.writable&&e.write(c)===!1&&n.pause&&n.pause()}n.on("data",r);function o(){n.readable&&n.resume&&n.resume()}e.on("drain",o),!e._isStdio&&(!t||t.end!==!1)&&(n.on("end",l),n.on("close",h));let s=!1;function l(){s||(s=!0,e.end())}function h(){s||(s=!0,typeof e.destroy=="function"&&e.destroy())}function b(c){f(),Un.listenerCount(this,"error")===0&&this.emit("error",c)}Yr(n,"error",b),Yr(e,"error",b);function f(){n.removeListener("data",r),e.removeListener("drain",o),n.removeListener("end",l),n.removeListener("close",h),n.removeListener("error",b),e.removeListener("error",b),n.removeListener("end",f),n.removeListener("close",f),e.removeListener("close",f)}return n.on("end",f),n.on("close",f),e.on("close",f),e.emit("pipe",n),e};function Yr(e,t,n){if(typeof e.prependListener=="function")return e.prependListener(t,n);!e._events||!e._events[t]?e.on(t,n):Ih(e._events[t])?e._events[t].unshift(n):e._events[t]=[n,e._events[t]]}var pi={Stream:Bn,prependListener:Yr},Ms={exports:{}};(function(e){const{AbortError:t,codes:n}=Ee,{isNodeStream:r,isWebStream:o,kControllerErrorFunction:s}=Qe,l=it,{ERR_INVALID_ARG_TYPE:h}=n,b=(f,c)=>{if(typeof f!="object"||!("aborted"in f))throw new h(c,"AbortSignal",f)};e.exports.addAbortSignal=function(c,R){if(b(c,"signal"),!r(R)&&!o(R))throw new h("stream",["ReadableStream","WritableStream","Stream"],R);return e.exports.addAbortSignalNoValidate(c,R)},e.exports.addAbortSignalNoValidate=function(f,c){if(typeof f!="object"||!("aborted"in f))return c;const R=r(c)?()=>{c.destroy(new t(void 0,{cause:f.reason}))}:()=>{c[s](new t(void 0,{cause:f.reason}))};return f.aborted?R():(f.addEventListener("abort",R),l(c,()=>f.removeEventListener("abort",R))),c}})(Ms);var Fn=Ms.exports;const{StringPrototypeSlice:Wo,SymbolIterator:Nh,TypedArrayPrototypeSet:rn,Uint8Array:vh}=de,{Buffer:cr}=we,{inspect:Ch}=Je;var $h=class{constructor(){this.head=null,this.tail=null,this.length=0}push(t){const n={data:t,next:null};this.length>0?this.tail.next=n:this.head=n,this.tail=n,++this.length}unshift(t){const n={data:t,next:this.head};this.length===0&&(this.tail=n),this.head=n,++this.length}shift(){if(this.length===0)return;const t=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,t}clear(){this.head=this.tail=null,this.length=0}join(t){if(this.length===0)return"";let n=this.head,r=""+n.data;for(;(n=n.next)!==null;)r+=t+n.data;return r}concat(t){if(this.length===0)return cr.alloc(0);const n=cr.allocUnsafe(t>>>0);let r=this.head,o=0;for(;r;)rn(n,r.data,o),o+=r.data.length,r=r.next;return n}consume(t,n){const r=this.head.data;if(t<r.length){const o=r.slice(0,t);return this.head.data=r.slice(t),o}return t===r.length?this.shift():n?this._getString(t):this._getBuffer(t)}first(){return this.head.data}*[Nh](){for(let t=this.head;t;t=t.next)yield t.data}_getString(t){let n="",r=this.head,o=0;do{const s=r.data;if(t>s.length)n+=s,t-=s.length;else{t===s.length?(n+=s,++o,r.next?this.head=r.next:this.head=this.tail=null):(n+=Wo(s,0,t),this.head=r,r.data=Wo(s,t));break}++o}while((r=r.next)!==null);return this.length-=o,n}_getBuffer(t){const n=cr.allocUnsafe(t),r=t;let o=this.head,s=0;do{const l=o.data;if(t>l.length)rn(n,l,r-t),t-=l.length;else{t===l.length?(rn(n,l,r-t),++s,o.next?this.head=o.next:this.head=this.tail=null):(rn(n,new vh(l.buffer,l.byteOffset,t),r-t),this.head=o,o.data=l.slice(t));break}++s}while((o=o.next)!==null);return this.length-=s,n}[Symbol.for("nodejs.util.inspect.custom")](t,n){return Ch(this,{...n,depth:0,customInspect:!1})}};const{MathFloor:Mh,NumberIsInteger:Dh}=de,{ERR_INVALID_ARG_VALUE:Ph}=Ee.codes;function Oh(e,t,n){return e.highWaterMark!=null?e.highWaterMark:t?e[n]:null}function Ds(e){return e?16:16*1024}function Lh(e,t,n,r){const o=Oh(t,r,n);if(o!=null){if(!Dh(o)||o<0){const s=r?`options.${n}`:"options.highWaterMark";throw new Ph(s,o)}return Mh(o)}return Ds(e.objectMode)}var gi={getHighWaterMark:Lh,getDefaultHighWaterMark:Ds};const Uo=Se,{PromisePrototypeThen:kh,SymbolAsyncIterator:Bo,SymbolIterator:Fo}=de,{Buffer:xh}=we,{ERR_INVALID_ARG_TYPE:Wh,ERR_STREAM_NULL_VALUES:Uh}=Ee.codes;function Bh(e,t,n){let r;if(typeof t=="string"||t instanceof xh)return new e({objectMode:!0,...n,read(){this.push(t),this.push(null)}});let o;if(t&&t[Bo])o=!0,r=t[Bo]();else if(t&&t[Fo])o=!1,r=t[Fo]();else throw new Wh("iterable",["Iterable"],t);const s=new e({objectMode:!0,highWaterMark:1,...n});let l=!1;s._read=function(){l||(l=!0,b())},s._destroy=function(f,c){kh(h(f),()=>Uo.nextTick(c,f),R=>Uo.nextTick(c,R||f))};async function h(f){const c=f!=null,R=typeof r.throw=="function";if(c&&R){const{value:A,done:y}=await r.throw(f);if(await A,y)return}if(typeof r.return=="function"){const{value:A}=await r.return();await A}}async function b(){for(;;){try{const{value:f,done:c}=o?await r.next():r.next();if(c)s.push(null);else{const R=f&&typeof f.then=="function"?await f:f;if(R===null)throw l=!1,new Uh;if(s.push(R))continue;l=!1}}catch(f){s.destroy(f)}break}}return s}var Ps=Bh,hr,jo;function jn(){if(jo)return hr;jo=1;const e=Se,{ArrayPrototypeIndexOf:t,NumberIsInteger:n,NumberIsNaN:r,NumberParseInt:o,ObjectDefineProperties:s,ObjectKeys:l,ObjectSetPrototypeOf:h,Promise:b,SafeSet:f,SymbolAsyncIterator:c,Symbol:R}=de;hr=S,S.ReadableState=te;const{EventEmitter:A}=mt,{Stream:y,prependListener:p}=pi,{Buffer:P}=we,{addAbortSignal:$}=Fn,I=it;let _=Je.debuglog("stream",i=>{_=i});const L=$h,F=Lt,{getHighWaterMark:D,getDefaultHighWaterMark:K}=gi,{aggregateTwoErrors:j,codes:{ERR_INVALID_ARG_TYPE:G,ERR_METHOD_NOT_IMPLEMENTED:H,ERR_OUT_OF_RANGE:w,ERR_STREAM_PUSH_AFTER_EOF:O,ERR_STREAM_UNSHIFT_AFTER_END_EVENT:q}}=Ee,{validateObject:k}=On,x=R("kPaused"),{StringDecoder:C}=la,V=Ps;h(S.prototype,y.prototype),h(S,y);const Y=()=>{},{errorOrDestroy:W}=F;function te(i,a,m){typeof m!="boolean"&&(m=a instanceof Ye()),this.objectMode=!!(i&&i.objectMode),m&&(this.objectMode=this.objectMode||!!(i&&i.readableObjectMode)),this.highWaterMark=i?D(this,i,"readableHighWaterMark",m):K(!1),this.buffer=new L,this.length=0,this.pipes=[],this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.constructed=!0,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this[x]=null,this.errorEmitted=!1,this.emitClose=!i||i.emitClose!==!1,this.autoDestroy=!i||i.autoDestroy!==!1,this.destroyed=!1,this.errored=null,this.closed=!1,this.closeEmitted=!1,this.defaultEncoding=i&&i.defaultEncoding||"utf8",this.awaitDrainWriters=null,this.multiAwaitDrain=!1,this.readingMore=!1,this.dataEmitted=!1,this.decoder=null,this.encoding=null,i&&i.encoding&&(this.decoder=new C(i.encoding),this.encoding=i.encoding)}function S(i){if(!(this instanceof S))return new S(i);const a=this instanceof Ye();this._readableState=new te(i,this,a),i&&(typeof i.read=="function"&&(this._read=i.read),typeof i.destroy=="function"&&(this._destroy=i.destroy),typeof i.construct=="function"&&(this._construct=i.construct),i.signal&&!a&&$(i.signal,this)),y.call(this,i),F.construct(this,()=>{this._readableState.needReadable&&ue(this,this._readableState)})}S.prototype.destroy=F.destroy,S.prototype._undestroy=F.undestroy,S.prototype._destroy=function(i,a){a(i)},S.prototype[A.captureRejectionSymbol]=function(i){this.destroy(i)},S.prototype.push=function(i,a){return z(this,i,a,!1)},S.prototype.unshift=function(i,a){return z(this,i,a,!0)};function z(i,a,m,E){_("readableAddChunk",a);const T=i._readableState;let X;if(T.objectMode||(typeof a=="string"?(m=m||T.defaultEncoding,T.encoding!==m&&(E&&T.encoding?a=P.from(a,m).toString(T.encoding):(a=P.from(a,m),m=""))):a instanceof P?m="":y._isUint8Array(a)?(a=y._uint8ArrayToBuffer(a),m=""):a!=null&&(X=new G("chunk",["string","Buffer","Uint8Array"],a))),X)W(i,X);else if(a===null)T.reading=!1,ot(i,T);else if(T.objectMode||a&&a.length>0)if(E)if(T.endEmitted)W(i,new q);else{if(T.destroyed||T.errored)return!1;oe(i,T,a,!0)}else if(T.ended)W(i,new O);else{if(T.destroyed||T.errored)return!1;T.reading=!1,T.decoder&&!m?(a=T.decoder.write(a),T.objectMode||a.length!==0?oe(i,T,a,!1):ue(i,T)):oe(i,T,a,!1)}else E||(T.reading=!1,ue(i,T));return!T.ended&&(T.length<T.highWaterMark||T.length===0)}function oe(i,a,m,E){a.flowing&&a.length===0&&!a.sync&&i.listenerCount("data")>0?(a.multiAwaitDrain?a.awaitDrainWriters.clear():a.awaitDrainWriters=null,a.dataEmitted=!0,i.emit("data",m)):(a.length+=a.objectMode?1:m.length,E?a.buffer.unshift(m):a.buffer.push(m),a.needReadable&&Re(i)),ue(i,a)}S.prototype.isPaused=function(){const i=this._readableState;return i[x]===!0||i.flowing===!1},S.prototype.setEncoding=function(i){const a=new C(i);this._readableState.decoder=a,this._readableState.encoding=this._readableState.decoder.encoding;const m=this._readableState.buffer;let E="";for(const T of m)E+=a.write(T);return m.clear(),E!==""&&m.push(E),this._readableState.length=E.length,this};const $e=1073741824;function Me(i){if(i>$e)throw new w("size","<= 1GiB",i);return i--,i|=i>>>1,i|=i>>>2,i|=i>>>4,i|=i>>>8,i|=i>>>16,i++,i}function he(i,a){return i<=0||a.length===0&&a.ended?0:a.objectMode?1:r(i)?a.flowing&&a.length?a.buffer.first().length:a.length:i<=a.length?i:a.ended?a.length:0}S.prototype.read=function(i){_("read",i),i===void 0?i=NaN:n(i)||(i=o(i,10));const a=this._readableState,m=i;if(i>a.highWaterMark&&(a.highWaterMark=Me(i)),i!==0&&(a.emittedReadable=!1),i===0&&a.needReadable&&((a.highWaterMark!==0?a.length>=a.highWaterMark:a.length>0)||a.ended))return _("read: emitReadable",a.length,a.ended),a.length===0&&a.ended?re(this):Re(this),null;if(i=he(i,a),i===0&&a.ended)return a.length===0&&re(this),null;let E=a.needReadable;if(_("need readable",E),(a.length===0||a.length-i<a.highWaterMark)&&(E=!0,_("length less than watermark",E)),a.ended||a.reading||a.destroyed||a.errored||!a.constructed)E=!1,_("reading, ended or constructing",E);else if(E){_("do read"),a.reading=!0,a.sync=!0,a.length===0&&(a.needReadable=!0);try{this._read(a.highWaterMark)}catch(X){W(this,X)}a.sync=!1,a.reading||(i=he(m,a))}let T;return i>0?T=B(i,a):T=null,T===null?(a.needReadable=a.length<=a.highWaterMark,i=0):(a.length-=i,a.multiAwaitDrain?a.awaitDrainWriters.clear():a.awaitDrainWriters=null),a.length===0&&(a.ended||(a.needReadable=!0),m!==i&&a.ended&&re(this)),T!==null&&!a.errorEmitted&&!a.closeEmitted&&(a.dataEmitted=!0,this.emit("data",T)),T};function ot(i,a){if(_("onEofChunk"),!a.ended){if(a.decoder){const m=a.decoder.end();m&&m.length&&(a.buffer.push(m),a.length+=a.objectMode?1:m.length)}a.ended=!0,a.sync?Re(i):(a.needReadable=!1,a.emittedReadable=!0,Ae(i))}}function Re(i){const a=i._readableState;_("emitReadable",a.needReadable,a.emittedReadable),a.needReadable=!1,a.emittedReadable||(_("emitReadable",a.flowing),a.emittedReadable=!0,e.nextTick(Ae,i))}function Ae(i){const a=i._readableState;_("emitReadable_",a.destroyed,a.length,a.ended),!a.destroyed&&!a.errored&&(a.length||a.ended)&&(i.emit("readable"),a.emittedReadable=!1),a.needReadable=!a.flowing&&!a.ended&&a.length<=a.highWaterMark,N(i)}function ue(i,a){!a.readingMore&&a.constructed&&(a.readingMore=!0,e.nextTick(at,i,a))}function at(i,a){for(;!a.reading&&!a.ended&&(a.length<a.highWaterMark||a.flowing&&a.length===0);){const m=a.length;if(_("maybeReadMore read 0"),i.read(0),m===a.length)break}a.readingMore=!1}S.prototype._read=function(i){throw new H("_read()")},S.prototype.pipe=function(i,a){const m=this,E=this._readableState;E.pipes.length===1&&(E.multiAwaitDrain||(E.multiAwaitDrain=!0,E.awaitDrainWriters=new f(E.awaitDrainWriters?[E.awaitDrainWriters]:[]))),E.pipes.push(i),_("pipe count=%d opts=%j",E.pipes.length,a);const X=(!a||a.end!==!1)&&i!==e.stdout&&i!==e.stderr?xt:Le;E.endEmitted?e.nextTick(X):m.once("end",X),i.on("unpipe",Q);function Q(pe,se){_("onunpipe"),pe===m&&se&&se.hasUnpiped===!1&&(se.hasUnpiped=!0,Vn())}function xt(){_("onend"),i.end()}let be,Wt=!1;function Vn(){_("cleanup"),i.removeListener("close",lt),i.removeListener("finish",dt),be&&i.removeListener("drain",be),i.removeListener("error",st),i.removeListener("unpipe",Q),m.removeListener("end",xt),m.removeListener("end",Le),m.removeListener("data",Bt),Wt=!0,be&&E.awaitDrainWriters&&(!i._writableState||i._writableState.needDrain)&&be()}function Ut(){Wt||(E.pipes.length===1&&E.pipes[0]===i?(_("false write response, pause",0),E.awaitDrainWriters=i,E.multiAwaitDrain=!1):E.pipes.length>1&&E.pipes.includes(i)&&(_("false write response, pause",E.awaitDrainWriters.size),E.awaitDrainWriters.add(i)),m.pause()),be||(be=De(m,i),i.on("drain",be))}m.on("data",Bt);function Bt(pe){_("ondata");const se=i.write(pe);_("dest.write",se),se===!1&&Ut()}function st(pe){if(_("onerror",pe),Le(),i.removeListener("error",st),i.listenerCount("error")===0){const se=i._writableState||i._readableState;se&&!se.errorEmitted?W(i,pe):i.emit("error",pe)}}p(i,"error",st);function lt(){i.removeListener("finish",dt),Le()}i.once("close",lt);function dt(){_("onfinish"),i.removeListener("close",lt),Le()}i.once("finish",dt);function Le(){_("unpipe"),m.unpipe(i)}return i.emit("pipe",m),i.writableNeedDrain===!0?E.flowing&&Ut():E.flowing||(_("pipe resume"),m.resume()),i};function De(i,a){return function(){const E=i._readableState;E.awaitDrainWriters===a?(_("pipeOnDrain",1),E.awaitDrainWriters=null):E.multiAwaitDrain&&(_("pipeOnDrain",E.awaitDrainWriters.size),E.awaitDrainWriters.delete(a)),(!E.awaitDrainWriters||E.awaitDrainWriters.size===0)&&i.listenerCount("data")&&i.resume()}}S.prototype.unpipe=function(i){const a=this._readableState,m={hasUnpiped:!1};if(a.pipes.length===0)return this;if(!i){const T=a.pipes;a.pipes=[],this.pause();for(let X=0;X<T.length;X++)T[X].emit("unpipe",this,{hasUnpiped:!1});return this}const E=t(a.pipes,i);return E===-1?this:(a.pipes.splice(E,1),a.pipes.length===0&&this.pause(),i.emit("unpipe",this,m),this)},S.prototype.on=function(i,a){const m=y.prototype.on.call(this,i,a),E=this._readableState;return i==="data"?(E.readableListening=this.listenerCount("readable")>0,E.flowing!==!1&&this.resume()):i==="readable"&&!E.endEmitted&&!E.readableListening&&(E.readableListening=E.needReadable=!0,E.flowing=!1,E.emittedReadable=!1,_("on readable",E.length,E.reading),E.length?Re(this):E.reading||e.nextTick(d,this)),m},S.prototype.addListener=S.prototype.on,S.prototype.removeListener=function(i,a){const m=y.prototype.removeListener.call(this,i,a);return i==="readable"&&e.nextTick(Pe,this),m},S.prototype.off=S.prototype.removeListener,S.prototype.removeAllListeners=function(i){const a=y.prototype.removeAllListeners.apply(this,arguments);return(i==="readable"||i===void 0)&&e.nextTick(Pe,this),a};function Pe(i){const a=i._readableState;a.readableListening=i.listenerCount("readable")>0,a.resumeScheduled&&a[x]===!1?a.flowing=!0:i.listenerCount("data")>0?i.resume():a.readableListening||(a.flowing=null)}function d(i){_("readable nexttick read 0"),i.read(0)}S.prototype.resume=function(){const i=this._readableState;return i.flowing||(_("resume"),i.flowing=!i.readableListening,u(this,i)),i[x]=!1,this};function u(i,a){a.resumeScheduled||(a.resumeScheduled=!0,e.nextTick(g,i,a))}function g(i,a){_("resume",a.reading),a.reading||i.read(0),a.resumeScheduled=!1,i.emit("resume"),N(i),a.flowing&&!a.reading&&i.read(0)}S.prototype.pause=function(){return _("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(_("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState[x]=!0,this};function N(i){const a=i._readableState;for(_("flow",a.flowing);a.flowing&&i.read()!==null;);}S.prototype.wrap=function(i){let a=!1;i.on("data",E=>{!this.push(E)&&i.pause&&(a=!0,i.pause())}),i.on("end",()=>{this.push(null)}),i.on("error",E=>{W(this,E)}),i.on("close",()=>{this.destroy()}),i.on("destroy",()=>{this.destroy()}),this._read=()=>{a&&i.resume&&(a=!1,i.resume())};const m=l(i);for(let E=1;E<m.length;E++){const T=m[E];this[T]===void 0&&typeof i[T]=="function"&&(this[T]=i[T].bind(i))}return this},S.prototype[c]=function(){return v(this)},S.prototype.iterator=function(i){return i!==void 0&&k(i,"options"),v(this,i)};function v(i,a){typeof i.read!="function"&&(i=S.wrap(i,{objectMode:!0}));const m=U(i,a);return m.stream=i,m}async function*U(i,a){let m=Y;function E(Q){this===i?(m(),m=Y):m=Q}i.on("readable",E);let T;const X=I(i,{writable:!1},Q=>{T=Q?j(T,Q):null,m(),m=Y});try{for(;;){const Q=i.destroyed?null:i.read();if(Q!==null)yield Q;else{if(T)throw T;if(T===null)return;await new b(E)}}}catch(Q){throw T=j(T,Q),T}finally{(T||(a==null?void 0:a.destroyOnReturn)!==!1)&&(T===void 0||i._readableState.autoDestroy)?F.destroyer(i,null):(i.off("readable",E),X())}}s(S.prototype,{readable:{__proto__:null,get(){const i=this._readableState;return!!i&&i.readable!==!1&&!i.destroyed&&!i.errorEmitted&&!i.endEmitted},set(i){this._readableState&&(this._readableState.readable=!!i)}},readableDidRead:{__proto__:null,enumerable:!1,get:function(){return this._readableState.dataEmitted}},readableAborted:{__proto__:null,enumerable:!1,get:function(){return!!(this._readableState.readable!==!1&&(this._readableState.destroyed||this._readableState.errored)&&!this._readableState.endEmitted)}},readableHighWaterMark:{__proto__:null,enumerable:!1,get:function(){return this._readableState.highWaterMark}},readableBuffer:{__proto__:null,enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}},readableFlowing:{__proto__:null,enumerable:!1,get:function(){return this._readableState.flowing},set:function(i){this._readableState&&(this._readableState.flowing=i)}},readableLength:{__proto__:null,enumerable:!1,get(){return this._readableState.length}},readableObjectMode:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.objectMode:!1}},readableEncoding:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.encoding:null}},errored:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.errored:null}},closed:{__proto__:null,get(){return this._readableState?this._readableState.closed:!1}},destroyed:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.destroyed:!1},set(i){this._readableState&&(this._readableState.destroyed=i)}},readableEnded:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.endEmitted:!1}}}),s(te.prototype,{pipesCount:{__proto__:null,get(){return this.pipes.length}},paused:{__proto__:null,get(){return this[x]!==!1},set(i){this[x]=!!i}}}),S._fromList=B;function B(i,a){if(a.length===0)return null;let m;return a.objectMode?m=a.buffer.shift():!i||i>=a.length?(a.decoder?m=a.buffer.join(""):a.buffer.length===1?m=a.buffer.first():m=a.buffer.concat(a.length),a.buffer.clear()):m=a.buffer.consume(i,a.decoder),m}function re(i){const a=i._readableState;_("endReadable",a.endEmitted),a.endEmitted||(a.ended=!0,e.nextTick(Te,a,i))}function Te(i,a){if(_("endReadableNT",i.endEmitted,i.length),!i.errored&&!i.closeEmitted&&!i.endEmitted&&i.length===0){if(i.endEmitted=!0,a.emit("end"),a.writable&&a.allowHalfOpen===!1)e.nextTick(Oe,a);else if(i.autoDestroy){const m=a._writableState;(!m||m.autoDestroy&&(m.finished||m.writable===!1))&&a.destroy()}}}function Oe(i){i.writable&&!i.writableEnded&&!i.destroyed&&i.end()}S.from=function(i,a){return V(S,i,a)};let ae;function kt(){return ae===void 0&&(ae={}),ae}return S.fromWeb=function(i,a){return kt().newStreamReadableFromReadableStream(i,a)},S.toWeb=function(i,a){return kt().newReadableStreamFromStreamReadable(i,a)},S.wrap=function(i,a){var m,E;return new S({objectMode:(m=(E=i.readableObjectMode)!==null&&E!==void 0?E:i.objectMode)!==null&&m!==void 0?m:!0,...a,destroy(T,X){F.destroyer(i,T),X(T)}}).wrap(i)},hr}var br,Ho;function Os(){if(Ho)return br;Ho=1;const e=Se,{ArrayPrototypeSlice:t,Error:n,FunctionPrototypeSymbolHasInstance:r,ObjectDefineProperty:o,ObjectDefineProperties:s,ObjectSetPrototypeOf:l,StringPrototypeToLowerCase:h,Symbol:b,SymbolHasInstance:f}=de;br=C,C.WritableState=k;const{EventEmitter:c}=mt,R=pi.Stream,{Buffer:A}=we,y=Lt,{addAbortSignal:p}=Fn,{getHighWaterMark:P,getDefaultHighWaterMark:$}=gi,{ERR_INVALID_ARG_TYPE:I,ERR_METHOD_NOT_IMPLEMENTED:_,ERR_MULTIPLE_CALLBACK:L,ERR_STREAM_CANNOT_PIPE:F,ERR_STREAM_DESTROYED:D,ERR_STREAM_ALREADY_FINISHED:K,ERR_STREAM_NULL_VALUES:j,ERR_STREAM_WRITE_AFTER_END:G,ERR_UNKNOWN_ENCODING:H}=Ee.codes,{errorOrDestroy:w}=y;l(C.prototype,R.prototype),l(C,R);function O(){}const q=b("kOnFinished");function k(d,u,g){typeof g!="boolean"&&(g=u instanceof Ye()),this.objectMode=!!(d&&d.objectMode),g&&(this.objectMode=this.objectMode||!!(d&&d.writableObjectMode)),this.highWaterMark=d?P(this,d,"writableHighWaterMark",g):$(!1),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;const N=!!(d&&d.decodeStrings===!1);this.decodeStrings=!N,this.defaultEncoding=d&&d.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=S.bind(void 0,u),this.writecb=null,this.writelen=0,this.afterWriteTickInfo=null,x(this),this.pendingcb=0,this.constructed=!0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!d||d.emitClose!==!1,this.autoDestroy=!d||d.autoDestroy!==!1,this.errored=null,this.closed=!1,this.closeEmitted=!1,this[q]=[]}function x(d){d.buffered=[],d.bufferedIndex=0,d.allBuffers=!0,d.allNoop=!0}k.prototype.getBuffer=function(){return t(this.buffered,this.bufferedIndex)},o(k.prototype,"bufferedRequestCount",{__proto__:null,get(){return this.buffered.length-this.bufferedIndex}});function C(d){const u=this instanceof Ye();if(!u&&!r(C,this))return new C(d);this._writableState=new k(d,this,u),d&&(typeof d.write=="function"&&(this._write=d.write),typeof d.writev=="function"&&(this._writev=d.writev),typeof d.destroy=="function"&&(this._destroy=d.destroy),typeof d.final=="function"&&(this._final=d.final),typeof d.construct=="function"&&(this._construct=d.construct),d.signal&&p(d.signal,this)),R.call(this,d),y.construct(this,()=>{const g=this._writableState;g.writing||Me(this,g),Ae(this,g)})}o(C,f,{__proto__:null,value:function(d){return r(this,d)?!0:this!==C?!1:d&&d._writableState instanceof k}}),C.prototype.pipe=function(){w(this,new F)};function V(d,u,g,N){const v=d._writableState;if(typeof g=="function")N=g,g=v.defaultEncoding;else{if(!g)g=v.defaultEncoding;else if(g!=="buffer"&&!A.isEncoding(g))throw new H(g);typeof N!="function"&&(N=O)}if(u===null)throw new j;if(!v.objectMode)if(typeof u=="string")v.decodeStrings!==!1&&(u=A.from(u,g),g="buffer");else if(u instanceof A)g="buffer";else if(R._isUint8Array(u))u=R._uint8ArrayToBuffer(u),g="buffer";else throw new I("chunk",["string","Buffer","Uint8Array"],u);let U;return v.ending?U=new G:v.destroyed&&(U=new D("write")),U?(e.nextTick(N,U),w(d,U,!0),U):(v.pendingcb++,Y(d,v,u,g,N))}C.prototype.write=function(d,u,g){return V(this,d,u,g)===!0},C.prototype.cork=function(){this._writableState.corked++},C.prototype.uncork=function(){const d=this._writableState;d.corked&&(d.corked--,d.writing||Me(this,d))},C.prototype.setDefaultEncoding=function(u){if(typeof u=="string"&&(u=h(u)),!A.isEncoding(u))throw new H(u);return this._writableState.defaultEncoding=u,this};function Y(d,u,g,N,v){const U=u.objectMode?1:g.length;u.length+=U;const B=u.length<u.highWaterMark;return B||(u.needDrain=!0),u.writing||u.corked||u.errored||!u.constructed?(u.buffered.push({chunk:g,encoding:N,callback:v}),u.allBuffers&&N!=="buffer"&&(u.allBuffers=!1),u.allNoop&&v!==O&&(u.allNoop=!1)):(u.writelen=U,u.writecb=v,u.writing=!0,u.sync=!0,d._write(g,N,u.onwrite),u.sync=!1),B&&!u.errored&&!u.destroyed}function W(d,u,g,N,v,U,B){u.writelen=N,u.writecb=B,u.writing=!0,u.sync=!0,u.destroyed?u.onwrite(new D("write")):g?d._writev(v,u.onwrite):d._write(v,U,u.onwrite),u.sync=!1}function te(d,u,g,N){--u.pendingcb,N(g),$e(u),w(d,g)}function S(d,u){const g=d._writableState,N=g.sync,v=g.writecb;if(typeof v!="function"){w(d,new L);return}g.writing=!1,g.writecb=null,g.length-=g.writelen,g.writelen=0,u?(u.stack,g.errored||(g.errored=u),d._readableState&&!d._readableState.errored&&(d._readableState.errored=u),N?e.nextTick(te,d,g,u,v):te(d,g,u,v)):(g.buffered.length>g.bufferedIndex&&Me(d,g),N?g.afterWriteTickInfo!==null&&g.afterWriteTickInfo.cb===v?g.afterWriteTickInfo.count++:(g.afterWriteTickInfo={count:1,cb:v,stream:d,state:g},e.nextTick(z,g.afterWriteTickInfo)):oe(d,g,1,v))}function z({stream:d,state:u,count:g,cb:N}){return u.afterWriteTickInfo=null,oe(d,u,g,N)}function oe(d,u,g,N){for(!u.ending&&!d.destroyed&&u.length===0&&u.needDrain&&(u.needDrain=!1,d.emit("drain"));g-- >0;)u.pendingcb--,N();u.destroyed&&$e(u),Ae(d,u)}function $e(d){if(d.writing)return;for(let v=d.bufferedIndex;v<d.buffered.length;++v){var u;const{chunk:U,callback:B}=d.buffered[v],re=d.objectMode?1:U.length;d.length-=re,B((u=d.errored)!==null&&u!==void 0?u:new D("write"))}const g=d[q].splice(0);for(let v=0;v<g.length;v++){var N;g[v]((N=d.errored)!==null&&N!==void 0?N:new D("end"))}x(d)}function Me(d,u){if(u.corked||u.bufferProcessing||u.destroyed||!u.constructed)return;const{buffered:g,bufferedIndex:N,objectMode:v}=u,U=g.length-N;if(!U)return;let B=N;if(u.bufferProcessing=!0,U>1&&d._writev){u.pendingcb-=U-1;const re=u.allNoop?O:Oe=>{for(let ae=B;ae<g.length;++ae)g[ae].callback(Oe)},Te=u.allNoop&&B===0?g:t(g,B);Te.allBuffers=u.allBuffers,W(d,u,!0,u.length,Te,"",re),x(u)}else{do{const{chunk:re,encoding:Te,callback:Oe}=g[B];g[B++]=null;const ae=v?1:re.length;W(d,u,!1,ae,re,Te,Oe)}while(B<g.length&&!u.writing);B===g.length?x(u):B>256?(g.splice(0,B),u.bufferedIndex=0):u.bufferedIndex=B}u.bufferProcessing=!1}C.prototype._write=function(d,u,g){if(this._writev)this._writev([{chunk:d,encoding:u}],g);else throw new _("_write()")},C.prototype._writev=null,C.prototype.end=function(d,u,g){const N=this._writableState;typeof d=="function"?(g=d,d=null,u=null):typeof u=="function"&&(g=u,u=null);let v;if(d!=null){const U=V(this,d,u);U instanceof n&&(v=U)}return N.corked&&(N.corked=1,this.uncork()),v||(!N.errored&&!N.ending?(N.ending=!0,Ae(this,N,!0),N.ended=!0):N.finished?v=new K("end"):N.destroyed&&(v=new D("end"))),typeof g=="function"&&(v||N.finished?e.nextTick(g,v):N[q].push(g)),this};function he(d){return d.ending&&!d.destroyed&&d.constructed&&d.length===0&&!d.errored&&d.buffered.length===0&&!d.finished&&!d.writing&&!d.errorEmitted&&!d.closeEmitted}function ot(d,u){let g=!1;function N(v){if(g){w(d,v??L());return}if(g=!0,u.pendingcb--,v){const U=u[q].splice(0);for(let B=0;B<U.length;B++)U[B](v);w(d,v,u.sync)}else he(u)&&(u.prefinished=!0,d.emit("prefinish"),u.pendingcb++,e.nextTick(ue,d,u))}u.sync=!0,u.pendingcb++;try{d._final(N)}catch(v){N(v)}u.sync=!1}function Re(d,u){!u.prefinished&&!u.finalCalled&&(typeof d._final=="function"&&!u.destroyed?(u.finalCalled=!0,ot(d,u)):(u.prefinished=!0,d.emit("prefinish")))}function Ae(d,u,g){he(u)&&(Re(d,u),u.pendingcb===0&&(g?(u.pendingcb++,e.nextTick((N,v)=>{he(v)?ue(N,v):v.pendingcb--},d,u)):he(u)&&(u.pendingcb++,ue(d,u))))}function ue(d,u){u.pendingcb--,u.finished=!0;const g=u[q].splice(0);for(let N=0;N<g.length;N++)g[N]();if(d.emit("finish"),u.autoDestroy){const N=d._readableState;(!N||N.autoDestroy&&(N.endEmitted||N.readable===!1))&&d.destroy()}}s(C.prototype,{closed:{__proto__:null,get(){return this._writableState?this._writableState.closed:!1}},destroyed:{__proto__:null,get(){return this._writableState?this._writableState.destroyed:!1},set(d){this._writableState&&(this._writableState.destroyed=d)}},writable:{__proto__:null,get(){const d=this._writableState;return!!d&&d.writable!==!1&&!d.destroyed&&!d.errored&&!d.ending&&!d.ended},set(d){this._writableState&&(this._writableState.writable=!!d)}},writableFinished:{__proto__:null,get(){return this._writableState?this._writableState.finished:!1}},writableObjectMode:{__proto__:null,get(){return this._writableState?this._writableState.objectMode:!1}},writableBuffer:{__proto__:null,get(){return this._writableState&&this._writableState.getBuffer()}},writableEnded:{__proto__:null,get(){return this._writableState?this._writableState.ending:!1}},writableNeedDrain:{__proto__:null,get(){const d=this._writableState;return d?!d.destroyed&&!d.ending&&d.needDrain:!1}},writableHighWaterMark:{__proto__:null,get(){return this._writableState&&this._writableState.highWaterMark}},writableCorked:{__proto__:null,get(){return this._writableState?this._writableState.corked:0}},writableLength:{__proto__:null,get(){return this._writableState&&this._writableState.length}},errored:{__proto__:null,enumerable:!1,get(){return this._writableState?this._writableState.errored:null}},writableAborted:{__proto__:null,enumerable:!1,get:function(){return!!(this._writableState.writable!==!1&&(this._writableState.destroyed||this._writableState.errored)&&!this._writableState.finished)}}});const at=y.destroy;C.prototype.destroy=function(d,u){const g=this._writableState;return!g.destroyed&&(g.bufferedIndex<g.buffered.length||g[q].length)&&e.nextTick($e,g),at.call(this,d,u),this},C.prototype._undestroy=y.undestroy,C.prototype._destroy=function(d,u){u(d)},C.prototype[c.captureRejectionSymbol]=function(d){this.destroy(d)};let De;function Pe(){return De===void 0&&(De={}),De}return C.fromWeb=function(d,u){return Pe().newStreamWritableFromWritableStream(d,u)},C.toWeb=function(d){return Pe().newWritableStreamFromStreamWritable(d)},br}var pr,Vo;function Fh(){if(Vo)return pr;Vo=1;const e=Se,t=we,{isReadable:n,isWritable:r,isIterable:o,isNodeStream:s,isReadableNodeStream:l,isWritableNodeStream:h,isDuplexNodeStream:b}=Qe,f=it,{AbortError:c,codes:{ERR_INVALID_ARG_TYPE:R,ERR_INVALID_RETURN_VALUE:A}}=Ee,{destroyer:y}=Lt,p=Ye(),P=jn(),{createDeferredPromise:$}=Je,I=Ps,_=globalThis.Blob||t.Blob,L=typeof _<"u"?function(w){return w instanceof _}:function(w){return!1},F=globalThis.AbortController||Mt().AbortController,{FunctionPrototypeCall:D}=de;class K extends p{constructor(w){super(w),(w==null?void 0:w.readable)===!1&&(this._readableState.readable=!1,this._readableState.ended=!0,this._readableState.endEmitted=!0),(w==null?void 0:w.writable)===!1&&(this._writableState.writable=!1,this._writableState.ending=!0,this._writableState.ended=!0,this._writableState.finished=!0)}}pr=function H(w,O){if(b(w))return w;if(l(w))return G({readable:w});if(h(w))return G({writable:w});if(s(w))return G({writable:!1,readable:!1});if(typeof w=="function"){const{value:k,write:x,final:C,destroy:V}=j(w);if(o(k))return I(K,k,{objectMode:!0,write:x,final:C,destroy:V});const Y=k==null?void 0:k.then;if(typeof Y=="function"){let W;const te=D(Y,k,S=>{if(S!=null)throw new A("nully","body",S)},S=>{y(W,S)});return W=new K({objectMode:!0,readable:!1,write:x,final(S){C(async()=>{try{await te,e.nextTick(S,null)}catch(z){e.nextTick(S,z)}})},destroy:V})}throw new A("Iterable, AsyncIterable or AsyncFunction",O,k)}if(L(w))return H(w.arrayBuffer());if(o(w))return I(K,w,{objectMode:!0,writable:!1});if(typeof(w==null?void 0:w.writable)=="object"||typeof(w==null?void 0:w.readable)=="object"){const k=w!=null&&w.readable?l(w==null?void 0:w.readable)?w==null?void 0:w.readable:H(w.readable):void 0,x=w!=null&&w.writable?h(w==null?void 0:w.writable)?w==null?void 0:w.writable:H(w.writable):void 0;return G({readable:k,writable:x})}const q=w==null?void 0:w.then;if(typeof q=="function"){let k;return D(q,w,x=>{x!=null&&k.push(x),k.push(null)},x=>{y(k,x)}),k=new K({objectMode:!0,writable:!1,read(){}})}throw new R(O,["Blob","ReadableStream","WritableStream","Stream","Iterable","AsyncIterable","Function","{ readable, writable } pair","Promise"],w)};function j(H){let{promise:w,resolve:O}=$();const q=new F,k=q.signal;return{value:H(async function*(){for(;;){const C=w;w=null;const{chunk:V,done:Y,cb:W}=await C;if(e.nextTick(W),Y)return;if(k.aborted)throw new c(void 0,{cause:k.reason});({promise:w,resolve:O}=$()),yield V}}(),{signal:k}),write(C,V,Y){const W=O;O=null,W({chunk:C,done:!1,cb:Y})},final(C){const V=O;O=null,V({done:!0,cb:C})},destroy(C,V){q.abort(),V(C)}}}function G(H){const w=H.readable&&typeof H.readable.read!="function"?P.wrap(H.readable):H.readable,O=H.writable;let q=!!n(w),k=!!r(O),x,C,V,Y,W;function te(S){const z=Y;Y=null,z?z(S):S&&W.destroy(S)}return W=new K({readableObjectMode:!!(w!=null&&w.readableObjectMode),writableObjectMode:!!(O!=null&&O.writableObjectMode),readable:q,writable:k}),k&&(f(O,S=>{k=!1,S&&y(w,S),te(S)}),W._write=function(S,z,oe){O.write(S,z)?oe():x=oe},W._final=function(S){O.end(),C=S},O.on("drain",function(){if(x){const S=x;x=null,S()}}),O.on("finish",function(){if(C){const S=C;C=null,S()}})),q&&(f(w,S=>{q=!1,S&&y(w,S),te(S)}),w.on("readable",function(){if(V){const S=V;V=null,S()}}),w.on("end",function(){W.push(null)}),W._read=function(){for(;;){const S=w.read();if(S===null){V=W._read;return}if(!W.push(S))return}}),W._destroy=function(S,z){!S&&Y!==null&&(S=new c),V=null,x=null,C=null,Y===null?z(S):(Y=z,y(O,S),y(w,S))},W}return pr}var gr,Go;function Ye(){if(Go)return gr;Go=1;const{ObjectDefineProperties:e,ObjectGetOwnPropertyDescriptor:t,ObjectKeys:n,ObjectSetPrototypeOf:r}=de;gr=l;const o=jn(),s=Os();r(l.prototype,o.prototype),r(l,o);{const c=n(s.prototype);for(let R=0;R<c.length;R++){const A=c[R];l.prototype[A]||(l.prototype[A]=s.prototype[A])}}function l(c){if(!(this instanceof l))return new l(c);o.call(this,c),s.call(this,c),c?(this.allowHalfOpen=c.allowHalfOpen!==!1,c.readable===!1&&(this._readableState.readable=!1,this._readableState.ended=!0,this._readableState.endEmitted=!0),c.writable===!1&&(this._writableState.writable=!1,this._writableState.ending=!0,this._writableState.ended=!0,this._writableState.finished=!0)):this.allowHalfOpen=!0}e(l.prototype,{writable:{__proto__:null,...t(s.prototype,"writable")},writableHighWaterMark:{__proto__:null,...t(s.prototype,"writableHighWaterMark")},writableObjectMode:{__proto__:null,...t(s.prototype,"writableObjectMode")},writableBuffer:{__proto__:null,...t(s.prototype,"writableBuffer")},writableLength:{__proto__:null,...t(s.prototype,"writableLength")},writableFinished:{__proto__:null,...t(s.prototype,"writableFinished")},writableCorked:{__proto__:null,...t(s.prototype,"writableCorked")},writableEnded:{__proto__:null,...t(s.prototype,"writableEnded")},writableNeedDrain:{__proto__:null,...t(s.prototype,"writableNeedDrain")},destroyed:{__proto__:null,get(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set(c){this._readableState&&this._writableState&&(this._readableState.destroyed=c,this._writableState.destroyed=c)}}});let h;function b(){return h===void 0&&(h={}),h}l.fromWeb=function(c,R){return b().newStreamDuplexFromReadableWritablePair(c,R)},l.toWeb=function(c){return b().newReadableWritablePairFromDuplex(c)};let f;return l.from=function(c){return f||(f=Fh()),f(c,"body")},gr}const{ObjectSetPrototypeOf:Ls,Symbol:jh}=de;var ks=Xe;const{ERR_METHOD_NOT_IMPLEMENTED:Hh}=Ee.codes,yi=Ye(),{getHighWaterMark:Vh}=gi;Ls(Xe.prototype,yi.prototype);Ls(Xe,yi);const qt=jh("kCallback");function Xe(e){if(!(this instanceof Xe))return new Xe(e);const t=e?Vh(this,e,"readableHighWaterMark",!0):null;t===0&&(e={...e,highWaterMark:null,readableHighWaterMark:t,writableHighWaterMark:e.writableHighWaterMark||0}),yi.call(this,e),this._readableState.sync=!1,this[qt]=null,e&&(typeof e.transform=="function"&&(this._transform=e.transform),typeof e.flush=="function"&&(this._flush=e.flush)),this.on("prefinish",Gh)}function Xr(e){typeof this._flush=="function"&&!this.destroyed?this._flush((t,n)=>{if(t){e?e(t):this.destroy(t);return}n!=null&&this.push(n),this.push(null),e&&e()}):(this.push(null),e&&e())}function Gh(){this._final!==Xr&&Xr.call(this)}Xe.prototype._final=Xr;Xe.prototype._transform=function(e,t,n){throw new Hh("_transform()")};Xe.prototype._write=function(e,t,n){const r=this._readableState,o=this._writableState,s=r.length;this._transform(e,t,(l,h)=>{if(l){n(l);return}h!=null&&this.push(h),o.ended||s===r.length||r.length<r.highWaterMark?n():this[qt]=n})};Xe.prototype._read=function(){if(this[qt]){const e=this[qt];this[qt]=null,e()}};const{ObjectSetPrototypeOf:xs}=de;var Ws=$t;const _i=ks;xs($t.prototype,_i.prototype);xs($t,_i);function $t(e){if(!(this instanceof $t))return new $t(e);_i.call(this,e)}$t.prototype._transform=function(e,t,n){n(null,e)};const Vt=Se,{ArrayIsArray:Kh,Promise:qh,SymbolAsyncIterator:Yh}=de,gn=it,{once:Xh}=Je,zh=Lt,Ko=Ye(),{aggregateTwoErrors:Zh,codes:{ERR_INVALID_ARG_TYPE:zr,ERR_INVALID_RETURN_VALUE:yr,ERR_MISSING_ARGS:Jh,ERR_STREAM_DESTROYED:Qh,ERR_STREAM_PREMATURE_CLOSE:eb},AbortError:tb}=Ee,{validateFunction:nb,validateAbortSignal:rb}=On,{isIterable:gt,isReadable:_r,isReadableNodeStream:un,isNodeStream:qo,isTransformStream:vt,isWebStream:ib,isReadableStream:wr,isReadableEnded:ob}=Qe,ab=globalThis.AbortController||Mt().AbortController;let Sr,mr;function Yo(e,t,n){let r=!1;e.on("close",()=>{r=!0});const o=gn(e,{readable:t,writable:n},s=>{r=!s});return{destroy:s=>{r||(r=!0,zh.destroyer(e,s||new Qh("pipe")))},cleanup:o}}function sb(e){return nb(e[e.length-1],"streams[stream.length - 1]"),e.pop()}function Er(e){if(gt(e))return e;if(un(e))return lb(e);throw new zr("val",["Readable","Iterable","AsyncIterable"],e)}async function*lb(e){mr||(mr=jn()),yield*mr.prototype[Yh].call(e)}async function on(e,t,n,{end:r}){let o,s=null;const l=f=>{if(f&&(o=f),s){const c=s;s=null,c()}},h=()=>new qh((f,c)=>{o?c(o):s=()=>{o?c(o):f()}});t.on("drain",l);const b=gn(t,{readable:!1},l);try{t.writableNeedDrain&&await h();for await(const f of e)t.write(f)||await h();r&&t.end(),await h(),n()}catch(f){n(o!==f?Zh(o,f):f)}finally{b(),t.off("drain",l)}}async function Rr(e,t,n,{end:r}){vt(t)&&(t=t.writable);const o=t.getWriter();try{for await(const s of e)await o.ready,o.write(s).catch(()=>{});await o.ready,r&&await o.close(),n()}catch(s){try{await o.abort(s),n(s)}catch(l){n(l)}}}function db(...e){return Us(e,Xh(sb(e)))}function Us(e,t,n){if(e.length===1&&Kh(e[0])&&(e=e[0]),e.length<2)throw new Jh("streams");const r=new ab,o=r.signal,s=n==null?void 0:n.signal,l=[];rb(s,"options.signal");function h(){y(new tb)}s==null||s.addEventListener("abort",h);let b,f;const c=[];let R=0;function A(I){y(I,--R===0)}function y(I,_){if(I&&(!b||b.code==="ERR_STREAM_PREMATURE_CLOSE")&&(b=I),!(!b&&!_)){for(;c.length;)c.shift()(b);s==null||s.removeEventListener("abort",h),r.abort(),_&&(b||l.forEach(L=>L()),Vt.nextTick(t,b,f))}}let p;for(let I=0;I<e.length;I++){const _=e[I],L=I<e.length-1,F=I>0,D=L||(n==null?void 0:n.end)!==!1,K=I===e.length-1;if(qo(_)){let j=function(G){G&&G.name!=="AbortError"&&G.code!=="ERR_STREAM_PREMATURE_CLOSE"&&A(G)};if(D){const{destroy:G,cleanup:H}=Yo(_,L,F);c.push(G),_r(_)&&K&&l.push(H)}_.on("error",j),_r(_)&&K&&l.push(()=>{_.removeListener("error",j)})}if(I===0)if(typeof _=="function"){if(p=_({signal:o}),!gt(p))throw new yr("Iterable, AsyncIterable or Stream","source",p)}else gt(_)||un(_)||vt(_)?p=_:p=Ko.from(_);else if(typeof _=="function"){if(vt(p)){var P;p=Er((P=p)===null||P===void 0?void 0:P.readable)}else p=Er(p);if(p=_(p,{signal:o}),L){if(!gt(p,!0))throw new yr("AsyncIterable",`transform[${I-1}]`,p)}else{var $;Sr||(Sr=Ws);const j=new Sr({objectMode:!0}),G=($=p)===null||$===void 0?void 0:$.then;if(typeof G=="function")R++,G.call(p,O=>{f=O,O!=null&&j.write(O),D&&j.end(),Vt.nextTick(A)},O=>{j.destroy(O),Vt.nextTick(A,O)});else if(gt(p,!0))R++,on(p,j,A,{end:D});else if(wr(p)||vt(p)){const O=p.readable||p;R++,on(O,j,A,{end:D})}else throw new yr("AsyncIterable or Promise","destination",p);p=j;const{destroy:H,cleanup:w}=Yo(p,!1,!0);c.push(H),K&&l.push(w)}}else if(qo(_)){if(un(p)){R+=2;const j=ub(p,_,A,{end:D});_r(_)&&K&&l.push(j)}else if(vt(p)||wr(p)){const j=p.readable||p;R++,on(j,_,A,{end:D})}else if(gt(p))R++,on(p,_,A,{end:D});else throw new zr("val",["Readable","Iterable","AsyncIterable","ReadableStream","TransformStream"],p);p=_}else if(ib(_)){if(un(p))R++,Rr(Er(p),_,A,{end:D});else if(wr(p)||gt(p))R++,Rr(p,_,A,{end:D});else if(vt(p))R++,Rr(p.readable,_,A,{end:D});else throw new zr("val",["Readable","Iterable","AsyncIterable","ReadableStream","TransformStream"],p);p=_}else p=Ko.from(_)}return(o!=null&&o.aborted||s!=null&&s.aborted)&&Vt.nextTick(h),p}function ub(e,t,n,{end:r}){let o=!1;if(t.on("close",()=>{o||n(new eb)}),e.pipe(t,{end:!1}),r){let s=function(){o=!0,t.end()};ob(e)?Vt.nextTick(s):e.once("end",s)}else n();return gn(e,{readable:!0,writable:!1},s=>{const l=e._readableState;s&&s.code==="ERR_STREAM_PREMATURE_CLOSE"&&l&&l.ended&&!l.errored&&!l.errorEmitted?e.once("end",n).once("error",n):n(s)}),gn(t,{readable:!1,writable:!0},n)}var wi={pipelineImpl:Us,pipeline:db};const{pipeline:fb}=wi,an=Ye(),{destroyer:cb}=Lt,{isNodeStream:sn,isReadable:Xo,isWritable:zo,isWebStream:Ar,isTransformStream:ct,isWritableStream:Zo,isReadableStream:Jo}=Qe,{AbortError:hb,codes:{ERR_INVALID_ARG_VALUE:Qo,ERR_MISSING_ARGS:bb}}=Ee,pb=it;var Bs=function(...t){if(t.length===0)throw new bb("streams");if(t.length===1)return an.from(t[0]);const n=[...t];if(typeof t[0]=="function"&&(t[0]=an.from(t[0])),typeof t[t.length-1]=="function"){const y=t.length-1;t[y]=an.from(t[y])}for(let y=0;y<t.length;++y)if(!(!sn(t[y])&&!Ar(t[y]))){if(y<t.length-1&&!(Xo(t[y])||Jo(t[y])||ct(t[y])))throw new Qo(`streams[${y}]`,n[y],"must be readable");if(y>0&&!(zo(t[y])||Zo(t[y])||ct(t[y])))throw new Qo(`streams[${y}]`,n[y],"must be writable")}let r,o,s,l,h;function b(y){const p=l;l=null,p?p(y):y?h.destroy(y):!A&&!R&&h.destroy()}const f=t[0],c=fb(t,b),R=!!(zo(f)||Zo(f)||ct(f)),A=!!(Xo(c)||Jo(c)||ct(c));if(h=new an({writableObjectMode:!!(f!=null&&f.writableObjectMode),readableObjectMode:!!(c!=null&&c.writableObjectMode),writable:R,readable:A}),R){if(sn(f))h._write=function(p,P,$){f.write(p,P)?$():r=$},h._final=function(p){f.end(),o=p},f.on("drain",function(){if(r){const p=r;r=null,p()}});else if(Ar(f)){const P=(ct(f)?f.writable:f).getWriter();h._write=async function($,I,_){try{await P.ready,P.write($).catch(()=>{}),_()}catch(L){_(L)}},h._final=async function($){try{await P.ready,P.close().catch(()=>{}),o=$}catch(I){$(I)}}}const y=ct(c)?c.readable:c;pb(y,()=>{if(o){const p=o;o=null,p()}})}if(A){if(sn(c))c.on("readable",function(){if(s){const y=s;s=null,y()}}),c.on("end",function(){h.push(null)}),h._read=function(){for(;;){const y=c.read();if(y===null){s=h._read;return}if(!h.push(y))return}};else if(Ar(c)){const p=(ct(c)?c.readable:c).getReader();h._read=async function(){for(;;)try{const{value:P,done:$}=await p.read();if(!h.push(P))return;if($){h.push(null);return}}catch{return}}}}return h._destroy=function(y,p){!y&&l!==null&&(y=new hb),s=null,r=null,o=null,l===null?p(y):(l=p,sn(c)&&cb(c,y))},h};const Fs=globalThis.AbortController||Mt().AbortController,{codes:{ERR_INVALID_ARG_VALUE:gb,ERR_INVALID_ARG_TYPE:zt,ERR_MISSING_ARGS:yb,ERR_OUT_OF_RANGE:_b},AbortError:je}=Ee,{validateAbortSignal:At,validateInteger:wb,validateObject:Tt}=On,Sb=de.Symbol("kWeak"),{finished:mb}=it,Eb=Bs,{addAbortSignalNoValidate:Rb}=Fn,{isWritable:Ab,isNodeStream:Tb}=Qe,{ArrayPrototypePush:Ib,MathFloor:Nb,Number:vb,NumberIsNaN:Cb,Promise:ea,PromiseReject:ta,PromisePrototypeThen:$b,Symbol:js}=de,yn=js("kEmpty"),na=js("kEof");function Mb(e,t){if(t!=null&&Tt(t,"options"),(t==null?void 0:t.signal)!=null&&At(t.signal,"options.signal"),Tb(e)&&!Ab(e))throw new gb("stream",e,"must be writable");const n=Eb(this,e);return t!=null&&t.signal&&Rb(t.signal,n),n}function Hn(e,t){if(typeof e!="function")throw new zt("fn",["Function","AsyncFunction"],e);t!=null&&Tt(t,"options"),(t==null?void 0:t.signal)!=null&&At(t.signal,"options.signal");let n=1;return(t==null?void 0:t.concurrency)!=null&&(n=Nb(t.concurrency)),wb(n,"concurrency",1),(async function*(){var o,s;const l=new Fs,h=this,b=[],f=l.signal,c={signal:f},R=()=>l.abort();t!=null&&(o=t.signal)!==null&&o!==void 0&&o.aborted&&R(),t==null||(s=t.signal)===null||s===void 0||s.addEventListener("abort",R);let A,y,p=!1;function P(){p=!0}async function $(){try{for await(let L of h){var I;if(p)return;if(f.aborted)throw new je;try{L=e(L,c)}catch(F){L=ta(F)}L!==yn&&(typeof((I=L)===null||I===void 0?void 0:I.catch)=="function"&&L.catch(P),b.push(L),A&&(A(),A=null),!p&&b.length&&b.length>=n&&await new ea(F=>{y=F}))}b.push(na)}catch(L){const F=ta(L);$b(F,void 0,P),b.push(F)}finally{var _;p=!0,A&&(A(),A=null),t==null||(_=t.signal)===null||_===void 0||_.removeEventListener("abort",R)}}$();try{for(;;){for(;b.length>0;){const I=await b[0];if(I===na)return;if(f.aborted)throw new je;I!==yn&&(yield I),b.shift(),y&&(y(),y=null)}await new ea(I=>{A=I})}}finally{l.abort(),p=!0,y&&(y(),y=null)}}).call(this)}function Db(e=void 0){return e!=null&&Tt(e,"options"),(e==null?void 0:e.signal)!=null&&At(e.signal,"options.signal"),(async function*(){let n=0;for await(const o of this){var r;if(e!=null&&(r=e.signal)!==null&&r!==void 0&&r.aborted)throw new je({cause:e.signal.reason});yield[n++,o]}}).call(this)}async function Hs(e,t=void 0){for await(const n of Si.call(this,e,t))return!0;return!1}async function Pb(e,t=void 0){if(typeof e!="function")throw new zt("fn",["Function","AsyncFunction"],e);return!await Hs.call(this,async(...n)=>!await e(...n),t)}async function Ob(e,t){for await(const n of Si.call(this,e,t))return n}async function Lb(e,t){if(typeof e!="function")throw new zt("fn",["Function","AsyncFunction"],e);async function n(r,o){return await e(r,o),yn}for await(const r of Hn.call(this,n,t));}function Si(e,t){if(typeof e!="function")throw new zt("fn",["Function","AsyncFunction"],e);async function n(r,o){return await e(r,o)?r:yn}return Hn.call(this,n,t)}class kb extends yb{constructor(){super("reduce"),this.message="Reduce of an empty stream requires an initial value"}}async function xb(e,t,n){var r;if(typeof e!="function")throw new zt("reducer",["Function","AsyncFunction"],e);n!=null&&Tt(n,"options"),(n==null?void 0:n.signal)!=null&&At(n.signal,"options.signal");let o=arguments.length>1;if(n!=null&&(r=n.signal)!==null&&r!==void 0&&r.aborted){const f=new je(void 0,{cause:n.signal.reason});throw this.once("error",()=>{}),await mb(this.destroy(f)),f}const s=new Fs,l=s.signal;if(n!=null&&n.signal){const f={once:!0,[Sb]:this};n.signal.addEventListener("abort",()=>s.abort(),f)}let h=!1;try{for await(const f of this){var b;if(h=!0,n!=null&&(b=n.signal)!==null&&b!==void 0&&b.aborted)throw new je;o?t=await e(t,f,{signal:l}):(t=f,o=!0)}if(!h&&!o)throw new kb}finally{s.abort()}return t}async function Wb(e){e!=null&&Tt(e,"options"),(e==null?void 0:e.signal)!=null&&At(e.signal,"options.signal");const t=[];for await(const r of this){var n;if(e!=null&&(n=e.signal)!==null&&n!==void 0&&n.aborted)throw new je(void 0,{cause:e.signal.reason});Ib(t,r)}return t}function Ub(e,t){const n=Hn.call(this,e,t);return(async function*(){for await(const o of n)yield*o}).call(this)}function Vs(e){if(e=vb(e),Cb(e))return 0;if(e<0)throw new _b("number",">= 0",e);return e}function Bb(e,t=void 0){return t!=null&&Tt(t,"options"),(t==null?void 0:t.signal)!=null&&At(t.signal,"options.signal"),e=Vs(e),(async function*(){var r;if(t!=null&&(r=t.signal)!==null&&r!==void 0&&r.aborted)throw new je;for await(const s of this){var o;if(t!=null&&(o=t.signal)!==null&&o!==void 0&&o.aborted)throw new je;e--<=0&&(yield s)}}).call(this)}function Fb(e,t=void 0){return t!=null&&Tt(t,"options"),(t==null?void 0:t.signal)!=null&&At(t.signal,"options.signal"),e=Vs(e),(async function*(){var r;if(t!=null&&(r=t.signal)!==null&&r!==void 0&&r.aborted)throw new je;for await(const s of this){var o;if(t!=null&&(o=t.signal)!==null&&o!==void 0&&o.aborted)throw new je;if(e-- >0)yield s;else return}}).call(this)}di.streamReturningOperators={asIndexedPairs:Db,drop:Bb,filter:Si,flatMap:Ub,map:Hn,take:Fb,compose:Mb};di.promiseReturningOperators={every:Pb,forEach:Lb,reduce:xb,toArray:Wb,some:Hs,find:Ob};var Tr,ra;function Gs(){if(ra)return Tr;ra=1;const{ArrayPrototypePop:e,Promise:t}=de,{isIterable:n,isNodeStream:r,isWebStream:o}=Qe,{pipelineImpl:s}=wi,{finished:l}=it;Ks();function h(...b){return new t((f,c)=>{let R,A;const y=b[b.length-1];if(y&&typeof y=="object"&&!r(y)&&!n(y)&&!o(y)){const p=e(b);R=p.signal,A=p.end}s(b,(p,P)=>{p?c(p):f(P)},{signal:R,end:A})})}return Tr={finished:l,pipeline:h},Tr}var ia;function Ks(){if(ia)return dr.exports;ia=1;const{Buffer:e}=we,{ObjectDefineProperty:t,ObjectKeys:n,ReflectApply:r}=de,{promisify:{custom:o}}=Je,{streamReturningOperators:s,promiseReturningOperators:l}=di,{codes:{ERR_ILLEGAL_CONSTRUCTOR:h}}=Ee,b=Bs,{pipeline:f}=wi,{destroyer:c}=Lt,R=it,A=Gs(),y=Qe,p=dr.exports=pi.Stream;p.isDisturbed=y.isDisturbed,p.isErrored=y.isErrored,p.isReadable=y.isReadable,p.Readable=jn();for(const $ of n(s)){let _=function(...L){if(new.target)throw h();return p.Readable.from(r(I,this,L))};const I=s[$];t(_,"name",{__proto__:null,value:I.name}),t(_,"length",{__proto__:null,value:I.length}),t(p.Readable.prototype,$,{__proto__:null,value:_,enumerable:!1,configurable:!0,writable:!0})}for(const $ of n(l)){let _=function(...L){if(new.target)throw h();return r(I,this,L)};const I=l[$];t(_,"name",{__proto__:null,value:I.name}),t(_,"length",{__proto__:null,value:I.length}),t(p.Readable.prototype,$,{__proto__:null,value:_,enumerable:!1,configurable:!0,writable:!0})}p.Writable=Os(),p.Duplex=Ye(),p.Transform=ks,p.PassThrough=Ws,p.pipeline=f;const{addAbortSignal:P}=Fn;return p.addAbortSignal=P,p.finished=R,p.destroy=c,p.compose=b,t(p,"promises",{__proto__:null,configurable:!0,enumerable:!0,get(){return A}}),t(f,o,{__proto__:null,enumerable:!0,get(){return A.pipeline}}),t(R,o,{__proto__:null,enumerable:!0,get(){return A.finished}}),p.Stream=p,p._isUint8Array=function(I){return I instanceof Uint8Array},p._uint8ArrayToBuffer=function(I){return e.from(I.buffer,I.byteOffset,I.byteLength)},dr.exports}(function(e){const t=Ks(),n=Gs(),r=t.Readable.destroy;e.exports=t.Readable,e.exports._uint8ArrayToBuffer=t._uint8ArrayToBuffer,e.exports._isUint8Array=t._isUint8Array,e.exports.isDisturbed=t.isDisturbed,e.exports.isErrored=t.isErrored,e.exports.isReadable=t.isReadable,e.exports.Readable=t.Readable,e.exports.Writable=t.Writable,e.exports.Duplex=t.Duplex,e.exports.Transform=t.Transform,e.exports.PassThrough=t.PassThrough,e.exports.addAbortSignal=t.addAbortSignal,e.exports.finished=t.finished,e.exports.destroy=t.destroy,e.exports.destroy=r,e.exports.pipeline=t.pipeline,e.exports.compose=t.compose,Object.defineProperty(t,"promises",{configurable:!0,enumerable:!0,get(){return n}}),e.exports.Stream=t.Stream,e.exports.default=e.exports})(Uf);function oa(e){let t=!1,n=0,r;try{r=window[e],t=!0,n=r.length;const o="__storage_test__";return r.setItem(o,o),r.removeItem(o),!0}catch(o){const s=o;return s&&(s.code===22||s.code===1014||s.name==="QuotaExceededError"||s.name==="NS_ERROR_DOM_QUOTA_REACHED")&&t&&n!==0}}class jb{constructor(){M(this,"store",{})}getItem(t){return this.store[t]||null}setItem(t,n){this.store[t]=n}}class Hb{constructor(t,n){M(this,"storage",void 0),M(this,"_storeKey",void 0),this.storage=n,this._storeKey=t;try{n.getItem(t)||this.resetStore()}catch{}}static getInstance(t){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"local";if(!this.instance){let r;n==="local"&&oa("localStorage")?r=window.localStorage:n==="session"&&oa("sessionStorage")?r=window.sessionStorage:r=new jb,this.instance=new this(t,r)}return this.instance}toJSON(){return this.storage.getItem(this._storeKey)}resetStore(){const t=this.getStore();return this.storage.setItem(this._storeKey,JSON.stringify({})),t}getStore(){return JSON.parse(this.storage.getItem(this._storeKey)||"{}")}get(t){return JSON.parse(this.storage.getItem(this._storeKey)||"{}")[t]}set(t,n){const r=JSON.parse(this.storage.getItem(this._storeKey)||"{}");r[t]=n,this.storage.setItem(this._storeKey,JSON.stringify(r))}}M(Hb,"instance",void 0);J(J({},zs),Zs);const Vb=wn.getLogger("http-helpers");Vb.setLevel(aa.levels.INFO);class Gb extends Error{}Gb.prototype.name="InvalidTokenError";const Kb={EIP155:"eip155",SOLANA:"solana",OTHER:"other"},qb={EIP155:"eip155",SOLANA:"solana",XRPL:"xrpl",MULTICHAIN:"multichain"};class Zt extends Js{constructor(t,n){super(n),M(this,"code",void 0),M(this,"message",void 0),this.code=t,this.message=n||"",Object.defineProperty(this,"name",{value:"Web3AuthError"})}toJSON(){return{name:this.name,code:this.code,message:this.message}}toString(){return JSON.stringify(this.toJSON())}}class ie extends Zt{constructor(t,n){super(t,n),Object.defineProperty(this,"name",{value:"WalletInitializationError"})}static fromCode(t){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";return new ie(t,`${ie.messages[t]}, ${n}`)}static notFound(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return ie.fromCode(5001,t)}static notInstalled(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return ie.fromCode(5002,t)}static notReady(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return ie.fromCode(5003,t)}static windowBlocked(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return ie.fromCode(5004,t)}static windowClosed(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return ie.fromCode(5005,t)}static incompatibleChainNameSpace(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return ie.fromCode(5006,t)}static duplicateAdapterError(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return ie.fromCode(5007,t)}static invalidProviderConfigError(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return ie.fromCode(5008,t)}static providerNotReadyError(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return ie.fromCode(5009,t)}static rpcConnectionError(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return ie.fromCode(5010,t)}static invalidParams(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return ie.fromCode(5011,t)}static invalidNetwork(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return ie.fromCode(5013,t)}}M(ie,"messages",{5e3:"Custom",5001:"Wallet is not found",5002:"Wallet is not installed",5003:"Wallet is not ready yet",5004:"Wallet window is blocked",5005:"Wallet window has been closed by the user",5006:"Incompatible chain namespace provided",5007:"Adapter has already been included",5008:"Invalid provider Config",5009:"Provider is not ready yet",5010:"Failed to connect with rpc url",5011:"Invalid params passed in",5013:"Invalid network provided"});class ge extends Zt{constructor(t,n){super(t,n),Object.defineProperty(this,"name",{value:"WalletLoginError"})}static fromCode(t){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";return new ge(t,`${ge.messages[t]}. ${n}`)}static connectionError(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return ge.fromCode(5111,t)}static disconnectionError(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return ge.fromCode(5112,t)}static notConnectedError(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return ge.fromCode(5113,t)}static popupClosed(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return ge.fromCode(5114,t)}static mfaEnabled(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return ge.fromCode(5115,t)}static chainConfigNotAdded(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return ge.fromCode(5116,t)}static unsupportedOperation(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return ge.fromCode(5117,t)}static coreKitKeyNotFound(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return ge.fromCode(5118,t)}static userNotLoggedIn(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return ge.fromCode(5119,t)}}M(ge,"messages",{5e3:"Custom",5111:"Failed to connect with wallet",5112:"Failed to disconnect from wallet",5113:"Wallet is not connected",5114:"Wallet popup has been closed by the user",5115:"User has already enabled mfa, please use the @web3auth/web3auth-web sdk for login with mfa",5116:"Chain config has not been added. Please add the chain config before calling switchChain",5117:"Unsupported operation",5118:"useCoreKitKey flag is enabled but coreKitKey is not available",5119:"User not logged in."});class ke extends Zt{constructor(t,n){super(t,n),Object.defineProperty(this,"name",{value:"WalletOperationsError"})}static fromCode(t){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";return new ke(t,`${ke.messages[t]}, ${n}`)}static chainIDNotAllowed(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return ke.fromCode(5201,t)}static operationNotAllowed(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return ke.fromCode(5202,t)}static chainNamespaceNotAllowed(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return ke.fromCode(5203,t)}}M(ke,"messages",{5e3:"Custom",5201:"Provided chainId is not allowed",5202:"This operation is not allowed"});class mi extends Zt{constructor(t,n){super(t,n),Object.defineProperty(this,"name",{value:"WalletProviderError"})}static fromCode(t){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";return new ke(t,`${mi.messages[t]}, ${n}`)}static invalidRequestArgs(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return ke.fromCode(5301,t)}static invalidRequestMethod(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return ke.fromCode(5302,t)}static invalidRequestParams(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return ke.fromCode(5303,t)}}M(mi,"messages",{5e3:"Custom",5301:"Expected a single, non-array, object argument.",5302:"'args.method' must be a non-empty string.",5303:"'args.params' must be an object or array if provided."});const _n={OPENLOGIN:"openlogin",WALLET_CONNECT_V2:"wallet-connect-v2"},Gt=J({TORUS_SOLANA:"torus-solana",PHANTOM:"phantom",SOLFLARE:"solflare",SLOPE:"slope"},_n),fn=J({TORUS_EVM:"torus-evm",METAMASK:"metamask",COINBASE:"coinbase"},_n),ln=J(J({},fn),Gt);_n.OPENLOGIN+"",_n.WALLET_CONNECT_V2+"",Gt.TORUS_SOLANA+"",Gt.PHANTOM+"",Gt.SOLFLARE+"",Gt.SLOPE+"",fn.TORUS_EVM+"",fn.METAMASK+"",fn.COINBASE+"";const Yb={EXTERNAL:"external",IN_APP:"in_app"},Ne={NOT_READY:"not_ready",READY:"ready",CONNECTING:"connecting",CONNECTED:"connected",DISCONNECTED:"disconnected",ERRORED:"errored"},Ir=J(J({},Ne),{},{ADAPTER_DATA_UPDATED:"adapter_data_updated",CACHE_CLEAR:"cache_clear"});var Nr=wn.getLogger("web3auth-logger");class rp extends el{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};super(t),M(this,"name",ln.TORUS_EVM),M(this,"adapterNamespace",qb.EIP155),M(this,"currentChainNamespace",Kb.EIP155),M(this,"type",Yb.EXTERNAL),M(this,"status",Ne.NOT_READY),M(this,"torusInstance",null),M(this,"torusWalletOptions",void 0),M(this,"initParams",void 0),M(this,"loginSettings",{}),this.torusWalletOptions=t.adapterSettings||{},this.initParams=t.initParams||{},this.loginSettings=t.loginSettings||{}}get provider(){return this.status!==Ne.NOT_READY&&this.torusInstance?this.torusInstance.provider:null}set provider(t){throw new Error("Not implemented")}async init(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};await super.init(t),super.checkInitializationRequirements();const{chainId:n,blockExplorer:r,displayName:o,rpcTarget:s,ticker:l,tickerName:h}=this.chainConfig,b={chainId:Number.parseInt(n,16),host:s,blockExplorer:r,networkName:o,ticker:l,tickerName:h};this.torusInstance=new Wf(this.torusWalletOptions),Nr.debug("initializing torus evm adapter init"),await this.torusInstance.init(J(J({showTorusButton:!1},this.initParams),{},{network:b})),this.status=Ne.READY,this.emit(Ir.READY,ln.TORUS_EVM);try{Nr.debug("initializing torus evm adapter"),t.autoConnect&&(this.rehydrated=!0,await this.connect())}catch(f){Nr.error("Failed to connect with torus evm provider",f),this.emit(Ir.ERRORED,f)}}async connect(){if(super.checkConnectionRequirements(),!this.torusInstance)throw ie.notReady("Torus wallet is not initialized");this.status=Ne.CONNECTING,this.emit(Ir.CONNECTING,{adapter:ln.TORUS_EVM});try{await this.torusInstance.login(this.loginSettings);const t=await this.torusInstance.provider.request({method:"eth_chainId"});if(t&&parseInt(t)!==parseInt(this.chainConfig.chainId,16)){const{chainId:n,blockExplorer:r,displayName:o,rpcTarget:s,ticker:l,tickerName:h}=this.chainConfig,b={chainId:Number.parseInt(n,16),host:s,blockExplorer:r,networkName:o,tickerName:h,ticker:l};await this.torusInstance.setProvider(J({},b));const f=await this.torusInstance.ethereum.request({method:"eth_chainId"});if(f&&parseInt(f)!==parseInt(this.chainConfig.chainId,16))throw ie.fromCode(5e3,`Not connected to correct chainId. Expected: ${this.chainConfig.chainId}, Current: ${f}`)}return this.status=Ne.CONNECTED,this.torusInstance.showTorusButton(),this.emit(Ne.CONNECTED,{adapter:ln.TORUS_EVM,reconnected:this.rehydrated}),this.provider}catch(t){throw this.status=Ne.READY,this.rehydrated=!1,this.emit(Ne.ERRORED,t),t instanceof Zt?t:ge.connectionError("Failed to login with torus wallet")}}async disconnect(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{cleanup:!1};if(await super.disconnectSession(),!this.torusInstance)throw ie.notReady("Torus wallet is not initialized");await this.torusInstance.logout(),this.torusInstance.hideTorusButton(),t.cleanup?(this.status=Ne.NOT_READY,this.torusInstance=null):this.status=Ne.READY,await super.disconnect()}async getUserInfo(){if(this.status!==Ne.CONNECTED)throw ge.notConnectedError("Not connected with wallet");if(!this.torusInstance)throw ie.notReady("Torus wallet is not initialized");return await this.torusInstance.getUserInfo("")}async addChain(t){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;super.checkAddChainRequirements(t,n),this.addChainConfig(t)}async switchChain(t){var n;let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;super.checkSwitchChainRequirements(t,r);const o=this.getChainConfig(t.chainId);await((n=this.torusInstance)===null||n===void 0?void 0:n.setProvider({host:o.rpcTarget,chainId:parseInt(o.chainId,16),networkName:o.displayName,blockExplorer:o.blockExplorer,ticker:o.ticker,tickerName:o.tickerName})),this.setAdapterSettings({chainConfig:this.getChainConfig(t.chainId)})}}export{rp as TorusWalletAdapter};
