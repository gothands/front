(self["webpackChunkHandsy_io"]=self["webpackChunkHandsy_io"]||[]).push([[598],{76598:(e,t,n)=>{"use strict";n.d(t,{OpenloginAdapter:()=>ni,getOpenloginDefaultOptions:()=>ti});var r={};n.r(r),n.d(r,{Decoder:()=>Xn,Encoder:()=>Jn,PacketType:()=>Yn,protocol:()=>Gn});n(21057),n(76801),n(48324);var i=n(94956),o=n(2160),s=n.n(o),a=n(95082),l=n(50815);const c=s();function d(e){return c.encode(e)}function h(e){return c.decode(e)}function u(e){return c.encode(JSON.stringify(e))}function f(e){let t,n=!1,r=0;try{t=window[e],n=!0,r=t.length;const i="__storage_test__";return t.setItem(i,i),t.removeItem(i),!0}catch(i){const e=i;return e&&(22===e.code||1014===e.code||"QuotaExceededError"===e.name||"NS_ERROR_DOM_QUOTA_REACHED"===e.name)&&n&&0!==r}}class p{constructor(){(0,i.Z)(this,"store",{})}getItem(e){return this.store[e]||null}setItem(e,t){this.store[e]=t}}class g{constructor(e,t){(0,i.Z)(this,"storage",void 0),(0,i.Z)(this,"_storeKey",void 0),this.storage=t,this._storeKey=e;try{t.getItem(e)||this.resetStore()}catch(n){}}static getInstance(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"local";if(!this.instance){let n;n="local"===t&&f("localStorage")?window.localStorage:"session"===t&&f("sessionStorage")?window.sessionStorage:new p,this.instance=new this(e,n)}return this.instance}toJSON(){return this.storage.getItem(this._storeKey)}resetStore(){const e=this.getStore();return this.storage.setItem(this._storeKey,JSON.stringify({})),e}getStore(){return JSON.parse(this.storage.getItem(this._storeKey)||"{}")}get(e){const t=JSON.parse(this.storage.getItem(this._storeKey)||"{}");return t[e]}set(e,t){const n=JSON.parse(this.storage.getItem(this._storeKey)||"{}");n[e]=t,this.storage.setItem(this._storeKey,JSON.stringify(n))}}(0,i.Z)(g,"instance",void 0);const y={POPUP:"popup",REDIRECT:"redirect"},b=(0,a.Z)((0,a.Z)({},l.X_),l.Ad),m={SECP256K1:"secp256k1",ED25519:"ed25519"},w={GOOGLE:"google",FACEBOOK:"facebook",REDDIT:"reddit",DISCORD:"discord",TWITCH:"twitch",APPLE:"apple",LINE:"line",GITHUB:"github",KAKAO:"kakao",LINKEDIN:"linkedin",TWITTER:"twitter",WEIBO:"weibo",WECHAT:"wechat",EMAIL_PASSWORDLESS:"email_passwordless",SMS_PASSWORDLESS:"sms_passwordless",WEBAUTHN:"webauthn",JWT:"jwt"},v={LOGIN:"login",ENABLE_MFA:"enable_mfa",MODIFY_MFA:"modify_mfa"},_={PRODUCTION:"production",DEVELOPMENT:"development",STAGING:"staging",TESTING:"testing"};n(19979),n(98858),n(61318),n(33228),n(64043),n(57267);var E=n(17228),S=n(89245),R=n.n(S),A=(n(70560),n(73148)),k=n.n(A);const N=R().getLogger("http-helpers");N.setLevel(S.levels.INFO);let T="torus-default",C="";const I="x-api-key",O="x-embed-host";let P=null;const x=[],L=[];async function D(e,t){let n=null;try{n=new URL(e)}catch(r){}if(P&&n&&(x.includes(n.origin)||L.includes(n.pathname))){const n=P.startTransaction({name:e}),r=n.startChild({op:"http"}),i=await fetch(e,t);return r.finish(),n.finish(),i}return fetch(e,t)}function M(){const e={};return T&&(e[I]=T),C&&(e[O]=C),e}function B(e){N.info(`Response: ${e.status} ${e.statusText}`),N.info(`Url: ${e.url}`)}function U(e){N.info(`Request tracing with traceID=${e.headers.get("x-web3-correlation-id")}`)}const j=(e,t)=>{const n=new Promise(((t,n)=>{const r=setTimeout((()=>{clearTimeout(r),n(new Error(`Timed out in ${e}ms`))}),e)}));return Promise.race([t,n])},K=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r={mode:"cors",headers:{}};n.useAPIKey&&(r.headers=(0,a.Z)((0,a.Z)({},r.headers),M()));const i=k()(r,t,{method:"GET"}),o=await D(e,i);if(o.ok){const e=o.headers.get("content-type");return null!==e&&void 0!==e&&e.includes("application/json")?o.json():o.text()}throw B(o),o},W=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const i={mode:"cors",headers:{"Content-Type":"application/json; charset=utf-8"}};r.useAPIKey&&(i.headers=(0,a.Z)((0,a.Z)({},i.headers),M()));const o=k()(i,n,{method:"POST"});return r.isUrlEncodedData?(o.body=t,"application/json; charset=utf-8"===o.headers["Content-Type"]&&delete o.headers["Content-Type"]):o.body=JSON.stringify(t),j(r.timeout||6e4,D(e,o).then((e=>{if(r.logTracingHeader&&U(e),e.ok){const t=e.headers.get("content-type");return null!==t&&void 0!==t&&t.includes("application/json")?e.json():e.text()}throw B(e),e})))},F=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const i={mode:"cors",headers:{"Content-Type":"application/json; charset=utf-8"}};r.useAPIKey&&(i.headers=(0,a.Z)((0,a.Z)({},i.headers),M()));const o=k()(i,n,{method:"PATCH"});r.isUrlEncodedData?(o.body=t,"application/json; charset=utf-8"===o.headers["Content-Type"]&&delete o.headers["Content-Type"]):o.body=JSON.stringify(t);const s=await D(e,o);if(s.ok){const e=s.headers.get("content-type");return null!==e&&void 0!==e&&e.includes("application/json")?s.json():s.text()}throw B(s),s},$=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const i={mode:"cors",headers:{"Content-Type":"application/json; charset=utf-8"}};r.useAPIKey&&(i.headers=(0,a.Z)((0,a.Z)({},i.headers),M()));const o=k()(i,n,{method:"PUT"});r.isUrlEncodedData?(o.body=t,"application/json; charset=utf-8"===o.headers["Content-Type"]&&delete o.headers["Content-Type"]):o.body=JSON.stringify(t);const s=await D(e,o);if(s.ok){const e=s.headers.get("content-type");return null!==e&&void 0!==e&&e.includes("application/json")?s.json():s.text()}throw B(s),s};class q{constructor(){(0,i.Z)(this,"sessionId",void 0)}checkSessionParams(){if(!this.sessionId)throw new Error("Session id is required");this.sessionId=this.sessionId.padStart(64,"0")}request(e){let{method:t="GET",url:n,data:r={},headers:i={}}=e;const o={headers:i};switch(t){case"GET":return K(n,o);case"POST":return W(n,r,o);case"PUT":return $(n,r,o);case"PATCH":return F(n,r,o)}throw new Error("Invalid method type")}}n(95194),n(79943),n(20522),n(82),n(79976),n(93356),n(24224),n(61121),n(37133);var Z=n(59821),H=n(32127),V=n(15361)["Buffer"];const G=new H.ec("secp256k1"),Y=n.g.crypto||n.g.msCrypto||{},J=Y.subtle||Y.webkitSubtle,z=V.from("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141","hex"),X=V.alloc(32,0);function Q(e,t){if(!e)throw new Error(t||"Assertion failed")}function ee(e){return V.isBuffer(e)&&32===e.length}function te(e){return!!ee(e)&&(e.compare(X)>0&&e.compare(z)<0)}function ne(e){const t=new Uint8Array(e);return"undefined"===typeof Y.getRandomValues?V.from(Z.randomBytes(e)):(Y.getRandomValues(t),V.from(t))}function re(e){return async function(t,n,r){if(J){const i={name:"AES-CBC"},o=await J.importKey("raw",n,i,!1,[e]),s={name:"AES-CBC",iv:t},a=await J[e](s,o,r);return V.from(new Uint8Array(a))}if("encrypt"===e){const e=Z.createCipheriv("aes-256-cbc",n,t),i=e.update(r),o=e.final();return V.concat([i,o])}if("decrypt"===e){const e=Z.createDecipheriv("aes-256-cbc",n,t),i=e.update(r),o=e.final();return V.concat([i,o])}throw new Error(`Unsupported operation: ${e}`)}}re("encrypt"),re("decrypt");const ie=function(){let e=ne(32);while(!te(e))e=ne(32);return e},oe=function(e){return Q(32===e.length,"Bad private key"),Q(te(e),"Bad private key"),V.from(G.keyFromPrivate(e).getPublic("array"))},se=async function(e,t){return Q(32===e.length,"Bad private key"),Q(te(e),"Bad private key"),Q(t.length>0,"Message should not be empty"),Q(t.length<=32,"Message is too long"),V.from(G.sign(t,e,{canonical:!0}).toDER())},ae=R().getLogger("http-helpers");ae.setLevel(S.levels.INFO);n(40391);var le=n(76186),ce=n(15361)["Buffer"];const de=new H.ec("secp256k1"),he=n.g.crypto||n.g.msCrypto||{},ue=he.subtle||he.webkitSubtle,fe=ce.from("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141","hex"),pe=ce.alloc(32,0);function ge(e,t){if(!e)throw new Error(t||"Assertion failed")}function ye(e){return ce.isBuffer(e)&&32===e.length}function be(e){return!!ye(e)&&(e.compare(pe)>0&&e.compare(fe)<0)}function me(e,t){if(e.length!==t.length)return!1;let n=0;for(let r=0;r<e.length;r++)n|=e[r]^t[r];return 0===n}function we(e){const t=new Uint8Array(e);return"undefined"===typeof he.getRandomValues?ce.from(Z.randomBytes(e)):(he.getRandomValues(t),ce.from(t))}async function ve(e){if(ue){const t=await ue.digest("SHA-512",e),n=new Uint8Array(t);return n}const t=Z.createHash("sha512"),n=t.update(e).digest();return new Uint8Array(n)}function _e(e){return async function(t,n,r){if(ue){const i={name:"AES-CBC"},o=await ue.importKey("raw",n,i,!1,[e]),s={name:"AES-CBC",iv:t},a=await ue[e](s,o,r);return ce.from(new Uint8Array(a))}if("encrypt"===e){const e=Z.createCipheriv("aes-256-cbc",n,t),i=e.update(r),o=e.final();return ce.concat([i,o])}if("decrypt"===e){const e=Z.createDecipheriv("aes-256-cbc",n,t),i=e.update(r),o=e.final();return ce.concat([i,o])}throw new Error(`Unsupported operation: ${e}`)}}const Ee=_e("encrypt"),Se=_e("decrypt");async function Re(e,t){if(ue){const n={name:"HMAC",hash:{name:"SHA-256"}},r=await ue.importKey("raw",new Uint8Array(e),n,!1,["sign","verify"]),i=await ue.sign("HMAC",r,t),o=ce.from(new Uint8Array(i));return o}const n=Z.createHmac("sha256",ce.from(e));n.update(t);const r=n.digest();return r}async function Ae(e,t,n){const r=await Re(e,t);return me(r,n)}const ke=function(e){return ge(32===e.length,"Bad private key"),ge(be(e),"Bad private key"),ce.from(de.keyFromPrivate(e).getPublic("array"))},Ne=async function(e,t){ge(ce.isBuffer(e),"Bad private key"),ge(ce.isBuffer(t),"Bad public key"),ge(32===e.length,"Bad private key"),ge(be(e),"Bad private key"),ge(65===t.length||33===t.length,"Bad public key"),65===t.length&&ge(4===t[0],"Bad public key"),33===t.length&&ge(2===t[0]||3===t[0],"Bad public key");const n=de.keyFromPrivate(e),r=de.keyFromPublic(t),i=n.derive(r.getPublic());return ce.from(i.toArray())},Te=Ne,Ce=async function(e,t){ge(ce.isBuffer(e),"Bad private key"),ge(ce.isBuffer(t),"Bad public key"),ge(32===e.length,"Bad private key"),ge(be(e),"Bad private key"),ge(65===t.length||33===t.length,"Bad public key"),65===t.length&&ge(4===t[0],"Bad public key"),33===t.length&&ge(2===t[0]||3===t[0],"Bad public key");const n=de.keyFromPrivate(e),r=de.keyFromPublic(t),i=n.derive(r.getPublic());return ce.from(i.toString(16,64),"hex")},Ie=async function(e,t,n){n=n||{};let r=n.ephemPrivateKey||we(32);while(!be(r))r=n.ephemPrivateKey||we(32);const i=ke(r),o=await Te(r,e),s=await ve(o),a=n.iv||we(16),l=s.slice(0,32),c=s.slice(32),d=await Ee(a,ce.from(l),t),h=d,u=ce.concat([a,i,h]),f=await Re(ce.from(c),u);return{iv:a,ephemPublicKey:i,ciphertext:h,mac:f}},Oe=async function(e,t,n){const r=null!==n&&void 0!==n&&n,i=r?Ce:Te,o=await i(e,t.ephemPublicKey),s=await ve(o),a=s.slice(0,32),l=s.slice(32),c=ce.concat([t.iv,t.ephemPublicKey,t.ciphertext]),d=await Ae(ce.from(l),c,t.mac);if(!d&&!1===r)return Oe(e,t,!0);if(!d&&!0===r)throw new Error("bad MAC after trying padded");const h=await Se(t.iv,ce.from(a),t.ciphertext);return ce.from(new Uint8Array(h))};var Pe=n(15361)["Buffer"];function xe(e){return Pe.from((0,le.wn)(e))}const Le=new H.ec("secp256k1");function De(e){return{iv:Pe.from(e.iv,"hex"),ephemPublicKey:Pe.from(e.ephemPublicKey,"hex"),ciphertext:Pe.from(e.ciphertext,"hex"),mac:Pe.from(e.mac,"hex")}}function Me(e){return{iv:Pe.from(e.iv).toString("hex"),ephemPublicKey:Pe.from(e.ephemPublicKey).toString("hex"),ciphertext:Pe.from(e.ciphertext).toString("hex"),mac:Pe.from(e.mac).toString("hex")}}async function Be(e,t){const n=JSON.stringify(t),r=Pe.from(n,"utf-8"),i=await Ie(ke(Pe.from(e,"hex")),r),o=Me(i),s=JSON.stringify(o);return s}async function Ue(e,t){const n=JSON.parse(t),r=De(n),i=Le.keyFromPrivate(e),o=await Oe(Pe.from(i.getPrivate().toString("hex",64),"hex"),r),s=o.toString("utf-8"),a=JSON.parse(s);return a}var je=n(15361)["Buffer"];const Ke=86400;class We extends q{constructor(){let{sessionServerBaseUrl:e,sessionNamespace:t,sessionTime:n,sessionId:r}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(),(0,i.Z)(this,"sessionServerBaseUrl","https://broadcast-server.tor.us"),(0,i.Z)(this,"sessionNamespace",void 0),(0,i.Z)(this,"sessionTime",Ke),(0,i.Z)(this,"sessionId",""),e&&(this.sessionServerBaseUrl=e),t&&(this.sessionNamespace=t),n&&(this.sessionTime=n),r&&(this.sessionId=r.padStart(64,"0"))}static generateRandomSessionKey(){return ie().toString("hex").padStart(64,"0")}async createSession(e){super.checkSessionParams();const t=je.from(this.sessionId,"hex"),n=oe(t).toString("hex"),r=await Be(this.sessionId,e),i=(await se(t,xe(je.from(r,"utf8")))).toString("hex"),o={key:n,data:r,signature:i,namespace:this.sessionNamespace,timeout:this.sessionTime};return await super.request({method:"POST",url:`${this.sessionServerBaseUrl}/store/set`,data:o}),this.sessionId}async authorizeSession(){super.checkSessionParams();const e=oe(je.from(this.sessionId,"hex")).toString("hex"),t=new URL(`${this.sessionServerBaseUrl}/store/get`);t.searchParams.append("key",e),this.sessionNamespace&&t.searchParams.append("namespace",this.sessionNamespace);const n=await super.request({url:t.toString()});if(!n.message)throw new Error("Session Expired or Invalid public key");const r=await Ue(this.sessionId,n.message);if(r.error)throw new Error("There was an error decrypting data.");return r}async updateSession(e){super.checkSessionParams();const t=je.from(this.sessionId,"hex"),n=oe(t).toString("hex"),r=await Be(this.sessionId,e),i=(await se(t,xe(je.from(r,"utf8")))).toString("hex"),o={key:n,data:r,signature:i,namespace:this.sessionNamespace};await super.request({method:"PUT",url:`${this.sessionServerBaseUrl}/store/update`,data:o})}async invalidateSession(){super.checkSessionParams();const e=je.from(this.sessionId,"hex"),t=oe(e).toString("hex"),n=await Be(this.sessionId,{}),r=(await se(e,xe(je.from(n,"utf8")))).toString("hex"),i={key:t,data:n,signature:r,namespace:this.sessionNamespace,timeout:1};return await super.request({method:"POST",url:`${this.sessionServerBaseUrl}/store/set`,data:i}),this.sessionId="",!0}}var Fe=n(15361)["Buffer"];const $e=new H.ec("secp256k1"),qe=n.g.crypto||n.g.msCrypto||{},Ze=qe.subtle||qe.webkitSubtle,He=Fe.from("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141","hex"),Ve=Fe.alloc(32,0);function Ge(e,t){if(!e)throw new Error(t||"Assertion failed")}function Ye(e){return Fe.isBuffer(e)&&32===e.length}function Je(e){return!!Ye(e)&&(e.compare(Ve)>0&&e.compare(He)<0)}function ze(e){return async function(t,n,r){if(Ze){const i={name:"AES-CBC"},o=await Ze.importKey("raw",n,i,!1,[e]),s={name:"AES-CBC",iv:t},a=await Ze[e](s,o,r);return Fe.from(new Uint8Array(a))}if("encrypt"===e){const e=Z.createCipheriv("aes-256-cbc",n,t),i=e.update(r),o=e.final();return Fe.concat([i,o])}if("decrypt"===e){const e=Z.createDecipheriv("aes-256-cbc",n,t),i=e.update(r),o=e.final();return Fe.concat([i,o])}throw new Error(`Unsupported operation: ${e}`)}}ze("encrypt"),ze("decrypt");const Xe=function(e){return Ge(32===e.length,"Bad private key"),Ge(Je(e),"Bad private key"),Fe.from($e.keyFromPrivate(e).getPublic("array"))},Qe=async function(e,t){return Ge(32===e.length,"Bad private key"),Ge(Je(e),"Bad private key"),Ge(t.length>0,"Message should not be empty"),Ge(t.length<=32,"Message is too long"),Fe.from($e.sign(t,e,{canonical:!0}).toDER())},et=R().getLogger("http-helpers");et.setLevel(S.levels.INFO);let tt="torus-default",nt="";const rt="x-api-key",it="x-embed-host";let ot=null;const st=[],at=[];function lt(e){et.setLevel(e)}async function ct(e,t){let n=null;try{n=new URL(e)}catch(r){}if(ot&&n&&(st.includes(n.origin)||at.includes(n.pathname))){const n=ot.startTransaction({name:e}),r=n.startChild({op:"http"}),i=await fetch(e,t);return r.finish(),n.finish(),i}return fetch(e,t)}function dt(){const e={};return tt&&(e[rt]=tt),nt&&(e[it]=nt),e}function ht(e){et.info(`Response: ${e.status} ${e.statusText}`),et.info(`Url: ${e.url}`)}function ut(e){et.info(`Request tracing with traceID=${e.headers.get("x-web3-correlation-id")}`)}const ft=(e,t)=>{const n=new Promise(((t,n)=>{const r=setTimeout((()=>{clearTimeout(r),n(new Error(`Timed out in ${e}ms`))}),e)}));return Promise.race([t,n])},pt=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const i={mode:"cors",headers:{"Content-Type":"application/json; charset=utf-8"}};r.useAPIKey&&(i.headers=(0,a.Z)((0,a.Z)({},i.headers),dt()));const o=k()(i,n,{method:"POST"});return r.isUrlEncodedData?(o.body=t,"application/json; charset=utf-8"===o.headers["Content-Type"]&&delete o.headers["Content-Type"]):o.body=JSON.stringify(t),ft(r.timeout||6e4,ct(e,o).then((e=>{if(r.logTracingHeader&&ut(e),e.ok){const t=e.headers.get("content-type");return null!==t&&void 0!==t&&t.includes("application/json")?e.json():e.text()}throw ht(e),e})))};n(86544),n(278);const gt=Object.create(null);gt["open"]="0",gt["close"]="1",gt["ping"]="2",gt["pong"]="3",gt["message"]="4",gt["upgrade"]="5",gt["noop"]="6";const yt=Object.create(null);Object.keys(gt).forEach((e=>{yt[gt[e]]=e}));const bt={type:"error",data:"parser error"},mt="function"===typeof Blob||"undefined"!==typeof Blob&&"[object BlobConstructor]"===Object.prototype.toString.call(Blob),wt="function"===typeof ArrayBuffer,vt=e=>"function"===typeof ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer instanceof ArrayBuffer,_t=({type:e,data:t},n,r)=>mt&&t instanceof Blob?n?r(t):Et(t,r):wt&&(t instanceof ArrayBuffer||vt(t))?n?r(t):Et(new Blob([t]),r):r(gt[e]+(t||"")),Et=(e,t)=>{const n=new FileReader;return n.onload=function(){const e=n.result.split(",")[1];t("b"+(e||""))},n.readAsDataURL(e)};function St(e){return e instanceof Uint8Array?e:e instanceof ArrayBuffer?new Uint8Array(e):new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}let Rt;function At(e,t){return mt&&e.data instanceof Blob?e.data.arrayBuffer().then(St).then(t):wt&&(e.data instanceof ArrayBuffer||vt(e.data))?t(St(e.data)):void _t(e,!1,(e=>{Rt||(Rt=new TextEncoder),t(Rt.encode(e))}))}const kt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Nt="undefined"===typeof Uint8Array?[]:new Uint8Array(256);for(let ii=0;ii<kt.length;ii++)Nt[kt.charCodeAt(ii)]=ii;const Tt=e=>{let t,n,r,i,o,s=.75*e.length,a=e.length,l=0;"="===e[e.length-1]&&(s--,"="===e[e.length-2]&&s--);const c=new ArrayBuffer(s),d=new Uint8Array(c);for(t=0;t<a;t+=4)n=Nt[e.charCodeAt(t)],r=Nt[e.charCodeAt(t+1)],i=Nt[e.charCodeAt(t+2)],o=Nt[e.charCodeAt(t+3)],d[l++]=n<<2|r>>4,d[l++]=(15&r)<<4|i>>2,d[l++]=(3&i)<<6|63&o;return c},Ct="function"===typeof ArrayBuffer,It=(e,t)=>{if("string"!==typeof e)return{type:"message",data:Pt(e,t)};const n=e.charAt(0);if("b"===n)return{type:"message",data:Ot(e.substring(1),t)};const r=yt[n];return r?e.length>1?{type:yt[n],data:e.substring(1)}:{type:yt[n]}:bt},Ot=(e,t)=>{if(Ct){const n=Tt(e);return Pt(n,t)}return{base64:!0,data:e}},Pt=(e,t)=>{switch(t){case"blob":return e instanceof Blob?e:new Blob([e]);case"arraybuffer":default:return e instanceof ArrayBuffer?e:e.buffer}},xt=String.fromCharCode(30),Lt=(e,t)=>{const n=e.length,r=new Array(n);let i=0;e.forEach(((e,o)=>{_t(e,!1,(e=>{r[o]=e,++i===n&&t(r.join(xt))}))}))},Dt=(e,t)=>{const n=e.split(xt),r=[];for(let i=0;i<n.length;i++){const e=It(n[i],t);if(r.push(e),"error"===e.type)break}return r};function Mt(){return new TransformStream({transform(e,t){At(e,(n=>{const r=n.length;let i;if(r<126)i=new Uint8Array(1),new DataView(i.buffer).setUint8(0,r);else if(r<65536){i=new Uint8Array(3);const e=new DataView(i.buffer);e.setUint8(0,126),e.setUint16(1,r)}else{i=new Uint8Array(9);const e=new DataView(i.buffer);e.setUint8(0,127),e.setBigUint64(1,BigInt(r))}e.data&&"string"!==typeof e.data&&(i[0]|=128),t.enqueue(i),t.enqueue(n)}))}})}let Bt;function Ut(e){return e.reduce(((e,t)=>e+t.length),0)}function jt(e,t){if(e[0].length===t)return e.shift();const n=new Uint8Array(t);let r=0;for(let i=0;i<t;i++)n[i]=e[0][r++],r===e[0].length&&(e.shift(),r=0);return e.length&&r<e[0].length&&(e[0]=e[0].slice(r)),n}function Kt(e,t){Bt||(Bt=new TextDecoder);const n=[];let r=0,i=-1,o=!1;return new TransformStream({transform(s,a){n.push(s);while(1){if(0===r){if(Ut(n)<1)break;const e=jt(n,1);o=128===(128&e[0]),i=127&e[0],r=i<126?3:126===i?1:2}else if(1===r){if(Ut(n)<2)break;const e=jt(n,2);i=new DataView(e.buffer,e.byteOffset,e.length).getUint16(0),r=3}else if(2===r){if(Ut(n)<8)break;const e=jt(n,8),t=new DataView(e.buffer,e.byteOffset,e.length),o=t.getUint32(0);if(o>Math.pow(2,21)-1){a.enqueue(bt);break}i=o*Math.pow(2,32)+t.getUint32(4),r=3}else{if(Ut(n)<i)break;const e=jt(n,i);a.enqueue(It(o?e:Bt.decode(e),t)),r=0}if(0===i||i>e){a.enqueue(bt);break}}}})}const Wt=4;function Ft(e){if(e)return $t(e)}function $t(e){for(var t in Ft.prototype)e[t]=Ft.prototype[t];return e}Ft.prototype.on=Ft.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this},Ft.prototype.once=function(e,t){function n(){this.off(e,n),t.apply(this,arguments)}return n.fn=t,this.on(e,n),this},Ft.prototype.off=Ft.prototype.removeListener=Ft.prototype.removeAllListeners=Ft.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n,r=this._callbacks["$"+e];if(!r)return this;if(1==arguments.length)return delete this._callbacks["$"+e],this;for(var i=0;i<r.length;i++)if(n=r[i],n===t||n.fn===t){r.splice(i,1);break}return 0===r.length&&delete this._callbacks["$"+e],this},Ft.prototype.emit=function(e){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),n=this._callbacks["$"+e],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(n){n=n.slice(0);r=0;for(var i=n.length;r<i;++r)n[r].apply(this,t)}return this},Ft.prototype.emitReserved=Ft.prototype.emit,Ft.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]},Ft.prototype.hasListeners=function(e){return!!this.listeners(e).length};n(3650);const qt=(()=>"undefined"!==typeof self?self:"undefined"!==typeof window?window:Function("return this")())();function Zt(e,...t){return t.reduce(((t,n)=>(e.hasOwnProperty(n)&&(t[n]=e[n]),t)),{})}const Ht=qt.setTimeout,Vt=qt.clearTimeout;function Gt(e,t){t.useNativeTimers?(e.setTimeoutFn=Ht.bind(qt),e.clearTimeoutFn=Vt.bind(qt)):(e.setTimeoutFn=qt.setTimeout.bind(qt),e.clearTimeoutFn=qt.clearTimeout.bind(qt))}const Yt=1.33;function Jt(e){return"string"===typeof e?zt(e):Math.ceil((e.byteLength||e.size)*Yt)}function zt(e){let t=0,n=0;for(let r=0,i=e.length;r<i;r++)t=e.charCodeAt(r),t<128?n+=1:t<2048?n+=2:t<55296||t>=57344?n+=3:(r++,n+=4);return n}function Xt(e){let t="";for(let n in e)e.hasOwnProperty(n)&&(t.length&&(t+="&"),t+=encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t}function Qt(e){let t={},n=e.split("&");for(let r=0,i=n.length;r<i;r++){let e=n[r].split("=");t[decodeURIComponent(e[0])]=decodeURIComponent(e[1])}return t}class en extends Error{constructor(e,t,n){super(e),this.description=t,this.context=n,this.type="TransportError"}}class tn extends Ft{constructor(e){super(),this.writable=!1,Gt(this,e),this.opts=e,this.query=e.query,this.socket=e.socket}onError(e,t,n){return super.emitReserved("error",new en(e,t,n)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this}send(e){"open"===this.readyState&&this.write(e)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(e){const t=It(e,this.socket.binaryType);this.onPacket(t)}onPacket(e){super.emitReserved("packet",e)}onClose(e){this.readyState="closed",super.emitReserved("close",e)}pause(e){}createUri(e,t={}){return e+"://"+this._hostname()+this._port()+this.opts.path+this._query(t)}_hostname(){const e=this.opts.hostname;return-1===e.indexOf(":")?e:"["+e+"]"}_port(){return this.opts.port&&(this.opts.secure&&Number(443!==this.opts.port)||!this.opts.secure&&80!==Number(this.opts.port))?":"+this.opts.port:""}_query(e){const t=Xt(e);return t.length?"?"+t:""}}const nn="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),rn=64,on={};let sn,an=0,ln=0;function cn(e){let t="";do{t=nn[e%rn]+t,e=Math.floor(e/rn)}while(e>0);return t}function dn(){const e=cn(+new Date);return e!==sn?(an=0,sn=e):e+"."+cn(an++)}for(;ln<rn;ln++)on[nn[ln]]=ln;let hn=!1;try{hn="undefined"!==typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(ri){}const un=hn;function fn(e){const t=e.xdomain;try{if("undefined"!==typeof XMLHttpRequest&&(!t||un))return new XMLHttpRequest}catch(n){}if(!t)try{return new(qt[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(n){}}function pn(){}function gn(){}const yn=function(){const e=new fn({xdomain:!1});return null!=e.responseType}();class bn extends tn{constructor(e){if(super(e),this.polling=!1,"undefined"!==typeof location){const t="https:"===location.protocol;let n=location.port;n||(n=t?"443":"80"),this.xd="undefined"!==typeof location&&e.hostname!==location.hostname||n!==e.port}const t=e&&e.forceBase64;this.supportsBinary=yn&&!t,this.opts.withCredentials&&(this.cookieJar=pn())}get name(){return"polling"}doOpen(){this.poll()}pause(e){this.readyState="pausing";const t=()=>{this.readyState="paused",e()};if(this.polling||!this.writable){let e=0;this.polling&&(e++,this.once("pollComplete",(function(){--e||t()}))),this.writable||(e++,this.once("drain",(function(){--e||t()})))}else t()}poll(){this.polling=!0,this.doPoll(),this.emitReserved("poll")}onData(e){const t=e=>{if("opening"===this.readyState&&"open"===e.type&&this.onOpen(),"close"===e.type)return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(e)};Dt(e,this.socket.binaryType).forEach(t),"closed"!==this.readyState&&(this.polling=!1,this.emitReserved("pollComplete"),"open"===this.readyState&&this.poll())}doClose(){const e=()=>{this.write([{type:"close"}])};"open"===this.readyState?e():this.once("open",e)}write(e){this.writable=!1,Lt(e,(e=>{this.doWrite(e,(()=>{this.writable=!0,this.emitReserved("drain")}))}))}uri(){const e=this.opts.secure?"https":"http",t=this.query||{};return!1!==this.opts.timestampRequests&&(t[this.opts.timestampParam]=dn()),this.supportsBinary||t.sid||(t.b64=1),this.createUri(e,t)}request(e={}){return Object.assign(e,{xd:this.xd,cookieJar:this.cookieJar},this.opts),new mn(this.uri(),e)}doWrite(e,t){const n=this.request({method:"POST",data:e});n.on("success",t),n.on("error",((e,t)=>{this.onError("xhr post error",e,t)}))}doPoll(){const e=this.request();e.on("data",this.onData.bind(this)),e.on("error",((e,t)=>{this.onError("xhr poll error",e,t)})),this.pollXhr=e}}class mn extends Ft{constructor(e,t){super(),Gt(this,t),this.opts=t,this.method=t.method||"GET",this.uri=e,this.data=void 0!==t.data?t.data:null,this.create()}create(){var e;const t=Zt(this.opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");t.xdomain=!!this.opts.xd;const n=this.xhr=new fn(t);try{n.open(this.method,this.uri,!0);try{if(this.opts.extraHeaders){n.setDisableHeaderCheck&&n.setDisableHeaderCheck(!0);for(let e in this.opts.extraHeaders)this.opts.extraHeaders.hasOwnProperty(e)&&n.setRequestHeader(e,this.opts.extraHeaders[e])}}catch(r){}if("POST"===this.method)try{n.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(r){}try{n.setRequestHeader("Accept","*/*")}catch(r){}null===(e=this.opts.cookieJar)||void 0===e||e.addCookies(n),"withCredentials"in n&&(n.withCredentials=this.opts.withCredentials),this.opts.requestTimeout&&(n.timeout=this.opts.requestTimeout),n.onreadystatechange=()=>{var e;3===n.readyState&&(null===(e=this.opts.cookieJar)||void 0===e||e.parseCookies(n)),4===n.readyState&&(200===n.status||1223===n.status?this.onLoad():this.setTimeoutFn((()=>{this.onError("number"===typeof n.status?n.status:0)}),0))},n.send(this.data)}catch(r){return void this.setTimeoutFn((()=>{this.onError(r)}),0)}"undefined"!==typeof document&&(this.index=mn.requestsCount++,mn.requests[this.index]=this)}onError(e){this.emitReserved("error",e,this.xhr),this.cleanup(!0)}cleanup(e){if("undefined"!==typeof this.xhr&&null!==this.xhr){if(this.xhr.onreadystatechange=gn,e)try{this.xhr.abort()}catch(t){}"undefined"!==typeof document&&delete mn.requests[this.index],this.xhr=null}}onLoad(){const e=this.xhr.responseText;null!==e&&(this.emitReserved("data",e),this.emitReserved("success"),this.cleanup())}abort(){this.cleanup()}}if(mn.requestsCount=0,mn.requests={},"undefined"!==typeof document)if("function"===typeof attachEvent)attachEvent("onunload",wn);else if("function"===typeof addEventListener){const e="onpagehide"in qt?"pagehide":"unload";addEventListener(e,wn,!1)}function wn(){for(let e in mn.requests)mn.requests.hasOwnProperty(e)&&mn.requests[e].abort()}const vn=(()=>{const e="function"===typeof Promise&&"function"===typeof Promise.resolve;return e?e=>Promise.resolve().then(e):(e,t)=>t(e,0)})(),_n=qt.WebSocket||qt.MozWebSocket,En=!0,Sn="arraybuffer";var Rn=n(15361)["Buffer"];const An="undefined"!==typeof navigator&&"string"===typeof navigator.product&&"reactnative"===navigator.product.toLowerCase();class kn extends tn{constructor(e){super(e),this.supportsBinary=!e.forceBase64}get name(){return"websocket"}doOpen(){if(!this.check())return;const e=this.uri(),t=this.opts.protocols,n=An?{}:Zt(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(n.headers=this.opts.extraHeaders);try{this.ws=En&&!An?t?new _n(e,t):new _n(e):new _n(e,t,n)}catch(ri){return this.emitReserved("error",ri)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=e=>this.onClose({description:"websocket connection closed",context:e}),this.ws.onmessage=e=>this.onData(e.data),this.ws.onerror=e=>this.onError("websocket error",e)}write(e){this.writable=!1;for(let t=0;t<e.length;t++){const n=e[t],r=t===e.length-1;_t(n,this.supportsBinary,(e=>{const t={};if(!En&&(n.options&&(t.compress=n.options.compress),this.opts.perMessageDeflate)){const n="string"===typeof e?Rn.byteLength(e):e.length;n<this.opts.perMessageDeflate.threshold&&(t.compress=!1)}try{En?this.ws.send(e):this.ws.send(e,t)}catch(i){}r&&vn((()=>{this.writable=!0,this.emitReserved("drain")}),this.setTimeoutFn)}))}}doClose(){"undefined"!==typeof this.ws&&(this.ws.close(),this.ws=null)}uri(){const e=this.opts.secure?"wss":"ws",t=this.query||{};return this.opts.timestampRequests&&(t[this.opts.timestampParam]=dn()),this.supportsBinary||(t.b64=1),this.createUri(e,t)}check(){return!!_n}}class Nn extends tn{get name(){return"webtransport"}doOpen(){"function"===typeof WebTransport&&(this.transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name]),this.transport.closed.then((()=>{this.onClose()})).catch((e=>{this.onError("webtransport error",e)})),this.transport.ready.then((()=>{this.transport.createBidirectionalStream().then((e=>{const t=Kt(Number.MAX_SAFE_INTEGER,this.socket.binaryType),n=e.readable.pipeThrough(t).getReader(),r=Mt();r.readable.pipeTo(e.writable),this.writer=r.writable.getWriter();const i=()=>{n.read().then((({done:e,value:t})=>{e||(this.onPacket(t),i())})).catch((e=>{}))};i();const o={type:"open"};this.query.sid&&(o.data=`{"sid":"${this.query.sid}"}`),this.writer.write(o).then((()=>this.onOpen()))}))})))}write(e){this.writable=!1;for(let t=0;t<e.length;t++){const n=e[t],r=t===e.length-1;this.writer.write(n).then((()=>{r&&vn((()=>{this.writable=!0,this.emitReserved("drain")}),this.setTimeoutFn)}))}}doClose(){var e;null===(e=this.transport)||void 0===e||e.close()}}const Tn={websocket:kn,webtransport:Nn,polling:bn},Cn=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,In=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function On(e){if(e.length>2e3)throw"URI too long";const t=e,n=e.indexOf("["),r=e.indexOf("]");-1!=n&&-1!=r&&(e=e.substring(0,n)+e.substring(n,r).replace(/:/g,";")+e.substring(r,e.length));let i=Cn.exec(e||""),o={},s=14;while(s--)o[In[s]]=i[s]||"";return-1!=n&&-1!=r&&(o.source=t,o.host=o.host.substring(1,o.host.length-1).replace(/;/g,":"),o.authority=o.authority.replace("[","").replace("]","").replace(/;/g,":"),o.ipv6uri=!0),o.pathNames=Pn(o,o["path"]),o.queryKey=xn(o,o["query"]),o}function Pn(e,t){const n=/\/{2,9}/g,r=t.replace(n,"/").split("/");return"/"!=t.slice(0,1)&&0!==t.length||r.splice(0,1),"/"==t.slice(-1)&&r.splice(r.length-1,1),r}function xn(e,t){const n={};return t.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,(function(e,t,r){t&&(n[t]=r)})),n}class Ln extends Ft{constructor(e,t={}){super(),this.binaryType=Sn,this.writeBuffer=[],e&&"object"===typeof e&&(t=e,e=null),e?(e=On(e),t.hostname=e.host,t.secure="https"===e.protocol||"wss"===e.protocol,t.port=e.port,e.query&&(t.query=e.query)):t.host&&(t.hostname=On(t.host).host),Gt(this,t),this.secure=null!=t.secure?t.secure:"undefined"!==typeof location&&"https:"===location.protocol,t.hostname&&!t.port&&(t.port=this.secure?"443":"80"),this.hostname=t.hostname||("undefined"!==typeof location?location.hostname:"localhost"),this.port=t.port||("undefined"!==typeof location&&location.port?location.port:this.secure?"443":"80"),this.transports=t.transports||["polling","websocket","webtransport"],this.writeBuffer=[],this.prevBufferLen=0,this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},t),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),"string"===typeof this.opts.query&&(this.opts.query=Qt(this.opts.query)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingTimeoutTimer=null,"function"===typeof addEventListener&&(this.opts.closeOnBeforeunload&&(this.beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this.beforeunloadEventListener,!1)),"localhost"!==this.hostname&&(this.offlineEventListener=()=>{this.onClose("transport close",{description:"network connection lost"})},addEventListener("offline",this.offlineEventListener,!1))),this.open()}createTransport(e){const t=Object.assign({},this.opts.query);t.EIO=Wt,t.transport=e,this.id&&(t.sid=this.id);const n=Object.assign({},this.opts,{query:t,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[e]);return new Tn[e](n)}open(){let e;if(this.opts.rememberUpgrade&&Ln.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket"))e="websocket";else{if(0===this.transports.length)return void this.setTimeoutFn((()=>{this.emitReserved("error","No transports available")}),0);e=this.transports[0]}this.readyState="opening";try{e=this.createTransport(e)}catch(t){return this.transports.shift(),void this.open()}e.open(),this.setTransport(e)}setTransport(e){this.transport&&this.transport.removeAllListeners(),this.transport=e,e.on("drain",this.onDrain.bind(this)).on("packet",this.onPacket.bind(this)).on("error",this.onError.bind(this)).on("close",(e=>this.onClose("transport close",e)))}probe(e){let t=this.createTransport(e),n=!1;Ln.priorWebsocketSuccess=!1;const r=()=>{n||(t.send([{type:"ping",data:"probe"}]),t.once("packet",(e=>{if(!n)if("pong"===e.type&&"probe"===e.data){if(this.upgrading=!0,this.emitReserved("upgrading",t),!t)return;Ln.priorWebsocketSuccess="websocket"===t.name,this.transport.pause((()=>{n||"closed"!==this.readyState&&(c(),this.setTransport(t),t.send([{type:"upgrade"}]),this.emitReserved("upgrade",t),t=null,this.upgrading=!1,this.flush())}))}else{const e=new Error("probe error");e.transport=t.name,this.emitReserved("upgradeError",e)}})))};function i(){n||(n=!0,c(),t.close(),t=null)}const o=e=>{const n=new Error("probe error: "+e);n.transport=t.name,i(),this.emitReserved("upgradeError",n)};function s(){o("transport closed")}function a(){o("socket closed")}function l(e){t&&e.name!==t.name&&i()}const c=()=>{t.removeListener("open",r),t.removeListener("error",o),t.removeListener("close",s),this.off("close",a),this.off("upgrading",l)};t.once("open",r),t.once("error",o),t.once("close",s),this.once("close",a),this.once("upgrading",l),-1!==this.upgrades.indexOf("webtransport")&&"webtransport"!==e?this.setTimeoutFn((()=>{n||t.open()}),200):t.open()}onOpen(){if(this.readyState="open",Ln.priorWebsocketSuccess="websocket"===this.transport.name,this.emitReserved("open"),this.flush(),"open"===this.readyState&&this.opts.upgrade){let e=0;const t=this.upgrades.length;for(;e<t;e++)this.probe(this.upgrades[e])}}onPacket(e){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(this.emitReserved("packet",e),this.emitReserved("heartbeat"),this.resetPingTimeout(),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"ping":this.sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong");break;case"error":const t=new Error("server error");t.code=e.data,this.onError(t);break;case"message":this.emitReserved("data",e.data),this.emitReserved("message",e.data);break}}onHandshake(e){this.emitReserved("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this.upgrades=this.filterUpgrades(e.upgrades),this.pingInterval=e.pingInterval,this.pingTimeout=e.pingTimeout,this.maxPayload=e.maxPayload,this.onOpen(),"closed"!==this.readyState&&this.resetPingTimeout()}resetPingTimeout(){this.clearTimeoutFn(this.pingTimeoutTimer),this.pingTimeoutTimer=this.setTimeoutFn((()=>{this.onClose("ping timeout")}),this.pingInterval+this.pingTimeout),this.opts.autoUnref&&this.pingTimeoutTimer.unref()}onDrain(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0===this.writeBuffer.length?this.emitReserved("drain"):this.flush()}flush(){if("closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const e=this.getWritablePackets();this.transport.send(e),this.prevBufferLen=e.length,this.emitReserved("flush")}}getWritablePackets(){const e=this.maxPayload&&"polling"===this.transport.name&&this.writeBuffer.length>1;if(!e)return this.writeBuffer;let t=1;for(let n=0;n<this.writeBuffer.length;n++){const e=this.writeBuffer[n].data;if(e&&(t+=Jt(e)),n>0&&t>this.maxPayload)return this.writeBuffer.slice(0,n);t+=2}return this.writeBuffer}write(e,t,n){return this.sendPacket("message",e,t,n),this}send(e,t,n){return this.sendPacket("message",e,t,n),this}sendPacket(e,t,n,r){if("function"===typeof t&&(r=t,t=void 0),"function"===typeof n&&(r=n,n=null),"closing"===this.readyState||"closed"===this.readyState)return;n=n||{},n.compress=!1!==n.compress;const i={type:e,data:t,options:n};this.emitReserved("packetCreate",i),this.writeBuffer.push(i),r&&this.once("flush",r),this.flush()}close(){const e=()=>{this.onClose("forced close"),this.transport.close()},t=()=>{this.off("upgrade",t),this.off("upgradeError",t),e()},n=()=>{this.once("upgrade",t),this.once("upgradeError",t)};return"opening"!==this.readyState&&"open"!==this.readyState||(this.readyState="closing",this.writeBuffer.length?this.once("drain",(()=>{this.upgrading?n():e()})):this.upgrading?n():e()),this}onError(e){Ln.priorWebsocketSuccess=!1,this.emitReserved("error",e),this.onClose("transport error",e)}onClose(e,t){"opening"!==this.readyState&&"open"!==this.readyState&&"closing"!==this.readyState||(this.clearTimeoutFn(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),"function"===typeof removeEventListener&&(removeEventListener("beforeunload",this.beforeunloadEventListener,!1),removeEventListener("offline",this.offlineEventListener,!1)),this.readyState="closed",this.id=null,this.emitReserved("close",e,t),this.writeBuffer=[],this.prevBufferLen=0)}filterUpgrades(e){const t=[];let n=0;const r=e.length;for(;n<r;n++)~this.transports.indexOf(e[n])&&t.push(e[n]);return t}}Ln.protocol=Wt;Ln.protocol;function Dn(e,t="",n){let r=e;n=n||"undefined"!==typeof location&&location,null==e&&(e=n.protocol+"//"+n.host),"string"===typeof e&&("/"===e.charAt(0)&&(e="/"===e.charAt(1)?n.protocol+e:n.host+e),/^(https?|wss?):\/\//.test(e)||(e="undefined"!==typeof n?n.protocol+"//"+e:"https://"+e),r=On(e)),r.port||(/^(http|ws)$/.test(r.protocol)?r.port="80":/^(http|ws)s$/.test(r.protocol)&&(r.port="443")),r.path=r.path||"/";const i=-1!==r.host.indexOf(":"),o=i?"["+r.host+"]":r.host;return r.id=r.protocol+"://"+o+":"+r.port+t,r.href=r.protocol+"://"+o+(n&&n.port===r.port?"":":"+r.port),r}n(25847),n(91719);const Mn="function"===typeof ArrayBuffer,Bn=e=>"function"===typeof ArrayBuffer.isView?ArrayBuffer.isView(e):e.buffer instanceof ArrayBuffer,Un=Object.prototype.toString,jn="function"===typeof Blob||"undefined"!==typeof Blob&&"[object BlobConstructor]"===Un.call(Blob),Kn="function"===typeof File||"undefined"!==typeof File&&"[object FileConstructor]"===Un.call(File);function Wn(e){return Mn&&(e instanceof ArrayBuffer||Bn(e))||jn&&e instanceof Blob||Kn&&e instanceof File}function Fn(e,t){if(!e||"object"!==typeof e)return!1;if(Array.isArray(e)){for(let t=0,n=e.length;t<n;t++)if(Fn(e[t]))return!0;return!1}if(Wn(e))return!0;if(e.toJSON&&"function"===typeof e.toJSON&&1===arguments.length)return Fn(e.toJSON(),!0);for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)&&Fn(e[n]))return!0;return!1}function $n(e){const t=[],n=e.data,r=e;return r.data=qn(n,t),r.attachments=t.length,{packet:r,buffers:t}}function qn(e,t){if(!e)return e;if(Wn(e)){const n={_placeholder:!0,num:t.length};return t.push(e),n}if(Array.isArray(e)){const n=new Array(e.length);for(let r=0;r<e.length;r++)n[r]=qn(e[r],t);return n}if("object"===typeof e&&!(e instanceof Date)){const n={};for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=qn(e[r],t));return n}return e}function Zn(e,t){return e.data=Hn(e.data,t),delete e.attachments,e}function Hn(e,t){if(!e)return e;if(e&&!0===e._placeholder){const n="number"===typeof e.num&&e.num>=0&&e.num<t.length;if(n)return t[e.num];throw new Error("illegal attachments")}if(Array.isArray(e))for(let n=0;n<e.length;n++)e[n]=Hn(e[n],t);else if("object"===typeof e)for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&(e[n]=Hn(e[n],t));return e}const Vn=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],Gn=5;var Yn;(function(e){e[e["CONNECT"]=0]="CONNECT",e[e["DISCONNECT"]=1]="DISCONNECT",e[e["EVENT"]=2]="EVENT",e[e["ACK"]=3]="ACK",e[e["CONNECT_ERROR"]=4]="CONNECT_ERROR",e[e["BINARY_EVENT"]=5]="BINARY_EVENT",e[e["BINARY_ACK"]=6]="BINARY_ACK"})(Yn||(Yn={}));class Jn{constructor(e){this.replacer=e}encode(e){return e.type!==Yn.EVENT&&e.type!==Yn.ACK||!Fn(e)?[this.encodeAsString(e)]:this.encodeAsBinary({type:e.type===Yn.EVENT?Yn.BINARY_EVENT:Yn.BINARY_ACK,nsp:e.nsp,data:e.data,id:e.id})}encodeAsString(e){let t=""+e.type;return e.type!==Yn.BINARY_EVENT&&e.type!==Yn.BINARY_ACK||(t+=e.attachments+"-"),e.nsp&&"/"!==e.nsp&&(t+=e.nsp+","),null!=e.id&&(t+=e.id),null!=e.data&&(t+=JSON.stringify(e.data,this.replacer)),t}encodeAsBinary(e){const t=$n(e),n=this.encodeAsString(t.packet),r=t.buffers;return r.unshift(n),r}}function zn(e){return"[object Object]"===Object.prototype.toString.call(e)}class Xn extends Ft{constructor(e){super(),this.reviver=e}add(e){let t;if("string"===typeof e){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");t=this.decodeString(e);const n=t.type===Yn.BINARY_EVENT;n||t.type===Yn.BINARY_ACK?(t.type=n?Yn.EVENT:Yn.ACK,this.reconstructor=new Qn(t),0===t.attachments&&super.emitReserved("decoded",t)):super.emitReserved("decoded",t)}else{if(!Wn(e)&&!e.base64)throw new Error("Unknown type: "+e);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");t=this.reconstructor.takeBinaryData(e),t&&(this.reconstructor=null,super.emitReserved("decoded",t))}}decodeString(e){let t=0;const n={type:Number(e.charAt(0))};if(void 0===Yn[n.type])throw new Error("unknown packet type "+n.type);if(n.type===Yn.BINARY_EVENT||n.type===Yn.BINARY_ACK){const r=t+1;while("-"!==e.charAt(++t)&&t!=e.length);const i=e.substring(r,t);if(i!=Number(i)||"-"!==e.charAt(t))throw new Error("Illegal attachments");n.attachments=Number(i)}if("/"===e.charAt(t+1)){const r=t+1;while(++t){const n=e.charAt(t);if(","===n)break;if(t===e.length)break}n.nsp=e.substring(r,t)}else n.nsp="/";const r=e.charAt(t+1);if(""!==r&&Number(r)==r){const r=t+1;while(++t){const n=e.charAt(t);if(null==n||Number(n)!=n){--t;break}if(t===e.length)break}n.id=Number(e.substring(r,t+1))}if(e.charAt(++t)){const r=this.tryParse(e.substr(t));if(!Xn.isPayloadValid(n.type,r))throw new Error("invalid payload");n.data=r}return n}tryParse(e){try{return JSON.parse(e,this.reviver)}catch(t){return!1}}static isPayloadValid(e,t){switch(e){case Yn.CONNECT:return zn(t);case Yn.DISCONNECT:return void 0===t;case Yn.CONNECT_ERROR:return"string"===typeof t||zn(t);case Yn.EVENT:case Yn.BINARY_EVENT:return Array.isArray(t)&&("number"===typeof t[0]||"string"===typeof t[0]&&-1===Vn.indexOf(t[0]));case Yn.ACK:case Yn.BINARY_ACK:return Array.isArray(t)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class Qn{constructor(e){this.packet=e,this.buffers=[],this.reconPack=e}takeBinaryData(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){const e=Zn(this.reconPack,this.buffers);return this.finishedReconstruction(),e}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}function er(e,t,n){return e.on(t,n),function(){e.off(t,n)}}const tr=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class nr extends Ft{constructor(e,t,n){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=e,this.nsp=t,n&&n.auth&&(this.auth=n.auth),this._opts=Object.assign({},n),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const e=this.io;this.subs=[er(e,"open",this.onopen.bind(this)),er(e,"packet",this.onpacket.bind(this)),er(e,"error",this.onerror.bind(this)),er(e,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected||(this.subEvents(),this.io["_reconnecting"]||this.io.open(),"open"===this.io._readyState&&this.onopen()),this}open(){return this.connect()}send(...e){return e.unshift("message"),this.emit.apply(this,e),this}emit(e,...t){if(tr.hasOwnProperty(e))throw new Error('"'+e.toString()+'" is a reserved event name');if(t.unshift(e),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(t),this;const n={type:Yn.EVENT,data:t,options:{}};if(n.options.compress=!1!==this.flags.compress,"function"===typeof t[t.length-1]){const e=this.ids++,r=t.pop();this._registerAckCallback(e,r),n.id=e}const r=this.io.engine&&this.io.engine.transport&&this.io.engine.transport.writable,i=this.flags.volatile&&(!r||!this.connected);return i||(this.connected?(this.notifyOutgoingListeners(n),this.packet(n)):this.sendBuffer.push(n)),this.flags={},this}_registerAckCallback(e,t){var n;const r=null!==(n=this.flags.timeout)&&void 0!==n?n:this._opts.ackTimeout;if(void 0===r)return void(this.acks[e]=t);const i=this.io.setTimeoutFn((()=>{delete this.acks[e];for(let t=0;t<this.sendBuffer.length;t++)this.sendBuffer[t].id===e&&this.sendBuffer.splice(t,1);t.call(this,new Error("operation has timed out"))}),r);this.acks[e]=(...e)=>{this.io.clearTimeoutFn(i),t.apply(this,[null,...e])}}emitWithAck(e,...t){const n=void 0!==this.flags.timeout||void 0!==this._opts.ackTimeout;return new Promise(((r,i)=>{t.push(((e,t)=>n?e?i(e):r(t):r(e))),this.emit(e,...t)}))}_addToQueue(e){let t;"function"===typeof e[e.length-1]&&(t=e.pop());const n={id:this._queueSeq++,tryCount:0,pending:!1,args:e,flags:Object.assign({fromQueue:!0},this.flags)};e.push(((e,...r)=>{if(n!==this._queue[0])return;const i=null!==e;return i?n.tryCount>this._opts.retries&&(this._queue.shift(),t&&t(e)):(this._queue.shift(),t&&t(null,...r)),n.pending=!1,this._drainQueue()})),this._queue.push(n),this._drainQueue()}_drainQueue(e=!1){if(!this.connected||0===this._queue.length)return;const t=this._queue[0];t.pending&&!e||(t.pending=!0,t.tryCount++,this.flags=t.flags,this.emit.apply(this,t.args))}packet(e){e.nsp=this.nsp,this.io._packet(e)}onopen(){"function"==typeof this.auth?this.auth((e=>{this._sendConnectPacket(e)})):this._sendConnectPacket(this.auth)}_sendConnectPacket(e){this.packet({type:Yn.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},e):e})}onerror(e){this.connected||this.emitReserved("connect_error",e)}onclose(e,t){this.connected=!1,delete this.id,this.emitReserved("disconnect",e,t)}onpacket(e){const t=e.nsp===this.nsp;if(t)switch(e.type){case Yn.CONNECT:e.data&&e.data.sid?this.onconnect(e.data.sid,e.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case Yn.EVENT:case Yn.BINARY_EVENT:this.onevent(e);break;case Yn.ACK:case Yn.BINARY_ACK:this.onack(e);break;case Yn.DISCONNECT:this.ondisconnect();break;case Yn.CONNECT_ERROR:this.destroy();const t=new Error(e.data.message);t.data=e.data.data,this.emitReserved("connect_error",t);break}}onevent(e){const t=e.data||[];null!=e.id&&t.push(this.ack(e.id)),this.connected?this.emitEvent(t):this.receiveBuffer.push(Object.freeze(t))}emitEvent(e){if(this._anyListeners&&this._anyListeners.length){const t=this._anyListeners.slice();for(const n of t)n.apply(this,e)}super.emit.apply(this,e),this._pid&&e.length&&"string"===typeof e[e.length-1]&&(this._lastOffset=e[e.length-1])}ack(e){const t=this;let n=!1;return function(...r){n||(n=!0,t.packet({type:Yn.ACK,id:e,data:r}))}}onack(e){const t=this.acks[e.id];"function"===typeof t&&(t.apply(this,e.data),delete this.acks[e.id])}onconnect(e,t){this.id=e,this.recovered=t&&this._pid===t,this._pid=t,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach((e=>this.emitEvent(e))),this.receiveBuffer=[],this.sendBuffer.forEach((e=>{this.notifyOutgoingListeners(e),this.packet(e)})),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach((e=>e())),this.subs=void 0),this.io["_destroy"](this)}disconnect(){return this.connected&&this.packet({type:Yn.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(e){return this.flags.compress=e,this}get volatile(){return this.flags.volatile=!0,this}timeout(e){return this.flags.timeout=e,this}onAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(e),this}prependAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(e),this}offAny(e){if(!this._anyListeners)return this;if(e){const t=this._anyListeners;for(let n=0;n<t.length;n++)if(e===t[n])return t.splice(n,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(e),this}prependAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(e),this}offAnyOutgoing(e){if(!this._anyOutgoingListeners)return this;if(e){const t=this._anyOutgoingListeners;for(let n=0;n<t.length;n++)if(e===t[n])return t.splice(n,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(e){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const t=this._anyOutgoingListeners.slice();for(const n of t)n.apply(this,e.data)}}}function rr(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,this.attempts=0}rr.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),n=Math.floor(t*this.jitter*e);e=0==(1&Math.floor(10*t))?e-n:e+n}return 0|Math.min(e,this.max)},rr.prototype.reset=function(){this.attempts=0},rr.prototype.setMin=function(e){this.ms=e},rr.prototype.setMax=function(e){this.max=e},rr.prototype.setJitter=function(e){this.jitter=e};class ir extends Ft{constructor(e,t){var n;super(),this.nsps={},this.subs=[],e&&"object"===typeof e&&(t=e,e=void 0),t=t||{},t.path=t.path||"/socket.io",this.opts=t,Gt(this,t),this.reconnection(!1!==t.reconnection),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor(null!==(n=t.randomizationFactor)&&void 0!==n?n:.5),this.backoff=new rr({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==t.timeout?2e4:t.timeout),this._readyState="closed",this.uri=e;const i=t.parser||r;this.encoder=new i.Encoder,this.decoder=new i.Decoder,this._autoConnect=!1!==t.autoConnect,this._autoConnect&&this.open()}reconnection(e){return arguments.length?(this._reconnection=!!e,this):this._reconnection}reconnectionAttempts(e){return void 0===e?this._reconnectionAttempts:(this._reconnectionAttempts=e,this)}reconnectionDelay(e){var t;return void 0===e?this._reconnectionDelay:(this._reconnectionDelay=e,null===(t=this.backoff)||void 0===t||t.setMin(e),this)}randomizationFactor(e){var t;return void 0===e?this._randomizationFactor:(this._randomizationFactor=e,null===(t=this.backoff)||void 0===t||t.setJitter(e),this)}reconnectionDelayMax(e){var t;return void 0===e?this._reconnectionDelayMax:(this._reconnectionDelayMax=e,null===(t=this.backoff)||void 0===t||t.setMax(e),this)}timeout(e){return arguments.length?(this._timeout=e,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()}open(e){if(~this._readyState.indexOf("open"))return this;this.engine=new Ln(this.uri,this.opts);const t=this.engine,n=this;this._readyState="opening",this.skipReconnect=!1;const r=er(t,"open",(function(){n.onopen(),e&&e()})),i=t=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",t),e?e(t):this.maybeReconnectOnOpen()},o=er(t,"error",i);if(!1!==this._timeout){const e=this._timeout,n=this.setTimeoutFn((()=>{r(),i(new Error("timeout")),t.close()}),e);this.opts.autoUnref&&n.unref(),this.subs.push((()=>{this.clearTimeoutFn(n)}))}return this.subs.push(r),this.subs.push(o),this}connect(e){return this.open(e)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const e=this.engine;this.subs.push(er(e,"ping",this.onping.bind(this)),er(e,"data",this.ondata.bind(this)),er(e,"error",this.onerror.bind(this)),er(e,"close",this.onclose.bind(this)),er(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(e){try{this.decoder.add(e)}catch(t){this.onclose("parse error",t)}}ondecoded(e){vn((()=>{this.emitReserved("packet",e)}),this.setTimeoutFn)}onerror(e){this.emitReserved("error",e)}socket(e,t){let n=this.nsps[e];return n?this._autoConnect&&!n.active&&n.connect():(n=new nr(this,e,t),this.nsps[e]=n),n}_destroy(e){const t=Object.keys(this.nsps);for(const n of t){const e=this.nsps[n];if(e.active)return}this._close()}_packet(e){const t=this.encoder.encode(e);for(let n=0;n<t.length;n++)this.engine.write(t[n],e.options)}cleanup(){this.subs.forEach((e=>e())),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close"),this.engine&&this.engine.close()}disconnect(){return this._close()}onclose(e,t){this.cleanup(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",e,t),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const e=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const t=this.backoff.duration();this._reconnecting=!0;const n=this.setTimeoutFn((()=>{e.skipReconnect||(this.emitReserved("reconnect_attempt",e.backoff.attempts),e.skipReconnect||e.open((t=>{t?(e._reconnecting=!1,e.reconnect(),this.emitReserved("reconnect_error",t)):e.onreconnect()})))}),t);this.opts.autoUnref&&n.unref(),this.subs.push((()=>{this.clearTimeoutFn(n)}))}}onreconnect(){const e=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",e)}}const or={};function sr(e,t){"object"===typeof e&&(t=e,e=void 0),t=t||{};const n=Dn(e,t.path||"/socket.io"),r=n.source,i=n.id,o=n.path,s=or[i]&&o in or[i]["nsps"],a=t.forceNew||t["force new connection"]||!1===t.multiplex||s;let l;return a?l=new ir(r,t):(or[i]||(or[i]=new ir(r,t)),l=or[i]),n.query&&!t.query&&(t.query=n.queryKey),l.socket(n.path,t)}Object.assign(sr,{Manager:ir,Socket:nr,io:sr,connect:sr});var ar=n(15361)["Buffer"],lr=R().getLogger("SecurePubSub");class cr{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,i.Z)(this,"options",void 0),(0,i.Z)(this,"SOCKET_CONN",null),this.options=e,this.options.timeout=e.timeout||600,this.options.serverUrl=e.serverUrl||"https://broadcast-server.tor.us",this.options.enableLogging=e.enableLogging||!1,this.options.namespace=e.namespace||"",this.options.enableLogging?lr.enableAll():lr.disableAll()}static setLogLevel(e){lr.setLevel(e),lt(e)}async publish(e,t){const n=xe(ar.from(e,"utf8")),r=await Be(n.toString("hex"),t),i=await Qe(n,xe(ar.from(r,"utf8"))),o={key:Xe(n).toString("hex"),data:r,signature:i.toString("hex"),timeout:this.options.timeout,namespace:this.options.namespace};return pt(`${this.options.serverUrl}/channel/set`,o)}async subscribe(e){let t=!0;const n=xe(ar.from(e,"utf8")),r=Xe(n).toString("hex"),i=this.getSocketConnection();i.connected?(lr.debug("already connected with socket"),i.emit("check_auth_status",r,{namespace:this.options.namespace})):i.once("connect",(()=>{lr.debug("connected with socket"),i.emit("check_auth_status",r,{namespace:this.options.namespace})}));const o=()=>{i.once("connect",(async()=>{lr.debug("connected with socket using reconnect"),t&&i.emit("check_auth_status",r,{namespace:this.options.namespace})}))},s=()=>{t||document.removeEventListener("visibilitychange",s),i.connected||"visible"!==document.visibilityState||o()},a=()=>{lr.debug("socket disconnected",t),t?(lr.error("socket disconnected unexpectedly, reconnecting socket"),o()):i.removeListener("disconnect",a)};i.on("disconnect",a);const l=new Promise(((e,o)=>{const a=async r=>{try{const t=await Ue(n.toString("hex"),r);lr.info("got data",t),e(t)}catch(i){lr.error(i),o(i)}finally{t=!1,document.removeEventListener("visibilitychange",s)}};lr.info("listening to",`${r}_success`),i.once(`${r}_success`,a)}));return"undefined"!==typeof document&&document.addEventListener("visibilitychange",s),l}cleanup(){this.SOCKET_CONN&&(this.SOCKET_CONN.disconnect(),this.SOCKET_CONN=null)}getSocketConnection(){if(this.SOCKET_CONN)return this.SOCKET_CONN;const e=sr(this.options.serverUrl,{transports:["websocket","polling"],withCredentials:!0,reconnectionDelayMax:1e4,reconnectionAttempts:10});return e.on("connect_error",(t=>{e.io.opts.transports=["polling","websocket"],lr.error("connect error",t)})),e.on("connect",(async()=>{const{engine:t}=e.io;lr.debug("initially connected to",t.transport.name),t.once("upgrade",(()=>{lr.debug("upgraded",t.transport.name)})),t.once("close",(e=>{lr.debug("connection closed",e)}))})),e.on("error",(t=>{lr.error("socket errored",t),e.disconnect()})),this.SOCKET_CONN=e,this.SOCKET_CONN}}var dr=n(43793),hr=n(15361)["Buffer"];new H.ec("secp256k1");const ur=n.g.crypto||n.g.msCrypto||{},fr=ur.subtle||ur.webkitSubtle;hr.from("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141","hex"),hr.alloc(32,0);function pr(e){return async function(t,n,r){if(fr){const i={name:"AES-CBC"},o=await fr.importKey("raw",n,i,!1,[e]),s={name:"AES-CBC",iv:t},a=await fr[e](s,o,r);return hr.from(new Uint8Array(a))}if("encrypt"===e){const e=Z.createCipheriv("aes-256-cbc",n,t),i=e.update(r),o=e.final();return hr.concat([i,o])}if("decrypt"===e){const e=Z.createDecipheriv("aes-256-cbc",n,t),i=e.update(r),o=e.final();return hr.concat([i,o])}throw new Error(`Unsupported operation: ${e}`)}}pr("encrypt"),pr("decrypt");var gr=n(7544),yr=n.n(gr),br=(n(15361)["Buffer"],n(15941));class mr extends E.s{constructor(e,t){super(t),(0,i.Z)(this,"code",void 0),(0,i.Z)(this,"message",void 0),this.code=e,this.message=t||"",Object.defineProperty(this,"name",{value:"OpenloginError"})}toJSON(){return{name:this.name,code:this.code,message:this.message}}toString(){return JSON.stringify(this.toJSON())}}class wr extends mr{constructor(e,t){super(e,t),Object.defineProperty(this,"name",{value:"InitializationError"})}static fromCode(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return new wr(e,`${wr.messages[e]}, ${t}`)}static invalidParams(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return wr.fromCode(5001,e)}static notInitialized(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return wr.fromCode(5002,e)}}(0,i.Z)(wr,"messages",{5e3:"Custom",5001:"Invalid constructor params",5002:"SDK not initialized. please call init first"});class vr extends mr{constructor(e,t){super(e,t),Object.defineProperty(this,"name",{value:"LoginError"})}static fromCode(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return new vr(e,`${vr.messages[e]}, ${t}`)}static invalidLoginParams(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return vr.fromCode(5111,e)}static userNotLoggedIn(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return vr.fromCode(5112,e)}static popupClosed(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return vr.fromCode(5113,e)}static loginFailed(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return vr.fromCode(5114,e)}static popupBlocked(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return vr.fromCode(5115,e)}}(0,i.Z)(vr,"messages",{5e3:"Custom",5111:"Invalid login params",5112:"User not logged in.",5113:"login popup has been closed by the user",5114:"Login failed",5115:"Popup was blocked. Please call this function as soon as user clicks button or use redirect mode"});const _r=(0,S.getLogger)("openlogin");_r.setLevel("error");const Er="6.1.0";function Sr(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const t={},n=new URL(window.location.href);n.searchParams.forEach(((e,n)=>{"result"!==n&&(t[n]=e)}));const r=n.searchParams.get("result");if(r)try{const e=JSON.parse(h(r));Object.keys(e).forEach((n=>{t[n]=e[n]}))}catch(l){_r.error(l)}const i=n.hash.substring(1),o=new URL(`${window.location.origin}/?${i}`);o.searchParams.forEach(((e,n)=>{"result"!==n&&(t[n]=e)}));const s=o.searchParams.get("result");if(s)try{const e=JSON.parse(h(s));Object.keys(e).forEach((n=>{t[n]=e[n]}))}catch(l){_r.error(l)}if(e){const e=new URL(window.location.origin+window.location.pathname);if(e.search=window.location.search,s){const t=JSON.parse(h(s));delete t.sessionId,delete t.sessionNamespace,delete t.error,e.hash=d(JSON.stringify(t))}window.history.replaceState((0,a.Z)((0,a.Z)({},window.history.state),{},{as:e.href,url:e.href}),"",e.href)}return t}function Rr(e){const{baseURL:t,query:n,hash:r}=e,i=new URL(t);if(n&&Object.keys(n).forEach((e=>{i.searchParams.append(e,n[e])})),r){const e=new URL(Rr({baseURL:t,query:r})).searchParams.toString();i.hash=e}return i.toString()}function Ar(){if("undefined"===typeof window)return"";const e=void 0!==window.screenLeft?window.screenLeft:window.screenX,t=void 0!==window.screenTop?window.screenTop:window.screenY,n=1200,r=700,i=window.innerWidth?window.innerWidth:document.documentElement.clientWidth?document.documentElement.clientWidth:window.screen.width,o=window.innerHeight?window.innerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:window.screen.height,s=1,a=Math.abs((i-n)/2/s+e),l=Math.abs((o-r)/2/s+t),c=`titlebar=0,toolbar=0,status=0,location=0,menubar=0,height=${r/s},width=${n/s},top=${l},left=${a}`;return c}function kr(){if("undefined"===typeof window)return!1;const e=yr().getParser(window.navigator.userAgent),t=e.getPlatform();return t.type===yr().PLATFORMS_MAP.tablet||t.type===yr().PLATFORMS_MAP.mobile}function Nr(e){return e!==w.FACEBOOK&&e!==w.LINE||!kr()?1e4:3e5}class Tr extends dr.EventEmitter{constructor(e){let{url:t,target:n,features:r,timeout:o=3e4}=e;super(),(0,i.Z)(this,"url",void 0),(0,i.Z)(this,"target",void 0),(0,i.Z)(this,"features",void 0),(0,i.Z)(this,"window",void 0),(0,i.Z)(this,"windowTimer",void 0),(0,i.Z)(this,"iClosedWindow",void 0),(0,i.Z)(this,"timeout",void 0),this.url=t,this.target=n||"_blank",this.features=r||Ar(),this.window=void 0,this.windowTimer=void 0,this.iClosedWindow=!1,this.timeout=o,this._setupTimer()}_setupTimer(){this.windowTimer=Number(setInterval((()=>{this.window&&this.window.closed&&(clearInterval(this.windowTimer),setTimeout((()=>{this.iClosedWindow||this.emit("close"),this.iClosedWindow=!1,this.window=void 0}),this.timeout)),void 0===this.window&&clearInterval(this.windowTimer)}),500))}open(){var e;if(this.window=window.open(this.url,this.target,this.features),!this.window)throw vr.popupBlocked();null!==(e=this.window)&&void 0!==e&&e.focus&&this.window.focus()}close(){this.iClosedWindow=!0,this.window&&this.window.close()}redirect(e){e?window.location.replace(this.url):window.location.href=this.url}async listenOnChannel(e){const t=new cr,n=await t.subscribe(e);this.close(),t.cleanup();const r=JSON.parse(n);return r.error?{error:r.error,state:r.state}:r.data}}class Cr{constructor(e){if((0,i.Z)(this,"state",{}),(0,i.Z)(this,"options",void 0),(0,i.Z)(this,"sessionManager",void 0),(0,i.Z)(this,"currentStorage",void 0),(0,i.Z)(this,"_storageBaseKey","openlogin_store"),(0,i.Z)(this,"dappState",void 0),(0,i.Z)(this,"addVersionInUrls",!0),!e.clientId)throw wr.invalidParams("clientId is required");if(e.network||(e.network=b.SAPPHIRE_MAINNET),e.buildEnv||(e.buildEnv=_.PRODUCTION),(e.buildEnv===_.DEVELOPMENT||e.buildEnv===_.TESTING||e.sdkUrl)&&(this.addVersionInUrls=!1),e.sdkUrl||e.useMpc||(e.buildEnv===_.DEVELOPMENT?e.sdkUrl="http://localhost:3000":e.buildEnv===_.STAGING?e.sdkUrl="https://staging-auth.web3auth.io":e.buildEnv===_.TESTING?e.sdkUrl="https://develop-auth.web3auth.io":e.sdkUrl="https://auth.web3auth.io"),e.useMpc&&!e.sdkUrl){if(Object.values(l.Ad).includes(e.network))throw new Error("MPC is not supported on legacy networks");e.buildEnv===_.DEVELOPMENT?e.sdkUrl="http://localhost:3000":e.buildEnv===_.STAGING?e.sdkUrl="https://staging-mpc-auth.web3auth.io":e.buildEnv===_.TESTING?e.sdkUrl="https://develop-mpc-auth.web3auth.io":e.sdkUrl="https://mpc-auth.web3auth.io"}e.redirectUrl||"undefined"===typeof window||(e.redirectUrl=`${window.location.protocol}//${window.location.host}${window.location.pathname}`),e.uxMode||(e.uxMode=y.REDIRECT),"boolean"!==typeof e.replaceUrlOnRedirect&&(e.replaceUrlOnRedirect=!0),e.originData||(e.originData={}),e.whiteLabel||(e.whiteLabel={}),e.loginConfig||(e.loginConfig={}),e.mfaSettings||(e.mfaSettings={}),e.storageServerUrl||(e.storageServerUrl="https://broadcast-server.tor.us"),e.storageKey||(e.storageKey="local"),e.webauthnTransports||(e.webauthnTransports=["internal"]),e.sessionTime||(e.sessionTime=86400),this.options=e}get privKey(){return this.options.useMpc?this.state.factorKey||"":this.state.privKey?this.state.privKey.padStart(64,"0"):""}get coreKitKey(){return this.state.coreKitKey?this.state.coreKitKey.padStart(64,"0"):""}get ed25519PrivKey(){return this.state.ed25519PrivKey?this.state.ed25519PrivKey.padStart(128,"0"):""}get coreKitEd25519Key(){return this.state.coreKitEd25519PrivKey?this.state.coreKitEd25519PrivKey.padStart(128,"0"):""}get sessionId(){return this.state.sessionId||""}get sessionNamespace(){return this.options.sessionNamespace||""}get appState(){return this.state.userInfo.appState||this.dappState||""}get baseUrl(){return this.addVersionInUrls?`${this.options.sdkUrl}/v${Er.split(".")[0]}`:`${this.options.sdkUrl}`}async init(){const e=Sr(this.options.replaceUrlOnRedirect);e.sessionNamespace&&(this.options.sessionNamespace=e.sessionNamespace);const t=this.options.sessionNamespace?`${this._storageBaseKey}_${this.options.sessionNamespace}`:this._storageBaseKey;this.currentStorage=g.getInstance(t,this.options.storageKey);const n=this.currentStorage.get("sessionId");if(this.sessionManager=new We({sessionServerBaseUrl:this.options.storageServerUrl,sessionNamespace:this.options.sessionNamespace,sessionTime:this.options.sessionTime,sessionId:n}),this.options.network!==b.TESTNET&&this.options.network!==b.SAPPHIRE_DEVNET||br.log(`%c WARNING! You are on ${this.options.network}. Please set network: 'mainnet' or 'sapphire_mainnet' in production`,"color: #FF0000"),this.options.buildEnv!==_.PRODUCTION&&br.log(`%c WARNING! You are using build env ${this.options.buildEnv}. Please set buildEnv: 'production' in production`,"color: #FF0000"),e.error)throw this.dappState=e.state,vr.loginFailed(e.error);if(e.sessionId&&(this.currentStorage.set("sessionId",e.sessionId),this.sessionManager.sessionId=e.sessionId),this.sessionManager.sessionId){const e=await this._authorizeSession();this.updateState(e),0===Object.keys(e).length&&this.currentStorage.set("sessionId","")}}async login(e){if(!e.loginProvider)throw vr.invalidLoginParams("loginProvider is required");const t={redirectUrl:this.options.redirectUrl},n=(0,a.Z)((0,a.Z)({loginProvider:e.loginProvider},t),e),r={actionType:v.LOGIN,options:this.options,params:n},i=await this.openloginHandler(`${this.baseUrl}/start`,r,Nr(e.loginProvider));if(this.options.uxMode===y.REDIRECT)return null;if(i.error)throw this.dappState=i.state,vr.loginFailed(i.error);return this.sessionManager.sessionId=i.sessionId,this.options.sessionNamespace=i.sessionNamespace,this.currentStorage.set("sessionId",i.sessionId),await this.rehydrateSession(),{privKey:this.privKey}}async logout(){if(!this.sessionManager.sessionId)throw vr.userNotLoggedIn();await this.sessionManager.invalidateSession(),this.updateState({privKey:"",coreKitKey:"",coreKitEd25519PrivKey:"",ed25519PrivKey:"",walletKey:"",oAuthPrivateKey:"",tKey:"",metadataNonce:"",keyMode:void 0,userInfo:{name:"",profileImage:"",dappShare:"",idToken:"",oAuthIdToken:"",oAuthAccessToken:"",appState:"",email:"",verifier:"",verifierId:"",aggregateVerifier:"",typeOfLogin:"",isMfaEnabled:!1},authToken:"",sessionId:"",factorKey:"",signatures:[],tssShareIndex:-1,tssPubKey:"",tssShare:"",tssNonce:-1}),this.currentStorage.set("sessionId","")}async setupMFA(e){if(!this.sessionId)throw vr.userNotLoggedIn();const t={redirectUrl:this.options.redirectUrl},n={actionType:v.ENABLE_MFA,options:this.options,params:(0,a.Z)((0,a.Z)({},t),e),sessionId:this.sessionId},r=await this.openloginHandler(`${this.baseUrl}/start`,n);if(this.options.uxMode!==y.REDIRECT)return this.sessionManager.sessionId=r.sessionId,this.options.sessionNamespace=r.sessionNamespace,this.currentStorage.set("sessionId",r.sessionId),await this.rehydrateSession(),!0}async changeSocialFactor(e){if(!this.sessionId)throw vr.userNotLoggedIn();const t={redirectUrl:this.options.redirectUrl},n={actionType:v.MODIFY_MFA,options:this.options,params:(0,a.Z)((0,a.Z)({},t),e),sessionId:this.sessionId},r=await this.openloginHandler(`${this.baseUrl}/start`,n);if(this.options.uxMode!==y.REDIRECT)return this.sessionManager.sessionId=r.sessionId,this.options.sessionNamespace=r.sessionNamespace,this.currentStorage.set("sessionId",r.sessionId),await this.rehydrateSession(),!0}getUserInfo(){if(!this.sessionManager.sessionId)throw vr.userNotLoggedIn();return this.state.userInfo}async getLoginId(e){if(!this.sessionManager)throw wr.notInitialized();const t=We.generateRandomSessionKey(),n=new We({sessionServerBaseUrl:this.options.storageServerUrl,sessionNamespace:this.options.sessionNamespace,sessionTime:600,sessionId:t});return await n.createSession(JSON.parse(JSON.stringify(e))),t}async _authorizeSession(){try{if(!this.sessionManager.sessionId)return{};const e=await this.sessionManager.authorizeSession();return e}catch(ri){return _r.error("authorization failed",ri),{}}}updateState(e){this.state=(0,a.Z)((0,a.Z)({},this.state),e)}async rehydrateSession(){const e=await this._authorizeSession();this.updateState(e)}async openloginHandler(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e4;const r=await this.getLoginId(t),i={loginId:r,sessionNamespace:this.options.sessionNamespace};if(this.options.uxMode!==y.REDIRECT)return new Promise(((t,o)=>{const s=Rr({baseURL:e,hash:{b64Params:u(i)}}),a=new Tr({url:s,timeout:n});a.on("close",(()=>{o(vr.popupClosed())})),a.listenOnChannel(r).then(t).catch(o);try{a.open()}catch(l){o(l)}}));{const t=Rr({baseURL:e,hash:{b64Params:u(i)}});window.location.href=t}}}n(76034),n(42140),n(25383),n(72620),n(38901),n(19157),n(46568);function Ir(e,t,n){try{Reflect.apply(e,t,n)}catch(ri){setTimeout((()=>{throw ri}))}}function Or(e){const t=e.length,n=new Array(t);for(let r=0;r<t;r+=1)n[r]=e[r];return n}class Pr extends dr.EventEmitter{emit(e){let t="error"===e;const n=this._events;if(void 0!==n)t=t&&void 0===n.error;else if(!t)return!1;for(var r=arguments.length,i=new Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];if(t){let e;if(i.length>0&&([e]=i),e instanceof Error)throw e;const t=new Error("Unhandled error."+(e?` (${e.message})`:""));throw t.context=e,t}const s=n[e];if(void 0===s)return!1;if("function"===typeof s)Ir(s,this,i);else{const e=s.length,t=Or(s);for(let n=0;n<e;n+=1)Ir(t[n],this,i)}return!0}}Symbol("IGNORE_SUBSTREAM");const xr=R().getLogger("http-helpers");xr.setLevel(S.levels.INFO);n(13429);class Lr extends Error{}Lr.prototype.name="InvalidTokenError";const Dr={EIP155:"eip155",SOLANA:"solana",OTHER:"other"},Mr={EIP155:"eip155",SOLANA:"solana",XRPL:"xrpl",MULTICHAIN:"multichain"},Br=e=>{if(e===Dr.EIP155)return 1;if(e===Dr.SOLANA)return 1;throw new Error(`Chain namespace ${e} is not supported`)},Ur=e=>{const t=Dr.EIP155;return 1===e?{chainNamespace:t,chainId:"0x1",rpcTarget:"https://rpc.ankr.com/eth",displayName:"Ethereum Mainnet",blockExplorer:"https://etherscan.io/",ticker:"ETH",tickerName:"Ethereum",decimals:18}:5===e?{chainNamespace:t,chainId:"0x5",rpcTarget:"https://rpc.ankr.com/eth_goerli",displayName:"Goerli Testnet",blockExplorer:"https://goerli.etherscan.io/",ticker:"ETH",tickerName:"Ethereum",decimals:18}:11155111===e?{chainNamespace:t,chainId:"0xaa36a7",rpcTarget:"https://rpc.ankr.com/eth_sepolia",displayName:"Sepolia Testnet",blockExplorer:"https://sepolia.etherscan.io/",ticker:"ETH",tickerName:"Ethereum",decimals:18}:137===e?{chainNamespace:t,chainId:"0x89",rpcTarget:"https://rpc.ankr.com/polygon",displayName:"Polygon Mainnet",blockExplorer:"https://polygonscan.com",ticker:"MATIC",tickerName:"Polygon"}:80001===e?{chainNamespace:t,chainId:"0x13881",rpcTarget:"https://rpc.ankr.com/polygon_mumbai",displayName:"Polygon Mumbai Testnet",blockExplorer:"https://mumbai.polygonscan.com/",ticker:"MATIC",tickerName:"Polygon",decimals:18}:56===e?{chainNamespace:t,chainId:"0x38",rpcTarget:"https://rpc.ankr.com/bsc",displayName:"Binance SmartChain Mainnet",blockExplorer:"https://bscscan.com",ticker:"BNB",tickerName:"Binance SmartChain",decimals:18}:97===e?{chainNamespace:t,chainId:"0x61",rpcTarget:"https://rpc.ankr.com/bsc_testnet_chapel",displayName:"Binance SmartChain Testnet",blockExplorer:"https://testnet.bscscan.com",ticker:"BNB",tickerName:"Binance SmartChain",decimals:18}:25===e?{chainNamespace:t,chainId:"0x19",rpcTarget:"https://rpc.cronos.org",displayName:"Cronos Mainnet",blockExplorer:"https://cronoscan.com/",ticker:"CRO",tickerName:"Cronos"}:338===e?{chainNamespace:t,chainId:"0x152",rpcTarget:"https://rpc-t3.cronos.org/",displayName:"Cronos Testnet",blockExplorer:"https://cronoscan.com/",ticker:"CRO",tickerName:"Cronos",decimals:18}:8217===e?{chainNamespace:t,chainId:"0x2019",rpcTarget:"https://public-node-api.klaytnapi.com/v1/cypress",displayName:"Klaytn Mainnet",blockExplorer:"https://scope.klaytn.com",ticker:"KLAY",tickerName:"Klaytn",decimals:18}:null},jr=e=>{const t=Dr.SOLANA;return 1===e?{chainNamespace:t,chainId:"0x1",rpcTarget:"https://rpc.ankr.com/solana",displayName:"Solana Mainnet",blockExplorer:"https://explorer.solana.com",ticker:"SOL",tickerName:"Solana",decimals:9}:2===e?{chainNamespace:t,chainId:"0x2",rpcTarget:"https://api.testnet.solana.com",displayName:"Solana Testnet",blockExplorer:"https://explorer.solana.com?cluster=testnet",ticker:"SOL",tickerName:"Solana",decimals:9}:3===e?{chainNamespace:t,chainId:"0x3",rpcTarget:"https://api.devnet.solana.com",displayName:"Solana Devnet",blockExplorer:"https://explorer.solana.com?cluster=devnet",ticker:"SOL",tickerName:"Solana",decimals:9}:null},Kr=(e,t)=>{if(e===Dr.OTHER)return null;const n=t?"number"===typeof t?t:parseInt(t,16):Br(e);return e===Dr.EIP155?Ur(n):e===Dr.SOLANA?jr(n):null};class Wr extends E.s{constructor(e,t){super(t),(0,i.Z)(this,"code",void 0),(0,i.Z)(this,"message",void 0),this.code=e,this.message=t||"",Object.defineProperty(this,"name",{value:"Web3AuthError"})}toJSON(){return{name:this.name,code:this.code,message:this.message}}toString(){return JSON.stringify(this.toJSON())}}class Fr extends Wr{constructor(e,t){super(e,t),Object.defineProperty(this,"name",{value:"WalletInitializationError"})}static fromCode(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return new Fr(e,`${Fr.messages[e]}, ${t}`)}static notFound(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return Fr.fromCode(5001,e)}static notInstalled(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return Fr.fromCode(5002,e)}static notReady(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return Fr.fromCode(5003,e)}static windowBlocked(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return Fr.fromCode(5004,e)}static windowClosed(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return Fr.fromCode(5005,e)}static incompatibleChainNameSpace(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return Fr.fromCode(5006,e)}static duplicateAdapterError(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return Fr.fromCode(5007,e)}static invalidProviderConfigError(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return Fr.fromCode(5008,e)}static providerNotReadyError(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return Fr.fromCode(5009,e)}static rpcConnectionError(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return Fr.fromCode(5010,e)}static invalidParams(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return Fr.fromCode(5011,e)}static invalidNetwork(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return Fr.fromCode(5013,e)}}(0,i.Z)(Fr,"messages",{5e3:"Custom",5001:"Wallet is not found",5002:"Wallet is not installed",5003:"Wallet is not ready yet",5004:"Wallet window is blocked",5005:"Wallet window has been closed by the user",5006:"Incompatible chain namespace provided",5007:"Adapter has already been included",5008:"Invalid provider Config",5009:"Provider is not ready yet",5010:"Failed to connect with rpc url",5011:"Invalid params passed in",5013:"Invalid network provided"});class $r extends Wr{constructor(e,t){super(e,t),Object.defineProperty(this,"name",{value:"WalletLoginError"})}static fromCode(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return new $r(e,`${$r.messages[e]}. ${t}`)}static connectionError(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return $r.fromCode(5111,e)}static disconnectionError(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return $r.fromCode(5112,e)}static notConnectedError(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return $r.fromCode(5113,e)}static popupClosed(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return $r.fromCode(5114,e)}static mfaEnabled(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return $r.fromCode(5115,e)}static chainConfigNotAdded(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return $r.fromCode(5116,e)}static unsupportedOperation(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return $r.fromCode(5117,e)}static coreKitKeyNotFound(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return $r.fromCode(5118,e)}static userNotLoggedIn(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return $r.fromCode(5119,e)}}(0,i.Z)($r,"messages",{5e3:"Custom",5111:"Failed to connect with wallet",5112:"Failed to disconnect from wallet",5113:"Wallet is not connected",5114:"Wallet popup has been closed by the user",5115:"User has already enabled mfa, please use the @web3auth/web3auth-web sdk for login with mfa",5116:"Chain config has not been added. Please add the chain config before calling switchChain",5117:"Unsupported operation",5118:"useCoreKitKey flag is enabled but coreKitKey is not available",5119:"User not logged in."});class qr extends Wr{constructor(e,t){super(e,t),Object.defineProperty(this,"name",{value:"WalletOperationsError"})}static fromCode(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return new qr(e,`${qr.messages[e]}, ${t}`)}static chainIDNotAllowed(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return qr.fromCode(5201,e)}static operationNotAllowed(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return qr.fromCode(5202,e)}static chainNamespaceNotAllowed(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return qr.fromCode(5203,e)}}(0,i.Z)(qr,"messages",{5e3:"Custom",5201:"Provided chainId is not allowed",5202:"This operation is not allowed"});class Zr extends Wr{constructor(e,t){super(e,t),Object.defineProperty(this,"name",{value:"WalletProviderError"})}static fromCode(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return new qr(e,`${Zr.messages[e]}, ${t}`)}static invalidRequestArgs(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return qr.fromCode(5301,e)}static invalidRequestMethod(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return qr.fromCode(5302,e)}static invalidRequestParams(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return qr.fromCode(5303,e)}}(0,i.Z)(Zr,"messages",{5e3:"Custom",5301:"Expected a single, non-array, object argument.",5302:"'args.method' must be a non-empty string.",5303:"'args.params' must be an object or array if provided."});const Hr={OPENLOGIN:"openlogin",WALLET_CONNECT_V2:"wallet-connect-v2"},Vr=(0,a.Z)({TORUS_SOLANA:"torus-solana",PHANTOM:"phantom",SOLFLARE:"solflare",SLOPE:"slope"},Hr),Gr=(0,a.Z)({TORUS_EVM:"torus-evm",METAMASK:"metamask",COINBASE:"coinbase"},Hr),Yr=(0,a.Z)((0,a.Z)({},Gr),Vr),Jr=(Hr.OPENLOGIN,Hr.WALLET_CONNECT_V2,Vr.TORUS_SOLANA,Vr.PHANTOM,Vr.SOLFLARE,Vr.SLOPE,Gr.TORUS_EVM,Gr.METAMASK,Gr.COINBASE,{EXTERNAL:"external",IN_APP:"in_app"}),zr={NOT_READY:"not_ready",READY:"ready",CONNECTING:"connecting",CONNECTED:"connected",DISCONNECTED:"disconnected",ERRORED:"errored"},Xr=(0,a.Z)((0,a.Z)({},zr),{},{ADAPTER_DATA_UPDATED:"adapter_data_updated",CACHE_CLEAR:"cache_clear"});class Qr extends Pr{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(),(0,i.Z)(this,"adapterData",{}),(0,i.Z)(this,"sessionTime",86400),(0,i.Z)(this,"clientId",void 0),(0,i.Z)(this,"web3AuthNetwork",b.MAINNET),(0,i.Z)(this,"rehydrated",!1),(0,i.Z)(this,"chainConfig",null),(0,i.Z)(this,"knownChainConfigs",{}),(0,i.Z)(this,"adapterNamespace",void 0),(0,i.Z)(this,"currentChainNamespace",void 0),(0,i.Z)(this,"type",void 0),(0,i.Z)(this,"name",void 0),(0,i.Z)(this,"status",void 0),this.setAdapterSettings(e)}get chainConfigProxy(){return this.chainConfig?(0,a.Z)({},this.chainConfig):null}get connnected(){return this.status===zr.CONNECTED}setAdapterSettings(e){if(this.status===zr.READY)return;null!==e&&void 0!==e&&e.sessionTime&&(this.sessionTime=e.sessionTime),null!==e&&void 0!==e&&e.clientId&&(this.clientId=e.clientId),null!==e&&void 0!==e&&e.web3AuthNetwork&&(this.web3AuthNetwork=e.web3AuthNetwork);const t=e.chainConfig;if(t){if(!t.chainNamespace)throw Fr.notReady("ChainNamespace is required while setting chainConfig");this.currentChainNamespace=t.chainNamespace;const e=Kr(t.chainNamespace,t.chainId),n=(0,a.Z)((0,a.Z)({},e||{}),t);this.chainConfig=n,this.addChainConfig(n)}}checkConnectionRequirements(){if(this.name!==Yr.WALLET_CONNECT_V2||this.status!==zr.CONNECTING){if(this.status===zr.CONNECTING)throw Fr.notReady("Already connecting");if(this.status===zr.CONNECTED)throw $r.connectionError("Already connected");if(this.status!==zr.READY)throw $r.connectionError("Wallet adapter is not ready yet, Please wait for init function to resolve before calling connect/connectTo function")}}checkInitializationRequirements(){if(!this.clientId)throw Fr.invalidParams("Please initialize Web3Auth with a valid clientId in constructor");if(!this.chainConfig)throw Fr.invalidParams("rpcTarget is required in chainConfig");if(!this.chainConfig.rpcTarget&&this.chainConfig.chainNamespace!==Dr.OTHER)throw Fr.invalidParams("rpcTarget is required in chainConfig");if(!this.chainConfig.chainId&&this.chainConfig.chainNamespace!==Dr.OTHER)throw Fr.invalidParams("chainID is required in chainConfig");if(this.status!==zr.NOT_READY){if(this.status===zr.CONNECTED)throw Fr.notReady("Already connected");if(this.status===zr.READY)throw Fr.notReady("Adapter is already initialized")}}checkDisconnectionRequirements(){if(this.status!==zr.CONNECTED)throw $r.disconnectionError("Not connected with wallet")}checkAddChainRequirements(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!t&&!this.provider)throw $r.notConnectedError("Not connected with wallet.");if(this.currentChainNamespace!==e.chainNamespace)throw qr.chainNamespaceNotAllowed("This adapter doesn't support this chainNamespace")}checkSwitchChainRequirements(e){let{chainId:t}=e,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!n&&!this.provider)throw $r.notConnectedError("Not connected with wallet.");if(!this.knownChainConfigs[t])throw $r.chainConfigNotAdded("Invalid chainId")}updateAdapterData(e){this.adapterData=e,this.emit(Xr.ADAPTER_DATA_UPDATED,{adapterName:this.name,data:e})}addChainConfig(e){const t=this.knownChainConfigs[e.chainId];this.knownChainConfigs[e.chainId]=(0,a.Z)((0,a.Z)({},t||{}),e)}getChainConfig(e){return this.knownChainConfigs[e]||null}}var ei=R().getLogger("web3auth-logger");const ti=()=>({adapterSettings:{network:b.SAPPHIRE_MAINNET,clientId:"",uxMode:y.POPUP},loginSettings:{},privateKeyProvider:void 0});class ni extends Qr{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(e),(0,i.Z)(this,"name",Yr.OPENLOGIN),(0,i.Z)(this,"adapterNamespace",Mr.MULTICHAIN),(0,i.Z)(this,"type",Jr.IN_APP),(0,i.Z)(this,"openloginInstance",null),(0,i.Z)(this,"status",zr.NOT_READY),(0,i.Z)(this,"currentChainNamespace",Dr.EIP155),(0,i.Z)(this,"privateKeyProvider",null),(0,i.Z)(this,"openloginOptions",void 0),(0,i.Z)(this,"loginSettings",{loginProvider:""}),this.setAdapterSettings((0,a.Z)((0,a.Z)({},e.adapterSettings),{},{chainConfig:e.chainConfig,clientId:e.clientId||"",sessionTime:e.sessionTime,web3AuthNetwork:e.web3AuthNetwork,useCoreKitKey:e.useCoreKitKey,privateKeyProvider:e.privateKeyProvider})),this.loginSettings=e.loginSettings||{loginProvider:""},this.privateKeyProvider=e.privateKeyProvider||null}get chainConfigProxy(){return this.chainConfig?(0,a.Z)({},this.chainConfig):null}get provider(){return this.status!==zr.NOT_READY&&this.privateKeyProvider?this.privateKeyProvider:null}set provider(e){throw new Error("Not implemented")}async init(e){if(super.checkInitializationRequirements(),!this.clientId)throw Fr.invalidParams("clientId is required before openlogin's initialization");if(!this.openloginOptions)throw Fr.invalidParams("openloginOptions is required before openlogin's initialization");const t=this.openloginOptions.uxMode===y.REDIRECT;if(this.openloginOptions=(0,a.Z)((0,a.Z)({},this.openloginOptions),{},{replaceUrlOnRedirect:t}),this.openloginInstance=new Cr((0,a.Z)((0,a.Z)({},this.openloginOptions),{},{clientId:this.clientId,network:this.openloginOptions.network||this.web3AuthNetwork||b.SAPPHIRE_MAINNET})),ei.debug("initializing openlogin adapter init"),await this.openloginInstance.init(),!this.chainConfig)throw Fr.invalidParams("chainConfig is required before initialization");this.status=zr.READY,this.emit(Xr.READY,Yr.OPENLOGIN);try{ei.debug("initializing openlogin adapter");const n=this._getFinalPrivKey();n&&(e.autoConnect||t)&&(this.rehydrated=!0,await this.connect())}catch(n){ei.error("Failed to connect with cached openlogin provider",n),this.emit("ERRORED",n)}}async connect(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{loginProvider:""};super.checkConnectionRequirements(),this.status=zr.CONNECTING,this.emit(Xr.CONNECTING,(0,a.Z)((0,a.Z)({},e),{},{adapter:Yr.OPENLOGIN}));try{return await this.connectWithProvider(e),this.provider}catch(t){if(ei.error("Failed to connect with openlogin provider",t),this.status=zr.READY,this.emit(Xr.ERRORED,t),null!==t&&void 0!==t&&t.message.includes("user closed popup"))throw $r.popupClosed();if(t instanceof Wr)throw t;throw $r.connectionError("Failed to login with openlogin")}}async disconnect(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{cleanup:!1};if(this.status!==zr.CONNECTED)throw $r.notConnectedError("Not connected with wallet");if(!this.openloginInstance)throw Fr.notReady("openloginInstance is not ready");await this.openloginInstance.logout(),e.cleanup?(this.status=zr.NOT_READY,this.openloginInstance=null,this.privateKeyProvider=null):this.status=zr.READY,this.rehydrated=!1,this.emit(Xr.DISCONNECTED)}async authenticateUser(){if(this.status!==zr.CONNECTED)throw $r.notConnectedError("Not connected with wallet, Please login/connect first");const e=await this.getUserInfo();return{idToken:e.idToken}}async getUserInfo(){if(this.status!==zr.CONNECTED)throw $r.notConnectedError("Not connected with wallet");if(!this.openloginInstance)throw Fr.notReady("openloginInstance is not ready");const e=this.openloginInstance.getUserInfo();return e}setAdapterSettings(e){super.setAdapterSettings(e);const t=ti();ei.info("setting adapter settings",e),this.openloginOptions=(0,a.Z)((0,a.Z)((0,a.Z)({},t.adapterSettings),this.openloginOptions),e),e.web3AuthNetwork&&(this.openloginOptions.network=e.web3AuthNetwork),void 0!==e.useCoreKitKey&&(this.openloginOptions.useCoreKitKey=e.useCoreKitKey),e.privateKeyProvider&&(this.privateKeyProvider=e.privateKeyProvider)}async addChain(e){var t;let n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];super.checkAddChainRequirements(e,n),null===(t=this.privateKeyProvider)||void 0===t||t.addChain(e),this.addChainConfig(e)}async switchChain(e){var t;let n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];super.checkSwitchChainRequirements(e,n),await(null===(t=this.privateKeyProvider)||void 0===t?void 0:t.switchChain(e)),this.setAdapterSettings({chainConfig:this.getChainConfig(e.chainId)})}_getFinalPrivKey(){var e;if(!this.openloginInstance)return"";let t=this.openloginInstance.privKey;if(null!==(e=this.openloginOptions)&&void 0!==e&&e.useCoreKitKey){if(this.openloginInstance.privKey&&!this.openloginInstance.coreKitKey)throw $r.coreKitKeyNotFound();t=this.openloginInstance.coreKitKey}return t}_getFinalEd25519PrivKey(){var e;if(!this.openloginInstance)return"";let t=this.openloginInstance.ed25519PrivKey;if(null!==(e=this.openloginOptions)&&void 0!==e&&e.useCoreKitKey){if(this.openloginInstance.ed25519PrivKey&&!this.openloginInstance.coreKitEd25519Key)throw $r.coreKitKeyNotFound();t=this.openloginInstance.coreKitEd25519Key}return t}async connectWithProvider(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{loginProvider:""};if(!this.privateKeyProvider)throw Fr.invalidParams("PrivateKey Provider is required before initialization");if(!this.openloginInstance)throw Fr.notReady("openloginInstance is not ready");const n=this._getFinalPrivKey();if(!n||null!==(e=t.extraLoginOptions)&&void 0!==e&&e.id_token){var r;if(this.loginSettings.curve||(this.loginSettings.curve=this.currentChainNamespace===Dr.SOLANA?m.ED25519:m.SECP256K1),!t.loginProvider&&!this.loginSettings.loginProvider)throw Fr.invalidParams("loginProvider is required for login");await this.openloginInstance.login(k()(this.loginSettings,t,{extraLoginOptions:(0,a.Z)((0,a.Z)({},t.extraLoginOptions||{}),{},{login_hint:t.login_hint||(null===(r=t.extraLoginOptions)||void 0===r?void 0:r.login_hint)})}))}let i=this._getFinalPrivKey();i&&(this.currentChainNamespace===Dr.SOLANA&&(i=this._getFinalEd25519PrivKey()),await this.privateKeyProvider.setupProvider(i),this.status=zr.CONNECTED,this.emit(Xr.CONNECTED,{adapter:Yr.OPENLOGIN,reconnected:this.rehydrated}))}}},76665:(e,t,n)=>{"use strict";const{AbortError:r,codes:i}=n(49293),{isNodeStream:o,isWebStream:s,kControllerErrorFunction:a}=n(49888),l=n(40701),{ERR_INVALID_ARG_TYPE:c}=i,d=(e,t)=>{if("object"!==typeof e||!("aborted"in e))throw new c(t,"AbortSignal",e)};e.exports.addAbortSignal=function(t,n){if(d(t,"signal"),!o(n)&&!s(n))throw new c("stream",["ReadableStream","WritableStream","Stream"],n);return e.exports.addAbortSignalNoValidate(t,n)},e.exports.addAbortSignalNoValidate=function(e,t){if("object"!==typeof e||!("aborted"in e))return t;const n=o(t)?()=>{t.destroy(new r(void 0,{cause:e.reason}))}:()=>{t[a](new r(void 0,{cause:e.reason}))};return e.aborted?n():(e.addEventListener("abort",n),l(t,(()=>e.removeEventListener("abort",n)))),t}},52727:(e,t,n)=>{"use strict";n(86544);const{StringPrototypeSlice:r,SymbolIterator:i,TypedArrayPrototypeSet:o,Uint8Array:s}=n(17594),{Buffer:a}=n(15361),{inspect:l}=n(81125);e.exports=class{constructor(){this.head=null,this.tail=null,this.length=0}push(e){const t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length}unshift(e){const t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length}shift(){if(0===this.length)return;const e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}clear(){this.head=this.tail=null,this.length=0}join(e){if(0===this.length)return"";let t=this.head,n=""+t.data;while(null!==(t=t.next))n+=e+t.data;return n}concat(e){if(0===this.length)return a.alloc(0);const t=a.allocUnsafe(e>>>0);let n=this.head,r=0;while(n)o(t,n.data,r),r+=n.data.length,n=n.next;return t}consume(e,t){const n=this.head.data;if(e<n.length){const t=n.slice(0,e);return this.head.data=n.slice(e),t}return e===n.length?this.shift():t?this._getString(e):this._getBuffer(e)}first(){return this.head.data}*[i](){for(let e=this.head;e;e=e.next)yield e.data}_getString(e){let t="",n=this.head,i=0;do{const o=n.data;if(!(e>o.length)){e===o.length?(t+=o,++i,n.next?this.head=n.next:this.head=this.tail=null):(t+=r(o,0,e),this.head=n,n.data=r(o,e));break}t+=o,e-=o.length,++i}while(null!==(n=n.next));return this.length-=i,t}_getBuffer(e){const t=a.allocUnsafe(e),n=e;let r=this.head,i=0;do{const a=r.data;if(!(e>a.length)){e===a.length?(o(t,a,n-e),++i,r.next?this.head=r.next:this.head=this.tail=null):(o(t,new s(a.buffer,a.byteOffset,e),n-e),this.head=r,r.data=a.slice(e));break}o(t,a,n-e),e-=a.length,++i}while(null!==(r=r.next));return this.length-=i,t}[Symbol.for("nodejs.util.inspect.custom")](e,t){return l(this,{...t,depth:0,customInspect:!1})}}},92431:(e,t,n)=>{"use strict";n(70560);const{pipeline:r}=n(55918),i=n(59910),{destroyer:o}=n(68818),{isNodeStream:s,isReadable:a,isWritable:l,isWebStream:c,isTransformStream:d,isWritableStream:h,isReadableStream:u}=n(49888),{AbortError:f,codes:{ERR_INVALID_ARG_VALUE:p,ERR_MISSING_ARGS:g}}=n(49293),y=n(40701);e.exports=function(...e){if(0===e.length)throw new g("streams");if(1===e.length)return i.from(e[0]);const t=[...e];if("function"===typeof e[0]&&(e[0]=i.from(e[0])),"function"===typeof e[e.length-1]){const t=e.length-1;e[t]=i.from(e[t])}for(let r=0;r<e.length;++r)if(s(e[r])||c(e[r])){if(r<e.length-1&&!(a(e[r])||u(e[r])||d(e[r])))throw new p(`streams[${r}]`,t[r],"must be readable");if(r>0&&!(l(e[r])||h(e[r])||d(e[r])))throw new p(`streams[${r}]`,t[r],"must be writable")}let n,b,m,w,v;function _(e){const t=w;w=null,t?t(e):e?v.destroy(e):A||R||v.destroy()}const E=e[0],S=r(e,_),R=!!(l(E)||h(E)||d(E)),A=!!(a(S)||u(S)||d(S));if(v=new i({writableObjectMode:!(null===E||void 0===E||!E.writableObjectMode),readableObjectMode:!(null===S||void 0===S||!S.writableObjectMode),writable:R,readable:A}),R){if(s(E))v._write=function(e,t,r){E.write(e,t)?r():n=r},v._final=function(e){E.end(),b=e},E.on("drain",(function(){if(n){const e=n;n=null,e()}}));else if(c(E)){const e=d(E)?E.writable:E,t=e.getWriter();v._write=async function(e,n,r){try{await t.ready,t.write(e).catch((()=>{})),r()}catch(i){r(i)}},v._final=async function(e){try{await t.ready,t.close().catch((()=>{})),b=e}catch(n){e(n)}}}const e=d(S)?S.readable:S;y(e,(()=>{if(b){const e=b;b=null,e()}}))}if(A)if(s(S))S.on("readable",(function(){if(m){const e=m;m=null,e()}})),S.on("end",(function(){v.push(null)})),v._read=function(){while(1){const e=S.read();if(null===e)return void(m=v._read);if(!v.push(e))return}};else if(c(S)){const e=d(S)?S.readable:S,t=e.getReader();v._read=async function(){while(1)try{const{value:e,done:n}=await t.read();if(!v.push(e))return;if(n)return void v.push(null)}catch{return}}}return v._destroy=function(e,t){e||null===w||(e=new f),m=null,n=null,b=null,null===w?t(e):(w=t,s(S)&&o(S,e))},v}},68818:(e,t,n)=>{"use strict";const r=n(96027),{aggregateTwoErrors:i,codes:{ERR_MULTIPLE_CALLBACK:o},AbortError:s}=n(49293),{Symbol:a}=n(17594),{kDestroyed:l,isDestroyed:c,isFinished:d,isServerRequest:h}=n(49888),u=a("kDestroy"),f=a("kConstruct");function p(e,t,n){e&&(e.stack,t&&!t.errored&&(t.errored=e),n&&!n.errored&&(n.errored=e))}function g(e,t){const n=this._readableState,r=this._writableState,o=r||n;return null!==r&&void 0!==r&&r.destroyed||null!==n&&void 0!==n&&n.destroyed?("function"===typeof t&&t(),this):(p(e,r,n),r&&(r.destroyed=!0),n&&(n.destroyed=!0),o.constructed?y(this,e,t):this.once(u,(function(n){y(this,i(n,e),t)})),this)}function y(e,t,n){let i=!1;function o(t){if(i)return;i=!0;const o=e._readableState,s=e._writableState;p(t,s,o),s&&(s.closed=!0),o&&(o.closed=!0),"function"===typeof n&&n(t),t?r.nextTick(b,e,t):r.nextTick(m,e)}try{e._destroy(t||null,o)}catch(t){o(t)}}function b(e,t){w(e,t),m(e)}function m(e){const t=e._readableState,n=e._writableState;n&&(n.closeEmitted=!0),t&&(t.closeEmitted=!0),(null!==n&&void 0!==n&&n.emitClose||null!==t&&void 0!==t&&t.emitClose)&&e.emit("close")}function w(e,t){const n=e._readableState,r=e._writableState;null!==r&&void 0!==r&&r.errorEmitted||null!==n&&void 0!==n&&n.errorEmitted||(r&&(r.errorEmitted=!0),n&&(n.errorEmitted=!0),e.emit("error",t))}function v(){const e=this._readableState,t=this._writableState;e&&(e.constructed=!0,e.closed=!1,e.closeEmitted=!1,e.destroyed=!1,e.errored=null,e.errorEmitted=!1,e.reading=!1,e.ended=!1===e.readable,e.endEmitted=!1===e.readable),t&&(t.constructed=!0,t.destroyed=!1,t.closed=!1,t.closeEmitted=!1,t.errored=null,t.errorEmitted=!1,t.finalCalled=!1,t.prefinished=!1,t.ended=!1===t.writable,t.ending=!1===t.writable,t.finished=!1===t.writable)}function _(e,t,n){const i=e._readableState,o=e._writableState;if(null!==o&&void 0!==o&&o.destroyed||null!==i&&void 0!==i&&i.destroyed)return this;null!==i&&void 0!==i&&i.autoDestroy||null!==o&&void 0!==o&&o.autoDestroy?e.destroy(t):t&&(t.stack,o&&!o.errored&&(o.errored=t),i&&!i.errored&&(i.errored=t),n?r.nextTick(w,e,t):w(e,t))}function E(e,t){if("function"!==typeof e._construct)return;const n=e._readableState,i=e._writableState;n&&(n.constructed=!1),i&&(i.constructed=!1),e.once(f,t),e.listenerCount(f)>1||r.nextTick(S,e)}function S(e){let t=!1;function n(n){if(t)return void _(e,null!==n&&void 0!==n?n:new o);t=!0;const i=e._readableState,s=e._writableState,a=s||i;i&&(i.constructed=!0),s&&(s.constructed=!0),a.destroyed?e.emit(u,n):n?_(e,n,!0):r.nextTick(R,e)}try{e._construct((e=>{r.nextTick(n,e)}))}catch(i){r.nextTick(n,i)}}function R(e){e.emit(f)}function A(e){return(null===e||void 0===e?void 0:e.setHeader)&&"function"===typeof e.abort}function k(e){e.emit("close")}function N(e,t){e.emit("error",t),r.nextTick(k,e)}function T(e,t){e&&!c(e)&&(t||d(e)||(t=new s),h(e)?(e.socket=null,e.destroy(t)):A(e)?e.abort():A(e.req)?e.req.abort():"function"===typeof e.destroy?e.destroy(t):"function"===typeof e.close?e.close():t?r.nextTick(N,e,t):r.nextTick(k,e),e.destroyed||(e[l]=!0))}e.exports={construct:E,destroyer:T,destroy:g,undestroy:v,errorOrDestroy:_}},59910:(e,t,n)=>{"use strict";const{ObjectDefineProperties:r,ObjectGetOwnPropertyDescriptor:i,ObjectKeys:o,ObjectSetPrototypeOf:s}=n(17594);e.exports=c;const a=n(67180),l=n(76558);s(c.prototype,a.prototype),s(c,a);{const e=o(l.prototype);for(let t=0;t<e.length;t++){const n=e[t];c.prototype[n]||(c.prototype[n]=l.prototype[n])}}function c(e){if(!(this instanceof c))return new c(e);a.call(this,e),l.call(this,e),e?(this.allowHalfOpen=!1!==e.allowHalfOpen,!1===e.readable&&(this._readableState.readable=!1,this._readableState.ended=!0,this._readableState.endEmitted=!0),!1===e.writable&&(this._writableState.writable=!1,this._writableState.ending=!0,this._writableState.ended=!0,this._writableState.finished=!0)):this.allowHalfOpen=!0}let d,h;function u(){return void 0===d&&(d={}),d}r(c.prototype,{writable:{__proto__:null,...i(l.prototype,"writable")},writableHighWaterMark:{__proto__:null,...i(l.prototype,"writableHighWaterMark")},writableObjectMode:{__proto__:null,...i(l.prototype,"writableObjectMode")},writableBuffer:{__proto__:null,...i(l.prototype,"writableBuffer")},writableLength:{__proto__:null,...i(l.prototype,"writableLength")},writableFinished:{__proto__:null,...i(l.prototype,"writableFinished")},writableCorked:{__proto__:null,...i(l.prototype,"writableCorked")},writableEnded:{__proto__:null,...i(l.prototype,"writableEnded")},writableNeedDrain:{__proto__:null,...i(l.prototype,"writableNeedDrain")},destroyed:{__proto__:null,get(){return void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed&&this._writableState.destroyed)},set(e){this._readableState&&this._writableState&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}}}),c.fromWeb=function(e,t){return u().newStreamDuplexFromReadableWritablePair(e,t)},c.toWeb=function(e){return u().newReadableWritablePairFromDuplex(e)},c.from=function(e){return h||(h=n(88013)),h(e,"body")}},88013:(e,t,n)=>{n(45398),n(70560);const r=n(96027),i=n(15361),{isReadable:o,isWritable:s,isIterable:a,isNodeStream:l,isReadableNodeStream:c,isWritableNodeStream:d,isDuplexNodeStream:h}=n(49888),u=n(40701),{AbortError:f,codes:{ERR_INVALID_ARG_TYPE:p,ERR_INVALID_RETURN_VALUE:g}}=n(49293),{destroyer:y}=n(68818),b=n(59910),m=n(67180),{createDeferredPromise:w}=n(81125),v=n(16881),_=globalThis.Blob||i.Blob,E="undefined"!==typeof _?function(e){return e instanceof _}:function(e){return!1},S=globalThis.AbortController||n(71927).AbortController,{FunctionPrototypeCall:R}=n(17594);class A extends b{constructor(e){super(e),!1===(null===e||void 0===e?void 0:e.readable)&&(this._readableState.readable=!1,this._readableState.ended=!0,this._readableState.endEmitted=!0),!1===(null===e||void 0===e?void 0:e.writable)&&(this._writableState.writable=!1,this._writableState.ending=!0,this._writableState.ended=!0,this._writableState.finished=!0)}}function k(e){let{promise:t,resolve:n}=w();const i=new S,o=i.signal,s=e(async function*(){while(1){const e=t;t=null;const{chunk:i,done:s,cb:a}=await e;if(r.nextTick(a),s)return;if(o.aborted)throw new f(void 0,{cause:o.reason});({promise:t,resolve:n}=w()),yield i}}(),{signal:o});return{value:s,write(e,t,r){const i=n;n=null,i({chunk:e,done:!1,cb:r})},final(e){const t=n;n=null,t({done:!0,cb:e})},destroy(e,t){i.abort(),t(e)}}}function N(e){const t=e.readable&&"function"!==typeof e.readable.read?m.wrap(e.readable):e.readable,n=e.writable;let r,i,a,l,c,d=!!o(t),h=!!s(n);function p(e){const t=l;l=null,t?t(e):e&&c.destroy(e)}return c=new A({readableObjectMode:!(null===t||void 0===t||!t.readableObjectMode),writableObjectMode:!(null===n||void 0===n||!n.writableObjectMode),readable:d,writable:h}),h&&(u(n,(e=>{h=!1,e&&y(t,e),p(e)})),c._write=function(e,t,i){n.write(e,t)?i():r=i},c._final=function(e){n.end(),i=e},n.on("drain",(function(){if(r){const e=r;r=null,e()}})),n.on("finish",(function(){if(i){const e=i;i=null,e()}}))),d&&(u(t,(e=>{d=!1,e&&y(t,e),p(e)})),t.on("readable",(function(){if(a){const e=a;a=null,e()}})),t.on("end",(function(){c.push(null)})),c._read=function(){while(1){const e=t.read();if(null===e)return void(a=c._read);if(!c.push(e))return}}),c._destroy=function(e,o){e||null===l||(e=new f),a=null,r=null,i=null,null===l?o(e):(l=o,y(n,e),y(t,e))},c}e.exports=function e(t,n){if(h(t))return t;if(c(t))return N({readable:t});if(d(t))return N({writable:t});if(l(t))return N({writable:!1,readable:!1});if("function"===typeof t){const{value:e,write:i,final:o,destroy:s}=k(t);if(a(e))return v(A,e,{objectMode:!0,write:i,final:o,destroy:s});const l=null===e||void 0===e?void 0:e.then;if("function"===typeof l){let t;const n=R(l,e,(e=>{if(null!=e)throw new g("nully","body",e)}),(e=>{y(t,e)}));return t=new A({objectMode:!0,readable:!1,write:i,final(e){o((async()=>{try{await n,r.nextTick(e,null)}catch(t){r.nextTick(e,t)}}))},destroy:s})}throw new g("Iterable, AsyncIterable or AsyncFunction",n,e)}if(E(t))return e(t.arrayBuffer());if(a(t))return v(A,t,{objectMode:!0,writable:!1});if("object"===typeof(null===t||void 0===t?void 0:t.writable)||"object"===typeof(null===t||void 0===t?void 0:t.readable)){const n=null!==t&&void 0!==t&&t.readable?c(null===t||void 0===t?void 0:t.readable)?null===t||void 0===t?void 0:t.readable:e(t.readable):void 0,r=null!==t&&void 0!==t&&t.writable?d(null===t||void 0===t?void 0:t.writable)?null===t||void 0===t?void 0:t.writable:e(t.writable):void 0;return N({readable:n,writable:r})}const i=null===t||void 0===t?void 0:t.then;if("function"===typeof i){let e;return R(i,t,(t=>{null!=t&&e.push(t),e.push(null)}),(t=>{y(e,t)})),e=new A({objectMode:!0,writable:!1,read(){}})}throw new p(n,["Blob","ReadableStream","WritableStream","Stream","Iterable","AsyncIterable","Function","{ readable, writable } pair","Promise"],t)}},40701:(e,t,n)=>{const r=n(96027),{AbortError:i,codes:o}=n(49293),{ERR_INVALID_ARG_TYPE:s,ERR_STREAM_PREMATURE_CLOSE:a}=o,{kEmptyObject:l,once:c}=n(81125),{validateAbortSignal:d,validateFunction:h,validateObject:u,validateBoolean:f}=n(57712),{Promise:p,PromisePrototypeThen:g}=n(17594),{isClosed:y,isReadable:b,isReadableNodeStream:m,isReadableStream:w,isReadableFinished:v,isReadableErrored:_,isWritable:E,isWritableNodeStream:S,isWritableStream:R,isWritableFinished:A,isWritableErrored:k,isNodeStream:N,willEmitClose:T,kIsClosedPromise:C}=n(49888);function I(e){return e.setHeader&&"function"===typeof e.abort}const O=()=>{};function P(e,t,n){var o,f;if(2===arguments.length?(n=t,t=l):null==t?t=l:u(t,"options"),h(n,"callback"),d(t.signal,"options.signal"),n=c(n),w(e)||R(e))return x(e,t,n);if(!N(e))throw new s("stream",["ReadableStream","WritableStream","Stream"],e);const p=null!==(o=t.readable)&&void 0!==o?o:m(e),g=null!==(f=t.writable)&&void 0!==f?f:S(e),C=e._writableState,P=e._readableState,L=()=>{e.writable||B()};let D=T(e)&&m(e)===p&&S(e)===g,M=A(e,!1);const B=()=>{M=!0,e.destroyed&&(D=!1),(!D||e.readable&&!p)&&(p&&!U||n.call(e))};let U=v(e,!1);const j=()=>{U=!0,e.destroyed&&(D=!1),(!D||e.writable&&!g)&&(g&&!M||n.call(e))},K=t=>{n.call(e,t)};let W=y(e);const F=()=>{W=!0;const t=k(e)||_(e);return t&&"boolean"!==typeof t?n.call(e,t):p&&!U&&m(e,!0)&&!v(e,!1)?n.call(e,new a):!g||M||A(e,!1)?void n.call(e):n.call(e,new a)},$=()=>{W=!0;const t=k(e)||_(e);if(t&&"boolean"!==typeof t)return n.call(e,t);n.call(e)},q=()=>{e.req.on("finish",B)};I(e)?(e.on("complete",B),D||e.on("abort",F),e.req?q():e.on("request",q)):g&&!C&&(e.on("end",L),e.on("close",L)),D||"boolean"!==typeof e.aborted||e.on("aborted",F),e.on("end",j),e.on("finish",B),!1!==t.error&&e.on("error",K),e.on("close",F),W?r.nextTick(F):null!==C&&void 0!==C&&C.errorEmitted||null!==P&&void 0!==P&&P.errorEmitted?D||r.nextTick($):(p||D&&!b(e)||!M&&!1!==E(e))&&(g||D&&!E(e)||!U&&!1!==b(e))?P&&e.req&&e.aborted&&r.nextTick($):r.nextTick($);const Z=()=>{n=O,e.removeListener("aborted",F),e.removeListener("complete",B),e.removeListener("abort",F),e.removeListener("request",q),e.req&&e.req.removeListener("finish",B),e.removeListener("end",L),e.removeListener("close",L),e.removeListener("finish",B),e.removeListener("end",j),e.removeListener("error",K),e.removeListener("close",F)};if(t.signal&&!W){const o=()=>{const r=n;Z(),r.call(e,new i(void 0,{cause:t.signal.reason}))};if(t.signal.aborted)r.nextTick(o);else{const r=n;n=c(((...n)=>{t.signal.removeEventListener("abort",o),r.apply(e,n)})),t.signal.addEventListener("abort",o)}}return Z}function x(e,t,n){let o=!1,s=O;if(t.signal)if(s=()=>{o=!0,n.call(e,new i(void 0,{cause:t.signal.reason}))},t.signal.aborted)r.nextTick(s);else{const r=n;n=c(((...n)=>{t.signal.removeEventListener("abort",s),r.apply(e,n)})),t.signal.addEventListener("abort",s)}const a=(...t)=>{o||r.nextTick((()=>n.apply(e,t)))};return g(e[C].promise,a,a),O}function L(e,t){var n;let r=!1;return null===t&&(t=l),null!==(n=t)&&void 0!==n&&n.cleanup&&(f(t.cleanup,"cleanup"),r=t.cleanup),new p(((n,i)=>{const o=P(e,t,(e=>{r&&o(),e?i(e):n()}))}))}e.exports=P,e.exports.finished=L},16881:(e,t,n)=>{"use strict";n(70560);const r=n(96027),{PromisePrototypeThen:i,SymbolAsyncIterator:o,SymbolIterator:s}=n(17594),{Buffer:a}=n(15361),{ERR_INVALID_ARG_TYPE:l,ERR_STREAM_NULL_VALUES:c}=n(49293).codes;function d(e,t,n){let d,h;if("string"===typeof t||t instanceof a)return new e({objectMode:!0,...n,read(){this.push(t),this.push(null)}});if(t&&t[o])h=!0,d=t[o]();else{if(!t||!t[s])throw new l("iterable",["Iterable"],t);h=!1,d=t[s]()}const u=new e({objectMode:!0,highWaterMark:1,...n});let f=!1;async function p(e){const t=void 0!==e&&null!==e,n="function"===typeof d.throw;if(t&&n){const{value:t,done:n}=await d.throw(e);if(await t,n)return}if("function"===typeof d.return){const{value:e}=await d.return();await e}}async function g(){for(;;){try{const{value:e,done:t}=h?await d.next():d.next();if(t)u.push(null);else{const t=e&&"function"===typeof e.then?await e:e;if(null===t)throw f=!1,new c;if(u.push(t))continue;f=!1}}catch(e){u.destroy(e)}break}}return u._read=function(){f||(f=!0,g())},u._destroy=function(e,t){i(p(e),(()=>r.nextTick(t,e)),(n=>r.nextTick(t,n||e)))},u}e.exports=d},2106:(e,t,n)=>{"use strict";n(91719);const{ArrayIsArray:r,ObjectSetPrototypeOf:i}=n(17594),{EventEmitter:o}=n(43793);function s(e){o.call(this,e)}function a(e,t,n){if("function"===typeof e.prependListener)return e.prependListener(t,n);e._events&&e._events[t]?r(e._events[t])?e._events[t].unshift(n):e._events[t]=[n,e._events[t]]:e.on(t,n)}i(s.prototype,o.prototype),i(s,o),s.prototype.pipe=function(e,t){const n=this;function r(t){e.writable&&!1===e.write(t)&&n.pause&&n.pause()}function i(){n.readable&&n.resume&&n.resume()}n.on("data",r),e.on("drain",i),e._isStdio||t&&!1===t.end||(n.on("end",l),n.on("close",c));let s=!1;function l(){s||(s=!0,e.end())}function c(){s||(s=!0,"function"===typeof e.destroy&&e.destroy())}function d(e){h(),0===o.listenerCount(this,"error")&&this.emit("error",e)}function h(){n.removeListener("data",r),e.removeListener("drain",i),n.removeListener("end",l),n.removeListener("close",c),n.removeListener("error",d),e.removeListener("error",d),n.removeListener("end",h),n.removeListener("close",h),e.removeListener("close",h)}return a(n,"error",d),a(e,"error",d),n.on("end",h),n.on("close",h),e.on("close",h),e.emit("pipe",n),e},e.exports={Stream:s,prependListener:a}},23196:(e,t,n)=>{"use strict";n(45398),n(70560);const r=globalThis.AbortController||n(71927).AbortController,{codes:{ERR_INVALID_ARG_VALUE:i,ERR_INVALID_ARG_TYPE:o,ERR_MISSING_ARGS:s,ERR_OUT_OF_RANGE:a},AbortError:l}=n(49293),{validateAbortSignal:c,validateInteger:d,validateObject:h}=n(57712),u=n(17594).Symbol("kWeak"),{finished:f}=n(40701),p=n(92431),{addAbortSignalNoValidate:g}=n(76665),{isWritable:y,isNodeStream:b}=n(49888),{ArrayPrototypePush:m,MathFloor:w,Number:v,NumberIsNaN:_,Promise:E,PromiseReject:S,PromisePrototypeThen:R,Symbol:A}=n(17594),k=A("kEmpty"),N=A("kEof");function T(e,t){if(null!=t&&h(t,"options"),null!=(null===t||void 0===t?void 0:t.signal)&&c(t.signal,"options.signal"),b(e)&&!y(e))throw new i("stream",e,"must be writable");const n=p(this,e);return null!==t&&void 0!==t&&t.signal&&g(t.signal,n),n}function C(e,t){if("function"!==typeof e)throw new o("fn",["Function","AsyncFunction"],e);null!=t&&h(t,"options"),null!=(null===t||void 0===t?void 0:t.signal)&&c(t.signal,"options.signal");let n=1;return null!=(null===t||void 0===t?void 0:t.concurrency)&&(n=w(t.concurrency)),d(n,"concurrency",1),async function*(){var i,o;const s=new r,a=this,c=[],d=s.signal,h={signal:d},u=()=>s.abort();let f,p;null!==t&&void 0!==t&&null!==(i=t.signal)&&void 0!==i&&i.aborted&&u(),null===t||void 0===t||null===(o=t.signal)||void 0===o||o.addEventListener("abort",u);let g=!1;function y(){g=!0}async function b(){try{for await(let t of a){var r;if(g)return;if(d.aborted)throw new l;try{t=e(t,h)}catch(o){t=S(o)}t!==k&&("function"===typeof(null===(r=t)||void 0===r?void 0:r.catch)&&t.catch(y),c.push(t),f&&(f(),f=null),!g&&c.length&&c.length>=n&&await new E((e=>{p=e})))}c.push(N)}catch(o){const e=S(o);R(e,void 0,y),c.push(e)}finally{var i;g=!0,f&&(f(),f=null),null===t||void 0===t||null===(i=t.signal)||void 0===i||i.removeEventListener("abort",u)}}b();try{while(1){while(c.length>0){const e=await c[0];if(e===N)return;if(d.aborted)throw new l;e!==k&&(yield e),c.shift(),p&&(p(),p=null)}await new E((e=>{f=e}))}}finally{s.abort(),g=!0,p&&(p(),p=null)}}.call(this)}function I(e=void 0){return null!=e&&h(e,"options"),null!=(null===e||void 0===e?void 0:e.signal)&&c(e.signal,"options.signal"),async function*(){let t=0;for await(const r of this){var n;if(null!==e&&void 0!==e&&null!==(n=e.signal)&&void 0!==n&&n.aborted)throw new l({cause:e.signal.reason});yield[t++,r]}}.call(this)}async function O(e,t=void 0){for await(const n of D.call(this,e,t))return!0;return!1}async function P(e,t=void 0){if("function"!==typeof e)throw new o("fn",["Function","AsyncFunction"],e);return!await O.call(this,(async(...t)=>!await e(...t)),t)}async function x(e,t){for await(const n of D.call(this,e,t))return n}async function L(e,t){if("function"!==typeof e)throw new o("fn",["Function","AsyncFunction"],e);async function n(t,n){return await e(t,n),k}for await(const r of C.call(this,n,t));}function D(e,t){if("function"!==typeof e)throw new o("fn",["Function","AsyncFunction"],e);async function n(t,n){return await e(t,n)?t:k}return C.call(this,n,t)}class M extends s{constructor(){super("reduce"),this.message="Reduce of an empty stream requires an initial value"}}async function B(e,t,n){var i;if("function"!==typeof e)throw new o("reducer",["Function","AsyncFunction"],e);null!=n&&h(n,"options"),null!=(null===n||void 0===n?void 0:n.signal)&&c(n.signal,"options.signal");let s=arguments.length>1;if(null!==n&&void 0!==n&&null!==(i=n.signal)&&void 0!==i&&i.aborted){const e=new l(void 0,{cause:n.signal.reason});throw this.once("error",(()=>{})),await f(this.destroy(e)),e}const a=new r,d=a.signal;if(null!==n&&void 0!==n&&n.signal){const e={once:!0,[u]:this};n.signal.addEventListener("abort",(()=>a.abort()),e)}let p=!1;try{for await(const r of this){var g;if(p=!0,null!==n&&void 0!==n&&null!==(g=n.signal)&&void 0!==g&&g.aborted)throw new l;s?t=await e(t,r,{signal:d}):(t=r,s=!0)}if(!p&&!s)throw new M}finally{a.abort()}return t}async function U(e){null!=e&&h(e,"options"),null!=(null===e||void 0===e?void 0:e.signal)&&c(e.signal,"options.signal");const t=[];for await(const r of this){var n;if(null!==e&&void 0!==e&&null!==(n=e.signal)&&void 0!==n&&n.aborted)throw new l(void 0,{cause:e.signal.reason});m(t,r)}return t}function j(e,t){const n=C.call(this,e,t);return async function*(){for await(const e of n)yield*e}.call(this)}function K(e){if(e=v(e),_(e))return 0;if(e<0)throw new a("number",">= 0",e);return e}function W(e,t=void 0){return null!=t&&h(t,"options"),null!=(null===t||void 0===t?void 0:t.signal)&&c(t.signal,"options.signal"),e=K(e),async function*(){var n;if(null!==t&&void 0!==t&&null!==(n=t.signal)&&void 0!==n&&n.aborted)throw new l;for await(const i of this){var r;if(null!==t&&void 0!==t&&null!==(r=t.signal)&&void 0!==r&&r.aborted)throw new l;e--<=0&&(yield i)}}.call(this)}function F(e,t=void 0){return null!=t&&h(t,"options"),null!=(null===t||void 0===t?void 0:t.signal)&&c(t.signal,"options.signal"),e=K(e),async function*(){var n;if(null!==t&&void 0!==t&&null!==(n=t.signal)&&void 0!==n&&n.aborted)throw new l;for await(const i of this){var r;if(null!==t&&void 0!==t&&null!==(r=t.signal)&&void 0!==r&&r.aborted)throw new l;if(!(e-- >0))return;yield i}}.call(this)}e.exports.streamReturningOperators={asIndexedPairs:I,drop:W,filter:D,flatMap:j,map:C,take:F,compose:T},e.exports.promiseReturningOperators={every:P,forEach:L,reduce:B,toArray:U,some:O,find:x}},80511:(e,t,n)=>{"use strict";const{ObjectSetPrototypeOf:r}=n(17594);e.exports=o;const i=n(61917);function o(e){if(!(this instanceof o))return new o(e);i.call(this,e)}r(o.prototype,i.prototype),r(o,i),o.prototype._transform=function(e,t,n){n(null,e)}},55918:(e,t,n)=>{n(45398),n(70560);const r=n(96027),{ArrayIsArray:i,Promise:o,SymbolAsyncIterator:s}=n(17594),a=n(40701),{once:l}=n(81125),c=n(68818),d=n(59910),{aggregateTwoErrors:h,codes:{ERR_INVALID_ARG_TYPE:u,ERR_INVALID_RETURN_VALUE:f,ERR_MISSING_ARGS:p,ERR_STREAM_DESTROYED:g,ERR_STREAM_PREMATURE_CLOSE:y},AbortError:b}=n(49293),{validateFunction:m,validateAbortSignal:w}=n(57712),{isIterable:v,isReadable:_,isReadableNodeStream:E,isNodeStream:S,isTransformStream:R,isWebStream:A,isReadableStream:k,isReadableEnded:N}=n(49888),T=globalThis.AbortController||n(71927).AbortController;let C,I;function O(e,t,n){let r=!1;e.on("close",(()=>{r=!0}));const i=a(e,{readable:t,writable:n},(e=>{r=!e}));return{destroy:t=>{r||(r=!0,c.destroyer(e,t||new g("pipe")))},cleanup:i}}function P(e){return m(e[e.length-1],"streams[stream.length - 1]"),e.pop()}function x(e){if(v(e))return e;if(E(e))return L(e);throw new u("val",["Readable","Iterable","AsyncIterable"],e)}async function*L(e){I||(I=n(67180)),yield*I.prototype[s].call(e)}async function D(e,t,n,{end:r}){let i,s=null;const l=e=>{if(e&&(i=e),s){const e=s;s=null,e()}},c=()=>new o(((e,t)=>{i?t(i):s=()=>{i?t(i):e()}}));t.on("drain",l);const d=a(t,{readable:!1},l);try{t.writableNeedDrain&&await c();for await(const n of e)t.write(n)||await c();r&&t.end(),await c(),n()}catch(u){n(i!==u?h(i,u):u)}finally{d(),t.off("drain",l)}}async function M(e,t,n,{end:r}){R(t)&&(t=t.writable);const i=t.getWriter();try{for await(const t of e)await i.ready,i.write(t).catch((()=>{}));await i.ready,r&&await i.close(),n()}catch(o){try{await i.abort(o),n(o)}catch(o){n(o)}}}function B(...e){return U(e,l(P(e)))}function U(e,t,o){if(1===e.length&&i(e[0])&&(e=e[0]),e.length<2)throw new p("streams");const s=new T,a=s.signal,l=null===o||void 0===o?void 0:o.signal,c=[];function h(){L(new b)}let g,y;w(l,"options.signal"),null===l||void 0===l||l.addEventListener("abort",h);const m=[];let N,I=0;function P(e){L(e,0===--I)}function L(e,n){if(!e||g&&"ERR_STREAM_PREMATURE_CLOSE"!==g.code||(g=e),g||n){while(m.length)m.shift()(g);null===l||void 0===l||l.removeEventListener("abort",h),s.abort(),n&&(g||c.forEach((e=>e())),r.nextTick(t,g,y))}}for(let W=0;W<e.length;W++){const F=e[W],$=W<e.length-1,q=W>0,Z=$||!1!==(null===o||void 0===o?void 0:o.end),H=W===e.length-1;if(S(F)){if(Z){const{destroy:V,cleanup:G}=O(F,$,q);m.push(V),_(F)&&H&&c.push(G)}function B(e){e&&"AbortError"!==e.name&&"ERR_STREAM_PREMATURE_CLOSE"!==e.code&&P(e)}F.on("error",B),_(F)&&H&&c.push((()=>{F.removeListener("error",B)}))}if(0===W)if("function"===typeof F){if(N=F({signal:a}),!v(N))throw new f("Iterable, AsyncIterable or Stream","source",N)}else N=v(F)||E(F)||R(F)?F:d.from(F);else if("function"===typeof F){var U;if(R(N))N=x(null===(U=N)||void 0===U?void 0:U.readable);else N=x(N);if(N=F(N,{signal:a}),$){if(!v(N,!0))throw new f("AsyncIterable",`transform[${W-1}]`,N)}else{var K;C||(C=n(80511));const Y=new C({objectMode:!0}),J=null===(K=N)||void 0===K?void 0:K.then;if("function"===typeof J)I++,J.call(N,(e=>{y=e,null!=e&&Y.write(e),Z&&Y.end(),r.nextTick(P)}),(e=>{Y.destroy(e),r.nextTick(P,e)}));else if(v(N,!0))I++,D(N,Y,P,{end:Z});else{if(!k(N)&&!R(N))throw new f("AsyncIterable or Promise","destination",N);{const Q=N.readable||N;I++,D(Q,Y,P,{end:Z})}}N=Y;const{destroy:z,cleanup:X}=O(N,!1,!0);m.push(z),H&&c.push(X)}}else if(S(F)){if(E(N)){I+=2;const ee=j(N,F,P,{end:Z});_(F)&&H&&c.push(ee)}else if(R(N)||k(N)){const te=N.readable||N;I++,D(te,F,P,{end:Z})}else{if(!v(N))throw new u("val",["Readable","Iterable","AsyncIterable","ReadableStream","TransformStream"],N);I++,D(N,F,P,{end:Z})}N=F}else if(A(F)){if(E(N))I++,M(x(N),F,P,{end:Z});else if(k(N)||v(N))I++,M(N,F,P,{end:Z});else{if(!R(N))throw new u("val",["Readable","Iterable","AsyncIterable","ReadableStream","TransformStream"],N);I++,M(N.readable,F,P,{end:Z})}N=F}else N=d.from(F)}return(null!==a&&void 0!==a&&a.aborted||null!==l&&void 0!==l&&l.aborted)&&r.nextTick(h),N}function j(e,t,n,{end:i}){let o=!1;if(t.on("close",(()=>{o||n(new y)})),e.pipe(t,{end:!1}),i){function s(){o=!0,t.end()}N(e)?r.nextTick(s):e.once("end",s)}else n();return a(e,{readable:!0,writable:!1},(t=>{const r=e._readableState;t&&"ERR_STREAM_PREMATURE_CLOSE"===t.code&&r&&r.ended&&!r.errored&&!r.errorEmitted?e.once("end",n).once("error",n):n(t)})),a(t,{readable:!1,writable:!0},n)}e.exports={pipelineImpl:U,pipeline:B}},67180:(e,t,n)=>{n(70560),n(91719),n(76801);const r=n(96027),{ArrayPrototypeIndexOf:i,NumberIsInteger:o,NumberIsNaN:s,NumberParseInt:a,ObjectDefineProperties:l,ObjectKeys:c,ObjectSetPrototypeOf:d,Promise:h,SafeSet:u,SymbolAsyncIterator:f,Symbol:p}=n(17594);e.exports=j,j.ReadableState=U;const{EventEmitter:g}=n(43793),{Stream:y,prependListener:b}=n(2106),{Buffer:m}=n(15361),{addAbortSignal:w}=n(76665),v=n(40701);let _=n(81125).debuglog("stream",(e=>{_=e}));const E=n(52727),S=n(68818),{getHighWaterMark:R,getDefaultHighWaterMark:A}=n(63695),{aggregateTwoErrors:k,codes:{ERR_INVALID_ARG_TYPE:N,ERR_METHOD_NOT_IMPLEMENTED:T,ERR_OUT_OF_RANGE:C,ERR_STREAM_PUSH_AFTER_EOF:I,ERR_STREAM_UNSHIFT_AFTER_END_EVENT:O}}=n(49293),{validateObject:P}=n(57712),x=p("kPaused"),{StringDecoder:L}=n(25605),D=n(16881);d(j.prototype,y.prototype),d(j,y);const M=()=>{},{errorOrDestroy:B}=S;function U(e,t,r){"boolean"!==typeof r&&(r=t instanceof n(59910)),this.objectMode=!(!e||!e.objectMode),r&&(this.objectMode=this.objectMode||!(!e||!e.readableObjectMode)),this.highWaterMark=e?R(this,e,"readableHighWaterMark",r):A(!1),this.buffer=new E,this.length=0,this.pipes=[],this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.constructed=!0,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this[x]=null,this.errorEmitted=!1,this.emitClose=!e||!1!==e.emitClose,this.autoDestroy=!e||!1!==e.autoDestroy,this.destroyed=!1,this.errored=null,this.closed=!1,this.closeEmitted=!1,this.defaultEncoding=e&&e.defaultEncoding||"utf8",this.awaitDrainWriters=null,this.multiAwaitDrain=!1,this.readingMore=!1,this.dataEmitted=!1,this.decoder=null,this.encoding=null,e&&e.encoding&&(this.decoder=new L(e.encoding),this.encoding=e.encoding)}function j(e){if(!(this instanceof j))return new j(e);const t=this instanceof n(59910);this._readableState=new U(e,this,t),e&&("function"===typeof e.read&&(this._read=e.read),"function"===typeof e.destroy&&(this._destroy=e.destroy),"function"===typeof e.construct&&(this._construct=e.construct),e.signal&&!t&&w(e.signal,this)),y.call(this,e),S.construct(this,(()=>{this._readableState.needReadable&&G(this,this._readableState)}))}function K(e,t,n,r){_("readableAddChunk",t);const i=e._readableState;let o;if(i.objectMode||("string"===typeof t?(n=n||i.defaultEncoding,i.encoding!==n&&(r&&i.encoding?t=m.from(t,n).toString(i.encoding):(t=m.from(t,n),n=""))):t instanceof m?n="":y._isUint8Array(t)?(t=y._uint8ArrayToBuffer(t),n=""):null!=t&&(o=new N("chunk",["string","Buffer","Uint8Array"],t))),o)B(e,o);else if(null===t)i.reading=!1,Z(e,i);else if(i.objectMode||t&&t.length>0)if(r)if(i.endEmitted)B(e,new O);else{if(i.destroyed||i.errored)return!1;W(e,i,t,!0)}else if(i.ended)B(e,new I);else{if(i.destroyed||i.errored)return!1;i.reading=!1,i.decoder&&!n?(t=i.decoder.write(t),i.objectMode||0!==t.length?W(e,i,t,!1):G(e,i)):W(e,i,t,!1)}else r||(i.reading=!1,G(e,i));return!i.ended&&(i.length<i.highWaterMark||0===i.length)}function W(e,t,n,r){t.flowing&&0===t.length&&!t.sync&&e.listenerCount("data")>0?(t.multiAwaitDrain?t.awaitDrainWriters.clear():t.awaitDrainWriters=null,t.dataEmitted=!0,e.emit("data",n)):(t.length+=t.objectMode?1:n.length,r?t.buffer.unshift(n):t.buffer.push(n),t.needReadable&&H(e)),G(e,t)}j.prototype.destroy=S.destroy,j.prototype._undestroy=S.undestroy,j.prototype._destroy=function(e,t){t(e)},j.prototype[g.captureRejectionSymbol]=function(e){this.destroy(e)},j.prototype.push=function(e,t){return K(this,e,t,!1)},j.prototype.unshift=function(e,t){return K(this,e,t,!0)},j.prototype.isPaused=function(){const e=this._readableState;return!0===e[x]||!1===e.flowing},j.prototype.setEncoding=function(e){const t=new L(e);this._readableState.decoder=t,this._readableState.encoding=this._readableState.decoder.encoding;const n=this._readableState.buffer;let r="";for(const i of n)r+=t.write(i);return n.clear(),""!==r&&n.push(r),this._readableState.length=r.length,this};const F=1073741824;function $(e){if(e>F)throw new C("size","<= 1GiB",e);return e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++,e}function q(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:s(e)?t.flowing&&t.length?t.buffer.first().length:t.length:e<=t.length?e:t.ended?t.length:0}function Z(e,t){if(_("onEofChunk"),!t.ended){if(t.decoder){const e=t.decoder.end();e&&e.length&&(t.buffer.push(e),t.length+=t.objectMode?1:e.length)}t.ended=!0,t.sync?H(e):(t.needReadable=!1,t.emittedReadable=!0,V(e))}}function H(e){const t=e._readableState;_("emitReadable",t.needReadable,t.emittedReadable),t.needReadable=!1,t.emittedReadable||(_("emitReadable",t.flowing),t.emittedReadable=!0,r.nextTick(V,e))}function V(e){const t=e._readableState;_("emitReadable_",t.destroyed,t.length,t.ended),t.destroyed||t.errored||!t.length&&!t.ended||(e.emit("readable"),t.emittedReadable=!1),t.needReadable=!t.flowing&&!t.ended&&t.length<=t.highWaterMark,te(e)}function G(e,t){!t.readingMore&&t.constructed&&(t.readingMore=!0,r.nextTick(Y,e,t))}function Y(e,t){while(!t.reading&&!t.ended&&(t.length<t.highWaterMark||t.flowing&&0===t.length)){const n=t.length;if(_("maybeReadMore read 0"),e.read(0),n===t.length)break}t.readingMore=!1}function J(e,t){return function(){const n=e._readableState;n.awaitDrainWriters===t?(_("pipeOnDrain",1),n.awaitDrainWriters=null):n.multiAwaitDrain&&(_("pipeOnDrain",n.awaitDrainWriters.size),n.awaitDrainWriters.delete(t)),n.awaitDrainWriters&&0!==n.awaitDrainWriters.size||!e.listenerCount("data")||e.resume()}}function z(e){const t=e._readableState;t.readableListening=e.listenerCount("readable")>0,t.resumeScheduled&&!1===t[x]?t.flowing=!0:e.listenerCount("data")>0?e.resume():t.readableListening||(t.flowing=null)}function X(e){_("readable nexttick read 0"),e.read(0)}function Q(e,t){t.resumeScheduled||(t.resumeScheduled=!0,r.nextTick(ee,e,t))}function ee(e,t){_("resume",t.reading),t.reading||e.read(0),t.resumeScheduled=!1,e.emit("resume"),te(e),t.flowing&&!t.reading&&e.read(0)}function te(e){const t=e._readableState;_("flow",t.flowing);while(t.flowing&&null!==e.read());}function ne(e,t){"function"!==typeof e.read&&(e=j.wrap(e,{objectMode:!0}));const n=re(e,t);return n.stream=e,n}async function*re(e,t){let n,r=M;function i(t){this===e?(r(),r=M):r=t}e.on("readable",i);const o=v(e,{writable:!1},(e=>{n=e?k(n,e):null,r(),r=M}));try{while(1){const t=e.destroyed?null:e.read();if(null!==t)yield t;else{if(n)throw n;if(null===n)return;await new h(i)}}}catch(s){throw n=k(n,s),n}finally{!n&&!1===(null===t||void 0===t?void 0:t.destroyOnReturn)||void 0!==n&&!e._readableState.autoDestroy?(e.off("readable",i),o()):S.destroyer(e,null)}}function ie(e,t){if(0===t.length)return null;let n;return t.objectMode?n=t.buffer.shift():!e||e>=t.length?(n=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.first():t.buffer.concat(t.length),t.buffer.clear()):n=t.buffer.consume(e,t.decoder),n}function oe(e){const t=e._readableState;_("endReadable",t.endEmitted),t.endEmitted||(t.ended=!0,r.nextTick(se,t,e))}function se(e,t){if(_("endReadableNT",e.endEmitted,e.length),!e.errored&&!e.closeEmitted&&!e.endEmitted&&0===e.length)if(e.endEmitted=!0,t.emit("end"),t.writable&&!1===t.allowHalfOpen)r.nextTick(ae,t);else if(e.autoDestroy){const e=t._writableState,n=!e||e.autoDestroy&&(e.finished||!1===e.writable);n&&t.destroy()}}function ae(e){const t=e.writable&&!e.writableEnded&&!e.destroyed;t&&e.end()}let le;function ce(){return void 0===le&&(le={}),le}j.prototype.read=function(e){_("read",e),void 0===e?e=NaN:o(e)||(e=a(e,10));const t=this._readableState,n=e;if(e>t.highWaterMark&&(t.highWaterMark=$(e)),0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&((0!==t.highWaterMark?t.length>=t.highWaterMark:t.length>0)||t.ended))return _("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?oe(this):H(this),null;if(e=q(e,t),0===e&&t.ended)return 0===t.length&&oe(this),null;let r,i=t.needReadable;if(_("need readable",i),(0===t.length||t.length-e<t.highWaterMark)&&(i=!0,_("length less than watermark",i)),t.ended||t.reading||t.destroyed||t.errored||!t.constructed)i=!1,_("reading, ended or constructing",i);else if(i){_("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0);try{this._read(t.highWaterMark)}catch(s){B(this,s)}t.sync=!1,t.reading||(e=q(n,t))}return r=e>0?ie(e,t):null,null===r?(t.needReadable=t.length<=t.highWaterMark,e=0):(t.length-=e,t.multiAwaitDrain?t.awaitDrainWriters.clear():t.awaitDrainWriters=null),0===t.length&&(t.ended||(t.needReadable=!0),n!==e&&t.ended&&oe(this)),null===r||t.errorEmitted||t.closeEmitted||(t.dataEmitted=!0,this.emit("data",r)),r},j.prototype._read=function(e){throw new T("_read()")},j.prototype.pipe=function(e,t){const n=this,i=this._readableState;1===i.pipes.length&&(i.multiAwaitDrain||(i.multiAwaitDrain=!0,i.awaitDrainWriters=new u(i.awaitDrainWriters?[i.awaitDrainWriters]:[]))),i.pipes.push(e),_("pipe count=%d opts=%j",i.pipes.length,t);const o=(!t||!1!==t.end)&&e!==r.stdout&&e!==r.stderr,s=o?l:w;function a(e,t){_("onunpipe"),e===n&&t&&!1===t.hasUnpiped&&(t.hasUnpiped=!0,h())}function l(){_("onend"),e.end()}let c;i.endEmitted?r.nextTick(s):n.once("end",s),e.on("unpipe",a);let d=!1;function h(){_("cleanup"),e.removeListener("close",y),e.removeListener("finish",m),c&&e.removeListener("drain",c),e.removeListener("error",g),e.removeListener("unpipe",a),n.removeListener("end",l),n.removeListener("end",w),n.removeListener("data",p),d=!0,c&&i.awaitDrainWriters&&(!e._writableState||e._writableState.needDrain)&&c()}function f(){d||(1===i.pipes.length&&i.pipes[0]===e?(_("false write response, pause",0),i.awaitDrainWriters=e,i.multiAwaitDrain=!1):i.pipes.length>1&&i.pipes.includes(e)&&(_("false write response, pause",i.awaitDrainWriters.size),i.awaitDrainWriters.add(e)),n.pause()),c||(c=J(n,e),e.on("drain",c))}function p(t){_("ondata");const n=e.write(t);_("dest.write",n),!1===n&&f()}function g(t){if(_("onerror",t),w(),e.removeListener("error",g),0===e.listenerCount("error")){const n=e._writableState||e._readableState;n&&!n.errorEmitted?B(e,t):e.emit("error",t)}}function y(){e.removeListener("finish",m),w()}function m(){_("onfinish"),e.removeListener("close",y),w()}function w(){_("unpipe"),n.unpipe(e)}return n.on("data",p),b(e,"error",g),e.once("close",y),e.once("finish",m),e.emit("pipe",n),!0===e.writableNeedDrain?i.flowing&&f():i.flowing||(_("pipe resume"),n.resume()),e},j.prototype.unpipe=function(e){const t=this._readableState,n={hasUnpiped:!1};if(0===t.pipes.length)return this;if(!e){const e=t.pipes;t.pipes=[],this.pause();for(let t=0;t<e.length;t++)e[t].emit("unpipe",this,{hasUnpiped:!1});return this}const r=i(t.pipes,e);return-1===r||(t.pipes.splice(r,1),0===t.pipes.length&&this.pause(),e.emit("unpipe",this,n)),this},j.prototype.on=function(e,t){const n=y.prototype.on.call(this,e,t),i=this._readableState;return"data"===e?(i.readableListening=this.listenerCount("readable")>0,!1!==i.flowing&&this.resume()):"readable"===e&&(i.endEmitted||i.readableListening||(i.readableListening=i.needReadable=!0,i.flowing=!1,i.emittedReadable=!1,_("on readable",i.length,i.reading),i.length?H(this):i.reading||r.nextTick(X,this))),n},j.prototype.addListener=j.prototype.on,j.prototype.removeListener=function(e,t){const n=y.prototype.removeListener.call(this,e,t);return"readable"===e&&r.nextTick(z,this),n},j.prototype.off=j.prototype.removeListener,j.prototype.removeAllListeners=function(e){const t=y.prototype.removeAllListeners.apply(this,arguments);return"readable"!==e&&void 0!==e||r.nextTick(z,this),t},j.prototype.resume=function(){const e=this._readableState;return e.flowing||(_("resume"),e.flowing=!e.readableListening,Q(this,e)),e[x]=!1,this},j.prototype.pause=function(){return _("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(_("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState[x]=!0,this},j.prototype.wrap=function(e){let t=!1;e.on("data",(n=>{!this.push(n)&&e.pause&&(t=!0,e.pause())})),e.on("end",(()=>{this.push(null)})),e.on("error",(e=>{B(this,e)})),e.on("close",(()=>{this.destroy()})),e.on("destroy",(()=>{this.destroy()})),this._read=()=>{t&&e.resume&&(t=!1,e.resume())};const n=c(e);for(let r=1;r<n.length;r++){const t=n[r];void 0===this[t]&&"function"===typeof e[t]&&(this[t]=e[t].bind(e))}return this},j.prototype[f]=function(){return ne(this)},j.prototype.iterator=function(e){return void 0!==e&&P(e,"options"),ne(this,e)},l(j.prototype,{readable:{__proto__:null,get(){const e=this._readableState;return!!e&&!1!==e.readable&&!e.destroyed&&!e.errorEmitted&&!e.endEmitted},set(e){this._readableState&&(this._readableState.readable=!!e)}},readableDidRead:{__proto__:null,enumerable:!1,get:function(){return this._readableState.dataEmitted}},readableAborted:{__proto__:null,enumerable:!1,get:function(){return!(!1===this._readableState.readable||!this._readableState.destroyed&&!this._readableState.errored||this._readableState.endEmitted)}},readableHighWaterMark:{__proto__:null,enumerable:!1,get:function(){return this._readableState.highWaterMark}},readableBuffer:{__proto__:null,enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}},readableFlowing:{__proto__:null,enumerable:!1,get:function(){return this._readableState.flowing},set:function(e){this._readableState&&(this._readableState.flowing=e)}},readableLength:{__proto__:null,enumerable:!1,get(){return this._readableState.length}},readableObjectMode:{__proto__:null,enumerable:!1,get(){return!!this._readableState&&this._readableState.objectMode}},readableEncoding:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.encoding:null}},errored:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.errored:null}},closed:{__proto__:null,get(){return!!this._readableState&&this._readableState.closed}},destroyed:{__proto__:null,enumerable:!1,get(){return!!this._readableState&&this._readableState.destroyed},set(e){this._readableState&&(this._readableState.destroyed=e)}},readableEnded:{__proto__:null,enumerable:!1,get(){return!!this._readableState&&this._readableState.endEmitted}}}),l(U.prototype,{pipesCount:{__proto__:null,get(){return this.pipes.length}},paused:{__proto__:null,get(){return!1!==this[x]},set(e){this[x]=!!e}}}),j._fromList=ie,j.from=function(e,t){return D(j,e,t)},j.fromWeb=function(e,t){return ce().newStreamReadableFromReadableStream(e,t)},j.toWeb=function(e,t){return ce().newReadableStreamFromStreamReadable(e,t)},j.wrap=function(e,t){var n,r;return new j({objectMode:null===(n=null!==(r=e.readableObjectMode)&&void 0!==r?r:e.objectMode)||void 0===n||n,...t,destroy(t,n){S.destroyer(e,t),n(t)}}).wrap(e)}},63695:(e,t,n)=>{"use strict";const{MathFloor:r,NumberIsInteger:i}=n(17594),{ERR_INVALID_ARG_VALUE:o}=n(49293).codes;function s(e,t,n){return null!=e.highWaterMark?e.highWaterMark:t?e[n]:null}function a(e){return e?16:16384}function l(e,t,n,l){const c=s(t,l,n);if(null!=c){if(!i(c)||c<0){const e=l?`options.${n}`:"options.highWaterMark";throw new o(e,c)}return r(c)}return a(e.objectMode)}e.exports={getHighWaterMark:l,getDefaultHighWaterMark:a}},61917:(e,t,n)=>{"use strict";n(70560);const{ObjectSetPrototypeOf:r,Symbol:i}=n(17594);e.exports=c;const{ERR_METHOD_NOT_IMPLEMENTED:o}=n(49293).codes,s=n(59910),{getHighWaterMark:a}=n(63695);r(c.prototype,s.prototype),r(c,s);const l=i("kCallback");function c(e){if(!(this instanceof c))return new c(e);const t=e?a(this,e,"readableHighWaterMark",!0):null;0===t&&(e={...e,highWaterMark:null,readableHighWaterMark:t,writableHighWaterMark:e.writableHighWaterMark||0}),s.call(this,e),this._readableState.sync=!1,this[l]=null,e&&("function"===typeof e.transform&&(this._transform=e.transform),"function"===typeof e.flush&&(this._flush=e.flush)),this.on("prefinish",h)}function d(e){"function"!==typeof this._flush||this.destroyed?(this.push(null),e&&e()):this._flush(((t,n)=>{t?e?e(t):this.destroy(t):(null!=n&&this.push(n),this.push(null),e&&e())}))}function h(){this._final!==d&&d.call(this)}c.prototype._final=d,c.prototype._transform=function(e,t,n){throw new o("_transform()")},c.prototype._write=function(e,t,n){const r=this._readableState,i=this._writableState,o=r.length;this._transform(e,t,((e,t)=>{e?n(e):(null!=t&&this.push(t),i.ended||o===r.length||r.length<r.highWaterMark?n():this[l]=n)}))},c.prototype._read=function(){if(this[l]){const e=this[l];this[l]=null,e()}}},49888:(e,t,n)=>{"use strict";const{Symbol:r,SymbolAsyncIterator:i,SymbolIterator:o,SymbolFor:s}=n(17594),a=r("kDestroyed"),l=r("kIsErrored"),c=r("kIsReadable"),d=r("kIsDisturbed"),h=s("nodejs.webstream.isClosedPromise"),u=s("nodejs.webstream.controllerErrorFunction");function f(e,t=!1){var n;return!(!e||"function"!==typeof e.pipe||"function"!==typeof e.on||t&&("function"!==typeof e.pause||"function"!==typeof e.resume)||e._writableState&&!1===(null===(n=e._readableState)||void 0===n?void 0:n.readable)||e._writableState&&!e._readableState)}function p(e){var t;return!(!e||"function"!==typeof e.write||"function"!==typeof e.on||e._readableState&&!1===(null===(t=e._writableState)||void 0===t?void 0:t.writable))}function g(e){return!(!e||"function"!==typeof e.pipe||!e._readableState||"function"!==typeof e.on||"function"!==typeof e.write)}function y(e){return e&&(e._readableState||e._writableState||"function"===typeof e.write&&"function"===typeof e.on||"function"===typeof e.pipe&&"function"===typeof e.on)}function b(e){return!(!e||y(e)||"function"!==typeof e.pipeThrough||"function"!==typeof e.getReader||"function"!==typeof e.cancel)}function m(e){return!(!e||y(e)||"function"!==typeof e.getWriter||"function"!==typeof e.abort)}function w(e){return!(!e||y(e)||"object"!==typeof e.readable||"object"!==typeof e.writable)}function v(e){return b(e)||m(e)||w(e)}function _(e,t){return null!=e&&(!0===t?"function"===typeof e[i]:!1===t?"function"===typeof e[o]:"function"===typeof e[i]||"function"===typeof e[o])}function E(e){if(!y(e))return null;const t=e._writableState,n=e._readableState,r=t||n;return!!(e.destroyed||e[a]||null!==r&&void 0!==r&&r.destroyed)}function S(e){if(!p(e))return null;if(!0===e.writableEnded)return!0;const t=e._writableState;return(null===t||void 0===t||!t.errored)&&("boolean"!==typeof(null===t||void 0===t?void 0:t.ended)?null:t.ended)}function R(e,t){if(!p(e))return null;if(!0===e.writableFinished)return!0;const n=e._writableState;return(null===n||void 0===n||!n.errored)&&("boolean"!==typeof(null===n||void 0===n?void 0:n.finished)?null:!!(n.finished||!1===t&&!0===n.ended&&0===n.length))}function A(e){if(!f(e))return null;if(!0===e.readableEnded)return!0;const t=e._readableState;return!(!t||t.errored)&&("boolean"!==typeof(null===t||void 0===t?void 0:t.ended)?null:t.ended)}function k(e,t){if(!f(e))return null;const n=e._readableState;return(null===n||void 0===n||!n.errored)&&("boolean"!==typeof(null===n||void 0===n?void 0:n.endEmitted)?null:!!(n.endEmitted||!1===t&&!0===n.ended&&0===n.length))}function N(e){return e&&null!=e[c]?e[c]:"boolean"!==typeof(null===e||void 0===e?void 0:e.readable)?null:!E(e)&&(f(e)&&e.readable&&!k(e))}function T(e){return"boolean"!==typeof(null===e||void 0===e?void 0:e.writable)?null:!E(e)&&(p(e)&&e.writable&&!S(e))}function C(e,t){return y(e)?!!E(e)||(!1===(null===t||void 0===t?void 0:t.readable)||!N(e))&&(!1===(null===t||void 0===t?void 0:t.writable)||!T(e)):null}function I(e){var t,n;return y(e)?e.writableErrored?e.writableErrored:null!==(t=null===(n=e._writableState)||void 0===n?void 0:n.errored)&&void 0!==t?t:null:null}function O(e){var t,n;return y(e)?e.readableErrored?e.readableErrored:null!==(t=null===(n=e._readableState)||void 0===n?void 0:n.errored)&&void 0!==t?t:null:null}function P(e){if(!y(e))return null;if("boolean"===typeof e.closed)return e.closed;const t=e._writableState,n=e._readableState;return"boolean"===typeof(null===t||void 0===t?void 0:t.closed)||"boolean"===typeof(null===n||void 0===n?void 0:n.closed)?(null===t||void 0===t?void 0:t.closed)||(null===n||void 0===n?void 0:n.closed):"boolean"===typeof e._closed&&x(e)?e._closed:null}function x(e){return"boolean"===typeof e._closed&&"boolean"===typeof e._defaultKeepAlive&&"boolean"===typeof e._removedConnection&&"boolean"===typeof e._removedContLen}function L(e){return"boolean"===typeof e._sent100&&x(e)}function D(e){var t;return"boolean"===typeof e._consuming&&"boolean"===typeof e._dumped&&void 0===(null===(t=e.req)||void 0===t?void 0:t.upgradeOrConnect)}function M(e){if(!y(e))return null;const t=e._writableState,n=e._readableState,r=t||n;return!r&&L(e)||!!(r&&r.autoDestroy&&r.emitClose&&!1===r.closed)}function B(e){var t;return!(!e||!(null!==(t=e[d])&&void 0!==t?t:e.readableDidRead||e.readableAborted))}function U(e){var t,n,r,i,o,s,a,c,d,h;return!(!e||!(null!==(t=null!==(n=null!==(r=null!==(i=null!==(o=null!==(s=e[l])&&void 0!==s?s:e.readableErrored)&&void 0!==o?o:e.writableErrored)&&void 0!==i?i:null===(a=e._readableState)||void 0===a?void 0:a.errorEmitted)&&void 0!==r?r:null===(c=e._writableState)||void 0===c?void 0:c.errorEmitted)&&void 0!==n?n:null===(d=e._readableState)||void 0===d?void 0:d.errored)&&void 0!==t?t:null===(h=e._writableState)||void 0===h?void 0:h.errored))}e.exports={kDestroyed:a,isDisturbed:B,kIsDisturbed:d,isErrored:U,kIsErrored:l,isReadable:N,kIsReadable:c,kIsClosedPromise:h,kControllerErrorFunction:u,isClosed:P,isDestroyed:E,isDuplexNodeStream:g,isFinished:C,isIterable:_,isReadableNodeStream:f,isReadableStream:b,isReadableEnded:A,isReadableFinished:k,isReadableErrored:O,isNodeStream:y,isWebStream:v,isWritable:T,isWritableNodeStream:p,isWritableStream:m,isWritableEnded:S,isWritableFinished:R,isWritableErrored:I,isServerRequest:D,isServerResponse:L,willEmitClose:M,isTransformStream:w}},76558:(e,t,n)=>{n(70560);const r=n(96027),{ArrayPrototypeSlice:i,Error:o,FunctionPrototypeSymbolHasInstance:s,ObjectDefineProperty:a,ObjectDefineProperties:l,ObjectSetPrototypeOf:c,StringPrototypeToLowerCase:d,Symbol:h,SymbolHasInstance:u}=n(17594);e.exports=L,L.WritableState=P;const{EventEmitter:f}=n(43793),p=n(2106).Stream,{Buffer:g}=n(15361),y=n(68818),{addAbortSignal:b}=n(76665),{getHighWaterMark:m,getDefaultHighWaterMark:w}=n(63695),{ERR_INVALID_ARG_TYPE:v,ERR_METHOD_NOT_IMPLEMENTED:_,ERR_MULTIPLE_CALLBACK:E,ERR_STREAM_CANNOT_PIPE:S,ERR_STREAM_DESTROYED:R,ERR_STREAM_ALREADY_FINISHED:A,ERR_STREAM_NULL_VALUES:k,ERR_STREAM_WRITE_AFTER_END:N,ERR_UNKNOWN_ENCODING:T}=n(49293).codes,{errorOrDestroy:C}=y;function I(){}c(L.prototype,p.prototype),c(L,p);const O=h("kOnFinished");function P(e,t,r){"boolean"!==typeof r&&(r=t instanceof n(59910)),this.objectMode=!(!e||!e.objectMode),r&&(this.objectMode=this.objectMode||!(!e||!e.writableObjectMode)),this.highWaterMark=e?m(this,e,"writableHighWaterMark",r):w(!1),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;const i=!(!e||!1!==e.decodeStrings);this.decodeStrings=!i,this.defaultEncoding=e&&e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=j.bind(void 0,t),this.writecb=null,this.writelen=0,this.afterWriteTickInfo=null,x(this),this.pendingcb=0,this.constructed=!0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!e||!1!==e.emitClose,this.autoDestroy=!e||!1!==e.autoDestroy,this.errored=null,this.closed=!1,this.closeEmitted=!1,this[O]=[]}function x(e){e.buffered=[],e.bufferedIndex=0,e.allBuffers=!0,e.allNoop=!0}function L(e){const t=this instanceof n(59910);if(!t&&!s(L,this))return new L(e);this._writableState=new P(e,this,t),e&&("function"===typeof e.write&&(this._write=e.write),"function"===typeof e.writev&&(this._writev=e.writev),"function"===typeof e.destroy&&(this._destroy=e.destroy),"function"===typeof e.final&&(this._final=e.final),"function"===typeof e.construct&&(this._construct=e.construct),e.signal&&b(e.signal,this)),p.call(this,e),y.construct(this,(()=>{const e=this._writableState;e.writing||$(this,e),V(this,e)}))}function D(e,t,n,i){const o=e._writableState;if("function"===typeof n)i=n,n=o.defaultEncoding;else{if(n){if("buffer"!==n&&!g.isEncoding(n))throw new T(n)}else n=o.defaultEncoding;"function"!==typeof i&&(i=I)}if(null===t)throw new k;if(!o.objectMode)if("string"===typeof t)!1!==o.decodeStrings&&(t=g.from(t,n),n="buffer");else if(t instanceof g)n="buffer";else{if(!p._isUint8Array(t))throw new v("chunk",["string","Buffer","Uint8Array"],t);t=p._uint8ArrayToBuffer(t),n="buffer"}let s;return o.ending?s=new N:o.destroyed&&(s=new R("write")),s?(r.nextTick(i,s),C(e,s,!0),s):(o.pendingcb++,M(e,o,t,n,i))}function M(e,t,n,r,i){const o=t.objectMode?1:n.length;t.length+=o;const s=t.length<t.highWaterMark;return s||(t.needDrain=!0),t.writing||t.corked||t.errored||!t.constructed?(t.buffered.push({chunk:n,encoding:r,callback:i}),t.allBuffers&&"buffer"!==r&&(t.allBuffers=!1),t.allNoop&&i!==I&&(t.allNoop=!1)):(t.writelen=o,t.writecb=i,t.writing=!0,t.sync=!0,e._write(n,r,t.onwrite),t.sync=!1),s&&!t.errored&&!t.destroyed}function B(e,t,n,r,i,o,s){t.writelen=r,t.writecb=s,t.writing=!0,t.sync=!0,t.destroyed?t.onwrite(new R("write")):n?e._writev(i,t.onwrite):e._write(i,o,t.onwrite),t.sync=!1}function U(e,t,n,r){--t.pendingcb,r(n),F(t),C(e,n)}function j(e,t){const n=e._writableState,i=n.sync,o=n.writecb;"function"===typeof o?(n.writing=!1,n.writecb=null,n.length-=n.writelen,n.writelen=0,t?(t.stack,n.errored||(n.errored=t),e._readableState&&!e._readableState.errored&&(e._readableState.errored=t),i?r.nextTick(U,e,n,t,o):U(e,n,t,o)):(n.buffered.length>n.bufferedIndex&&$(e,n),i?null!==n.afterWriteTickInfo&&n.afterWriteTickInfo.cb===o?n.afterWriteTickInfo.count++:(n.afterWriteTickInfo={count:1,cb:o,stream:e,state:n},r.nextTick(K,n.afterWriteTickInfo)):W(e,n,1,o))):C(e,new E)}function K({stream:e,state:t,count:n,cb:r}){return t.afterWriteTickInfo=null,W(e,t,n,r)}function W(e,t,n,r){const i=!t.ending&&!e.destroyed&&0===t.length&&t.needDrain;i&&(t.needDrain=!1,e.emit("drain"));while(n-- >0)t.pendingcb--,r();t.destroyed&&F(t),V(e,t)}function F(e){if(e.writing)return;for(let i=e.bufferedIndex;i<e.buffered.length;++i){var t;const{chunk:n,callback:r}=e.buffered[i],o=e.objectMode?1:n.length;e.length-=o,r(null!==(t=e.errored)&&void 0!==t?t:new R("write"))}const n=e[O].splice(0);for(let i=0;i<n.length;i++){var r;n[i](null!==(r=e.errored)&&void 0!==r?r:new R("end"))}x(e)}function $(e,t){if(t.corked||t.bufferProcessing||t.destroyed||!t.constructed)return;const{buffered:n,bufferedIndex:r,objectMode:o}=t,s=n.length-r;if(!s)return;let a=r;if(t.bufferProcessing=!0,s>1&&e._writev){t.pendingcb-=s-1;const r=t.allNoop?I:e=>{for(let t=a;t<n.length;++t)n[t].callback(e)},o=t.allNoop&&0===a?n:i(n,a);o.allBuffers=t.allBuffers,B(e,t,!0,t.length,o,"",r),x(t)}else{do{const{chunk:r,encoding:i,callback:s}=n[a];n[a++]=null;const l=o?1:r.length;B(e,t,!1,l,r,i,s)}while(a<n.length&&!t.writing);a===n.length?x(t):a>256?(n.splice(0,a),t.bufferedIndex=0):t.bufferedIndex=a}t.bufferProcessing=!1}function q(e){return e.ending&&!e.destroyed&&e.constructed&&0===e.length&&!e.errored&&0===e.buffered.length&&!e.finished&&!e.writing&&!e.errorEmitted&&!e.closeEmitted}function Z(e,t){let n=!1;function i(i){if(n)C(e,null!==i&&void 0!==i?i:E());else if(n=!0,t.pendingcb--,i){const n=t[O].splice(0);for(let e=0;e<n.length;e++)n[e](i);C(e,i,t.sync)}else q(t)&&(t.prefinished=!0,e.emit("prefinish"),t.pendingcb++,r.nextTick(G,e,t))}t.sync=!0,t.pendingcb++;try{e._final(i)}catch(o){i(o)}t.sync=!1}function H(e,t){t.prefinished||t.finalCalled||("function"!==typeof e._final||t.destroyed?(t.prefinished=!0,e.emit("prefinish")):(t.finalCalled=!0,Z(e,t)))}function V(e,t,n){q(t)&&(H(e,t),0===t.pendingcb&&(n?(t.pendingcb++,r.nextTick(((e,t)=>{q(t)?G(e,t):t.pendingcb--}),e,t)):q(t)&&(t.pendingcb++,G(e,t))))}function G(e,t){t.pendingcb--,t.finished=!0;const n=t[O].splice(0);for(let r=0;r<n.length;r++)n[r]();if(e.emit("finish"),t.autoDestroy){const t=e._readableState,n=!t||t.autoDestroy&&(t.endEmitted||!1===t.readable);n&&e.destroy()}}P.prototype.getBuffer=function(){return i(this.buffered,this.bufferedIndex)},a(P.prototype,"bufferedRequestCount",{__proto__:null,get(){return this.buffered.length-this.bufferedIndex}}),a(L,u,{__proto__:null,value:function(e){return!!s(this,e)||this===L&&(e&&e._writableState instanceof P)}}),L.prototype.pipe=function(){C(this,new S)},L.prototype.write=function(e,t,n){return!0===D(this,e,t,n)},L.prototype.cork=function(){this._writableState.corked++},L.prototype.uncork=function(){const e=this._writableState;e.corked&&(e.corked--,e.writing||$(this,e))},L.prototype.setDefaultEncoding=function(e){if("string"===typeof e&&(e=d(e)),!g.isEncoding(e))throw new T(e);return this._writableState.defaultEncoding=e,this},L.prototype._write=function(e,t,n){if(!this._writev)throw new _("_write()");this._writev([{chunk:e,encoding:t}],n)},L.prototype._writev=null,L.prototype.end=function(e,t,n){const i=this._writableState;let s;if("function"===typeof e?(n=e,e=null,t=null):"function"===typeof t&&(n=t,t=null),null!==e&&void 0!==e){const n=D(this,e,t);n instanceof o&&(s=n)}return i.corked&&(i.corked=1,this.uncork()),s||(i.errored||i.ending?i.finished?s=new A("end"):i.destroyed&&(s=new R("end")):(i.ending=!0,V(this,i,!0),i.ended=!0)),"function"===typeof n&&(s||i.finished?r.nextTick(n,s):i[O].push(n)),this},l(L.prototype,{closed:{__proto__:null,get(){return!!this._writableState&&this._writableState.closed}},destroyed:{__proto__:null,get(){return!!this._writableState&&this._writableState.destroyed},set(e){this._writableState&&(this._writableState.destroyed=e)}},writable:{__proto__:null,get(){const e=this._writableState;return!!e&&!1!==e.writable&&!e.destroyed&&!e.errored&&!e.ending&&!e.ended},set(e){this._writableState&&(this._writableState.writable=!!e)}},writableFinished:{__proto__:null,get(){return!!this._writableState&&this._writableState.finished}},writableObjectMode:{__proto__:null,get(){return!!this._writableState&&this._writableState.objectMode}},writableBuffer:{__proto__:null,get(){return this._writableState&&this._writableState.getBuffer()}},writableEnded:{__proto__:null,get(){return!!this._writableState&&this._writableState.ending}},writableNeedDrain:{__proto__:null,get(){const e=this._writableState;return!!e&&(!e.destroyed&&!e.ending&&e.needDrain)}},writableHighWaterMark:{__proto__:null,get(){return this._writableState&&this._writableState.highWaterMark}},writableCorked:{__proto__:null,get(){return this._writableState?this._writableState.corked:0}},writableLength:{__proto__:null,get(){return this._writableState&&this._writableState.length}},errored:{__proto__:null,enumerable:!1,get(){return this._writableState?this._writableState.errored:null}},writableAborted:{__proto__:null,enumerable:!1,get:function(){return!(!1===this._writableState.writable||!this._writableState.destroyed&&!this._writableState.errored||this._writableState.finished)}}});const Y=y.destroy;let J;function z(){return void 0===J&&(J={}),J}L.prototype.destroy=function(e,t){const n=this._writableState;return!n.destroyed&&(n.bufferedIndex<n.buffered.length||n[O].length)&&r.nextTick(F,n),Y.call(this,e,t),this},L.prototype._undestroy=y.undestroy,L.prototype._destroy=function(e,t){t(e)},L.prototype[f.captureRejectionSymbol]=function(e){this.destroy(e)},L.fromWeb=function(e,t){return z().newStreamWritableFromWritableStream(e,t)},L.toWeb=function(e){return z().newWritableStreamFromStreamWritable(e)}},57712:(e,t,n)=>{"use strict";const{ArrayIsArray:r,ArrayPrototypeIncludes:i,ArrayPrototypeJoin:o,ArrayPrototypeMap:s,NumberIsInteger:a,NumberIsNaN:l,NumberMAX_SAFE_INTEGER:c,NumberMIN_SAFE_INTEGER:d,NumberParseInt:h,ObjectPrototypeHasOwnProperty:u,RegExpPrototypeExec:f,String:p,StringPrototypeToUpperCase:g,StringPrototypeTrim:y}=n(17594),{hideStackFrames:b,codes:{ERR_SOCKET_BAD_PORT:m,ERR_INVALID_ARG_TYPE:w,ERR_INVALID_ARG_VALUE:v,ERR_OUT_OF_RANGE:_,ERR_UNKNOWN_SIGNAL:E}}=n(49293),{normalizeEncoding:S}=n(81125),{isAsyncFunction:R,isArrayBufferView:A}=n(81125).types,k={};function N(e){return e===(0|e)}function T(e){return e===e>>>0}const C=/^[0-7]+$/,I="must be a 32-bit unsigned integer or an octal string";function O(e,t,n){if("undefined"===typeof e&&(e=n),"string"===typeof e){if(null===f(C,e))throw new v(t,e,I);e=h(e,8)}return L(e,t),e}const P=b(((e,t,n=d,r=c)=>{if("number"!==typeof e)throw new w(t,"number",e);if(!a(e))throw new _(t,"an integer",e);if(e<n||e>r)throw new _(t,`>= ${n} && <= ${r}`,e)})),x=b(((e,t,n=-2147483648,r=2147483647)=>{if("number"!==typeof e)throw new w(t,"number",e);if(!a(e))throw new _(t,"an integer",e);if(e<n||e>r)throw new _(t,`>= ${n} && <= ${r}`,e)})),L=b(((e,t,n=!1)=>{if("number"!==typeof e)throw new w(t,"number",e);if(!a(e))throw new _(t,"an integer",e);const r=n?1:0,i=4294967295;if(e<r||e>i)throw new _(t,`>= ${r} && <= ${i}`,e)}));function D(e,t){if("string"!==typeof e)throw new w(t,"string",e)}function M(e,t,n=void 0,r){if("number"!==typeof e)throw new w(t,"number",e);if(null!=n&&e<n||null!=r&&e>r||(null!=n||null!=r)&&l(e))throw new _(t,`${null!=n?`>= ${n}`:""}${null!=n&&null!=r?" && ":""}${null!=r?`<= ${r}`:""}`,e)}const B=b(((e,t,n)=>{if(!i(n,e)){const r=o(s(n,(e=>"string"===typeof e?`'${e}'`:p(e))),", "),i="must be one of: "+r;throw new v(t,e,i)}}));function U(e,t){if("boolean"!==typeof e)throw new w(t,"boolean",e)}function j(e,t,n){return null!=e&&u(e,t)?e[t]:n}const K=b(((e,t,n=null)=>{const i=j(n,"allowArray",!1),o=j(n,"allowFunction",!1),s=j(n,"nullable",!1);if(!s&&null===e||!i&&r(e)||"object"!==typeof e&&(!o||"function"!==typeof e))throw new w(t,"Object",e)})),W=b(((e,t)=>{if(null!=e&&"object"!==typeof e&&"function"!==typeof e)throw new w(t,"a dictionary",e)})),F=b(((e,t,n=0)=>{if(!r(e))throw new w(t,"Array",e);if(e.length<n){const r=`must be longer than ${n}`;throw new v(t,e,r)}}));function $(e,t){F(e,t);for(let n=0;n<e.length;n++)D(e[n],`${t}[${n}]`)}function q(e,t){F(e,t);for(let n=0;n<e.length;n++)U(e[n],`${t}[${n}]`)}function Z(e,t="signal"){if(D(e,t),void 0===k[e]){if(void 0!==k[g(e)])throw new E(e+" (signals must use all capital letters)");throw new E(e)}}const H=b(((e,t="buffer")=>{if(!A(e))throw new w(t,["Buffer","TypedArray","DataView"],e)}));function V(e,t){const n=S(t),r=e.length;if("hex"===n&&r%2!==0)throw new v("encoding",t,`is invalid for data of length ${r}`)}function G(e,t="Port",n=!0){if("number"!==typeof e&&"string"!==typeof e||"string"===typeof e&&0===y(e).length||+e!==+e>>>0||e>65535||0===e&&!n)throw new m(t,e,n);return 0|e}const Y=b(((e,t)=>{if(void 0!==e&&(null===e||"object"!==typeof e||!("aborted"in e)))throw new w(t,"AbortSignal",e)})),J=b(((e,t)=>{if("function"!==typeof e)throw new w(t,"Function",e)})),z=b(((e,t)=>{if("function"!==typeof e||R(e))throw new w(t,"Function",e)})),X=b(((e,t)=>{if(void 0!==e)throw new w(t,"undefined",e)}));function Q(e,t,n){if(!i(n,e))throw new w(t,`('${o(n,"|")}')`,e)}const ee=/^(?:<[^>]*>)(?:\s*;\s*[^;"\s]+(?:=(")?[^;"\s]*\1)?)*$/;function te(e,t){if("undefined"===typeof e||!f(ee,e))throw new v(t,e,'must be an array or string of format "</styles.css>; rel=preload; as=style"')}function ne(e){if("string"===typeof e)return te(e,"hints"),e;if(r(e)){const t=e.length;let n="";if(0===t)return n;for(let r=0;r<t;r++){const i=e[r];te(i,"hints"),n+=i,r!==t-1&&(n+=", ")}return n}throw new v("hints",e,'must be an array or string of format "</styles.css>; rel=preload; as=style"')}e.exports={isInt32:N,isUint32:T,parseFileMode:O,validateArray:F,validateStringArray:$,validateBooleanArray:q,validateBoolean:U,validateBuffer:H,validateDictionary:W,validateEncoding:V,validateFunction:J,validateInt32:x,validateInteger:P,validateNumber:M,validateObject:K,validateOneOf:B,validatePlainFunction:z,validatePort:G,validateSignalName:Z,validateString:D,validateUint32:L,validateUndefined:X,validateUnion:Q,validateAbortSignal:Y,validateLinkHeaderValue:ne}},42140:(e,t,n)=>{"use strict";const r=n(57051),i=n(36895),o=r.Readable.destroy;e.exports=r.Readable,e.exports._uint8ArrayToBuffer=r._uint8ArrayToBuffer,e.exports._isUint8Array=r._isUint8Array,e.exports.isDisturbed=r.isDisturbed,e.exports.isErrored=r.isErrored,e.exports.isReadable=r.isReadable,e.exports.Readable=r.Readable,e.exports.Writable=r.Writable,e.exports.Duplex=r.Duplex,e.exports.Transform=r.Transform,e.exports.PassThrough=r.PassThrough,e.exports.addAbortSignal=r.addAbortSignal,e.exports.finished=r.finished,e.exports.destroy=r.destroy,e.exports.destroy=o,e.exports.pipeline=r.pipeline,e.exports.compose=r.compose,Object.defineProperty(r,"promises",{configurable:!0,enumerable:!0,get(){return i}}),e.exports.Stream=r.Stream,e.exports["default"]=e.exports},49293:(e,t,n)=>{"use strict";n(21057),n(95879),n(54927),n(45398),n(86544),n(64043),n(70560),n(76801);const{format:r,inspect:i,AggregateError:o}=n(81125),s=globalThis.AggregateError||o,a=Symbol("kIsNodeError"),l=["string","function","number","object","Function","Object","boolean","bigint","symbol"],c=/^([A-Z][a-z0-9]*)+$/,d="__node_internal_",h={};function u(e,t){if(!e)throw new h.ERR_INTERNAL_ASSERTION(t)}function f(e){let t="",n=e.length;const r="-"===e[0]?1:0;for(;n>=r+4;n-=3)t=`_${e.slice(n-3,n)}${t}`;return`${e.slice(0,n)}${t}`}function p(e,t,n){if("function"===typeof t)return u(t.length<=n.length,`Code: ${e}; The provided arguments length (${n.length}) does not match the required ones (${t.length}).`),t(...n);const i=(t.match(/%[dfijoOs]/g)||[]).length;return u(i===n.length,`Code: ${e}; The provided arguments length (${n.length}) does not match the required ones (${i}).`),0===n.length?t:r(t,...n)}function g(e,t,n){n||(n=Error);class r extends n{constructor(...n){super(p(e,t,n))}toString(){return`${this.name} [${e}]: ${this.message}`}}Object.defineProperties(r.prototype,{name:{value:n.name,writable:!0,enumerable:!1,configurable:!0},toString:{value(){return`${this.name} [${e}]: ${this.message}`},writable:!0,enumerable:!1,configurable:!0}}),r.prototype.code=e,r.prototype[a]=!0,h[e]=r}function y(e){const t=d+e.name;return Object.defineProperty(e,"name",{value:t}),e}function b(e,t){if(e&&t&&e!==t){if(Array.isArray(t.errors))return t.errors.push(e),t;const n=new s([t,e],t.message);return n.code=t.code,n}return e||t}class m extends Error{constructor(e="The operation was aborted",t=void 0){if(void 0!==t&&"object"!==typeof t)throw new h.ERR_INVALID_ARG_TYPE("options","Object",t);super(e,t),this.code="ABORT_ERR",this.name="AbortError"}}g("ERR_ASSERTION","%s",Error),g("ERR_INVALID_ARG_TYPE",((e,t,n)=>{u("string"===typeof e,"'name' must be a string"),Array.isArray(t)||(t=[t]);let r="The ";e.endsWith(" argument")?r+=`${e} `:r+=`"${e}" ${e.includes(".")?"property":"argument"} `,r+="must be ";const o=[],s=[],a=[];for(const i of t)u("string"===typeof i,"All expected entries have to be of type string"),l.includes(i)?o.push(i.toLowerCase()):c.test(i)?s.push(i):(u("object"!==i,'The value "object" should be written as "Object"'),a.push(i));if(s.length>0){const e=o.indexOf("object");-1!==e&&(o.splice(o,e,1),s.push("Object"))}if(o.length>0){switch(o.length){case 1:r+=`of type ${o[0]}`;break;case 2:r+=`one of type ${o[0]} or ${o[1]}`;break;default:{const e=o.pop();r+=`one of type ${o.join(", ")}, or ${e}`}}(s.length>0||a.length>0)&&(r+=" or ")}if(s.length>0){switch(s.length){case 1:r+=`an instance of ${s[0]}`;break;case 2:r+=`an instance of ${s[0]} or ${s[1]}`;break;default:{const e=s.pop();r+=`an instance of ${s.join(", ")}, or ${e}`}}a.length>0&&(r+=" or ")}switch(a.length){case 0:break;case 1:a[0].toLowerCase()!==a[0]&&(r+="an "),r+=`${a[0]}`;break;case 2:r+=`one of ${a[0]} or ${a[1]}`;break;default:{const e=a.pop();r+=`one of ${a.join(", ")}, or ${e}`}}if(null==n)r+=`. Received ${n}`;else if("function"===typeof n&&n.name)r+=`. Received function ${n.name}`;else if("object"===typeof n){var d;if(null!==(d=n.constructor)&&void 0!==d&&d.name)r+=`. Received an instance of ${n.constructor.name}`;else{const e=i(n,{depth:-1});r+=`. Received ${e}`}}else{let e=i(n,{colors:!1});e.length>25&&(e=`${e.slice(0,25)}...`),r+=`. Received type ${typeof n} (${e})`}return r}),TypeError),g("ERR_INVALID_ARG_VALUE",((e,t,n="is invalid")=>{let r=i(t);r.length>128&&(r=r.slice(0,128)+"...");const o=e.includes(".")?"property":"argument";return`The ${o} '${e}' ${n}. Received ${r}`}),TypeError),g("ERR_INVALID_RETURN_VALUE",((e,t,n)=>{var r;const i=null!==n&&void 0!==n&&null!==(r=n.constructor)&&void 0!==r&&r.name?`instance of ${n.constructor.name}`:"type "+typeof n;return`Expected ${e} to be returned from the "${t}" function but got ${i}.`}),TypeError),g("ERR_MISSING_ARGS",((...e)=>{let t;u(e.length>0,"At least one arg needs to be specified");const n=e.length;switch(e=(Array.isArray(e)?e:[e]).map((e=>`"${e}"`)).join(" or "),n){case 1:t+=`The ${e[0]} argument`;break;case 2:t+=`The ${e[0]} and ${e[1]} arguments`;break;default:{const n=e.pop();t+=`The ${e.join(", ")}, and ${n} arguments`}break}return`${t} must be specified`}),TypeError),g("ERR_OUT_OF_RANGE",((e,t,n)=>{let r;return u(t,'Missing "range" argument'),Number.isInteger(n)&&Math.abs(n)>2**32?r=f(String(n)):"bigint"===typeof n?(r=String(n),(n>2n**32n||n<-(2n**32n))&&(r=f(r)),r+="n"):r=i(n),`The value of "${e}" is out of range. It must be ${t}. Received ${r}`}),RangeError),g("ERR_MULTIPLE_CALLBACK","Callback called multiple times",Error),g("ERR_METHOD_NOT_IMPLEMENTED","The %s method is not implemented",Error),g("ERR_STREAM_ALREADY_FINISHED","Cannot call %s after a stream was finished",Error),g("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable",Error),g("ERR_STREAM_DESTROYED","Cannot call %s after a stream was destroyed",Error),g("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),g("ERR_STREAM_PREMATURE_CLOSE","Premature close",Error),g("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF",Error),g("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event",Error),g("ERR_STREAM_WRITE_AFTER_END","write after end",Error),g("ERR_UNKNOWN_ENCODING","Unknown encoding: %s",TypeError),e.exports={AbortError:m,aggregateTwoErrors:y(b),hideStackFrames:y,codes:h}},17594:(e,t,n)=>{"use strict";n(76801),n(70560),n(21057),n(86544),n(76034),n(64043),n(95194),n(79943),n(20522),n(82),n(79976),n(93356),n(24224),n(61121),n(37133),e.exports={ArrayIsArray(e){return Array.isArray(e)},ArrayPrototypeIncludes(e,t){return e.includes(t)},ArrayPrototypeIndexOf(e,t){return e.indexOf(t)},ArrayPrototypeJoin(e,t){return e.join(t)},ArrayPrototypeMap(e,t){return e.map(t)},ArrayPrototypePop(e,t){return e.pop(t)},ArrayPrototypePush(e,t){return e.push(t)},ArrayPrototypeSlice(e,t,n){return e.slice(t,n)},Error,FunctionPrototypeCall(e,t,...n){return e.call(t,...n)},FunctionPrototypeSymbolHasInstance(e,t){return Function.prototype[Symbol.hasInstance].call(e,t)},MathFloor:Math.floor,Number,NumberIsInteger:Number.isInteger,NumberIsNaN:Number.isNaN,NumberMAX_SAFE_INTEGER:Number.MAX_SAFE_INTEGER,NumberMIN_SAFE_INTEGER:Number.MIN_SAFE_INTEGER,NumberParseInt:Number.parseInt,ObjectDefineProperties(e,t){return Object.defineProperties(e,t)},ObjectDefineProperty(e,t,n){return Object.defineProperty(e,t,n)},ObjectGetOwnPropertyDescriptor(e,t){return Object.getOwnPropertyDescriptor(e,t)},ObjectKeys(e){return Object.keys(e)},ObjectSetPrototypeOf(e,t){return Object.setPrototypeOf(e,t)},Promise,PromisePrototypeCatch(e,t){return e.catch(t)},PromisePrototypeThen(e,t,n){return e.then(t,n)},PromiseReject(e){return Promise.reject(e)},ReflectApply:Reflect.apply,RegExpPrototypeTest(e,t){return e.test(t)},SafeSet:Set,String,StringPrototypeSlice(e,t,n){return e.slice(t,n)},StringPrototypeToLowerCase(e){return e.toLowerCase()},StringPrototypeToUpperCase(e){return e.toUpperCase()},StringPrototypeTrim(e){return e.trim()},Symbol,SymbolFor:Symbol.for,SymbolAsyncIterator:Symbol.asyncIterator,SymbolHasInstance:Symbol.hasInstance,SymbolIterator:Symbol.iterator,TypedArrayPrototypeSet(e,t,n){return e.set(t,n)},Uint8Array}},81125:(e,t,n)=>{"use strict";n(45398),n(21057),n(64043),n(57267),n(48324),n(76801),n(86544);const r=n(15361),i=Object.getPrototypeOf((async function(){})).constructor,o=globalThis.Blob||r.Blob,s="undefined"!==typeof o?function(e){return e instanceof o}:function(e){return!1};class a extends Error{constructor(e){if(!Array.isArray(e))throw new TypeError("Expected input to be an Array, got "+typeof e);let t="";for(let n=0;n<e.length;n++)t+=`    ${e[n].stack}\n`;super(t),this.name="AggregateError",this.errors=e}}e.exports={AggregateError:a,kEmptyObject:Object.freeze({}),once(e){let t=!1;return function(...n){t||(t=!0,e.apply(this,n))}},createDeferredPromise:function(){let e,t;const n=new Promise(((n,r)=>{e=n,t=r}));return{promise:n,resolve:e,reject:t}},promisify(e){return new Promise(((t,n)=>{e(((e,...r)=>e?n(e):t(...r)))}))},debuglog(){return function(){}},format(e,...t){return e.replace(/%([sdifj])/g,(function(...[e,n]){const r=t.shift();if("f"===n)return r.toFixed(6);if("j"===n)return JSON.stringify(r);if("s"===n&&"object"===typeof r){const e=r.constructor!==Object?r.constructor.name:"";return`${e} {}`.trim()}return r.toString()}))},inspect(e){switch(typeof e){case"string":if(e.includes("'")){if(!e.includes('"'))return`"${e}"`;if(!e.includes("`")&&!e.includes("${"))return`\`${e}\``}return`'${e}'`;case"number":return isNaN(e)?"NaN":Object.is(e,-0)?String(e):e;case"bigint":return`${String(e)}n`;case"boolean":case"undefined":return String(e);case"object":return"{}"}},types:{isAsyncFunction(e){return e instanceof i},isArrayBufferView(e){return ArrayBuffer.isView(e)}},isBlob:s},e.exports.promisify.custom=Symbol.for("nodejs.util.promisify.custom")},57051:(e,t,n)=>{n(95194),n(79943),n(20522),n(82),n(79976),n(93356),n(24224),n(61121),n(37133);const{Buffer:r}=n(15361),{ObjectDefineProperty:i,ObjectKeys:o,ReflectApply:s}=n(17594),{promisify:{custom:a}}=n(81125),{streamReturningOperators:l,promiseReturningOperators:c}=n(23196),{codes:{ERR_ILLEGAL_CONSTRUCTOR:d}}=n(49293),h=n(92431),{pipeline:u}=n(55918),{destroyer:f}=n(68818),p=n(40701),g=n(36895),y=n(49888),b=e.exports=n(2106).Stream;b.isDisturbed=y.isDisturbed,b.isErrored=y.isErrored,b.isReadable=y.isReadable,b.Readable=n(67180);for(const v of o(l)){const _=l[v];function m(...e){if(new.target)throw d();return b.Readable.from(s(_,this,e))}i(m,"name",{__proto__:null,value:_.name}),i(m,"length",{__proto__:null,value:_.length}),i(b.Readable.prototype,v,{__proto__:null,value:m,enumerable:!1,configurable:!0,writable:!0})}for(const E of o(c)){const S=c[E];function m(...e){if(new.target)throw d();return s(S,this,e)}i(m,"name",{__proto__:null,value:S.name}),i(m,"length",{__proto__:null,value:S.length}),i(b.Readable.prototype,E,{__proto__:null,value:m,enumerable:!1,configurable:!0,writable:!0})}b.Writable=n(76558),b.Duplex=n(59910),b.Transform=n(61917),b.PassThrough=n(80511),b.pipeline=u;const{addAbortSignal:w}=n(76665);b.addAbortSignal=w,b.finished=p,b.destroy=f,b.compose=h,i(b,"promises",{__proto__:null,configurable:!0,enumerable:!0,get(){return g}}),i(u,a,{__proto__:null,enumerable:!0,get(){return g.pipeline}}),i(p,a,{__proto__:null,enumerable:!0,get(){return g.finished}}),b.Stream=b,b._isUint8Array=function(e){return e instanceof Uint8Array},b._uint8ArrayToBuffer=function(e){return r.from(e.buffer,e.byteOffset,e.byteLength)}},36895:(e,t,n)=>{"use strict";const{ArrayPrototypePop:r,Promise:i}=n(17594),{isIterable:o,isNodeStream:s,isWebStream:a}=n(49888),{pipelineImpl:l}=n(55918),{finished:c}=n(40701);function d(...e){return new i(((t,n)=>{let i,c;const d=e[e.length-1];if(d&&"object"===typeof d&&!s(d)&&!o(d)&&!a(d)){const t=r(e);i=t.signal,c=t.end}l(e,((e,r)=>{e?n(e):t(r)}),{signal:i,end:c})}))}n(57051),e.exports={finished:c,pipeline:d}}}]);
//# sourceMappingURL=598.f09fedd5.js.map