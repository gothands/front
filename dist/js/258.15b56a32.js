(self["webpackChunkHandsy_io"]=self["webpackChunkHandsy_io"]||[]).push([[258],{61258:(e,t,n)=>{"use strict";n.d(t,{OpenloginAdapter:()=>mt,getOpenloginDefaultOptions:()=>yt});n(21703),n(26699),n(38862);var r=n(47327),i=n(2160),o=n.n(i),s=n(95082),a=n(50815);const c=o();function l(e){return c.encode(e)}function u(e){return c.decode(e)}function d(e){return c.encode(JSON.stringify(e))}function h(e){let t,n=!1,r=0;try{t=window[e],n=!0,r=t.length;const i="__storage_test__";return t.setItem(i,i),t.removeItem(i),!0}catch(i){const e=i;return e&&(22===e.code||1014===e.code||"QuotaExceededError"===e.name||"NS_ERROR_DOM_QUOTA_REACHED"===e.name)&&n&&0!==r}}class f{constructor(){(0,r.Z)(this,"store",{})}getItem(e){return this.store[e]||null}setItem(e,t){this.store[e]=t}}class p{constructor(e,t){(0,r.Z)(this,"storage",void 0),(0,r.Z)(this,"_storeKey",void 0),this.storage=t,this._storeKey=e;try{t.getItem(e)||this.resetStore()}catch(n){}}static getInstance(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"local";if(!this.instance){let n;n="local"===t&&h("localStorage")?window.localStorage:"session"===t&&h("sessionStorage")?window.sessionStorage:new f,this.instance=new this(e,n)}return this.instance}toJSON(){return this.storage.getItem(this._storeKey)}resetStore(){const e=this.getStore();return this.storage.setItem(this._storeKey,JSON.stringify({})),e}getStore(){return JSON.parse(this.storage.getItem(this._storeKey)||"{}")}get(e){const t=JSON.parse(this.storage.getItem(this._storeKey)||"{}");return t[e]}set(e,t){const n=JSON.parse(this.storage.getItem(this._storeKey)||"{}");n[e]=t,this.storage.setItem(this._storeKey,JSON.stringify(n))}}(0,r.Z)(p,"instance",void 0);const g={POPUP:"popup",REDIRECT:"redirect"},y=(0,s.Z)((0,s.Z)({},a.X_),a.Ad),m={SECP256K1:"secp256k1",ED25519:"ed25519"},b={GOOGLE:"google",FACEBOOK:"facebook",REDDIT:"reddit",DISCORD:"discord",TWITCH:"twitch",APPLE:"apple",LINE:"line",GITHUB:"github",KAKAO:"kakao",LINKEDIN:"linkedin",TWITTER:"twitter",WEIBO:"weibo",WECHAT:"wechat",EMAIL_PASSWORDLESS:"email_passwordless",SMS_PASSWORDLESS:"sms_passwordless",WEBAUTHN:"webauthn",JWT:"jwt"},w={LOGIN:"login",ENABLE_MFA:"enable_mfa",MODIFY_MFA:"modify_mfa"},v={PRODUCTION:"production",DEVELOPMENT:"development",STAGING:"staging",TESTING:"testing"};n(83753),n(74916),n(15306);var _=n(17228),S=n(89245),E=n.n(S),k=(n(57658),n(73148)),T=n.n(k);const P=E().getLogger("http-helpers");P.setLevel(S.levels.INFO);let R="torus-default",A="";const O="x-api-key",N="x-embed-host";let C=null;const I=[],x=[];async function M(e,t){let n=null;try{n=new URL(e)}catch(r){}if(C&&n&&(I.includes(n.origin)||x.includes(n.pathname))){const n=C.startTransaction({name:e}),r=n.startChild({op:"http"}),i=await fetch(e,t);return r.finish(),n.finish(),i}return fetch(e,t)}function L(){const e={};return R&&(e[O]=R),A&&(e[N]=A),e}function D(e){P.info(`Response: ${e.status} ${e.statusText}`),P.info(`Url: ${e.url}`)}function B(e){P.info(`Request tracing with traceID=${e.headers.get("x-web3-correlation-id")}`)}const j=(e,t)=>{const n=new Promise(((t,n)=>{const r=setTimeout((()=>{clearTimeout(r),n(new Error(`Timed out in ${e}ms`))}),e)}));return Promise.race([t,n])},U=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r={mode:"cors",headers:{}};n.useAPIKey&&(r.headers=(0,s.Z)((0,s.Z)({},r.headers),L()));const i=T()(r,t,{method:"GET"}),o=await M(e,i);if(o.ok){const e=o.headers.get("content-type");return null!==e&&void 0!==e&&e.includes("application/json")?o.json():o.text()}throw D(o),o},K=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const i={mode:"cors",headers:{"Content-Type":"application/json; charset=utf-8"}};r.useAPIKey&&(i.headers=(0,s.Z)((0,s.Z)({},i.headers),L()));const o=T()(i,n,{method:"POST"});return r.isUrlEncodedData?(o.body=t,"application/json; charset=utf-8"===o.headers["Content-Type"]&&delete o.headers["Content-Type"]):o.body=JSON.stringify(t),j(r.timeout||6e4,M(e,o).then((e=>{if(r.logTracingHeader&&B(e),e.ok){const t=e.headers.get("content-type");return null!==t&&void 0!==t&&t.includes("application/json")?e.json():e.text()}throw D(e),e})))},F=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const i={mode:"cors",headers:{"Content-Type":"application/json; charset=utf-8"}};r.useAPIKey&&(i.headers=(0,s.Z)((0,s.Z)({},i.headers),L()));const o=T()(i,n,{method:"PATCH"});r.isUrlEncodedData?(o.body=t,"application/json; charset=utf-8"===o.headers["Content-Type"]&&delete o.headers["Content-Type"]):o.body=JSON.stringify(t);const a=await M(e,o);if(a.ok){const e=a.headers.get("content-type");return null!==e&&void 0!==e&&e.includes("application/json")?a.json():a.text()}throw D(a),a},W=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const i={mode:"cors",headers:{"Content-Type":"application/json; charset=utf-8"}};r.useAPIKey&&(i.headers=(0,s.Z)((0,s.Z)({},i.headers),L()));const o=T()(i,n,{method:"PUT"});r.isUrlEncodedData?(o.body=t,"application/json; charset=utf-8"===o.headers["Content-Type"]&&delete o.headers["Content-Type"]):o.body=JSON.stringify(t);const a=await M(e,o);if(a.ok){const e=a.headers.get("content-type");return null!==e&&void 0!==e&&e.includes("application/json")?a.json():a.text()}throw D(a),a};class ${constructor(){(0,r.Z)(this,"sessionId",void 0)}checkSessionParams(){if(!this.sessionId)throw new Error("Session id is required");this.sessionId=this.sessionId.padStart(64,"0")}request(e){let{method:t="GET",url:n,data:r={},headers:i={}}=e;const o={headers:i};switch(t){case"GET":return U(n,o);case"POST":return K(n,r,o);case"PUT":return W(n,r,o);case"PATCH":return F(n,r,o)}throw new Error("Invalid method type")}}n(48675),n(33105),n(63408),n(14590),n(3462),n(33824),n(23767),n(8585),n(68696);var H=n(59821),V=n(32127),q=n(15361)["Buffer"];const Z=new V.ec("secp256k1"),G=n.g.crypto||n.g.msCrypto||{},Y=G.subtle||G.webkitSubtle,J=q.from("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141","hex"),z=q.alloc(32,0);function X(e,t){if(!e)throw new Error(t||"Assertion failed")}function Q(e){return q.isBuffer(e)&&32===e.length}function ee(e){return!!Q(e)&&(e.compare(z)>0&&e.compare(J)<0)}function te(e,t){if(e.length!==t.length)return!1;let n=0;for(let r=0;r<e.length;r++)n|=e[r]^t[r];return 0===n}function ne(e){const t=new Uint8Array(e);return"undefined"===typeof G.getRandomValues?q.from(H.randomBytes(e)):(G.getRandomValues(t),q.from(t))}async function re(e){if(Y){const t=await Y.digest("SHA-512",e),n=new Uint8Array(t);return n}const t=H.createHash("sha512"),n=t.update(e).digest();return new Uint8Array(n)}function ie(e){return async function(t,n,r){if(Y){const i={name:"AES-CBC"},o=await Y.importKey("raw",n,i,!1,[e]),s={name:"AES-CBC",iv:t},a=await Y[e](s,o,r);return q.from(new Uint8Array(a))}if("encrypt"===e){const e=H.createCipheriv("aes-256-cbc",n,t),i=e.update(r),o=e.final();return q.concat([i,o])}if("decrypt"===e){const e=H.createDecipheriv("aes-256-cbc",n,t),i=e.update(r),o=e.final();return q.concat([i,o])}throw new Error(`Unsupported operation: ${e}`)}}const oe=ie("encrypt"),se=ie("decrypt");async function ae(e,t){if(Y){const n={name:"HMAC",hash:{name:"SHA-256"}},r=await Y.importKey("raw",new Uint8Array(e),n,!1,["sign","verify"]),i=await Y.sign("HMAC",r,t),o=q.from(new Uint8Array(i));return o}const n=H.createHmac("sha256",q.from(e));n.update(t);const r=n.digest();return r}async function ce(e,t,n){const r=await ae(e,t);return te(r,n)}const le=function(){let e=ne(32);while(!ee(e))e=ne(32);return e},ue=function(e){return X(32===e.length,"Bad private key"),X(ee(e),"Bad private key"),q.from(Z.keyFromPrivate(e).getPublic("array"))},de=async function(e,t){return X(32===e.length,"Bad private key"),X(ee(e),"Bad private key"),X(t.length>0,"Message should not be empty"),X(t.length<=32,"Message is too long"),q.from(Z.sign(t,e,{canonical:!0}).toDER())},he=async function(e,t){X(q.isBuffer(e),"Bad private key"),X(q.isBuffer(t),"Bad public key"),X(32===e.length,"Bad private key"),X(ee(e),"Bad private key"),X(65===t.length||33===t.length,"Bad public key"),65===t.length&&X(4===t[0],"Bad public key"),33===t.length&&X(2===t[0]||3===t[0],"Bad public key");const n=Z.keyFromPrivate(e),r=Z.keyFromPublic(t),i=n.derive(r.getPublic());return q.from(i.toArray())},fe=he,pe=async function(e,t){X(q.isBuffer(e),"Bad private key"),X(q.isBuffer(t),"Bad public key"),X(32===e.length,"Bad private key"),X(ee(e),"Bad private key"),X(65===t.length||33===t.length,"Bad public key"),65===t.length&&X(4===t[0],"Bad public key"),33===t.length&&X(2===t[0]||3===t[0],"Bad public key");const n=Z.keyFromPrivate(e),r=Z.keyFromPublic(t),i=n.derive(r.getPublic());return q.from(i.toString(16,64),"hex")},ge=async function(e,t,n){n=n||{};let r=n.ephemPrivateKey||ne(32);while(!ee(r))r=n.ephemPrivateKey||ne(32);const i=ue(r),o=await fe(r,e),s=await re(o),a=n.iv||ne(16),c=s.slice(0,32),l=s.slice(32),u=await oe(a,q.from(c),t),d=u,h=q.concat([a,i,d]),f=await ae(q.from(l),h);return{iv:a,ephemPublicKey:i,ciphertext:d,mac:f}},ye=async function(e,t,n){const r=null!==n&&void 0!==n&&n,i=r?pe:fe,o=await i(e,t.ephemPublicKey),s=await re(o),a=s.slice(0,32),c=s.slice(32),l=q.concat([t.iv,t.ephemPublicKey,t.ciphertext]),u=await ce(q.from(c),l,t.mac);if(!u&&!1===r)return ye(e,t,!0);if(!u&&!0===r)throw new Error("bad MAC after trying padded");const d=await se(t.iv,q.from(a),t.ciphertext);return q.from(new Uint8Array(d))},me=E().getLogger("http-helpers");me.setLevel(S.levels.INFO);n(40391);var be=n(34973),we=n(15361)["Buffer"];function ve(e){return we.from((0,be.wn)(e))}const _e=new V.ec("secp256k1");function Se(e){return{iv:we.from(e.iv,"hex"),ephemPublicKey:we.from(e.ephemPublicKey,"hex"),ciphertext:we.from(e.ciphertext,"hex"),mac:we.from(e.mac,"hex")}}function Ee(e){return{iv:we.from(e.iv).toString("hex"),ephemPublicKey:we.from(e.ephemPublicKey).toString("hex"),ciphertext:we.from(e.ciphertext).toString("hex"),mac:we.from(e.mac).toString("hex")}}async function ke(e,t){const n=JSON.stringify(t),r=we.from(n,"utf-8"),i=await ge(ue(we.from(e,"hex")),r),o=Ee(i),s=JSON.stringify(o);return s}async function Te(e,t){const n=JSON.parse(t),r=Se(n),i=_e.keyFromPrivate(e),o=await ye(we.from(i.getPrivate().toString("hex",64),"hex"),r),s=o.toString("utf-8"),a=JSON.parse(s);return a}var Pe=n(15361)["Buffer"];const Re=86400;class Ae extends ${constructor(){let{sessionServerBaseUrl:e,sessionNamespace:t,sessionTime:n,sessionId:i}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(),(0,r.Z)(this,"sessionServerBaseUrl","https://broadcast-server.tor.us"),(0,r.Z)(this,"sessionNamespace",void 0),(0,r.Z)(this,"sessionTime",Re),(0,r.Z)(this,"sessionId",""),e&&(this.sessionServerBaseUrl=e),t&&(this.sessionNamespace=t),n&&(this.sessionTime=n),i&&(this.sessionId=i.padStart(64,"0"))}static generateRandomSessionKey(){return le().toString("hex").padStart(64,"0")}async createSession(e){super.checkSessionParams();const t=Pe.from(this.sessionId,"hex"),n=ue(t).toString("hex"),r=await ke(this.sessionId,e),i=(await de(t,ve(Pe.from(r,"utf8")))).toString("hex"),o={key:n,data:r,signature:i,namespace:this.sessionNamespace,timeout:this.sessionTime};return await super.request({method:"POST",url:`${this.sessionServerBaseUrl}/store/set`,data:o}),this.sessionId}async authorizeSession(){super.checkSessionParams();const e=ue(Pe.from(this.sessionId,"hex")).toString("hex"),t=new URL(`${this.sessionServerBaseUrl}/store/get`);t.searchParams.append("key",e),this.sessionNamespace&&t.searchParams.append("namespace",this.sessionNamespace);const n=await super.request({url:t.toString()});if(!n.message)throw new Error("Session Expired or Invalid public key");const r=await Te(this.sessionId,n.message);if(r.error)throw new Error("There was an error decrypting data.");return r}async updateSession(e){super.checkSessionParams();const t=Pe.from(this.sessionId,"hex"),n=ue(t).toString("hex"),r=await ke(this.sessionId,e),i=(await de(t,ve(Pe.from(r,"utf8")))).toString("hex"),o={key:n,data:r,signature:i,namespace:this.sessionNamespace};await super.request({method:"PUT",url:`${this.sessionServerBaseUrl}/store/update`,data:o})}async invalidateSession(){super.checkSessionParams();const e=Pe.from(this.sessionId,"hex"),t=ue(e).toString("hex"),n=await ke(this.sessionId,{}),r=(await de(e,ve(Pe.from(n,"utf8")))).toString("hex"),i={key:t,data:n,signature:r,namespace:this.sessionNamespace,timeout:1};return await super.request({method:"POST",url:`${this.sessionServerBaseUrl}/store/set`,data:i}),this.sessionId="",!0}}var Oe=n(28139),Ne=n(43793),Ce=(n(31893),n(78328),n(7544)),Ie=n.n(Ce),xe=(n(15361)["Buffer"],n(15941));class Me extends _.s{constructor(e,t){super(t),(0,r.Z)(this,"code",void 0),(0,r.Z)(this,"message",void 0),this.code=e,this.message=t||"",Object.defineProperty(this,"name",{value:"OpenloginError"})}toJSON(){return{name:this.name,code:this.code,message:this.message}}toString(){return JSON.stringify(this.toJSON())}}class Le extends Me{constructor(e,t){super(e,t),Object.defineProperty(this,"name",{value:"InitializationError"})}static fromCode(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return new Le(e,`${Le.messages[e]}, ${t}`)}static invalidParams(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return Le.fromCode(5001,e)}static notInitialized(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return Le.fromCode(5002,e)}}(0,r.Z)(Le,"messages",{5e3:"Custom",5001:"Invalid constructor params",5002:"SDK not initialized. please call init first"});class De extends Me{constructor(e,t){super(e,t),Object.defineProperty(this,"name",{value:"LoginError"})}static fromCode(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return new De(e,`${De.messages[e]}, ${t}`)}static invalidLoginParams(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return De.fromCode(5111,e)}static userNotLoggedIn(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return De.fromCode(5112,e)}static popupClosed(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return De.fromCode(5113,e)}static loginFailed(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return De.fromCode(5114,e)}}(0,r.Z)(De,"messages",{5e3:"Custom",5111:"Invalid login params",5112:"User not logged in.",5113:"login popup has been closed by the user",5114:"Login failed"});const Be=(0,S.getLogger)("openlogin");Be.setLevel("error");const je="5.2.0";function Ue(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const t={},n=new URL(window.location.href);n.searchParams.forEach(((e,n)=>{"result"!==n&&(t[n]=e)}));const r=n.searchParams.get("result");if(r)try{const e=JSON.parse(u(r));Object.keys(e).forEach((n=>{t[n]=e[n]}))}catch(c){Be.error(c)}const i=n.hash.substring(1),o=new URL(`${window.location.origin}/?${i}`);o.searchParams.forEach(((e,n)=>{"result"!==n&&(t[n]=e)}));const a=o.searchParams.get("result");if(a)try{const e=JSON.parse(u(a));Object.keys(e).forEach((n=>{t[n]=e[n]}))}catch(c){Be.error(c)}if(e){const e=new URL(window.location.origin+window.location.pathname);if(e.search=window.location.search,a){const t=JSON.parse(u(a));delete t.sessionId,delete t.sessionNamespace,delete t.error,e.hash=l(JSON.stringify(t))}window.history.replaceState((0,s.Z)((0,s.Z)({},window.history.state),{},{as:e.href,url:e.href}),"",e.href)}return t}function Ke(e){const{baseURL:t,query:n,hash:r}=e,i=new URL(t);if(n&&Object.keys(n).forEach((e=>{i.searchParams.append(e,n[e])})),r){const e=new URL(Ke({baseURL:t,query:r})).searchParams.toString();i.hash=e}return i.toString()}function Fe(){if("undefined"===typeof window)return"";const e=void 0!==window.screenLeft?window.screenLeft:window.screenX,t=void 0!==window.screenTop?window.screenTop:window.screenY,n=1200,r=700,i=window.innerWidth?window.innerWidth:document.documentElement.clientWidth?document.documentElement.clientWidth:window.screen.width,o=window.innerHeight?window.innerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:window.screen.height,s=1,a=Math.abs((i-n)/2/s+e),c=Math.abs((o-r)/2/s+t),l=`titlebar=0,toolbar=0,status=0,location=0,menubar=0,height=${r/s},width=${n/s},top=${c},left=${a}`;return l}function We(){if("undefined"===typeof window)return!1;const e=Ie().getParser(window.navigator.userAgent),t=e.getPlatform();return t.type===Ie().PLATFORMS_MAP.tablet||t.type===Ie().PLATFORMS_MAP.mobile}function $e(e){return e!==b.FACEBOOK&&e!==b.LINE||!We()?1e4:3e5}class He extends Ne.EventEmitter{constructor(e){let{url:t,target:n,features:i,timeout:o=3e4}=e;super(),(0,r.Z)(this,"url",void 0),(0,r.Z)(this,"target",void 0),(0,r.Z)(this,"features",void 0),(0,r.Z)(this,"window",void 0),(0,r.Z)(this,"windowTimer",void 0),(0,r.Z)(this,"iClosedWindow",void 0),(0,r.Z)(this,"timeout",void 0),this.url=t,this.target=n||"_blank",this.features=i||Fe(),this.window=void 0,this.windowTimer=void 0,this.iClosedWindow=!1,this.timeout=o,this._setupTimer()}_setupTimer(){this.windowTimer=Number(setInterval((()=>{this.window&&this.window.closed&&(clearInterval(this.windowTimer),setTimeout((()=>{this.iClosedWindow||this.emit("close"),this.iClosedWindow=!1,this.window=void 0}),this.timeout)),void 0===this.window&&clearInterval(this.windowTimer)}),500))}open(){var e;this.window=window.open(this.url,this.target,this.features),null!==(e=this.window)&&void 0!==e&&e.focus&&this.window.focus()}close(){this.iClosedWindow=!0,this.window&&this.window.close()}redirect(e){e?window.location.replace(this.url):window.location.href=this.url}async listenOnChannel(e){return new Promise(((t,n)=>{const r=new Oe.BroadcastChannel(e,{webWorkerSupport:!1,type:"server"});r.addEventListener("message",(e=>{this.close(),r.close(),e.error?t({error:e.error,state:e.state}):t(e.data)}))}))}}class Ve{constructor(e){if((0,r.Z)(this,"state",{}),(0,r.Z)(this,"options",void 0),(0,r.Z)(this,"sessionManager",void 0),(0,r.Z)(this,"currentStorage",void 0),(0,r.Z)(this,"_storageBaseKey","openlogin_store"),(0,r.Z)(this,"dappState",void 0),(0,r.Z)(this,"addVersionInUrls",!0),!e.clientId)throw Le.invalidParams("clientId is required");if(e.network||(e.network=y.SAPPHIRE_MAINNET),e.buildEnv||(e.buildEnv=v.PRODUCTION),(e.buildEnv===v.DEVELOPMENT||e.buildEnv===v.TESTING||e.sdkUrl)&&(this.addVersionInUrls=!1),e.sdkUrl||e.useMpc||(e.buildEnv===v.DEVELOPMENT?e.sdkUrl="http://localhost:3000":e.buildEnv===v.STAGING?e.sdkUrl="https://staging-auth.web3auth.io":e.buildEnv===v.TESTING?e.sdkUrl="https://develop-auth.web3auth.io":e.sdkUrl="https://auth.web3auth.io"),e.useMpc&&!e.sdkUrl){if(Object.values(a.Ad).includes(e.network))throw new Error("MPC is not supported on legacy networks");e.buildEnv===v.DEVELOPMENT?e.sdkUrl="http://localhost:3000":e.buildEnv===v.STAGING?e.sdkUrl="https://staging-mpc-auth.web3auth.io":e.buildEnv===v.TESTING?e.sdkUrl="https://develop-mpc-auth.web3auth.io":e.sdkUrl="https://mpc-auth.web3auth.io"}e.redirectUrl||"undefined"===typeof window||(e.redirectUrl=`${window.location.protocol}//${window.location.host}${window.location.pathname}`),e.uxMode||(e.uxMode=g.REDIRECT),"boolean"!==typeof e.replaceUrlOnRedirect&&(e.replaceUrlOnRedirect=!0),e.originData||(e.originData={}),e.whiteLabel||(e.whiteLabel={}),e.loginConfig||(e.loginConfig={}),e.mfaSettings||(e.mfaSettings={}),e.storageServerUrl||(e.storageServerUrl="https://broadcast-server.tor.us"),e.storageKey||(e.storageKey="local"),e.webauthnTransports||(e.webauthnTransports=["internal"]),e.sessionTime||(e.sessionTime=86400),this.options=e}get privKey(){return this.options.useMpc?this.state.factorKey||"":this.state.privKey?this.state.privKey.padStart(64,"0"):""}get coreKitKey(){return this.state.coreKitKey?this.state.coreKitKey.padStart(64,"0"):""}get ed25519PrivKey(){return this.state.ed25519PrivKey?this.state.ed25519PrivKey.padStart(128,"0"):""}get coreKitEd25519Key(){return this.state.coreKitEd25519PrivKey?this.state.coreKitEd25519PrivKey.padStart(128,"0"):""}get sessionId(){return this.state.sessionId||""}get sessionNamespace(){return this.options.sessionNamespace||""}get appState(){return this.state.userInfo.appState||this.dappState||""}get baseUrl(){return this.addVersionInUrls?`${this.options.sdkUrl}/v${je.split(".")[0]}`:`${this.options.sdkUrl}`}async init(){const e=Ue(this.options.replaceUrlOnRedirect);e.sessionNamespace&&(this.options.sessionNamespace=e.sessionNamespace);const t=this.options.sessionNamespace?`${this._storageBaseKey}_${this.options.sessionNamespace}`:this._storageBaseKey;this.currentStorage=p.getInstance(t,this.options.storageKey);const n=this.currentStorage.get("sessionId");if(this.sessionManager=new Ae({sessionServerBaseUrl:this.options.storageServerUrl,sessionNamespace:this.options.sessionNamespace,sessionTime:this.options.sessionTime,sessionId:n}),this.options.network!==y.TESTNET&&this.options.network!==y.SAPPHIRE_DEVNET||xe.log(`%c WARNING! You are on ${this.options.network}. Please set network: 'mainnet' or 'sapphire_mainnet' in production`,"color: #FF0000"),this.options.buildEnv!==v.PRODUCTION&&xe.log(`%c WARNING! You are using build env ${this.options.buildEnv}. Please set buildEnv: 'production' in production`,"color: #FF0000"),e.error)throw this.dappState=e.state,De.loginFailed(e.error);if(e.sessionId&&(this.currentStorage.set("sessionId",e.sessionId),this.sessionManager.sessionId=e.sessionId),this.sessionManager.sessionId){const e=await this._authorizeSession();this.updateState(e),0===Object.keys(e).length&&this.currentStorage.set("sessionId","")}}async login(e){if(!e.loginProvider)throw De.invalidLoginParams("loginProvider is required");const t={redirectUrl:this.options.redirectUrl},n=(0,s.Z)((0,s.Z)({loginProvider:e.loginProvider},t),e),r={actionType:w.LOGIN,options:this.options,params:n},i=await this.openloginHandler(`${this.baseUrl}/start`,r,$e(e.loginProvider));if(this.options.uxMode===g.REDIRECT)return null;if(i.error)throw this.dappState=i.state,De.loginFailed(i.error);return this.sessionManager.sessionId=i.sessionId,this.options.sessionNamespace=i.sessionNamespace,this.currentStorage.set("sessionId",i.sessionId),await this.rehydrateSession(),{privKey:this.privKey}}async logout(){if(!this.sessionManager.sessionId)throw De.userNotLoggedIn();await this.sessionManager.invalidateSession(),this.updateState({privKey:"",coreKitKey:"",coreKitEd25519PrivKey:"",ed25519PrivKey:"",walletKey:"",oAuthPrivateKey:"",tKey:"",metadataNonce:"",keyMode:void 0,userInfo:{name:"",profileImage:"",dappShare:"",idToken:"",oAuthIdToken:"",oAuthAccessToken:"",appState:"",email:"",verifier:"",verifierId:"",aggregateVerifier:"",typeOfLogin:"",isMfaEnabled:!1},authToken:"",sessionId:"",factorKey:"",signatures:[],tssShareIndex:-1,tssPubKey:"",tssShare:"",tssNonce:-1}),this.currentStorage.set("sessionId","")}async setupMFA(e){if(!this.sessionId)throw De.userNotLoggedIn();const t={redirectUrl:this.options.redirectUrl},n={actionType:w.ENABLE_MFA,options:this.options,params:(0,s.Z)((0,s.Z)({},t),e),sessionId:this.sessionId},r=await this.openloginHandler(`${this.baseUrl}/start`,n);if(this.options.uxMode!==g.REDIRECT)return this.sessionManager.sessionId=r.sessionId,this.options.sessionNamespace=r.sessionNamespace,this.currentStorage.set("sessionId",r.sessionId),await this.rehydrateSession(),!0}async changeSocialFactor(e){if(!this.sessionId)throw De.userNotLoggedIn();const t={redirectUrl:this.options.redirectUrl},n={actionType:w.MODIFY_MFA,options:this.options,params:(0,s.Z)((0,s.Z)({},t),e),sessionId:this.sessionId},r=await this.openloginHandler(`${this.baseUrl}/start`,n);if(this.options.uxMode!==g.REDIRECT)return this.sessionManager.sessionId=r.sessionId,this.options.sessionNamespace=r.sessionNamespace,this.currentStorage.set("sessionId",r.sessionId),await this.rehydrateSession(),!0}getUserInfo(){if(!this.sessionManager.sessionId)throw De.userNotLoggedIn();return this.state.userInfo}async getLoginId(e){if(!this.sessionManager)throw Le.notInitialized();const t=Ae.generateRandomSessionKey(),n=new Ae({sessionServerBaseUrl:this.options.storageServerUrl,sessionNamespace:this.options.sessionNamespace,sessionTime:600,sessionId:t});return await n.createSession(JSON.parse(JSON.stringify(e))),t}async _authorizeSession(){try{if(!this.sessionManager.sessionId)return{};const e=await this.sessionManager.authorizeSession();return e}catch(e){return Be.error("authorization failed",e),{}}}updateState(e){this.state=(0,s.Z)((0,s.Z)({},this.state),e)}async rehydrateSession(){const e=await this._authorizeSession();this.updateState(e)}async openloginHandler(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e4;const r=await this.getLoginId(t),i={loginId:r,sessionNamespace:this.options.sessionNamespace};if(this.options.uxMode!==g.REDIRECT)return new Promise(((t,o)=>{const s=Ke({baseURL:e,hash:{b64Params:d(i)}}),a=new He({url:s,timeout:n});a.on("close",(()=>{o(De.popupClosed())})),a.listenOnChannel(r).then(t).catch(o),a.open()}));{const t=Ke({baseURL:e,hash:{b64Params:d(i)}});window.location.href=t}}}n(81299),n(41817),n(42140),n(25383),n(72620),n(38901),n(19157),n(46568);function qe(e,t,n){try{Reflect.apply(e,t,n)}catch(r){setTimeout((()=>{throw r}))}}function Ze(e){const t=e.length,n=new Array(t);for(let r=0;r<t;r+=1)n[r]=e[r];return n}class Ge extends Ne.EventEmitter{emit(e){let t="error"===e;const n=this._events;if(void 0!==n)t=t&&void 0===n.error;else if(!t)return!1;for(var r=arguments.length,i=new Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];if(t){let e;if(i.length>0&&([e]=i),e instanceof Error)throw e;const t=new Error("Unhandled error."+(e?` (${e.message})`:""));throw t.context=e,t}const s=n[e];if(void 0===s)return!1;if("function"===typeof s)qe(s,this,i);else{const e=s.length,t=Ze(s);for(let n=0;n<e;n+=1)qe(t[n],this,i)}return!0}}class Ye extends Error{constructor(e){let{code:t,message:n,data:r}=e;if(!Number.isInteger(t))throw new Error("code must be an integer");if(!n||"string"!==typeof n)throw new Error("message must be string");super(n),_defineProperty(this,"code",void 0),_defineProperty(this,"data",void 0),this.code=t,void 0!==r&&(this.data=r)}toString(){return stringify({code:this.code,message:this.message,data:this.data,stack:this.stack})}}Symbol("IGNORE_SUBSTREAM");n(59730),n(61598);const Je={EIP155:"eip155",SOLANA:"solana",OTHER:"other"},ze={EIP155:"eip155",SOLANA:"solana",XRPL:"xrpl",MULTICHAIN:"multichain"},Xe=e=>{if(e===Je.EIP155)return 1;if(e===Je.SOLANA)return 1;throw new Error(`Chain namespace ${e} is not supported`)},Qe=e=>{const t=Je.EIP155;return 1===e?{chainNamespace:t,chainId:"0x1",rpcTarget:"https://rpc.ankr.com/eth",displayName:"Ethereum Mainnet",blockExplorer:"https://etherscan.io/",ticker:"ETH",tickerName:"Ethereum",decimals:18}:5===e?{chainNamespace:t,chainId:"0x5",rpcTarget:"https://rpc.ankr.com/eth_goerli",displayName:"Goerli Testnet",blockExplorer:"https://goerli.etherscan.io/",ticker:"ETH",tickerName:"Ethereum",decimals:18}:11155111===e?{chainNamespace:t,chainId:"0xaa36a7",rpcTarget:"https://rpc.ankr.com/eth_sepolia",displayName:"Sepolia Testnet",blockExplorer:"https://sepolia.etherscan.io/",ticker:"ETH",tickerName:"Ethereum",decimals:18}:137===e?{chainNamespace:t,chainId:"0x89",rpcTarget:"https://rpc.ankr.com/polygon",displayName:"Polygon Mainnet",blockExplorer:"https://polygonscan.com",ticker:"MATIC",tickerName:"Polygon"}:80001===e?{chainNamespace:t,chainId:"0x13881",rpcTarget:"https://rpc.ankr.com/polygon_mumbai",displayName:"Polygon Mumbai Testnet",blockExplorer:"https://mumbai.polygonscan.com/",ticker:"MATIC",tickerName:"Polygon",decimals:18}:56===e?{chainNamespace:t,chainId:"0x38",rpcTarget:"https://rpc.ankr.com/bsc",displayName:"Binance SmartChain Mainnet",blockExplorer:"https://bscscan.com",ticker:"BNB",tickerName:"Binance SmartChain",decimals:18}:97===e?{chainNamespace:t,chainId:"0x61",rpcTarget:"https://rpc.ankr.com/bsc_testnet_chapel",displayName:"Binance SmartChain Testnet",blockExplorer:"https://testnet.bscscan.com",ticker:"BNB",tickerName:"Binance SmartChain",decimals:18}:25===e?{chainNamespace:t,chainId:"0x19",rpcTarget:"https://rpc.cronos.org",displayName:"Cronos Mainnet",blockExplorer:"https://cronoscan.com/",ticker:"CRO",tickerName:"Cronos"}:338===e?{chainNamespace:t,chainId:"0x152",rpcTarget:"https://rpc-t3.cronos.org/",displayName:"Cronos Testnet",blockExplorer:"https://cronoscan.com/",ticker:"CRO",tickerName:"Cronos",decimals:18}:8217===e?{chainNamespace:t,chainId:"0x2019",rpcTarget:"https://public-node-api.klaytnapi.com/v1/cypress",displayName:"Klaytn Mainnet",blockExplorer:"https://scope.klaytn.com",ticker:"KLAY",tickerName:"Klaytn",decimals:18}:null},et=e=>{const t=Je.SOLANA;return 1===e?{chainNamespace:t,chainId:"0x1",rpcTarget:"https://rpc.ankr.com/solana",displayName:"Solana Mainnet",blockExplorer:"https://explorer.solana.com",ticker:"SOL",tickerName:"Solana",decimals:9}:2===e?{chainNamespace:t,chainId:"0x2",rpcTarget:"https://api.testnet.solana.com",displayName:"Solana Testnet",blockExplorer:"https://explorer.solana.com?cluster=testnet",ticker:"SOL",tickerName:"Solana",decimals:9}:3===e?{chainNamespace:t,chainId:"0x3",rpcTarget:"https://api.devnet.solana.com",displayName:"Solana Devnet",blockExplorer:"https://explorer.solana.com?cluster=devnet",ticker:"SOL",tickerName:"Solana",decimals:9}:null},tt=(e,t)=>{if(e===Je.OTHER)return null;const n=t?"number"===typeof t?t:parseInt(t,16):Xe(e);return e===Je.EIP155?Qe(n):e===Je.SOLANA?et(n):null};class nt extends _.s{constructor(e,t){super(t),(0,r.Z)(this,"code",void 0),(0,r.Z)(this,"message",void 0),this.code=e,this.message=t||"",Object.defineProperty(this,"name",{value:"Web3AuthError"})}toJSON(){return{name:this.name,code:this.code,message:this.message}}toString(){return JSON.stringify(this.toJSON())}}class rt extends nt{constructor(e,t){super(e,t),Object.defineProperty(this,"name",{value:"WalletInitializationError"})}static fromCode(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return new rt(e,`${rt.messages[e]}, ${t}`)}static notFound(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return rt.fromCode(5001,e)}static notInstalled(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return rt.fromCode(5002,e)}static notReady(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return rt.fromCode(5003,e)}static windowBlocked(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return rt.fromCode(5004,e)}static windowClosed(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return rt.fromCode(5005,e)}static incompatibleChainNameSpace(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return rt.fromCode(5006,e)}static duplicateAdapterError(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return rt.fromCode(5007,e)}static invalidProviderConfigError(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return rt.fromCode(5008,e)}static providerNotReadyError(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return rt.fromCode(5009,e)}static rpcConnectionError(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return rt.fromCode(5010,e)}static invalidParams(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return rt.fromCode(5011,e)}static invalidNetwork(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return rt.fromCode(5013,e)}}(0,r.Z)(rt,"messages",{5e3:"Custom",5001:"Wallet is not found",5002:"Wallet is not installed",5003:"Wallet is not ready yet",5004:"Wallet window is blocked",5005:"Wallet window has been closed by the user",5006:"Incompatible chain namespace provided",5007:"Adapter has already been included",5008:"Invalid provider Config",5009:"Provider is not ready yet",5010:"Failed to connect with rpc url",5011:"Invalid params passed in",5013:"Invalid network provided"});class it extends nt{constructor(e,t){super(e,t),Object.defineProperty(this,"name",{value:"WalletLoginError"})}static fromCode(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return new it(e,`${it.messages[e]}. ${t}`)}static connectionError(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return it.fromCode(5111,e)}static disconnectionError(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return it.fromCode(5112,e)}static notConnectedError(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return it.fromCode(5113,e)}static popupClosed(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return it.fromCode(5114,e)}static mfaEnabled(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return it.fromCode(5115,e)}static chainConfigNotAdded(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return it.fromCode(5116,e)}static unsupportedOperation(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return it.fromCode(5117,e)}static coreKitKeyNotFound(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return it.fromCode(5118,e)}static userNotLoggedIn(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return it.fromCode(5119,e)}}(0,r.Z)(it,"messages",{5e3:"Custom",5111:"Failed to connect with wallet",5112:"Failed to disconnect from wallet",5113:"Wallet is not connected",5114:"Wallet popup has been closed by the user",5115:"User has already enabled mfa, please use the @web3auth/web3auth-web sdk for login with mfa",5116:"Chain config has not been added. Please add the chain config before calling switchChain",5117:"Unsupported operation",5118:"useCoreKitKey flag is enabled but coreKitKey is not available",5119:"User not logged in."});class ot extends nt{constructor(e,t){super(e,t),Object.defineProperty(this,"name",{value:"WalletOperationsError"})}static fromCode(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return new ot(e,`${ot.messages[e]}, ${t}`)}static chainIDNotAllowed(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return ot.fromCode(5201,e)}static operationNotAllowed(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return ot.fromCode(5202,e)}static chainNamespaceNotAllowed(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return ot.fromCode(5203,e)}}(0,r.Z)(ot,"messages",{5e3:"Custom",5201:"Provided chainId is not allowed",5202:"This operation is not allowed"});class st extends nt{constructor(e,t){super(e,t),Object.defineProperty(this,"name",{value:"WalletProviderError"})}static fromCode(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return new ot(e,`${st.messages[e]}, ${t}`)}static invalidRequestArgs(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return ot.fromCode(5301,e)}static invalidRequestMethod(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return ot.fromCode(5302,e)}static invalidRequestParams(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return ot.fromCode(5303,e)}}(0,r.Z)(st,"messages",{5e3:"Custom",5301:"Expected a single, non-array, object argument.",5302:"'args.method' must be a non-empty string.",5303:"'args.params' must be an object or array if provided."});const at={OPENLOGIN:"openlogin",WALLET_CONNECT_V2:"wallet-connect-v2"},ct=(0,s.Z)({TORUS_SOLANA:"torus-solana",PHANTOM:"phantom",SOLFLARE:"solflare",SLOPE:"slope"},at),lt=(0,s.Z)({TORUS_EVM:"torus-evm",METAMASK:"metamask",COINBASE:"coinbase"},at),ut=(0,s.Z)((0,s.Z)({},lt),ct),dt=(at.OPENLOGIN,at.WALLET_CONNECT_V2,ct.TORUS_SOLANA,ct.PHANTOM,ct.SOLFLARE,ct.SLOPE,lt.TORUS_EVM,lt.METAMASK,lt.COINBASE,{EXTERNAL:"external",IN_APP:"in_app"}),ht={NOT_READY:"not_ready",READY:"ready",CONNECTING:"connecting",CONNECTED:"connected",DISCONNECTED:"disconnected",ERRORED:"errored"},ft=(0,s.Z)((0,s.Z)({},ht),{},{ADAPTER_DATA_UPDATED:"adapter_data_updated",CACHE_CLEAR:"cache_clear"});class pt extends Ge{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(),(0,r.Z)(this,"adapterData",{}),(0,r.Z)(this,"sessionTime",86400),(0,r.Z)(this,"clientId",void 0),(0,r.Z)(this,"web3AuthNetwork",y.MAINNET),(0,r.Z)(this,"rehydrated",!1),(0,r.Z)(this,"chainConfig",null),(0,r.Z)(this,"knownChainConfigs",{}),(0,r.Z)(this,"adapterNamespace",void 0),(0,r.Z)(this,"currentChainNamespace",void 0),(0,r.Z)(this,"type",void 0),(0,r.Z)(this,"name",void 0),(0,r.Z)(this,"status",void 0),this.setAdapterSettings(e)}get chainConfigProxy(){return this.chainConfig?(0,s.Z)({},this.chainConfig):null}get connnected(){return this.status===ht.CONNECTED}setAdapterSettings(e){if(this.status===ht.READY)return;null!==e&&void 0!==e&&e.sessionTime&&(this.sessionTime=e.sessionTime),null!==e&&void 0!==e&&e.clientId&&(this.clientId=e.clientId),null!==e&&void 0!==e&&e.web3AuthNetwork&&(this.web3AuthNetwork=e.web3AuthNetwork);const t=e.chainConfig;if(t){if(!t.chainNamespace)throw rt.notReady("ChainNamespace is required while setting chainConfig");this.currentChainNamespace=t.chainNamespace;const e=tt(t.chainNamespace,t.chainId),n=(0,s.Z)((0,s.Z)({},e||{}),t);this.chainConfig=n,this.addChainConfig(n)}}checkConnectionRequirements(){if(this.name!==ut.WALLET_CONNECT_V2||this.status!==ht.CONNECTING){if(this.status===ht.CONNECTING)throw rt.notReady("Already connecting");if(this.status===ht.CONNECTED)throw it.connectionError("Already connected");if(this.status!==ht.READY)throw it.connectionError("Wallet adapter is not ready yet, Please wait for init function to resolve before calling connect/connectTo function")}}checkInitializationRequirements(){if(!this.clientId)throw rt.invalidParams("Please initialize Web3Auth with a valid clientId in constructor");if(!this.chainConfig)throw rt.invalidParams("rpcTarget is required in chainConfig");if(!this.chainConfig.rpcTarget&&this.chainConfig.chainNamespace!==Je.OTHER)throw rt.invalidParams("rpcTarget is required in chainConfig");if(!this.chainConfig.chainId&&this.chainConfig.chainNamespace!==Je.OTHER)throw rt.invalidParams("chainID is required in chainConfig");if(this.status!==ht.NOT_READY){if(this.status===ht.CONNECTED)throw rt.notReady("Already connected");if(this.status===ht.READY)throw rt.notReady("Adapter is already initialized")}}checkDisconnectionRequirements(){if(this.status!==ht.CONNECTED)throw it.disconnectionError("Not connected with wallet")}checkAddChainRequirements(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!t&&!this.provider)throw it.notConnectedError("Not connected with wallet.");if(this.currentChainNamespace!==e.chainNamespace)throw ot.chainNamespaceNotAllowed("This adapter doesn't support this chainNamespace")}checkSwitchChainRequirements(e){let{chainId:t}=e,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!n&&!this.provider)throw it.notConnectedError("Not connected with wallet.");if(!this.knownChainConfigs[t])throw it.chainConfigNotAdded("Invalid chainId")}updateAdapterData(e){this.adapterData=e,this.emit(ft.ADAPTER_DATA_UPDATED,{adapterName:this.name,data:e})}addChainConfig(e){const t=this.knownChainConfigs[e.chainId];this.knownChainConfigs[e.chainId]=(0,s.Z)((0,s.Z)({},t||{}),e)}getChainConfig(e){return this.knownChainConfigs[e]||null}}var gt=E().getLogger("web3auth-logger");const yt=()=>({adapterSettings:{network:y.SAPPHIRE_MAINNET,clientId:"",uxMode:g.POPUP},loginSettings:{},privateKeyProvider:void 0});class mt extends pt{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(e),(0,r.Z)(this,"name",ut.OPENLOGIN),(0,r.Z)(this,"adapterNamespace",ze.MULTICHAIN),(0,r.Z)(this,"type",dt.IN_APP),(0,r.Z)(this,"openloginInstance",null),(0,r.Z)(this,"status",ht.NOT_READY),(0,r.Z)(this,"currentChainNamespace",Je.EIP155),(0,r.Z)(this,"privateKeyProvider",null),(0,r.Z)(this,"openloginOptions",void 0),(0,r.Z)(this,"loginSettings",{loginProvider:""}),this.setAdapterSettings((0,s.Z)((0,s.Z)({},e.adapterSettings),{},{chainConfig:e.chainConfig,clientId:e.clientId||"",sessionTime:e.sessionTime,web3AuthNetwork:e.web3AuthNetwork,useCoreKitKey:e.useCoreKitKey,privateKeyProvider:e.privateKeyProvider})),this.loginSettings=e.loginSettings||{loginProvider:""},this.privateKeyProvider=e.privateKeyProvider||null}get chainConfigProxy(){return this.chainConfig?(0,s.Z)({},this.chainConfig):null}get provider(){return this.status!==ht.NOT_READY&&this.privateKeyProvider?this.privateKeyProvider:null}set provider(e){throw new Error("Not implemented")}async init(e){if(super.checkInitializationRequirements(),!this.clientId)throw rt.invalidParams("clientId is required before openlogin's initialization");if(!this.openloginOptions)throw rt.invalidParams("openloginOptions is required before openlogin's initialization");const t=this.openloginOptions.uxMode===g.REDIRECT;if(this.openloginOptions=(0,s.Z)((0,s.Z)({},this.openloginOptions),{},{replaceUrlOnRedirect:t}),this.openloginInstance=new Ve((0,s.Z)((0,s.Z)({},this.openloginOptions),{},{clientId:this.clientId,network:this.openloginOptions.network||this.web3AuthNetwork||y.SAPPHIRE_MAINNET})),gt.debug("initializing openlogin adapter init"),await this.openloginInstance.init(),!this.chainConfig)throw rt.invalidParams("chainConfig is required before initialization");this.status=ht.READY,this.emit(ft.READY,ut.OPENLOGIN);try{gt.debug("initializing openlogin adapter");const n=this._getFinalPrivKey();n&&(e.autoConnect||t)&&(this.rehydrated=!0,await this.connect())}catch(n){gt.error("Failed to connect with cached openlogin provider",n),this.emit("ERRORED",n)}}async connect(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{loginProvider:""};super.checkConnectionRequirements(),this.status=ht.CONNECTING,this.emit(ft.CONNECTING,(0,s.Z)((0,s.Z)({},e),{},{adapter:ut.OPENLOGIN}));try{return await this.connectWithProvider(e),this.provider}catch(t){if(gt.error("Failed to connect with openlogin provider",t),this.status=ht.READY,this.emit(ft.ERRORED,t),null!==t&&void 0!==t&&t.message.includes("user closed popup"))throw it.popupClosed();if(t instanceof nt)throw t;throw it.connectionError("Failed to login with openlogin")}}async disconnect(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{cleanup:!1};if(this.status!==ht.CONNECTED)throw it.notConnectedError("Not connected with wallet");if(!this.openloginInstance)throw rt.notReady("openloginInstance is not ready");await this.openloginInstance.logout(),e.cleanup?(this.status=ht.NOT_READY,this.openloginInstance=null,this.privateKeyProvider=null):this.status=ht.READY,this.rehydrated=!1,this.emit(ft.DISCONNECTED)}async authenticateUser(){if(this.status!==ht.CONNECTED)throw it.notConnectedError("Not connected with wallet, Please login/connect first");const e=await this.getUserInfo();return{idToken:e.idToken}}async getUserInfo(){if(this.status!==ht.CONNECTED)throw it.notConnectedError("Not connected with wallet");if(!this.openloginInstance)throw rt.notReady("openloginInstance is not ready");const e=this.openloginInstance.getUserInfo();return e}setAdapterSettings(e){super.setAdapterSettings(e);const t=yt();gt.info("setting adapter settings",e),this.openloginOptions=(0,s.Z)((0,s.Z)((0,s.Z)({},t.adapterSettings),this.openloginOptions),e),e.web3AuthNetwork&&(this.openloginOptions.network=e.web3AuthNetwork),void 0!==e.useCoreKitKey&&(this.openloginOptions.useCoreKitKey=e.useCoreKitKey),e.privateKeyProvider&&(this.privateKeyProvider=e.privateKeyProvider)}async addChain(e){var t;let n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];super.checkAddChainRequirements(e,n),null===(t=this.privateKeyProvider)||void 0===t||t.addChain(e),this.addChainConfig(e)}async switchChain(e){var t;let n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];super.checkSwitchChainRequirements(e,n),await(null===(t=this.privateKeyProvider)||void 0===t?void 0:t.switchChain(e)),this.setAdapterSettings({chainConfig:this.getChainConfig(e.chainId)})}_getFinalPrivKey(){var e;if(!this.openloginInstance)return"";let t=this.openloginInstance.privKey;if(null!==(e=this.openloginOptions)&&void 0!==e&&e.useCoreKitKey){if(this.openloginInstance.privKey&&!this.openloginInstance.coreKitKey)throw it.coreKitKeyNotFound();t=this.openloginInstance.coreKitKey}return t}_getFinalEd25519PrivKey(){var e;if(!this.openloginInstance)return"";let t=this.openloginInstance.ed25519PrivKey;if(null!==(e=this.openloginOptions)&&void 0!==e&&e.useCoreKitKey){if(this.openloginInstance.ed25519PrivKey&&!this.openloginInstance.coreKitEd25519Key)throw it.coreKitKeyNotFound();t=this.openloginInstance.coreKitEd25519Key}return t}async connectWithProvider(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{loginProvider:""};if(!this.privateKeyProvider)throw rt.invalidParams("PrivateKey Provider is required before initialization");if(!this.openloginInstance)throw rt.notReady("openloginInstance is not ready");const n=this._getFinalPrivKey();if(!n||null!==(e=t.extraLoginOptions)&&void 0!==e&&e.id_token){var r;if(this.loginSettings.curve||(this.loginSettings.curve=this.currentChainNamespace===Je.SOLANA?m.ED25519:m.SECP256K1),!t.loginProvider&&!this.loginSettings.loginProvider)throw rt.invalidParams("loginProvider is required for login");await this.openloginInstance.login(T()(this.loginSettings,t,{extraLoginOptions:(0,s.Z)((0,s.Z)({},t.extraLoginOptions||{}),{},{login_hint:t.login_hint||(null===(r=t.extraLoginOptions)||void 0===r?void 0:r.login_hint)})}))}let i=this._getFinalPrivKey();i&&(this.currentChainNamespace===Je.SOLANA&&(i=this._getFinalEd25519PrivKey()),await this.privateKeyProvider.setupProvider(i),this.status=ht.CONNECTED,this.emit(ft.CONNECTED,{adapter:ut.OPENLOGIN,reconnected:this.rehydrated}))}}},56015:(e,t,n)=>{"use strict";n(21703),n(38862),n(57658),Object.defineProperty(t,"__esModule",{value:!0}),t.OPEN_BROADCAST_CHANNELS=t.BroadcastChannel=void 0,t.enforceOptions=u;var r=n(53425),i=n(63509),o=n(9337),s=new Set;t.OPEN_BROADCAST_CHANNELS=s;var a,c=0,l=function(e,t){this.id=c++,s.add(this),this.name=e,a&&(t=a),this.options=(0,o.fillOptionsWithDefaults)(t),this.method=(0,i.chooseMethod)(this.options),this._iL=!1,this._onML=null,this._addEL={message:[],internal:[]},this._uMP=new Set,this._befC=[],this._prepP=null,h(this)};function u(e){a=e}function d(e,t,n){var i=e.method.microSeconds(),o={time:i,type:t,data:n},s=e._prepP?e._prepP:r.PROMISE_RESOLVED_VOID;return s.then((function(){var t=e.method.postMessage(e._state,o);return e._uMP.add(t),t["catch"]().then((function(){return e._uMP["delete"](t)})),t}))}function h(e){var t=e.method.create(e.name,e.options);(0,r.isPromise)(t)?(e._prepP=t,t.then((function(t){e._state=t}))):e._state=t}function f(e){return e._addEL.message.length>0||e._addEL.internal.length>0}function p(e,t,n){e._addEL[t].push(n),y(e)}function g(e,t,n){e._addEL[t]=e._addEL[t].filter((function(e){return e!==n})),m(e)}function y(e){if(!e._iL&&f(e)){var t=function(t){e._addEL[t.type].forEach((function(n){var r=1e5,i=n.time-r;(t.time>=i||"server"===e.method.type)&&n.fn(t.data)}))},n=e.method.microSeconds();e._prepP?e._prepP.then((function(){e._iL=!0,e.method.onMessage(e._state,t,n)})):(e._iL=!0,e.method.onMessage(e._state,t,n))}}function m(e){if(e._iL&&!f(e)){e._iL=!1;var t=e.method.microSeconds();e.method.onMessage(e._state,null,t)}}t.BroadcastChannel=l,l._pubkey=!0,l.prototype={postMessage:function(e){if(this.closed)throw new Error("BroadcastChannel.postMessage(): Cannot post message after channel has closed "+JSON.stringify(e));return d(this,"message",e)},postInternal:function(e){return d(this,"internal",e)},set onmessage(e){var t=this.method.microSeconds(),n={time:t,fn:e};g(this,"message",this._onML),e&&"function"===typeof e?(this._onML=n,p(this,"message",n)):this._onML=null},addEventListener:function(e,t){var n=this.method.microSeconds(),r={time:n,fn:t};p(this,e,r)},removeEventListener:function(e,t){var n=this._addEL[e].find((function(e){return e.fn===t}));g(this,e,n)},close:function(){var e=this;if(!this.closed){s["delete"](this),this.closed=!0;var t=this._prepP?this._prepP:r.PROMISE_RESOLVED_VOID;return this._onML=null,this._addEL.message=[],t.then((function(){return Promise.all(Array.from(e._uMP))})).then((function(){return Promise.all(e._befC.map((function(e){return e()})))})).then((function(){return e.method.close(e._state)}))}},get type(){return this.method.type},get isClosed(){return this.closed}}},28139:(e,t,n)=>{"use strict";var r=n(7995);e.exports={BroadcastChannel:r.BroadcastChannel,enforceOptions:r.enforceOptions}},7995:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"BroadcastChannel",{enumerable:!0,get:function(){return r.BroadcastChannel}}),Object.defineProperty(t,"OPEN_BROADCAST_CHANNELS",{enumerable:!0,get:function(){return r.OPEN_BROADCAST_CHANNELS}}),Object.defineProperty(t,"enforceOptions",{enumerable:!0,get:function(){return r.enforceOptions}});var r=n(56015)},63509:(e,t,n)=>{"use strict";n(21703),n(38862);var r=n(62047);Object.defineProperty(t,"__esModule",{value:!0}),t.chooseMethod=u;var i=r(n(34461)),o=r(n(89786)),s=r(n(56769)),a=r(n(64577)),c=r(n(83869)),l=[i["default"],o["default"],s["default"],a["default"]];function u(e){var t=[].concat(e.methods,l).filter(Boolean);if(e.type){if("simulate"===e.type)return c["default"];var n=t.find((function(t){return t.type===e.type}));if(n)return n;throw new Error("method-type "+e.type+" not found")}e.webWorkerSupport||(t=t.filter((function(e){return"idb"!==e.type})));var r=t.find((function(t){return t.canBeUsed(e)}));if(r)return r;throw new Error("No useable method found in "+JSON.stringify(l.map((function(e){return e.type}))))}},89786:(e,t,n)=>{"use strict";n(57658),n(2707),Object.defineProperty(t,"__esModule",{value:!0}),t.TRANSACTION_SETTINGS=void 0,t.averageResponseTime=A,t.canBeUsed=R,t.cleanOldMessages=w,t.close=k,t.commitIndexedDBTransaction=h,t.create=v,t.createDatabase=f,t["default"]=void 0,t.getAllMessages=g,t.getIdb=d,t.getMessagesHigherThan=y,t.getOldMessages=b,t.microSeconds=void 0,t.onMessage=P,t.postMessage=T,t.removeMessagesById=m,t.type=void 0,t.writeMessage=p;var r=n(53425),i=n(33330),o=n(9337),s=r.microSeconds;t.microSeconds=s;var a="pubkey.broadcast-channel-0-",c="messages",l={durability:"relaxed"};t.TRANSACTION_SETTINGS=l;var u="idb";function d(){if("undefined"!==typeof indexedDB)return indexedDB;if("undefined"!==typeof window){if("undefined"!==typeof window.mozIndexedDB)return window.mozIndexedDB;if("undefined"!==typeof window.webkitIndexedDB)return window.webkitIndexedDB;if("undefined"!==typeof window.msIndexedDB)return window.msIndexedDB}return!1}function h(e){e.commit&&e.commit()}function f(e){var t=d(),n=a+e,r=t.open(n);r.onupgradeneeded=function(e){var t=e.target.result;t.createObjectStore(c,{keyPath:"id",autoIncrement:!0})};var i=new Promise((function(e,t){r.onerror=function(e){return t(e)},r.onsuccess=function(){e(r.result)}}));return i}function p(e,t,n){var r=(new Date).getTime(),i={uuid:t,time:r,data:n},o=e.transaction([c],"readwrite",l);return new Promise((function(e,t){o.oncomplete=function(){return e()},o.onerror=function(e){return t(e)};var n=o.objectStore(c);n.add(i),h(o)}))}function g(e){var t=e.transaction(c,"readonly",l),n=t.objectStore(c),r=[];return new Promise((function(e){n.openCursor().onsuccess=function(n){var i=n.target.result;i?(r.push(i.value),i["continue"]()):(h(t),e(r))}}))}function y(e,t){var n=e.transaction(c,"readonly",l),r=n.objectStore(c),i=[],o=IDBKeyRange.bound(t+1,1/0);if(r.getAll){var s=r.getAll(o);return new Promise((function(e,t){s.onerror=function(e){return t(e)},s.onsuccess=function(t){e(t.target.result)}}))}function a(){try{return o=IDBKeyRange.bound(t+1,1/0),r.openCursor(o)}catch(e){return r.openCursor()}}return new Promise((function(e,r){var o=a();o.onerror=function(e){return r(e)},o.onsuccess=function(r){var o=r.target.result;o?o.value.id<t+1?o["continue"](t+1):(i.push(o.value),o["continue"]()):(h(n),e(i))}}))}function m(e,t){var n=e.transaction([c],"readwrite",l),r=n.objectStore(c);return Promise.all(t.map((function(e){var t=r["delete"](e);return new Promise((function(e){t.onsuccess=function(){return e()}}))})))}function b(e,t){var n=(new Date).getTime()-t,r=e.transaction(c,"readonly",l),i=r.objectStore(c),o=[];return new Promise((function(e){i.openCursor().onsuccess=function(t){var i=t.target.result;if(i){var s=i.value;if(!(s.time<n))return h(r),void e(o);o.push(s),i["continue"]()}else e(o)}}))}function w(e,t){return b(e,t).then((function(t){return m(e,t.map((function(e){return e.id})))}))}function v(e,t){return t=(0,o.fillOptionsWithDefaults)(t),f(e).then((function(n){var o={closed:!1,lastCursorId:0,channelName:e,options:t,uuid:(0,r.randomToken)(),eMIs:new i.ObliviousSet(2*t.idb.ttl),writeBlockPromise:r.PROMISE_RESOLVED_VOID,messagesCallback:null,readQueuePromises:[],db:n};return n.onclose=function(){o.closed=!0,t.idb.onclose&&t.idb.onclose()},_(o),o}))}function _(e){e.closed||E(e).then((function(){return(0,r.sleep)(e.options.idb.fallbackInterval)})).then((function(){return _(e)}))}function S(e,t){return e.uuid!==t.uuid&&(!t.eMIs.has(e.id)&&!(e.data.time<t.messagesCallbackTime))}function E(e){return e.closed?r.PROMISE_RESOLVED_VOID:e.messagesCallback?y(e.db,e.lastCursorId).then((function(t){var n=t.filter((function(e){return!!e})).map((function(t){return t.id>e.lastCursorId&&(e.lastCursorId=t.id),t})).filter((function(t){return S(t,e)})).sort((function(e,t){return e.time-t.time}));return n.forEach((function(t){e.messagesCallback&&(e.eMIs.add(t.id),e.messagesCallback(t.data))})),r.PROMISE_RESOLVED_VOID})):r.PROMISE_RESOLVED_VOID}function k(e){e.closed=!0,e.db.close()}function T(e,t){return e.writeBlockPromise=e.writeBlockPromise.then((function(){return p(e.db,e.uuid,t)})).then((function(){0===(0,r.randomInt)(0,10)&&w(e.db,e.options.idb.ttl)})),e.writeBlockPromise}function P(e,t,n){e.messagesCallbackTime=n,e.messagesCallback=t,E(e)}function R(e){if(!e.support3PC)return!1;var t=d();return!!t}function A(e){return 2*e.idb.fallbackInterval}t.type=u;var O={create:v,close:k,onMessage:P,postMessage:T,canBeUsed:R,type:u,averageResponseTime:A,microSeconds:s};t["default"]=O},56769:(e,t,n)=>{"use strict";n(38862),n(21703),n(26699),Object.defineProperty(t,"__esModule",{value:!0}),t.addStorageEventListener=h,t.averageResponseTime=b,t.canBeUsed=m,t.close=g,t.create=p,t["default"]=void 0,t.getLocalStorage=l,t.microSeconds=void 0,t.onMessage=y,t.postMessage=d,t.removeStorageEventListener=f,t.storageKey=u,t.type=void 0;var r=n(33330),i=n(9337),o=n(53425),s=o.microSeconds;t.microSeconds=s;var a="pubkey.broadcastChannel-",c="localstorage";function l(){var e;if("undefined"===typeof window)return null;try{e=window.localStorage,e=window["ie8-eventlistener/storage"]||window.localStorage}catch(t){}return e}function u(e){return a+e}function d(e,t){return new Promise((function(n){(0,o.sleep)().then((function(){var r=u(e.channelName),i={token:(0,o.randomToken)(),time:(new Date).getTime(),data:t,uuid:e.uuid},s=JSON.stringify(i);l().setItem(r,s);var a=document.createEvent("Event");a.initEvent("storage",!0,!0),a.key=r,a.newValue=s,window.dispatchEvent(a),n()}))}))}function h(e,t){var n=u(e),r=function(e){e.key===n&&t(JSON.parse(e.newValue))};return window.addEventListener("storage",r),r}function f(e){window.removeEventListener("storage",e)}function p(e,t){if(t=(0,i.fillOptionsWithDefaults)(t),!m(t))throw new Error("BroadcastChannel: localstorage cannot be used");var n=(0,o.randomToken)(),s=new r.ObliviousSet(t.localstorage.removeTimeout),a={channelName:e,uuid:n,eMIs:s};return a.listener=h(e,(function(e){a.messagesCallback&&e.uuid!==n&&e.token&&!s.has(e.token)&&(e.data.time&&e.data.time<a.messagesCallbackTime||(s.add(e.token),a.messagesCallback(e.data)))})),a}function g(e){f(e.listener)}function y(e,t,n){e.messagesCallbackTime=n,e.messagesCallback=t}function m(e){if(!e.support3PC)return!1;var t=l();if(!t)return!1;try{var n="__broadcastchannel_check";t.setItem(n,"works"),t.removeItem(n)}catch(r){return!1}return!0}function b(){var e=120,t=navigator.userAgent.toLowerCase();return t.includes("safari")&&!t.includes("chrome")?2*e:e}t.type=c;var w={create:p,close:g,onMessage:y,postMessage:d,canBeUsed:m,type:c,averageResponseTime:b,microSeconds:s};t["default"]=w},34461:(e,t,n)=>{"use strict";n(21703),Object.defineProperty(t,"__esModule",{value:!0}),t.averageResponseTime=d,t.canBeUsed=u,t.close=a,t.create=s,t.microSeconds=t["default"]=void 0,t.onMessage=l,t.postMessage=c,t.type=void 0;var r=n(53425),i=r.microSeconds;t.microSeconds=i;var o="native";function s(e){var t={messagesCallback:null,bc:new BroadcastChannel(e),subFns:[]};return t.bc.onmessage=function(e){t.messagesCallback&&t.messagesCallback(e.data)},t}function a(e){e.bc.close(),e.subFns=[]}function c(e,t){try{return e.bc.postMessage(t,!1),r.PROMISE_RESOLVED_VOID}catch(n){return Promise.reject(n)}}function l(e,t){e.messagesCallback=t}function u(e){if("undefined"===typeof window)return!1;if(!e.support3PC)return!1;if("function"===typeof BroadcastChannel){if(BroadcastChannel._pubkey)throw new Error("BroadcastChannel: Do not overwrite window.BroadcastChannel with this module, this is not a polyfill");return!0}return!1}function d(){return 150}t.type=o;var h={create:s,close:a,onMessage:l,postMessage:c,canBeUsed:u,type:o,averageResponseTime:d,microSeconds:i};t["default"]=h},64577:(e,t,n)=>{"use strict";var r=n(15361)["Buffer"];n(38862),n(21703);var i=n(62047);Object.defineProperty(t,"__esModule",{value:!0}),t.averageResponseTime=R,t.canBeUsed=P,t.close=k,t.create=E,t["default"]=void 0,t.getSocketInstance=v,t.microSeconds=void 0,t.onMessage=T,t.postMessage=w,t.removeStorageEventListener=S,t.setupSocketConnection=_,t.storageKey=b,t.type=void 0;var o=i(n(78305)),s=i(n(25736)),a=n(33330),c=n(14718),l=n(31893),u=n(78328),d=n(53425),h=n(9337),f=d.microSeconds;t.microSeconds=f;var p="pubkey.broadcastChannel-",g="server";t.type=g;var y=null,m=new Set;function b(e){return p+e}function w(e,t){return new Promise((function(n,i){(0,d.sleep)().then((0,s["default"])(o["default"].mark((function s(){var a,c,h,f;return o["default"].wrap((function(o){while(1)switch(o.prev=o.next){case 0:return a=b(e.channelName),c=(0,u.keccak256)(r.from(a,"utf8")),o.next=4,(0,u.encryptData)(c.toString("hex"),{token:(0,d.randomToken)(),time:(new Date).getTime(),data:t,uuid:e.uuid});case 4:return h=o.sent,o.t0=(0,l.getPublic)(c).toString("hex"),o.t1=h,o.next=9,(0,l.sign)(c,(0,u.keccak256)(r.from(h,"utf8")));case 9:return o.t2=o.sent.toString("hex"),f={key:o.t0,data:o.t1,signature:o.t2},e.timeout&&(f.timeout=e.timeout),o.abrupt("return",fetch(e.serverUrl+"/channel/set",{method:"POST",body:JSON.stringify(f),headers:{"Content-Type":"application/json; charset=utf-8"}}).then(n)["catch"](i));case 13:case"end":return o.stop()}}),s)}))))}))}function v(e){if(y)return y;var t=(0,c.io)(e,{transports:["websocket","polling"],withCredentials:!0,reconnectionDelayMax:1e4,reconnectionAttempts:10});return t.on("connect_error",(function(e){t.io.opts.transports=["polling","websocket"],d.log.error("connect error",e)})),t.on("connect",(0,s["default"])(o["default"].mark((function e(){var n;return o["default"].wrap((function(e){while(1)switch(e.prev=e.next){case 0:n=t.io.engine,d.log.debug("initially connected to",n.transport.name),n.once("upgrade",(function(){d.log.debug("upgraded",n.transport.name)})),n.once("close",(function(e){d.log.debug("connection closed",e)}));case 4:case"end":return e.stop()}}),e)})))),t.on("error",(function(e){d.log.error("socket errored",e),t.disconnect()})),y=t,t}function _(e,t,n){var i=v(e),a=b(t),c=(0,u.keccak256)(r.from(a,"utf8")),h=(0,l.getPublic)(c).toString("hex");i.connected?i.emit("check_auth_status",h):i.once("connect",(function(){d.log.debug("connected with socket"),i.emit("check_auth_status",h)}));var f=function(){i.once("connect",(0,s["default"])(o["default"].mark((function e(){return o["default"].wrap((function(e){while(1)switch(e.prev=e.next){case 0:i.emit("check_auth_status",h);case 1:case"end":return e.stop()}}),e)}))))},p=function e(){i?i.connected||"visible"!==document.visibilityState||f():document.removeEventListener("visibilitychange",e)},g=function(){var e=(0,s["default"])(o["default"].mark((function e(t){var r;return o["default"].wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,u.decryptData)(c.toString("hex"),t);case 3:r=e.sent,d.log.info(r),n(r),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),d.log.error(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}();return i.on("disconnect",(function(){d.log.debug("socket disconnected"),m.has(t)&&(d.log.error("socket disconnected unexpectedly, reconnecting socket"),f())})),i.on(h+"_success",g),"undefined"!==typeof document&&document.addEventListener("visibilitychange",p),i}function S(){y&&y.disconnect()}function E(e,t){if(t=(0,h.fillOptionsWithDefaults)(t),!P(t))throw new Error("BroadcastChannel: server cannot be used");var n=(0,d.randomToken)(),r=new a.ObliviousSet(t.server.removeTimeout),i={channelName:e,uuid:n,eMIs:r,serverUrl:t.server.url};return t.server.timeout&&(i.timeout=t.server.timeout),_(t.server.url,e,(function(e){i.messagesCallback&&e.uuid!==i.uuid&&e.token&&!i.eMIs.has(e.token)&&(i.eMIs.add(e.token),i.messagesCallback(e.data))})),m.add(e),i}function k(e){m["delete"](e.channelName)}function T(e,t,n){e.messagesCallbackTime=n,e.messagesCallback=t}function P(){return!0}function R(){var e=500;return e}var A={create:E,close:k,onMessage:T,postMessage:w,canBeUsed:P,type:g,averageResponseTime:R,microSeconds:f};t["default"]=A},83869:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.averageResponseTime=h,t.canBeUsed=d,t.close=c,t.create=a,t.microSeconds=t["default"]=void 0,t.onMessage=u,t.postMessage=l,t.type=void 0;var r=n(53425),i=r.microSeconds;t.microSeconds=i;var o="simulate";t.type=o;var s=new Set;function a(e){var t={name:e,messagesCallback:null};return s.add(t),t}function c(e){s["delete"](e)}function l(e,t){return new Promise((function(n){return setTimeout((function(){var r=Array.from(s);r.filter((function(t){return t.name===e.name})).filter((function(t){return t!==e})).filter((function(e){return!!e.messagesCallback})).forEach((function(e){return e.messagesCallback(t)})),n()}),5)}))}function u(e,t){e.messagesCallback=t}function d(){return!0}function h(){return 5}var f={create:a,close:c,onMessage:u,postMessage:l,canBeUsed:d,type:o,averageResponseTime:h,microSeconds:i};t["default"]=f},9337:(e,t,n)=>{"use strict";n(38862),Object.defineProperty(t,"__esModule",{value:!0}),t.fillOptionsWithDefaults=i;var r=n(53425);function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=JSON.parse(JSON.stringify(e));return"undefined"===typeof t.support3PC&&(t.support3PC=(0,r.are3PCSupported)()),"undefined"===typeof t.webWorkerSupport&&(t.webWorkerSupport=!0),t.idb||(t.idb={}),t.idb.ttl||(t.idb.ttl=45e3),t.idb.fallbackInterval||(t.idb.fallbackInterval=150),e.idb&&"function"===typeof e.idb.onclose&&(t.idb.onclose=e.idb.onclose),t.localstorage||(t.localstorage={}),t.localstorage.removeTimeout||(t.localstorage.removeTimeout=6e4),t.server||(t.server={}),t.server.url||(t.server.url="https://broadcast-server.tor.us"),t.server.removeTimeout||(t.server.removeTimeout=3e5),e.methods&&(t.methods=e.methods),t}},53425:(e,t,n)=>{"use strict";n(38862);var r=n(62047);Object.defineProperty(t,"__esModule",{value:!0}),t.PROMISE_RESOLVED_VOID=t.PROMISE_RESOLVED_TRUE=t.PROMISE_RESOLVED_FALSE=void 0,t.are3PCSupported=y,t.isPromise=s,t.log=void 0,t.microSeconds=g,t.randomInt=d,t.randomToken=h,t.setLogLevel=void 0,t.sleep=u;var i=r(n(7544)),o=r(n(89245));function s(e){return!(!e||"function"!==typeof e.then)}var a=Promise.resolve(!1);t.PROMISE_RESOLVED_FALSE=a;var c=Promise.resolve(!0);t.PROMISE_RESOLVED_TRUE=c;var l=Promise.resolve();function u(e,t){return e||(e=0),new Promise((function(n){return setTimeout((function(){return n(t)}),e)}))}function d(e,t){return Math.floor(Math.random()*(t-e+1)+e)}function h(){return Math.random().toString(36).substring(2)}t.PROMISE_RESOLVED_VOID=l;var f=0,p=0;function g(){var e=(new Date).getTime();return e===f?(p++,1e3*e+p):(f=e,p=0,1e3*e)}function y(){if("undefined"===typeof navigator)return!1;var e=i["default"].parse(navigator.userAgent);m.info(JSON.stringify(e),"current browser info");var t=!0;return navigator.brave&&(t=!1),e.engine.name!==i["default"].ENGINE_MAP.WebKit&&e.engine.name!==i["default"].ENGINE_MAP.Gecko||(t=!1),t}var m=o["default"].getLogger("broadcast-channel");t.log=m,m.setLevel("error");var b=function(e){m.setLevel(e)};t.setLogLevel=b},31893:(e,t,n)=>{"use strict";n.r(t),n.d(t,{decrypt:()=>C,derive:()=>R,derivePadded:()=>O,deriveUnpadded:()=>A,encrypt:()=>N,generatePrivate:()=>S,getPublic:()=>E,getPublicCompressed:()=>k,sign:()=>T,verify:()=>P});n(21703),n(48675),n(33105),n(63408),n(14590),n(3462),n(33824),n(23767),n(8585),n(68696);var r=n(59821),i=n(32127),o=n(15361)["Buffer"];const s=new i.ec("secp256k1"),a=n.g.crypto||n.g.msCrypto||{},c=a.subtle||a.webkitSubtle,l=o.from("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141","hex"),u=o.alloc(32,0);function d(e,t){if(!e)throw new Error(t||"Assertion failed")}function h(e){return o.isBuffer(e)&&32===e.length}function f(e){return!!h(e)&&(e.compare(u)>0&&e.compare(l)<0)}function p(e,t){if(e.length!==t.length)return!1;let n=0;for(let r=0;r<e.length;r++)n|=e[r]^t[r];return 0===n}function g(e){const t=new Uint8Array(e);return"undefined"===typeof a.getRandomValues?o.from(r.randomBytes(e)):(a.getRandomValues(t),o.from(t))}async function y(e){if(c){const t=await c.digest("SHA-512",e),n=new Uint8Array(t);return n}const t=r.createHash("sha512"),n=t.update(e).digest();return new Uint8Array(n)}function m(e){return async function(t,n,i){if(c){const r={name:"AES-CBC"},s=await c.importKey("raw",n,r,!1,[e]),a={name:"AES-CBC",iv:t},l=await c[e](a,s,i);return o.from(new Uint8Array(l))}if("encrypt"===e){const e=r.createCipheriv("aes-256-cbc",n,t),s=e.update(i),a=e.final();return o.concat([s,a])}if("decrypt"===e){const e=r.createDecipheriv("aes-256-cbc",n,t),s=e.update(i),a=e.final();return o.concat([s,a])}throw new Error(`Unsupported operation: ${e}`)}}const b=m("encrypt"),w=m("decrypt");async function v(e,t){if(c){const n={name:"HMAC",hash:{name:"SHA-256"}},r=await c.importKey("raw",new Uint8Array(e),n,!1,["sign","verify"]),i=await c.sign("HMAC",r,t),s=o.from(new Uint8Array(i));return s}const n=r.createHmac("sha256",o.from(e));n.update(t);const i=n.digest();return i}async function _(e,t,n){const r=await v(e,t);return p(r,n)}const S=function(){let e=g(32);while(!f(e))e=g(32);return e},E=function(e){return d(32===e.length,"Bad private key"),d(f(e),"Bad private key"),o.from(s.keyFromPrivate(e).getPublic("array"))},k=function(e){d(32===e.length,"Bad private key"),d(f(e),"Bad private key");const t=!0;return o.from(s.keyFromPrivate(e).getPublic(t,"array"))},T=async function(e,t){return d(32===e.length,"Bad private key"),d(f(e),"Bad private key"),d(t.length>0,"Message should not be empty"),d(t.length<=32,"Message is too long"),o.from(s.sign(t,e,{canonical:!0}).toDER())},P=async function(e,t,n){if(d(65===e.length||33===e.length,"Bad public key"),65===e.length&&d(4===e[0],"Bad public key"),33===e.length&&d(2===e[0]||3===e[0],"Bad public key"),d(t.length>0,"Message should not be empty"),d(t.length<=32,"Message is too long"),s.verify(t,n,e))return null;throw new Error("Bad signature")},R=async function(e,t){d(o.isBuffer(e),"Bad private key"),d(o.isBuffer(t),"Bad public key"),d(32===e.length,"Bad private key"),d(f(e),"Bad private key"),d(65===t.length||33===t.length,"Bad public key"),65===t.length&&d(4===t[0],"Bad public key"),33===t.length&&d(2===t[0]||3===t[0],"Bad public key");const n=s.keyFromPrivate(e),r=s.keyFromPublic(t),i=n.derive(r.getPublic());return o.from(i.toArray())},A=R,O=async function(e,t){d(o.isBuffer(e),"Bad private key"),d(o.isBuffer(t),"Bad public key"),d(32===e.length,"Bad private key"),d(f(e),"Bad private key"),d(65===t.length||33===t.length,"Bad public key"),65===t.length&&d(4===t[0],"Bad public key"),33===t.length&&d(2===t[0]||3===t[0],"Bad public key");const n=s.keyFromPrivate(e),r=s.keyFromPublic(t),i=n.derive(r.getPublic());return o.from(i.toString(16,64),"hex")},N=async function(e,t,n){n=n||{};let r=n.ephemPrivateKey||g(32);while(!f(r))r=n.ephemPrivateKey||g(32);const i=E(r),s=await A(r,e),a=await y(s),c=n.iv||g(16),l=a.slice(0,32),u=a.slice(32),d=await b(c,o.from(l),t),h=d,p=o.concat([c,i,h]),m=await v(o.from(u),p);return{iv:c,ephemPublicKey:i,ciphertext:h,mac:m}},C=async function(e,t,n){const r=null!==n&&void 0!==n&&n,i=r?O:A,s=await i(e,t.ephemPublicKey),a=await y(s),c=a.slice(0,32),l=a.slice(32),u=o.concat([t.iv,t.ephemPublicKey,t.ciphertext]),d=await _(o.from(l),u,t.mac);if(!d&&!1===r)return C(e,t,!0);if(!d&&!0===r)throw new Error("bad MAC after trying padded");const h=await w(t.iv,o.from(c),t.ciphertext);return o.from(new Uint8Array(h))}},59730:(e,t,n)=>{"use strict";n.d(t,{ut:()=>m,v_:()=>E,y1:()=>y});n(57658),n(26699),n(21703),n(38862);var r=n(95082),i=n(73148),o=n.n(i),s=n(89245),a=n.n(s);const c=a().getLogger("http-helpers");c.setLevel(s.levels.INFO);let l="torus-default",u="";const d="x-api-key",h="x-embed-host";let f=null;const p=[],g=[];function y(e){u=e}function m(e){l=e}async function b(e,t){let n=null;try{n=new URL(e)}catch(r){}if(f&&n&&(p.includes(n.origin)||g.includes(n.pathname))){const n=f.startTransaction({name:e}),r=n.startChild({op:"http"}),i=await fetch(e,t);return r.finish(),n.finish(),i}return fetch(e,t)}function w(){const e={};return l&&(e[d]=l),u&&(e[h]=u),e}function v(e){c.info(`Response: ${e.status} ${e.statusText}`),c.info(`Url: ${e.url}`)}function _(e){c.info(`Request tracing with traceID=${e.headers.get("x-web3-correlation-id")}`)}const S=(e,t)=>{const n=new Promise(((t,n)=>{const r=setTimeout((()=>{clearTimeout(r),n(new Error(`Timed out in ${e}ms`))}),e)}));return Promise.race([t,n])},E=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const s={mode:"cors",headers:{"Content-Type":"application/json; charset=utf-8"}};i.useAPIKey&&(s.headers=(0,r.Z)((0,r.Z)({},s.headers),w()));const a=o()(s,n,{method:"POST"});return i.isUrlEncodedData?(a.body=t,"application/json; charset=utf-8"===a.headers["Content-Type"]&&delete a.headers["Content-Type"]):a.body=JSON.stringify(t),S(i.timeout||6e4,b(e,a).then((e=>{if(i.logTracingHeader&&_(e),e.ok){const t=e.headers.get("content-type");return null!==t&&void 0!==t&&t.includes("application/json")?e.json():e.text()}throw v(e),e})))}},78328:(e,t,n)=>{"use strict";n.r(t),n.d(t,{decryptData:()=>v,default:()=>p,ec:()=>f,encParamsBufToHex:()=>b,encParamsHexToBuf:()=>m,encryptAndSetData:()=>S,encryptData:()=>w,getAndDecryptData:()=>_,getDeviceShare:()=>P,getTorusShare:()=>T,keccak256:()=>h,setDeviceShare:()=>k,setTorusShare:()=>E});n(38862);var r=n(95082),i=n(47327),o=n(59730),s=n(40391),a=n.n(s),c=n(32127),l=n(34973),u=n(31893),d=n(15361)["Buffer"];function h(e){return d.from((0,l.wn)(e))}const f=new c.ec("secp256k1");class p{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"https://metadata.tor.us",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;(0,i.Z)(this,"metadataHost",void 0),(0,i.Z)(this,"serverTimeOffset",void 0),this.metadataHost=e,this.serverTimeOffset=t}static setAPIKey(e){(0,o.ut)(e)}static setEmbedHost(e){(0,o.y1)(e)}generateMetadataParams(e,t){var n,r;const i=f.keyFromPrivate(t,"hex"),o={data:e,timestamp:Math.floor(this.serverTimeOffset+Date.now()/1e3).toString(16)},s=i.sign(h(d.from(a()(o),"utf8")));return{pub_key_X:i.getPublic().getX().toString(16,64),pub_key_Y:i.getPublic().getY().toString(16,64),set_data:o,signature:d.from(s.r.toString(16,64)+s.s.toString(16,64)+(null!==(n=null===(r=s.recoveryParam)||void 0===r?void 0:r.toString(16).padStart(2,"0").slice(-2))&&void 0!==n?n:"00"),"hex").toString("base64")}}generatePubKeyParams(e){const t=f.keyFromPrivate(e,"hex");return{pub_key_X:t.getPublic().getX().toString(16,64),pub_key_Y:t.getPublic().getY().toString(16,64)}}async setMetadata(e,t,n){const i=null!==t?(0,r.Z)((0,r.Z)({},e),{},{namespace:t}):e,s=await(0,o.v_)(`${this.metadataHost}/set`,i,n,{useAPIKey:!0});return s.message}async getMetadata(e,t,n){const i=null!==t?(0,r.Z)((0,r.Z)({},e),{},{namespace:t}):e,s=await(0,o.v_)(`${this.metadataHost}/get`,i,n,{useAPIKey:!0});return s.message}}const g="webauthn_torus_share",y="webauthn_device_share";function m(e){return{iv:d.from(e.iv,"hex"),ephemPublicKey:d.from(e.ephemPublicKey,"hex"),ciphertext:d.from(e.ciphertext,"hex"),mac:d.from(e.mac,"hex")}}function b(e){return{iv:d.from(e.iv).toString("hex"),ephemPublicKey:d.from(e.ephemPublicKey).toString("hex"),ciphertext:d.from(e.ciphertext).toString("hex"),mac:d.from(e.mac).toString("hex")}}async function w(e,t){const n=JSON.stringify(t),r=d.from(n,"utf-8"),i=await(0,u.encrypt)((0,u.getPublic)(d.from(e,"hex")),r),o=b(i),s=JSON.stringify(o);return s}async function v(e,t){const n=JSON.parse(t),r=m(n),i=f.keyFromPrivate(e),o=await(0,u.decrypt)(d.from(i.getPrivate().toString("hex",64),"hex"),r),s=o.toString("utf-8"),a=JSON.parse(s);return a}async function _(e,t,n){const r=f.keyFromPrivate(t),i=r.getPublic(),o=await e.getMetadata({pub_key_X:i.getX().toString(16),pub_key_Y:i.getY().toString(16)},n);if(!o)return null;const s=await v(t,o);return s}async function S(e,t,n,r){const i=await w(t,n),o=e.generateMetadataParams(i,t);await e.setMetadata(o,r)}async function E(e,t,n,r,i){const o=f.keyFromPrivate(n),s=o.getPrivate(),a=f.keyFromPublic({x:t.pub_key_X,y:t.pub_key_Y}),c=await _(e,n,g);let l={};c&&(l=c);const h=JSON.stringify(i),p=d.from(h,"utf-8"),y=await(0,u.encrypt)(d.from(a.getPublic("hex"),"hex"),p),m=b(y);l[r]=m,await S(e,s.toString("hex",64),l,g)}async function k(e,t,n,r){const i=f.keyFromPrivate(t),o=i.getPrivate(),s=await _(e,t,y);let a={};s&&(a=s),a[n]=r,await S(e,o.toString("hex",64),a,y)}async function T(e,t,n,r){const i=await _(e,n,g);if(!i)return null;const o=i[r];if(!o)return null;const s=m(o),a=f.keyFromPrivate(t),c=a.getPrivate(),l=await(0,u.decrypt)(d.from(c.toString("hex",64),"hex"),s),h=l.toString("utf-8"),p=JSON.parse(h);return p}async function P(e,t,n){const r=await _(e,t,y);return r?r[n]:null}},76665:(e,t,n)=>{"use strict";const{AbortError:r,codes:i}=n(49293),{isNodeStream:o,isWebStream:s,kControllerErrorFunction:a}=n(49888),c=n(40701),{ERR_INVALID_ARG_TYPE:l}=i,u=(e,t)=>{if("object"!==typeof e||!("aborted"in e))throw new l(t,"AbortSignal",e)};e.exports.addAbortSignal=function(t,n){if(u(t,"signal"),!o(n)&&!s(n))throw new l("stream",["ReadableStream","WritableStream","Stream"],n);return e.exports.addAbortSignalNoValidate(t,n)},e.exports.addAbortSignalNoValidate=function(e,t){if("object"!==typeof e||!("aborted"in e))return t;const n=o(t)?()=>{t.destroy(new r(void 0,{cause:e.reason}))}:()=>{t[a](new r(void 0,{cause:e.reason}))};return e.aborted?n():(e.addEventListener("abort",n),c(t,(()=>e.removeEventListener("abort",n)))),t}},52727:(e,t,n)=>{"use strict";n(41817);const{StringPrototypeSlice:r,SymbolIterator:i,TypedArrayPrototypeSet:o,Uint8Array:s}=n(17594),{Buffer:a}=n(15361),{inspect:c}=n(81125);e.exports=class{constructor(){this.head=null,this.tail=null,this.length=0}push(e){const t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length}unshift(e){const t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length}shift(){if(0===this.length)return;const e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}clear(){this.head=this.tail=null,this.length=0}join(e){if(0===this.length)return"";let t=this.head,n=""+t.data;while(null!==(t=t.next))n+=e+t.data;return n}concat(e){if(0===this.length)return a.alloc(0);const t=a.allocUnsafe(e>>>0);let n=this.head,r=0;while(n)o(t,n.data,r),r+=n.data.length,n=n.next;return t}consume(e,t){const n=this.head.data;if(e<n.length){const t=n.slice(0,e);return this.head.data=n.slice(e),t}return e===n.length?this.shift():t?this._getString(e):this._getBuffer(e)}first(){return this.head.data}*[i](){for(let e=this.head;e;e=e.next)yield e.data}_getString(e){let t="",n=this.head,i=0;do{const o=n.data;if(!(e>o.length)){e===o.length?(t+=o,++i,n.next?this.head=n.next:this.head=this.tail=null):(t+=r(o,0,e),this.head=n,n.data=r(o,e));break}t+=o,e-=o.length,++i}while(null!==(n=n.next));return this.length-=i,t}_getBuffer(e){const t=a.allocUnsafe(e),n=e;let r=this.head,i=0;do{const a=r.data;if(!(e>a.length)){e===a.length?(o(t,a,n-e),++i,r.next?this.head=r.next:this.head=this.tail=null):(o(t,new s(a.buffer,a.byteOffset,e),n-e),this.head=r,r.data=a.slice(e));break}o(t,a,n-e),e-=a.length,++i}while(null!==(r=r.next));return this.length-=i,t}[Symbol.for("nodejs.util.inspect.custom")](e,t){return c(this,{...t,depth:0,customInspect:!1})}}},92431:(e,t,n)=>{"use strict";n(57658);const{pipeline:r}=n(55918),i=n(59910),{destroyer:o}=n(68818),{isNodeStream:s,isReadable:a,isWritable:c,isWebStream:l,isTransformStream:u,isWritableStream:d,isReadableStream:h}=n(49888),{AbortError:f,codes:{ERR_INVALID_ARG_VALUE:p,ERR_MISSING_ARGS:g}}=n(49293),y=n(40701);e.exports=function(...e){if(0===e.length)throw new g("streams");if(1===e.length)return i.from(e[0]);const t=[...e];if("function"===typeof e[0]&&(e[0]=i.from(e[0])),"function"===typeof e[e.length-1]){const t=e.length-1;e[t]=i.from(e[t])}for(let r=0;r<e.length;++r)if(s(e[r])||l(e[r])){if(r<e.length-1&&!(a(e[r])||h(e[r])||u(e[r])))throw new p(`streams[${r}]`,t[r],"must be readable");if(r>0&&!(c(e[r])||d(e[r])||u(e[r])))throw new p(`streams[${r}]`,t[r],"must be writable")}let n,m,b,w,v;function _(e){const t=w;w=null,t?t(e):e?v.destroy(e):T||k||v.destroy()}const S=e[0],E=r(e,_),k=!!(c(S)||d(S)||u(S)),T=!!(a(E)||h(E)||u(E));if(v=new i({writableObjectMode:!(null===S||void 0===S||!S.writableObjectMode),readableObjectMode:!(null===E||void 0===E||!E.writableObjectMode),writable:k,readable:T}),k){if(s(S))v._write=function(e,t,r){S.write(e,t)?r():n=r},v._final=function(e){S.end(),m=e},S.on("drain",(function(){if(n){const e=n;n=null,e()}}));else if(l(S)){const e=u(S)?S.writable:S,t=e.getWriter();v._write=async function(e,n,r){try{await t.ready,t.write(e).catch((()=>{})),r()}catch(i){r(i)}},v._final=async function(e){try{await t.ready,t.close().catch((()=>{})),m=e}catch(n){e(n)}}}const e=u(E)?E.readable:E;y(e,(()=>{if(m){const e=m;m=null,e()}}))}if(T)if(s(E))E.on("readable",(function(){if(b){const e=b;b=null,e()}})),E.on("end",(function(){v.push(null)})),v._read=function(){while(1){const e=E.read();if(null===e)return void(b=v._read);if(!v.push(e))return}};else if(l(E)){const e=u(E)?E.readable:E,t=e.getReader();v._read=async function(){while(1)try{const{value:e,done:n}=await t.read();if(!v.push(e))return;if(n)return void v.push(null)}catch{return}}}return v._destroy=function(e,t){e||null===w||(e=new f),b=null,n=null,m=null,null===w?t(e):(w=t,s(E)&&o(E,e))},v}},68818:(e,t,n)=>{"use strict";const r=n(96027),{aggregateTwoErrors:i,codes:{ERR_MULTIPLE_CALLBACK:o},AbortError:s}=n(49293),{Symbol:a}=n(17594),{kDestroyed:c,isDestroyed:l,isFinished:u,isServerRequest:d}=n(49888),h=a("kDestroy"),f=a("kConstruct");function p(e,t,n){e&&(e.stack,t&&!t.errored&&(t.errored=e),n&&!n.errored&&(n.errored=e))}function g(e,t){const n=this._readableState,r=this._writableState,o=r||n;return null!==r&&void 0!==r&&r.destroyed||null!==n&&void 0!==n&&n.destroyed?("function"===typeof t&&t(),this):(p(e,r,n),r&&(r.destroyed=!0),n&&(n.destroyed=!0),o.constructed?y(this,e,t):this.once(h,(function(n){y(this,i(n,e),t)})),this)}function y(e,t,n){let i=!1;function o(t){if(i)return;i=!0;const o=e._readableState,s=e._writableState;p(t,s,o),s&&(s.closed=!0),o&&(o.closed=!0),"function"===typeof n&&n(t),t?r.nextTick(m,e,t):r.nextTick(b,e)}try{e._destroy(t||null,o)}catch(t){o(t)}}function m(e,t){w(e,t),b(e)}function b(e){const t=e._readableState,n=e._writableState;n&&(n.closeEmitted=!0),t&&(t.closeEmitted=!0),(null!==n&&void 0!==n&&n.emitClose||null!==t&&void 0!==t&&t.emitClose)&&e.emit("close")}function w(e,t){const n=e._readableState,r=e._writableState;null!==r&&void 0!==r&&r.errorEmitted||null!==n&&void 0!==n&&n.errorEmitted||(r&&(r.errorEmitted=!0),n&&(n.errorEmitted=!0),e.emit("error",t))}function v(){const e=this._readableState,t=this._writableState;e&&(e.constructed=!0,e.closed=!1,e.closeEmitted=!1,e.destroyed=!1,e.errored=null,e.errorEmitted=!1,e.reading=!1,e.ended=!1===e.readable,e.endEmitted=!1===e.readable),t&&(t.constructed=!0,t.destroyed=!1,t.closed=!1,t.closeEmitted=!1,t.errored=null,t.errorEmitted=!1,t.finalCalled=!1,t.prefinished=!1,t.ended=!1===t.writable,t.ending=!1===t.writable,t.finished=!1===t.writable)}function _(e,t,n){const i=e._readableState,o=e._writableState;if(null!==o&&void 0!==o&&o.destroyed||null!==i&&void 0!==i&&i.destroyed)return this;null!==i&&void 0!==i&&i.autoDestroy||null!==o&&void 0!==o&&o.autoDestroy?e.destroy(t):t&&(t.stack,o&&!o.errored&&(o.errored=t),i&&!i.errored&&(i.errored=t),n?r.nextTick(w,e,t):w(e,t))}function S(e,t){if("function"!==typeof e._construct)return;const n=e._readableState,i=e._writableState;n&&(n.constructed=!1),i&&(i.constructed=!1),e.once(f,t),e.listenerCount(f)>1||r.nextTick(E,e)}function E(e){let t=!1;function n(n){if(t)return void _(e,null!==n&&void 0!==n?n:new o);t=!0;const i=e._readableState,s=e._writableState,a=s||i;i&&(i.constructed=!0),s&&(s.constructed=!0),a.destroyed?e.emit(h,n):n?_(e,n,!0):r.nextTick(k,e)}try{e._construct((e=>{r.nextTick(n,e)}))}catch(i){r.nextTick(n,i)}}function k(e){e.emit(f)}function T(e){return(null===e||void 0===e?void 0:e.setHeader)&&"function"===typeof e.abort}function P(e){e.emit("close")}function R(e,t){e.emit("error",t),r.nextTick(P,e)}function A(e,t){e&&!l(e)&&(t||u(e)||(t=new s),d(e)?(e.socket=null,e.destroy(t)):T(e)?e.abort():T(e.req)?e.req.abort():"function"===typeof e.destroy?e.destroy(t):"function"===typeof e.close?e.close():t?r.nextTick(R,e,t):r.nextTick(P,e),e.destroyed||(e[c]=!0))}e.exports={construct:S,destroyer:A,destroy:g,undestroy:v,errorOrDestroy:_}},59910:(e,t,n)=>{"use strict";const{ObjectDefineProperties:r,ObjectGetOwnPropertyDescriptor:i,ObjectKeys:o,ObjectSetPrototypeOf:s}=n(17594);e.exports=l;const a=n(67180),c=n(76558);s(l.prototype,a.prototype),s(l,a);{const e=o(c.prototype);for(let t=0;t<e.length;t++){const n=e[t];l.prototype[n]||(l.prototype[n]=c.prototype[n])}}function l(e){if(!(this instanceof l))return new l(e);a.call(this,e),c.call(this,e),e?(this.allowHalfOpen=!1!==e.allowHalfOpen,!1===e.readable&&(this._readableState.readable=!1,this._readableState.ended=!0,this._readableState.endEmitted=!0),!1===e.writable&&(this._writableState.writable=!1,this._writableState.ending=!0,this._writableState.ended=!0,this._writableState.finished=!0)):this.allowHalfOpen=!0}let u,d;function h(){return void 0===u&&(u={}),u}r(l.prototype,{writable:{__proto__:null,...i(c.prototype,"writable")},writableHighWaterMark:{__proto__:null,...i(c.prototype,"writableHighWaterMark")},writableObjectMode:{__proto__:null,...i(c.prototype,"writableObjectMode")},writableBuffer:{__proto__:null,...i(c.prototype,"writableBuffer")},writableLength:{__proto__:null,...i(c.prototype,"writableLength")},writableFinished:{__proto__:null,...i(c.prototype,"writableFinished")},writableCorked:{__proto__:null,...i(c.prototype,"writableCorked")},writableEnded:{__proto__:null,...i(c.prototype,"writableEnded")},writableNeedDrain:{__proto__:null,...i(c.prototype,"writableNeedDrain")},destroyed:{__proto__:null,get(){return void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed&&this._writableState.destroyed)},set(e){this._readableState&&this._writableState&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}}}),l.fromWeb=function(e,t){return h().newStreamDuplexFromReadableWritablePair(e,t)},l.toWeb=function(e){return h().newReadableWritablePairFromDuplex(e)},l.from=function(e){return d||(d=n(88013)),d(e,"body")}},88013:(e,t,n)=>{n(35837),n(57658);const r=n(96027),i=n(15361),{isReadable:o,isWritable:s,isIterable:a,isNodeStream:c,isReadableNodeStream:l,isWritableNodeStream:u,isDuplexNodeStream:d}=n(49888),h=n(40701),{AbortError:f,codes:{ERR_INVALID_ARG_TYPE:p,ERR_INVALID_RETURN_VALUE:g}}=n(49293),{destroyer:y}=n(68818),m=n(59910),b=n(67180),{createDeferredPromise:w}=n(81125),v=n(16881),_=globalThis.Blob||i.Blob,S="undefined"!==typeof _?function(e){return e instanceof _}:function(e){return!1},E=globalThis.AbortController||n(71927).AbortController,{FunctionPrototypeCall:k}=n(17594);class T extends m{constructor(e){super(e),!1===(null===e||void 0===e?void 0:e.readable)&&(this._readableState.readable=!1,this._readableState.ended=!0,this._readableState.endEmitted=!0),!1===(null===e||void 0===e?void 0:e.writable)&&(this._writableState.writable=!1,this._writableState.ending=!0,this._writableState.ended=!0,this._writableState.finished=!0)}}function P(e){let{promise:t,resolve:n}=w();const i=new E,o=i.signal,s=e(async function*(){while(1){const e=t;t=null;const{chunk:i,done:s,cb:a}=await e;if(r.nextTick(a),s)return;if(o.aborted)throw new f(void 0,{cause:o.reason});({promise:t,resolve:n}=w()),yield i}}(),{signal:o});return{value:s,write(e,t,r){const i=n;n=null,i({chunk:e,done:!1,cb:r})},final(e){const t=n;n=null,t({done:!0,cb:e})},destroy(e,t){i.abort(),t(e)}}}function R(e){const t=e.readable&&"function"!==typeof e.readable.read?b.wrap(e.readable):e.readable,n=e.writable;let r,i,a,c,l,u=!!o(t),d=!!s(n);function p(e){const t=c;c=null,t?t(e):e&&l.destroy(e)}return l=new T({readableObjectMode:!(null===t||void 0===t||!t.readableObjectMode),writableObjectMode:!(null===n||void 0===n||!n.writableObjectMode),readable:u,writable:d}),d&&(h(n,(e=>{d=!1,e&&y(t,e),p(e)})),l._write=function(e,t,i){n.write(e,t)?i():r=i},l._final=function(e){n.end(),i=e},n.on("drain",(function(){if(r){const e=r;r=null,e()}})),n.on("finish",(function(){if(i){const e=i;i=null,e()}}))),u&&(h(t,(e=>{u=!1,e&&y(t,e),p(e)})),t.on("readable",(function(){if(a){const e=a;a=null,e()}})),t.on("end",(function(){l.push(null)})),l._read=function(){while(1){const e=t.read();if(null===e)return void(a=l._read);if(!l.push(e))return}}),l._destroy=function(e,o){e||null===c||(e=new f),a=null,r=null,i=null,null===c?o(e):(c=o,y(n,e),y(t,e))},l}e.exports=function e(t,n){if(d(t))return t;if(l(t))return R({readable:t});if(u(t))return R({writable:t});if(c(t))return R({writable:!1,readable:!1});if("function"===typeof t){const{value:e,write:i,final:o,destroy:s}=P(t);if(a(e))return v(T,e,{objectMode:!0,write:i,final:o,destroy:s});const c=null===e||void 0===e?void 0:e.then;if("function"===typeof c){let t;const n=k(c,e,(e=>{if(null!=e)throw new g("nully","body",e)}),(e=>{y(t,e)}));return t=new T({objectMode:!0,readable:!1,write:i,final(e){o((async()=>{try{await n,r.nextTick(e,null)}catch(t){r.nextTick(e,t)}}))},destroy:s})}throw new g("Iterable, AsyncIterable or AsyncFunction",n,e)}if(S(t))return e(t.arrayBuffer());if(a(t))return v(T,t,{objectMode:!0,writable:!1});if("object"===typeof(null===t||void 0===t?void 0:t.writable)||"object"===typeof(null===t||void 0===t?void 0:t.readable)){const n=null!==t&&void 0!==t&&t.readable?l(null===t||void 0===t?void 0:t.readable)?null===t||void 0===t?void 0:t.readable:e(t.readable):void 0,r=null!==t&&void 0!==t&&t.writable?u(null===t||void 0===t?void 0:t.writable)?null===t||void 0===t?void 0:t.writable:e(t.writable):void 0;return R({readable:n,writable:r})}const i=null===t||void 0===t?void 0:t.then;if("function"===typeof i){let e;return k(i,t,(t=>{null!=t&&e.push(t),e.push(null)}),(t=>{y(e,t)})),e=new T({objectMode:!0,writable:!1,read(){}})}throw new p(n,["Blob","ReadableStream","WritableStream","Stream","Iterable","AsyncIterable","Function","{ readable, writable } pair","Promise"],t)}},40701:(e,t,n)=>{const r=n(96027),{AbortError:i,codes:o}=n(49293),{ERR_INVALID_ARG_TYPE:s,ERR_STREAM_PREMATURE_CLOSE:a}=o,{kEmptyObject:c,once:l}=n(81125),{validateAbortSignal:u,validateFunction:d,validateObject:h,validateBoolean:f}=n(57712),{Promise:p,PromisePrototypeThen:g}=n(17594),{isClosed:y,isReadable:m,isReadableNodeStream:b,isReadableStream:w,isReadableFinished:v,isReadableErrored:_,isWritable:S,isWritableNodeStream:E,isWritableStream:k,isWritableFinished:T,isWritableErrored:P,isNodeStream:R,willEmitClose:A,kIsClosedPromise:O}=n(49888);function N(e){return e.setHeader&&"function"===typeof e.abort}const C=()=>{};function I(e,t,n){var o,f;if(2===arguments.length?(n=t,t=c):null==t?t=c:h(t,"options"),d(n,"callback"),u(t.signal,"options.signal"),n=l(n),w(e)||k(e))return x(e,t,n);if(!R(e))throw new s("stream",["ReadableStream","WritableStream","Stream"],e);const p=null!==(o=t.readable)&&void 0!==o?o:b(e),g=null!==(f=t.writable)&&void 0!==f?f:E(e),O=e._writableState,I=e._readableState,M=()=>{e.writable||B()};let L=A(e)&&b(e)===p&&E(e)===g,D=T(e,!1);const B=()=>{D=!0,e.destroyed&&(L=!1),(!L||e.readable&&!p)&&(p&&!j||n.call(e))};let j=v(e,!1);const U=()=>{j=!0,e.destroyed&&(L=!1),(!L||e.writable&&!g)&&(g&&!D||n.call(e))},K=t=>{n.call(e,t)};let F=y(e);const W=()=>{F=!0;const t=P(e)||_(e);return t&&"boolean"!==typeof t?n.call(e,t):p&&!j&&b(e,!0)&&!v(e,!1)?n.call(e,new a):!g||D||T(e,!1)?void n.call(e):n.call(e,new a)},$=()=>{F=!0;const t=P(e)||_(e);if(t&&"boolean"!==typeof t)return n.call(e,t);n.call(e)},H=()=>{e.req.on("finish",B)};N(e)?(e.on("complete",B),L||e.on("abort",W),e.req?H():e.on("request",H)):g&&!O&&(e.on("end",M),e.on("close",M)),L||"boolean"!==typeof e.aborted||e.on("aborted",W),e.on("end",U),e.on("finish",B),!1!==t.error&&e.on("error",K),e.on("close",W),F?r.nextTick(W):null!==O&&void 0!==O&&O.errorEmitted||null!==I&&void 0!==I&&I.errorEmitted?L||r.nextTick($):(p||L&&!m(e)||!D&&!1!==S(e))&&(g||L&&!S(e)||!j&&!1!==m(e))?I&&e.req&&e.aborted&&r.nextTick($):r.nextTick($);const V=()=>{n=C,e.removeListener("aborted",W),e.removeListener("complete",B),e.removeListener("abort",W),e.removeListener("request",H),e.req&&e.req.removeListener("finish",B),e.removeListener("end",M),e.removeListener("close",M),e.removeListener("finish",B),e.removeListener("end",U),e.removeListener("error",K),e.removeListener("close",W)};if(t.signal&&!F){const o=()=>{const r=n;V(),r.call(e,new i(void 0,{cause:t.signal.reason}))};if(t.signal.aborted)r.nextTick(o);else{const r=n;n=l(((...n)=>{t.signal.removeEventListener("abort",o),r.apply(e,n)})),t.signal.addEventListener("abort",o)}}return V}function x(e,t,n){let o=!1,s=C;if(t.signal)if(s=()=>{o=!0,n.call(e,new i(void 0,{cause:t.signal.reason}))},t.signal.aborted)r.nextTick(s);else{const r=n;n=l(((...n)=>{t.signal.removeEventListener("abort",s),r.apply(e,n)})),t.signal.addEventListener("abort",s)}const a=(...t)=>{o||r.nextTick((()=>n.apply(e,t)))};return g(e[O].promise,a,a),C}function M(e,t){var n;let r=!1;return null===t&&(t=c),null!==(n=t)&&void 0!==n&&n.cleanup&&(f(t.cleanup,"cleanup"),r=t.cleanup),new p(((n,i)=>{const o=I(e,t,(e=>{r&&o(),e?i(e):n()}))}))}e.exports=I,e.exports.finished=M},16881:(e,t,n)=>{"use strict";n(57658);const r=n(96027),{PromisePrototypeThen:i,SymbolAsyncIterator:o,SymbolIterator:s}=n(17594),{Buffer:a}=n(15361),{ERR_INVALID_ARG_TYPE:c,ERR_STREAM_NULL_VALUES:l}=n(49293).codes;function u(e,t,n){let u,d;if("string"===typeof t||t instanceof a)return new e({objectMode:!0,...n,read(){this.push(t),this.push(null)}});if(t&&t[o])d=!0,u=t[o]();else{if(!t||!t[s])throw new c("iterable",["Iterable"],t);d=!1,u=t[s]()}const h=new e({objectMode:!0,highWaterMark:1,...n});let f=!1;async function p(e){const t=void 0!==e&&null!==e,n="function"===typeof u.throw;if(t&&n){const{value:t,done:n}=await u.throw(e);if(await t,n)return}if("function"===typeof u.return){const{value:e}=await u.return();await e}}async function g(){for(;;){try{const{value:e,done:t}=d?await u.next():u.next();if(t)h.push(null);else{const t=e&&"function"===typeof e.then?await e:e;if(null===t)throw f=!1,new l;if(h.push(t))continue;f=!1}}catch(e){h.destroy(e)}break}}return h._read=function(){f||(f=!0,g())},h._destroy=function(e,t){i(p(e),(()=>r.nextTick(t,e)),(n=>r.nextTick(t,n||e)))},h}e.exports=u},2106:(e,t,n)=>{"use strict";n(30541);const{ArrayIsArray:r,ObjectSetPrototypeOf:i}=n(17594),{EventEmitter:o}=n(43793);function s(e){o.call(this,e)}function a(e,t,n){if("function"===typeof e.prependListener)return e.prependListener(t,n);e._events&&e._events[t]?r(e._events[t])?e._events[t].unshift(n):e._events[t]=[n,e._events[t]]:e.on(t,n)}i(s.prototype,o.prototype),i(s,o),s.prototype.pipe=function(e,t){const n=this;function r(t){e.writable&&!1===e.write(t)&&n.pause&&n.pause()}function i(){n.readable&&n.resume&&n.resume()}n.on("data",r),e.on("drain",i),e._isStdio||t&&!1===t.end||(n.on("end",c),n.on("close",l));let s=!1;function c(){s||(s=!0,e.end())}function l(){s||(s=!0,"function"===typeof e.destroy&&e.destroy())}function u(e){d(),0===o.listenerCount(this,"error")&&this.emit("error",e)}function d(){n.removeListener("data",r),e.removeListener("drain",i),n.removeListener("end",c),n.removeListener("close",l),n.removeListener("error",u),e.removeListener("error",u),n.removeListener("end",d),n.removeListener("close",d),e.removeListener("close",d)}return a(n,"error",u),a(e,"error",u),n.on("end",d),n.on("close",d),e.on("close",d),e.emit("pipe",n),e},e.exports={Stream:s,prependListener:a}},23196:(e,t,n)=>{"use strict";n(35837),n(57658);const r=globalThis.AbortController||n(71927).AbortController,{codes:{ERR_INVALID_ARG_VALUE:i,ERR_INVALID_ARG_TYPE:o,ERR_MISSING_ARGS:s,ERR_OUT_OF_RANGE:a},AbortError:c}=n(49293),{validateAbortSignal:l,validateInteger:u,validateObject:d}=n(57712),h=n(17594).Symbol("kWeak"),{finished:f}=n(40701),p=n(92431),{addAbortSignalNoValidate:g}=n(76665),{isWritable:y,isNodeStream:m}=n(49888),{ArrayPrototypePush:b,MathFloor:w,Number:v,NumberIsNaN:_,Promise:S,PromiseReject:E,PromisePrototypeThen:k,Symbol:T}=n(17594),P=T("kEmpty"),R=T("kEof");function A(e,t){if(null!=t&&d(t,"options"),null!=(null===t||void 0===t?void 0:t.signal)&&l(t.signal,"options.signal"),m(e)&&!y(e))throw new i("stream",e,"must be writable");const n=p(this,e);return null!==t&&void 0!==t&&t.signal&&g(t.signal,n),n}function O(e,t){if("function"!==typeof e)throw new o("fn",["Function","AsyncFunction"],e);null!=t&&d(t,"options"),null!=(null===t||void 0===t?void 0:t.signal)&&l(t.signal,"options.signal");let n=1;return null!=(null===t||void 0===t?void 0:t.concurrency)&&(n=w(t.concurrency)),u(n,"concurrency",1),async function*(){var i,o;const s=new r,a=this,l=[],u=s.signal,d={signal:u},h=()=>s.abort();let f,p;null!==t&&void 0!==t&&null!==(i=t.signal)&&void 0!==i&&i.aborted&&h(),null===t||void 0===t||null===(o=t.signal)||void 0===o||o.addEventListener("abort",h);let g=!1;function y(){g=!0}async function m(){try{for await(let t of a){var r;if(g)return;if(u.aborted)throw new c;try{t=e(t,d)}catch(o){t=E(o)}t!==P&&("function"===typeof(null===(r=t)||void 0===r?void 0:r.catch)&&t.catch(y),l.push(t),f&&(f(),f=null),!g&&l.length&&l.length>=n&&await new S((e=>{p=e})))}l.push(R)}catch(o){const e=E(o);k(e,void 0,y),l.push(e)}finally{var i;g=!0,f&&(f(),f=null),null===t||void 0===t||null===(i=t.signal)||void 0===i||i.removeEventListener("abort",h)}}m();try{while(1){while(l.length>0){const e=await l[0];if(e===R)return;if(u.aborted)throw new c;e!==P&&(yield e),l.shift(),p&&(p(),p=null)}await new S((e=>{f=e}))}}finally{s.abort(),g=!0,p&&(p(),p=null)}}.call(this)}function N(e=void 0){return null!=e&&d(e,"options"),null!=(null===e||void 0===e?void 0:e.signal)&&l(e.signal,"options.signal"),async function*(){let t=0;for await(const r of this){var n;if(null!==e&&void 0!==e&&null!==(n=e.signal)&&void 0!==n&&n.aborted)throw new c({cause:e.signal.reason});yield[t++,r]}}.call(this)}async function C(e,t=void 0){for await(const n of L.call(this,e,t))return!0;return!1}async function I(e,t=void 0){if("function"!==typeof e)throw new o("fn",["Function","AsyncFunction"],e);return!await C.call(this,(async(...t)=>!await e(...t)),t)}async function x(e,t){for await(const n of L.call(this,e,t))return n}async function M(e,t){if("function"!==typeof e)throw new o("fn",["Function","AsyncFunction"],e);async function n(t,n){return await e(t,n),P}for await(const r of O.call(this,n,t));}function L(e,t){if("function"!==typeof e)throw new o("fn",["Function","AsyncFunction"],e);async function n(t,n){return await e(t,n)?t:P}return O.call(this,n,t)}class D extends s{constructor(){super("reduce"),this.message="Reduce of an empty stream requires an initial value"}}async function B(e,t,n){var i;if("function"!==typeof e)throw new o("reducer",["Function","AsyncFunction"],e);null!=n&&d(n,"options"),null!=(null===n||void 0===n?void 0:n.signal)&&l(n.signal,"options.signal");let s=arguments.length>1;if(null!==n&&void 0!==n&&null!==(i=n.signal)&&void 0!==i&&i.aborted){const e=new c(void 0,{cause:n.signal.reason});throw this.once("error",(()=>{})),await f(this.destroy(e)),e}const a=new r,u=a.signal;if(null!==n&&void 0!==n&&n.signal){const e={once:!0,[h]:this};n.signal.addEventListener("abort",(()=>a.abort()),e)}let p=!1;try{for await(const r of this){var g;if(p=!0,null!==n&&void 0!==n&&null!==(g=n.signal)&&void 0!==g&&g.aborted)throw new c;s?t=await e(t,r,{signal:u}):(t=r,s=!0)}if(!p&&!s)throw new D}finally{a.abort()}return t}async function j(e){null!=e&&d(e,"options"),null!=(null===e||void 0===e?void 0:e.signal)&&l(e.signal,"options.signal");const t=[];for await(const r of this){var n;if(null!==e&&void 0!==e&&null!==(n=e.signal)&&void 0!==n&&n.aborted)throw new c(void 0,{cause:e.signal.reason});b(t,r)}return t}function U(e,t){const n=O.call(this,e,t);return async function*(){for await(const e of n)yield*e}.call(this)}function K(e){if(e=v(e),_(e))return 0;if(e<0)throw new a("number",">= 0",e);return e}function F(e,t=void 0){return null!=t&&d(t,"options"),null!=(null===t||void 0===t?void 0:t.signal)&&l(t.signal,"options.signal"),e=K(e),async function*(){var n;if(null!==t&&void 0!==t&&null!==(n=t.signal)&&void 0!==n&&n.aborted)throw new c;for await(const i of this){var r;if(null!==t&&void 0!==t&&null!==(r=t.signal)&&void 0!==r&&r.aborted)throw new c;e--<=0&&(yield i)}}.call(this)}function W(e,t=void 0){return null!=t&&d(t,"options"),null!=(null===t||void 0===t?void 0:t.signal)&&l(t.signal,"options.signal"),e=K(e),async function*(){var n;if(null!==t&&void 0!==t&&null!==(n=t.signal)&&void 0!==n&&n.aborted)throw new c;for await(const i of this){var r;if(null!==t&&void 0!==t&&null!==(r=t.signal)&&void 0!==r&&r.aborted)throw new c;if(!(e-- >0))return;yield i}}.call(this)}e.exports.streamReturningOperators={asIndexedPairs:N,drop:F,filter:L,flatMap:U,map:O,take:W,compose:A},e.exports.promiseReturningOperators={every:I,forEach:M,reduce:B,toArray:j,some:C,find:x}},80511:(e,t,n)=>{"use strict";const{ObjectSetPrototypeOf:r}=n(17594);e.exports=o;const i=n(61917);function o(e){if(!(this instanceof o))return new o(e);i.call(this,e)}r(o.prototype,i.prototype),r(o,i),o.prototype._transform=function(e,t,n){n(null,e)}},55918:(e,t,n)=>{n(35837),n(57658);const r=n(96027),{ArrayIsArray:i,Promise:o,SymbolAsyncIterator:s}=n(17594),a=n(40701),{once:c}=n(81125),l=n(68818),u=n(59910),{aggregateTwoErrors:d,codes:{ERR_INVALID_ARG_TYPE:h,ERR_INVALID_RETURN_VALUE:f,ERR_MISSING_ARGS:p,ERR_STREAM_DESTROYED:g,ERR_STREAM_PREMATURE_CLOSE:y},AbortError:m}=n(49293),{validateFunction:b,validateAbortSignal:w}=n(57712),{isIterable:v,isReadable:_,isReadableNodeStream:S,isNodeStream:E,isTransformStream:k,isWebStream:T,isReadableStream:P,isReadableEnded:R}=n(49888),A=globalThis.AbortController||n(71927).AbortController;let O,N;function C(e,t,n){let r=!1;e.on("close",(()=>{r=!0}));const i=a(e,{readable:t,writable:n},(e=>{r=!e}));return{destroy:t=>{r||(r=!0,l.destroyer(e,t||new g("pipe")))},cleanup:i}}function I(e){return b(e[e.length-1],"streams[stream.length - 1]"),e.pop()}function x(e){if(v(e))return e;if(S(e))return M(e);throw new h("val",["Readable","Iterable","AsyncIterable"],e)}async function*M(e){N||(N=n(67180)),yield*N.prototype[s].call(e)}async function L(e,t,n,{end:r}){let i,s=null;const c=e=>{if(e&&(i=e),s){const e=s;s=null,e()}},l=()=>new o(((e,t)=>{i?t(i):s=()=>{i?t(i):e()}}));t.on("drain",c);const u=a(t,{readable:!1},c);try{t.writableNeedDrain&&await l();for await(const n of e)t.write(n)||await l();r&&t.end(),await l(),n()}catch(h){n(i!==h?d(i,h):h)}finally{u(),t.off("drain",c)}}async function D(e,t,n,{end:r}){k(t)&&(t=t.writable);const i=t.getWriter();try{for await(const t of e)await i.ready,i.write(t).catch((()=>{}));await i.ready,r&&await i.close(),n()}catch(o){try{await i.abort(o),n(o)}catch(o){n(o)}}}function B(...e){return j(e,c(I(e)))}function j(e,t,o){if(1===e.length&&i(e[0])&&(e=e[0]),e.length<2)throw new p("streams");const s=new A,a=s.signal,c=null===o||void 0===o?void 0:o.signal,l=[];function d(){M(new m)}let g,y;w(c,"options.signal"),null===c||void 0===c||c.addEventListener("abort",d);const b=[];let R,N=0;function I(e){M(e,0===--N)}function M(e,n){if(!e||g&&"ERR_STREAM_PREMATURE_CLOSE"!==g.code||(g=e),g||n){while(b.length)b.shift()(g);null===c||void 0===c||c.removeEventListener("abort",d),s.abort(),n&&(g||l.forEach((e=>e())),r.nextTick(t,g,y))}}for(let F=0;F<e.length;F++){const W=e[F],$=F<e.length-1,H=F>0,V=$||!1!==(null===o||void 0===o?void 0:o.end),q=F===e.length-1;if(E(W)){if(V){const{destroy:Z,cleanup:G}=C(W,$,H);b.push(Z),_(W)&&q&&l.push(G)}function B(e){e&&"AbortError"!==e.name&&"ERR_STREAM_PREMATURE_CLOSE"!==e.code&&I(e)}W.on("error",B),_(W)&&q&&l.push((()=>{W.removeListener("error",B)}))}if(0===F)if("function"===typeof W){if(R=W({signal:a}),!v(R))throw new f("Iterable, AsyncIterable or Stream","source",R)}else R=v(W)||S(W)||k(W)?W:u.from(W);else if("function"===typeof W){var j;if(k(R))R=x(null===(j=R)||void 0===j?void 0:j.readable);else R=x(R);if(R=W(R,{signal:a}),$){if(!v(R,!0))throw new f("AsyncIterable",`transform[${F-1}]`,R)}else{var K;O||(O=n(80511));const Y=new O({objectMode:!0}),J=null===(K=R)||void 0===K?void 0:K.then;if("function"===typeof J)N++,J.call(R,(e=>{y=e,null!=e&&Y.write(e),V&&Y.end(),r.nextTick(I)}),(e=>{Y.destroy(e),r.nextTick(I,e)}));else if(v(R,!0))N++,L(R,Y,I,{end:V});else{if(!P(R)&&!k(R))throw new f("AsyncIterable or Promise","destination",R);{const Q=R.readable||R;N++,L(Q,Y,I,{end:V})}}R=Y;const{destroy:z,cleanup:X}=C(R,!1,!0);b.push(z),q&&l.push(X)}}else if(E(W)){if(S(R)){N+=2;const ee=U(R,W,I,{end:V});_(W)&&q&&l.push(ee)}else if(k(R)||P(R)){const te=R.readable||R;N++,L(te,W,I,{end:V})}else{if(!v(R))throw new h("val",["Readable","Iterable","AsyncIterable","ReadableStream","TransformStream"],R);N++,L(R,W,I,{end:V})}R=W}else if(T(W)){if(S(R))N++,D(x(R),W,I,{end:V});else if(P(R)||v(R))N++,D(R,W,I,{end:V});else{if(!k(R))throw new h("val",["Readable","Iterable","AsyncIterable","ReadableStream","TransformStream"],R);N++,D(R.readable,W,I,{end:V})}R=W}else R=u.from(W)}return(null!==a&&void 0!==a&&a.aborted||null!==c&&void 0!==c&&c.aborted)&&r.nextTick(d),R}function U(e,t,n,{end:i}){let o=!1;if(t.on("close",(()=>{o||n(new y)})),e.pipe(t,{end:!1}),i){function s(){o=!0,t.end()}R(e)?r.nextTick(s):e.once("end",s)}else n();return a(e,{readable:!0,writable:!1},(t=>{const r=e._readableState;t&&"ERR_STREAM_PREMATURE_CLOSE"===t.code&&r&&r.ended&&!r.errored&&!r.errorEmitted?e.once("end",n).once("error",n):n(t)})),a(t,{readable:!1,writable:!0},n)}e.exports={pipelineImpl:j,pipeline:B}},67180:(e,t,n)=>{n(57658),n(30541),n(26699);const r=n(96027),{ArrayPrototypeIndexOf:i,NumberIsInteger:o,NumberIsNaN:s,NumberParseInt:a,ObjectDefineProperties:c,ObjectKeys:l,ObjectSetPrototypeOf:u,Promise:d,SafeSet:h,SymbolAsyncIterator:f,Symbol:p}=n(17594);e.exports=U,U.ReadableState=j;const{EventEmitter:g}=n(43793),{Stream:y,prependListener:m}=n(2106),{Buffer:b}=n(15361),{addAbortSignal:w}=n(76665),v=n(40701);let _=n(81125).debuglog("stream",(e=>{_=e}));const S=n(52727),E=n(68818),{getHighWaterMark:k,getDefaultHighWaterMark:T}=n(63695),{aggregateTwoErrors:P,codes:{ERR_INVALID_ARG_TYPE:R,ERR_METHOD_NOT_IMPLEMENTED:A,ERR_OUT_OF_RANGE:O,ERR_STREAM_PUSH_AFTER_EOF:N,ERR_STREAM_UNSHIFT_AFTER_END_EVENT:C}}=n(49293),{validateObject:I}=n(57712),x=p("kPaused"),{StringDecoder:M}=n(25605),L=n(16881);u(U.prototype,y.prototype),u(U,y);const D=()=>{},{errorOrDestroy:B}=E;function j(e,t,r){"boolean"!==typeof r&&(r=t instanceof n(59910)),this.objectMode=!(!e||!e.objectMode),r&&(this.objectMode=this.objectMode||!(!e||!e.readableObjectMode)),this.highWaterMark=e?k(this,e,"readableHighWaterMark",r):T(!1),this.buffer=new S,this.length=0,this.pipes=[],this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.constructed=!0,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this[x]=null,this.errorEmitted=!1,this.emitClose=!e||!1!==e.emitClose,this.autoDestroy=!e||!1!==e.autoDestroy,this.destroyed=!1,this.errored=null,this.closed=!1,this.closeEmitted=!1,this.defaultEncoding=e&&e.defaultEncoding||"utf8",this.awaitDrainWriters=null,this.multiAwaitDrain=!1,this.readingMore=!1,this.dataEmitted=!1,this.decoder=null,this.encoding=null,e&&e.encoding&&(this.decoder=new M(e.encoding),this.encoding=e.encoding)}function U(e){if(!(this instanceof U))return new U(e);const t=this instanceof n(59910);this._readableState=new j(e,this,t),e&&("function"===typeof e.read&&(this._read=e.read),"function"===typeof e.destroy&&(this._destroy=e.destroy),"function"===typeof e.construct&&(this._construct=e.construct),e.signal&&!t&&w(e.signal,this)),y.call(this,e),E.construct(this,(()=>{this._readableState.needReadable&&G(this,this._readableState)}))}function K(e,t,n,r){_("readableAddChunk",t);const i=e._readableState;let o;if(i.objectMode||("string"===typeof t?(n=n||i.defaultEncoding,i.encoding!==n&&(r&&i.encoding?t=b.from(t,n).toString(i.encoding):(t=b.from(t,n),n=""))):t instanceof b?n="":y._isUint8Array(t)?(t=y._uint8ArrayToBuffer(t),n=""):null!=t&&(o=new R("chunk",["string","Buffer","Uint8Array"],t))),o)B(e,o);else if(null===t)i.reading=!1,V(e,i);else if(i.objectMode||t&&t.length>0)if(r)if(i.endEmitted)B(e,new C);else{if(i.destroyed||i.errored)return!1;F(e,i,t,!0)}else if(i.ended)B(e,new N);else{if(i.destroyed||i.errored)return!1;i.reading=!1,i.decoder&&!n?(t=i.decoder.write(t),i.objectMode||0!==t.length?F(e,i,t,!1):G(e,i)):F(e,i,t,!1)}else r||(i.reading=!1,G(e,i));return!i.ended&&(i.length<i.highWaterMark||0===i.length)}function F(e,t,n,r){t.flowing&&0===t.length&&!t.sync&&e.listenerCount("data")>0?(t.multiAwaitDrain?t.awaitDrainWriters.clear():t.awaitDrainWriters=null,t.dataEmitted=!0,e.emit("data",n)):(t.length+=t.objectMode?1:n.length,r?t.buffer.unshift(n):t.buffer.push(n),t.needReadable&&q(e)),G(e,t)}U.prototype.destroy=E.destroy,U.prototype._undestroy=E.undestroy,U.prototype._destroy=function(e,t){t(e)},U.prototype[g.captureRejectionSymbol]=function(e){this.destroy(e)},U.prototype.push=function(e,t){return K(this,e,t,!1)},U.prototype.unshift=function(e,t){return K(this,e,t,!0)},U.prototype.isPaused=function(){const e=this._readableState;return!0===e[x]||!1===e.flowing},U.prototype.setEncoding=function(e){const t=new M(e);this._readableState.decoder=t,this._readableState.encoding=this._readableState.decoder.encoding;const n=this._readableState.buffer;let r="";for(const i of n)r+=t.write(i);return n.clear(),""!==r&&n.push(r),this._readableState.length=r.length,this};const W=1073741824;function $(e){if(e>W)throw new O("size","<= 1GiB",e);return e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++,e}function H(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:s(e)?t.flowing&&t.length?t.buffer.first().length:t.length:e<=t.length?e:t.ended?t.length:0}function V(e,t){if(_("onEofChunk"),!t.ended){if(t.decoder){const e=t.decoder.end();e&&e.length&&(t.buffer.push(e),t.length+=t.objectMode?1:e.length)}t.ended=!0,t.sync?q(e):(t.needReadable=!1,t.emittedReadable=!0,Z(e))}}function q(e){const t=e._readableState;_("emitReadable",t.needReadable,t.emittedReadable),t.needReadable=!1,t.emittedReadable||(_("emitReadable",t.flowing),t.emittedReadable=!0,r.nextTick(Z,e))}function Z(e){const t=e._readableState;_("emitReadable_",t.destroyed,t.length,t.ended),t.destroyed||t.errored||!t.length&&!t.ended||(e.emit("readable"),t.emittedReadable=!1),t.needReadable=!t.flowing&&!t.ended&&t.length<=t.highWaterMark,te(e)}function G(e,t){!t.readingMore&&t.constructed&&(t.readingMore=!0,r.nextTick(Y,e,t))}function Y(e,t){while(!t.reading&&!t.ended&&(t.length<t.highWaterMark||t.flowing&&0===t.length)){const n=t.length;if(_("maybeReadMore read 0"),e.read(0),n===t.length)break}t.readingMore=!1}function J(e,t){return function(){const n=e._readableState;n.awaitDrainWriters===t?(_("pipeOnDrain",1),n.awaitDrainWriters=null):n.multiAwaitDrain&&(_("pipeOnDrain",n.awaitDrainWriters.size),n.awaitDrainWriters.delete(t)),n.awaitDrainWriters&&0!==n.awaitDrainWriters.size||!e.listenerCount("data")||e.resume()}}function z(e){const t=e._readableState;t.readableListening=e.listenerCount("readable")>0,t.resumeScheduled&&!1===t[x]?t.flowing=!0:e.listenerCount("data")>0?e.resume():t.readableListening||(t.flowing=null)}function X(e){_("readable nexttick read 0"),e.read(0)}function Q(e,t){t.resumeScheduled||(t.resumeScheduled=!0,r.nextTick(ee,e,t))}function ee(e,t){_("resume",t.reading),t.reading||e.read(0),t.resumeScheduled=!1,e.emit("resume"),te(e),t.flowing&&!t.reading&&e.read(0)}function te(e){const t=e._readableState;_("flow",t.flowing);while(t.flowing&&null!==e.read());}function ne(e,t){"function"!==typeof e.read&&(e=U.wrap(e,{objectMode:!0}));const n=re(e,t);return n.stream=e,n}async function*re(e,t){let n,r=D;function i(t){this===e?(r(),r=D):r=t}e.on("readable",i);const o=v(e,{writable:!1},(e=>{n=e?P(n,e):null,r(),r=D}));try{while(1){const t=e.destroyed?null:e.read();if(null!==t)yield t;else{if(n)throw n;if(null===n)return;await new d(i)}}}catch(s){throw n=P(n,s),n}finally{!n&&!1===(null===t||void 0===t?void 0:t.destroyOnReturn)||void 0!==n&&!e._readableState.autoDestroy?(e.off("readable",i),o()):E.destroyer(e,null)}}function ie(e,t){if(0===t.length)return null;let n;return t.objectMode?n=t.buffer.shift():!e||e>=t.length?(n=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.first():t.buffer.concat(t.length),t.buffer.clear()):n=t.buffer.consume(e,t.decoder),n}function oe(e){const t=e._readableState;_("endReadable",t.endEmitted),t.endEmitted||(t.ended=!0,r.nextTick(se,t,e))}function se(e,t){if(_("endReadableNT",e.endEmitted,e.length),!e.errored&&!e.closeEmitted&&!e.endEmitted&&0===e.length)if(e.endEmitted=!0,t.emit("end"),t.writable&&!1===t.allowHalfOpen)r.nextTick(ae,t);else if(e.autoDestroy){const e=t._writableState,n=!e||e.autoDestroy&&(e.finished||!1===e.writable);n&&t.destroy()}}function ae(e){const t=e.writable&&!e.writableEnded&&!e.destroyed;t&&e.end()}let ce;function le(){return void 0===ce&&(ce={}),ce}U.prototype.read=function(e){_("read",e),void 0===e?e=NaN:o(e)||(e=a(e,10));const t=this._readableState,n=e;if(e>t.highWaterMark&&(t.highWaterMark=$(e)),0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&((0!==t.highWaterMark?t.length>=t.highWaterMark:t.length>0)||t.ended))return _("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?oe(this):q(this),null;if(e=H(e,t),0===e&&t.ended)return 0===t.length&&oe(this),null;let r,i=t.needReadable;if(_("need readable",i),(0===t.length||t.length-e<t.highWaterMark)&&(i=!0,_("length less than watermark",i)),t.ended||t.reading||t.destroyed||t.errored||!t.constructed)i=!1,_("reading, ended or constructing",i);else if(i){_("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0);try{this._read(t.highWaterMark)}catch(s){B(this,s)}t.sync=!1,t.reading||(e=H(n,t))}return r=e>0?ie(e,t):null,null===r?(t.needReadable=t.length<=t.highWaterMark,e=0):(t.length-=e,t.multiAwaitDrain?t.awaitDrainWriters.clear():t.awaitDrainWriters=null),0===t.length&&(t.ended||(t.needReadable=!0),n!==e&&t.ended&&oe(this)),null===r||t.errorEmitted||t.closeEmitted||(t.dataEmitted=!0,this.emit("data",r)),r},U.prototype._read=function(e){throw new A("_read()")},U.prototype.pipe=function(e,t){const n=this,i=this._readableState;1===i.pipes.length&&(i.multiAwaitDrain||(i.multiAwaitDrain=!0,i.awaitDrainWriters=new h(i.awaitDrainWriters?[i.awaitDrainWriters]:[]))),i.pipes.push(e),_("pipe count=%d opts=%j",i.pipes.length,t);const o=(!t||!1!==t.end)&&e!==r.stdout&&e!==r.stderr,s=o?c:w;function a(e,t){_("onunpipe"),e===n&&t&&!1===t.hasUnpiped&&(t.hasUnpiped=!0,d())}function c(){_("onend"),e.end()}let l;i.endEmitted?r.nextTick(s):n.once("end",s),e.on("unpipe",a);let u=!1;function d(){_("cleanup"),e.removeListener("close",y),e.removeListener("finish",b),l&&e.removeListener("drain",l),e.removeListener("error",g),e.removeListener("unpipe",a),n.removeListener("end",c),n.removeListener("end",w),n.removeListener("data",p),u=!0,l&&i.awaitDrainWriters&&(!e._writableState||e._writableState.needDrain)&&l()}function f(){u||(1===i.pipes.length&&i.pipes[0]===e?(_("false write response, pause",0),i.awaitDrainWriters=e,i.multiAwaitDrain=!1):i.pipes.length>1&&i.pipes.includes(e)&&(_("false write response, pause",i.awaitDrainWriters.size),i.awaitDrainWriters.add(e)),n.pause()),l||(l=J(n,e),e.on("drain",l))}function p(t){_("ondata");const n=e.write(t);_("dest.write",n),!1===n&&f()}function g(t){if(_("onerror",t),w(),e.removeListener("error",g),0===e.listenerCount("error")){const n=e._writableState||e._readableState;n&&!n.errorEmitted?B(e,t):e.emit("error",t)}}function y(){e.removeListener("finish",b),w()}function b(){_("onfinish"),e.removeListener("close",y),w()}function w(){_("unpipe"),n.unpipe(e)}return n.on("data",p),m(e,"error",g),e.once("close",y),e.once("finish",b),e.emit("pipe",n),!0===e.writableNeedDrain?i.flowing&&f():i.flowing||(_("pipe resume"),n.resume()),e},U.prototype.unpipe=function(e){const t=this._readableState,n={hasUnpiped:!1};if(0===t.pipes.length)return this;if(!e){const e=t.pipes;t.pipes=[],this.pause();for(let t=0;t<e.length;t++)e[t].emit("unpipe",this,{hasUnpiped:!1});return this}const r=i(t.pipes,e);return-1===r||(t.pipes.splice(r,1),0===t.pipes.length&&this.pause(),e.emit("unpipe",this,n)),this},U.prototype.on=function(e,t){const n=y.prototype.on.call(this,e,t),i=this._readableState;return"data"===e?(i.readableListening=this.listenerCount("readable")>0,!1!==i.flowing&&this.resume()):"readable"===e&&(i.endEmitted||i.readableListening||(i.readableListening=i.needReadable=!0,i.flowing=!1,i.emittedReadable=!1,_("on readable",i.length,i.reading),i.length?q(this):i.reading||r.nextTick(X,this))),n},U.prototype.addListener=U.prototype.on,U.prototype.removeListener=function(e,t){const n=y.prototype.removeListener.call(this,e,t);return"readable"===e&&r.nextTick(z,this),n},U.prototype.off=U.prototype.removeListener,U.prototype.removeAllListeners=function(e){const t=y.prototype.removeAllListeners.apply(this,arguments);return"readable"!==e&&void 0!==e||r.nextTick(z,this),t},U.prototype.resume=function(){const e=this._readableState;return e.flowing||(_("resume"),e.flowing=!e.readableListening,Q(this,e)),e[x]=!1,this},U.prototype.pause=function(){return _("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(_("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState[x]=!0,this},U.prototype.wrap=function(e){let t=!1;e.on("data",(n=>{!this.push(n)&&e.pause&&(t=!0,e.pause())})),e.on("end",(()=>{this.push(null)})),e.on("error",(e=>{B(this,e)})),e.on("close",(()=>{this.destroy()})),e.on("destroy",(()=>{this.destroy()})),this._read=()=>{t&&e.resume&&(t=!1,e.resume())};const n=l(e);for(let r=1;r<n.length;r++){const t=n[r];void 0===this[t]&&"function"===typeof e[t]&&(this[t]=e[t].bind(e))}return this},U.prototype[f]=function(){return ne(this)},U.prototype.iterator=function(e){return void 0!==e&&I(e,"options"),ne(this,e)},c(U.prototype,{readable:{__proto__:null,get(){const e=this._readableState;return!!e&&!1!==e.readable&&!e.destroyed&&!e.errorEmitted&&!e.endEmitted},set(e){this._readableState&&(this._readableState.readable=!!e)}},readableDidRead:{__proto__:null,enumerable:!1,get:function(){return this._readableState.dataEmitted}},readableAborted:{__proto__:null,enumerable:!1,get:function(){return!(!1===this._readableState.readable||!this._readableState.destroyed&&!this._readableState.errored||this._readableState.endEmitted)}},readableHighWaterMark:{__proto__:null,enumerable:!1,get:function(){return this._readableState.highWaterMark}},readableBuffer:{__proto__:null,enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}},readableFlowing:{__proto__:null,enumerable:!1,get:function(){return this._readableState.flowing},set:function(e){this._readableState&&(this._readableState.flowing=e)}},readableLength:{__proto__:null,enumerable:!1,get(){return this._readableState.length}},readableObjectMode:{__proto__:null,enumerable:!1,get(){return!!this._readableState&&this._readableState.objectMode}},readableEncoding:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.encoding:null}},errored:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.errored:null}},closed:{__proto__:null,get(){return!!this._readableState&&this._readableState.closed}},destroyed:{__proto__:null,enumerable:!1,get(){return!!this._readableState&&this._readableState.destroyed},set(e){this._readableState&&(this._readableState.destroyed=e)}},readableEnded:{__proto__:null,enumerable:!1,get(){return!!this._readableState&&this._readableState.endEmitted}}}),c(j.prototype,{pipesCount:{__proto__:null,get(){return this.pipes.length}},paused:{__proto__:null,get(){return!1!==this[x]},set(e){this[x]=!!e}}}),U._fromList=ie,U.from=function(e,t){return L(U,e,t)},U.fromWeb=function(e,t){return le().newStreamReadableFromReadableStream(e,t)},U.toWeb=function(e,t){return le().newReadableStreamFromStreamReadable(e,t)},U.wrap=function(e,t){var n,r;return new U({objectMode:null===(n=null!==(r=e.readableObjectMode)&&void 0!==r?r:e.objectMode)||void 0===n||n,...t,destroy(t,n){E.destroyer(e,t),n(t)}}).wrap(e)}},63695:(e,t,n)=>{"use strict";const{MathFloor:r,NumberIsInteger:i}=n(17594),{ERR_INVALID_ARG_VALUE:o}=n(49293).codes;function s(e,t,n){return null!=e.highWaterMark?e.highWaterMark:t?e[n]:null}function a(e){return e?16:16384}function c(e,t,n,c){const l=s(t,c,n);if(null!=l){if(!i(l)||l<0){const e=c?`options.${n}`:"options.highWaterMark";throw new o(e,l)}return r(l)}return a(e.objectMode)}e.exports={getHighWaterMark:c,getDefaultHighWaterMark:a}},61917:(e,t,n)=>{"use strict";n(57658);const{ObjectSetPrototypeOf:r,Symbol:i}=n(17594);e.exports=l;const{ERR_METHOD_NOT_IMPLEMENTED:o}=n(49293).codes,s=n(59910),{getHighWaterMark:a}=n(63695);r(l.prototype,s.prototype),r(l,s);const c=i("kCallback");function l(e){if(!(this instanceof l))return new l(e);const t=e?a(this,e,"readableHighWaterMark",!0):null;0===t&&(e={...e,highWaterMark:null,readableHighWaterMark:t,writableHighWaterMark:e.writableHighWaterMark||0}),s.call(this,e),this._readableState.sync=!1,this[c]=null,e&&("function"===typeof e.transform&&(this._transform=e.transform),"function"===typeof e.flush&&(this._flush=e.flush)),this.on("prefinish",d)}function u(e){"function"!==typeof this._flush||this.destroyed?(this.push(null),e&&e()):this._flush(((t,n)=>{t?e?e(t):this.destroy(t):(null!=n&&this.push(n),this.push(null),e&&e())}))}function d(){this._final!==u&&u.call(this)}l.prototype._final=u,l.prototype._transform=function(e,t,n){throw new o("_transform()")},l.prototype._write=function(e,t,n){const r=this._readableState,i=this._writableState,o=r.length;this._transform(e,t,((e,t)=>{e?n(e):(null!=t&&this.push(t),i.ended||o===r.length||r.length<r.highWaterMark?n():this[c]=n)}))},l.prototype._read=function(){if(this[c]){const e=this[c];this[c]=null,e()}}},49888:(e,t,n)=>{"use strict";const{Symbol:r,SymbolAsyncIterator:i,SymbolIterator:o,SymbolFor:s}=n(17594),a=r("kDestroyed"),c=r("kIsErrored"),l=r("kIsReadable"),u=r("kIsDisturbed"),d=s("nodejs.webstream.isClosedPromise"),h=s("nodejs.webstream.controllerErrorFunction");function f(e,t=!1){var n;return!(!e||"function"!==typeof e.pipe||"function"!==typeof e.on||t&&("function"!==typeof e.pause||"function"!==typeof e.resume)||e._writableState&&!1===(null===(n=e._readableState)||void 0===n?void 0:n.readable)||e._writableState&&!e._readableState)}function p(e){var t;return!(!e||"function"!==typeof e.write||"function"!==typeof e.on||e._readableState&&!1===(null===(t=e._writableState)||void 0===t?void 0:t.writable))}function g(e){return!(!e||"function"!==typeof e.pipe||!e._readableState||"function"!==typeof e.on||"function"!==typeof e.write)}function y(e){return e&&(e._readableState||e._writableState||"function"===typeof e.write&&"function"===typeof e.on||"function"===typeof e.pipe&&"function"===typeof e.on)}function m(e){return!(!e||y(e)||"function"!==typeof e.pipeThrough||"function"!==typeof e.getReader||"function"!==typeof e.cancel)}function b(e){return!(!e||y(e)||"function"!==typeof e.getWriter||"function"!==typeof e.abort)}function w(e){return!(!e||y(e)||"object"!==typeof e.readable||"object"!==typeof e.writable)}function v(e){return m(e)||b(e)||w(e)}function _(e,t){return null!=e&&(!0===t?"function"===typeof e[i]:!1===t?"function"===typeof e[o]:"function"===typeof e[i]||"function"===typeof e[o])}function S(e){if(!y(e))return null;const t=e._writableState,n=e._readableState,r=t||n;return!!(e.destroyed||e[a]||null!==r&&void 0!==r&&r.destroyed)}function E(e){if(!p(e))return null;if(!0===e.writableEnded)return!0;const t=e._writableState;return(null===t||void 0===t||!t.errored)&&("boolean"!==typeof(null===t||void 0===t?void 0:t.ended)?null:t.ended)}function k(e,t){if(!p(e))return null;if(!0===e.writableFinished)return!0;const n=e._writableState;return(null===n||void 0===n||!n.errored)&&("boolean"!==typeof(null===n||void 0===n?void 0:n.finished)?null:!!(n.finished||!1===t&&!0===n.ended&&0===n.length))}function T(e){if(!f(e))return null;if(!0===e.readableEnded)return!0;const t=e._readableState;return!(!t||t.errored)&&("boolean"!==typeof(null===t||void 0===t?void 0:t.ended)?null:t.ended)}function P(e,t){if(!f(e))return null;const n=e._readableState;return(null===n||void 0===n||!n.errored)&&("boolean"!==typeof(null===n||void 0===n?void 0:n.endEmitted)?null:!!(n.endEmitted||!1===t&&!0===n.ended&&0===n.length))}function R(e){return e&&null!=e[l]?e[l]:"boolean"!==typeof(null===e||void 0===e?void 0:e.readable)?null:!S(e)&&(f(e)&&e.readable&&!P(e))}function A(e){return"boolean"!==typeof(null===e||void 0===e?void 0:e.writable)?null:!S(e)&&(p(e)&&e.writable&&!E(e))}function O(e,t){return y(e)?!!S(e)||(!1===(null===t||void 0===t?void 0:t.readable)||!R(e))&&(!1===(null===t||void 0===t?void 0:t.writable)||!A(e)):null}function N(e){var t,n;return y(e)?e.writableErrored?e.writableErrored:null!==(t=null===(n=e._writableState)||void 0===n?void 0:n.errored)&&void 0!==t?t:null:null}function C(e){var t,n;return y(e)?e.readableErrored?e.readableErrored:null!==(t=null===(n=e._readableState)||void 0===n?void 0:n.errored)&&void 0!==t?t:null:null}function I(e){if(!y(e))return null;if("boolean"===typeof e.closed)return e.closed;const t=e._writableState,n=e._readableState;return"boolean"===typeof(null===t||void 0===t?void 0:t.closed)||"boolean"===typeof(null===n||void 0===n?void 0:n.closed)?(null===t||void 0===t?void 0:t.closed)||(null===n||void 0===n?void 0:n.closed):"boolean"===typeof e._closed&&x(e)?e._closed:null}function x(e){return"boolean"===typeof e._closed&&"boolean"===typeof e._defaultKeepAlive&&"boolean"===typeof e._removedConnection&&"boolean"===typeof e._removedContLen}function M(e){return"boolean"===typeof e._sent100&&x(e)}function L(e){var t;return"boolean"===typeof e._consuming&&"boolean"===typeof e._dumped&&void 0===(null===(t=e.req)||void 0===t?void 0:t.upgradeOrConnect)}function D(e){if(!y(e))return null;const t=e._writableState,n=e._readableState,r=t||n;return!r&&M(e)||!!(r&&r.autoDestroy&&r.emitClose&&!1===r.closed)}function B(e){var t;return!(!e||!(null!==(t=e[u])&&void 0!==t?t:e.readableDidRead||e.readableAborted))}function j(e){var t,n,r,i,o,s,a,l,u,d;return!(!e||!(null!==(t=null!==(n=null!==(r=null!==(i=null!==(o=null!==(s=e[c])&&void 0!==s?s:e.readableErrored)&&void 0!==o?o:e.writableErrored)&&void 0!==i?i:null===(a=e._readableState)||void 0===a?void 0:a.errorEmitted)&&void 0!==r?r:null===(l=e._writableState)||void 0===l?void 0:l.errorEmitted)&&void 0!==n?n:null===(u=e._readableState)||void 0===u?void 0:u.errored)&&void 0!==t?t:null===(d=e._writableState)||void 0===d?void 0:d.errored))}e.exports={kDestroyed:a,isDisturbed:B,kIsDisturbed:u,isErrored:j,kIsErrored:c,isReadable:R,kIsReadable:l,kIsClosedPromise:d,kControllerErrorFunction:h,isClosed:I,isDestroyed:S,isDuplexNodeStream:g,isFinished:O,isIterable:_,isReadableNodeStream:f,isReadableStream:m,isReadableEnded:T,isReadableFinished:P,isReadableErrored:C,isNodeStream:y,isWebStream:v,isWritable:A,isWritableNodeStream:p,isWritableStream:b,isWritableEnded:E,isWritableFinished:k,isWritableErrored:N,isServerRequest:L,isServerResponse:M,willEmitClose:D,isTransformStream:w}},76558:(e,t,n)=>{n(57658);const r=n(96027),{ArrayPrototypeSlice:i,Error:o,FunctionPrototypeSymbolHasInstance:s,ObjectDefineProperty:a,ObjectDefineProperties:c,ObjectSetPrototypeOf:l,StringPrototypeToLowerCase:u,Symbol:d,SymbolHasInstance:h}=n(17594);e.exports=M,M.WritableState=I;const{EventEmitter:f}=n(43793),p=n(2106).Stream,{Buffer:g}=n(15361),y=n(68818),{addAbortSignal:m}=n(76665),{getHighWaterMark:b,getDefaultHighWaterMark:w}=n(63695),{ERR_INVALID_ARG_TYPE:v,ERR_METHOD_NOT_IMPLEMENTED:_,ERR_MULTIPLE_CALLBACK:S,ERR_STREAM_CANNOT_PIPE:E,ERR_STREAM_DESTROYED:k,ERR_STREAM_ALREADY_FINISHED:T,ERR_STREAM_NULL_VALUES:P,ERR_STREAM_WRITE_AFTER_END:R,ERR_UNKNOWN_ENCODING:A}=n(49293).codes,{errorOrDestroy:O}=y;function N(){}l(M.prototype,p.prototype),l(M,p);const C=d("kOnFinished");function I(e,t,r){"boolean"!==typeof r&&(r=t instanceof n(59910)),this.objectMode=!(!e||!e.objectMode),r&&(this.objectMode=this.objectMode||!(!e||!e.writableObjectMode)),this.highWaterMark=e?b(this,e,"writableHighWaterMark",r):w(!1),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;const i=!(!e||!1!==e.decodeStrings);this.decodeStrings=!i,this.defaultEncoding=e&&e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=U.bind(void 0,t),this.writecb=null,this.writelen=0,this.afterWriteTickInfo=null,x(this),this.pendingcb=0,this.constructed=!0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!e||!1!==e.emitClose,this.autoDestroy=!e||!1!==e.autoDestroy,this.errored=null,this.closed=!1,this.closeEmitted=!1,this[C]=[]}function x(e){e.buffered=[],e.bufferedIndex=0,e.allBuffers=!0,e.allNoop=!0}function M(e){const t=this instanceof n(59910);if(!t&&!s(M,this))return new M(e);this._writableState=new I(e,this,t),e&&("function"===typeof e.write&&(this._write=e.write),"function"===typeof e.writev&&(this._writev=e.writev),"function"===typeof e.destroy&&(this._destroy=e.destroy),"function"===typeof e.final&&(this._final=e.final),"function"===typeof e.construct&&(this._construct=e.construct),e.signal&&m(e.signal,this)),p.call(this,e),y.construct(this,(()=>{const e=this._writableState;e.writing||$(this,e),Z(this,e)}))}function L(e,t,n,i){const o=e._writableState;if("function"===typeof n)i=n,n=o.defaultEncoding;else{if(n){if("buffer"!==n&&!g.isEncoding(n))throw new A(n)}else n=o.defaultEncoding;"function"!==typeof i&&(i=N)}if(null===t)throw new P;if(!o.objectMode)if("string"===typeof t)!1!==o.decodeStrings&&(t=g.from(t,n),n="buffer");else if(t instanceof g)n="buffer";else{if(!p._isUint8Array(t))throw new v("chunk",["string","Buffer","Uint8Array"],t);t=p._uint8ArrayToBuffer(t),n="buffer"}let s;return o.ending?s=new R:o.destroyed&&(s=new k("write")),s?(r.nextTick(i,s),O(e,s,!0),s):(o.pendingcb++,D(e,o,t,n,i))}function D(e,t,n,r,i){const o=t.objectMode?1:n.length;t.length+=o;const s=t.length<t.highWaterMark;return s||(t.needDrain=!0),t.writing||t.corked||t.errored||!t.constructed?(t.buffered.push({chunk:n,encoding:r,callback:i}),t.allBuffers&&"buffer"!==r&&(t.allBuffers=!1),t.allNoop&&i!==N&&(t.allNoop=!1)):(t.writelen=o,t.writecb=i,t.writing=!0,t.sync=!0,e._write(n,r,t.onwrite),t.sync=!1),s&&!t.errored&&!t.destroyed}function B(e,t,n,r,i,o,s){t.writelen=r,t.writecb=s,t.writing=!0,t.sync=!0,t.destroyed?t.onwrite(new k("write")):n?e._writev(i,t.onwrite):e._write(i,o,t.onwrite),t.sync=!1}function j(e,t,n,r){--t.pendingcb,r(n),W(t),O(e,n)}function U(e,t){const n=e._writableState,i=n.sync,o=n.writecb;"function"===typeof o?(n.writing=!1,n.writecb=null,n.length-=n.writelen,n.writelen=0,t?(t.stack,n.errored||(n.errored=t),e._readableState&&!e._readableState.errored&&(e._readableState.errored=t),i?r.nextTick(j,e,n,t,o):j(e,n,t,o)):(n.buffered.length>n.bufferedIndex&&$(e,n),i?null!==n.afterWriteTickInfo&&n.afterWriteTickInfo.cb===o?n.afterWriteTickInfo.count++:(n.afterWriteTickInfo={count:1,cb:o,stream:e,state:n},r.nextTick(K,n.afterWriteTickInfo)):F(e,n,1,o))):O(e,new S)}function K({stream:e,state:t,count:n,cb:r}){return t.afterWriteTickInfo=null,F(e,t,n,r)}function F(e,t,n,r){const i=!t.ending&&!e.destroyed&&0===t.length&&t.needDrain;i&&(t.needDrain=!1,e.emit("drain"));while(n-- >0)t.pendingcb--,r();t.destroyed&&W(t),Z(e,t)}function W(e){if(e.writing)return;for(let i=e.bufferedIndex;i<e.buffered.length;++i){var t;const{chunk:n,callback:r}=e.buffered[i],o=e.objectMode?1:n.length;e.length-=o,r(null!==(t=e.errored)&&void 0!==t?t:new k("write"))}const n=e[C].splice(0);for(let i=0;i<n.length;i++){var r;n[i](null!==(r=e.errored)&&void 0!==r?r:new k("end"))}x(e)}function $(e,t){if(t.corked||t.bufferProcessing||t.destroyed||!t.constructed)return;const{buffered:n,bufferedIndex:r,objectMode:o}=t,s=n.length-r;if(!s)return;let a=r;if(t.bufferProcessing=!0,s>1&&e._writev){t.pendingcb-=s-1;const r=t.allNoop?N:e=>{for(let t=a;t<n.length;++t)n[t].callback(e)},o=t.allNoop&&0===a?n:i(n,a);o.allBuffers=t.allBuffers,B(e,t,!0,t.length,o,"",r),x(t)}else{do{const{chunk:r,encoding:i,callback:s}=n[a];n[a++]=null;const c=o?1:r.length;B(e,t,!1,c,r,i,s)}while(a<n.length&&!t.writing);a===n.length?x(t):a>256?(n.splice(0,a),t.bufferedIndex=0):t.bufferedIndex=a}t.bufferProcessing=!1}function H(e){return e.ending&&!e.destroyed&&e.constructed&&0===e.length&&!e.errored&&0===e.buffered.length&&!e.finished&&!e.writing&&!e.errorEmitted&&!e.closeEmitted}function V(e,t){let n=!1;function i(i){if(n)O(e,null!==i&&void 0!==i?i:S());else if(n=!0,t.pendingcb--,i){const n=t[C].splice(0);for(let e=0;e<n.length;e++)n[e](i);O(e,i,t.sync)}else H(t)&&(t.prefinished=!0,e.emit("prefinish"),t.pendingcb++,r.nextTick(G,e,t))}t.sync=!0,t.pendingcb++;try{e._final(i)}catch(o){i(o)}t.sync=!1}function q(e,t){t.prefinished||t.finalCalled||("function"!==typeof e._final||t.destroyed?(t.prefinished=!0,e.emit("prefinish")):(t.finalCalled=!0,V(e,t)))}function Z(e,t,n){H(t)&&(q(e,t),0===t.pendingcb&&(n?(t.pendingcb++,r.nextTick(((e,t)=>{H(t)?G(e,t):t.pendingcb--}),e,t)):H(t)&&(t.pendingcb++,G(e,t))))}function G(e,t){t.pendingcb--,t.finished=!0;const n=t[C].splice(0);for(let r=0;r<n.length;r++)n[r]();if(e.emit("finish"),t.autoDestroy){const t=e._readableState,n=!t||t.autoDestroy&&(t.endEmitted||!1===t.readable);n&&e.destroy()}}I.prototype.getBuffer=function(){return i(this.buffered,this.bufferedIndex)},a(I.prototype,"bufferedRequestCount",{__proto__:null,get(){return this.buffered.length-this.bufferedIndex}}),a(M,h,{__proto__:null,value:function(e){return!!s(this,e)||this===M&&(e&&e._writableState instanceof I)}}),M.prototype.pipe=function(){O(this,new E)},M.prototype.write=function(e,t,n){return!0===L(this,e,t,n)},M.prototype.cork=function(){this._writableState.corked++},M.prototype.uncork=function(){const e=this._writableState;e.corked&&(e.corked--,e.writing||$(this,e))},M.prototype.setDefaultEncoding=function(e){if("string"===typeof e&&(e=u(e)),!g.isEncoding(e))throw new A(e);return this._writableState.defaultEncoding=e,this},M.prototype._write=function(e,t,n){if(!this._writev)throw new _("_write()");this._writev([{chunk:e,encoding:t}],n)},M.prototype._writev=null,M.prototype.end=function(e,t,n){const i=this._writableState;let s;if("function"===typeof e?(n=e,e=null,t=null):"function"===typeof t&&(n=t,t=null),null!==e&&void 0!==e){const n=L(this,e,t);n instanceof o&&(s=n)}return i.corked&&(i.corked=1,this.uncork()),s||(i.errored||i.ending?i.finished?s=new T("end"):i.destroyed&&(s=new k("end")):(i.ending=!0,Z(this,i,!0),i.ended=!0)),"function"===typeof n&&(s||i.finished?r.nextTick(n,s):i[C].push(n)),this},c(M.prototype,{closed:{__proto__:null,get(){return!!this._writableState&&this._writableState.closed}},destroyed:{__proto__:null,get(){return!!this._writableState&&this._writableState.destroyed},set(e){this._writableState&&(this._writableState.destroyed=e)}},writable:{__proto__:null,get(){const e=this._writableState;return!!e&&!1!==e.writable&&!e.destroyed&&!e.errored&&!e.ending&&!e.ended},set(e){this._writableState&&(this._writableState.writable=!!e)}},writableFinished:{__proto__:null,get(){return!!this._writableState&&this._writableState.finished}},writableObjectMode:{__proto__:null,get(){return!!this._writableState&&this._writableState.objectMode}},writableBuffer:{__proto__:null,get(){return this._writableState&&this._writableState.getBuffer()}},writableEnded:{__proto__:null,get(){return!!this._writableState&&this._writableState.ending}},writableNeedDrain:{__proto__:null,get(){const e=this._writableState;return!!e&&(!e.destroyed&&!e.ending&&e.needDrain)}},writableHighWaterMark:{__proto__:null,get(){return this._writableState&&this._writableState.highWaterMark}},writableCorked:{__proto__:null,get(){return this._writableState?this._writableState.corked:0}},writableLength:{__proto__:null,get(){return this._writableState&&this._writableState.length}},errored:{__proto__:null,enumerable:!1,get(){return this._writableState?this._writableState.errored:null}},writableAborted:{__proto__:null,enumerable:!1,get:function(){return!(!1===this._writableState.writable||!this._writableState.destroyed&&!this._writableState.errored||this._writableState.finished)}}});const Y=y.destroy;let J;function z(){return void 0===J&&(J={}),J}M.prototype.destroy=function(e,t){const n=this._writableState;return!n.destroyed&&(n.bufferedIndex<n.buffered.length||n[C].length)&&r.nextTick(W,n),Y.call(this,e,t),this},M.prototype._undestroy=y.undestroy,M.prototype._destroy=function(e,t){t(e)},M.prototype[f.captureRejectionSymbol]=function(e){this.destroy(e)},M.fromWeb=function(e,t){return z().newStreamWritableFromWritableStream(e,t)},M.toWeb=function(e){return z().newWritableStreamFromStreamWritable(e)}},57712:(e,t,n)=>{"use strict";const{ArrayIsArray:r,ArrayPrototypeIncludes:i,ArrayPrototypeJoin:o,ArrayPrototypeMap:s,NumberIsInteger:a,NumberIsNaN:c,NumberMAX_SAFE_INTEGER:l,NumberMIN_SAFE_INTEGER:u,NumberParseInt:d,ObjectPrototypeHasOwnProperty:h,RegExpPrototypeExec:f,String:p,StringPrototypeToUpperCase:g,StringPrototypeTrim:y}=n(17594),{hideStackFrames:m,codes:{ERR_SOCKET_BAD_PORT:b,ERR_INVALID_ARG_TYPE:w,ERR_INVALID_ARG_VALUE:v,ERR_OUT_OF_RANGE:_,ERR_UNKNOWN_SIGNAL:S}}=n(49293),{normalizeEncoding:E}=n(81125),{isAsyncFunction:k,isArrayBufferView:T}=n(81125).types,P={};function R(e){return e===(0|e)}function A(e){return e===e>>>0}const O=/^[0-7]+$/,N="must be a 32-bit unsigned integer or an octal string";function C(e,t,n){if("undefined"===typeof e&&(e=n),"string"===typeof e){if(null===f(O,e))throw new v(t,e,N);e=d(e,8)}return M(e,t),e}const I=m(((e,t,n=u,r=l)=>{if("number"!==typeof e)throw new w(t,"number",e);if(!a(e))throw new _(t,"an integer",e);if(e<n||e>r)throw new _(t,`>= ${n} && <= ${r}`,e)})),x=m(((e,t,n=-2147483648,r=2147483647)=>{if("number"!==typeof e)throw new w(t,"number",e);if(!a(e))throw new _(t,"an integer",e);if(e<n||e>r)throw new _(t,`>= ${n} && <= ${r}`,e)})),M=m(((e,t,n=!1)=>{if("number"!==typeof e)throw new w(t,"number",e);if(!a(e))throw new _(t,"an integer",e);const r=n?1:0,i=4294967295;if(e<r||e>i)throw new _(t,`>= ${r} && <= ${i}`,e)}));function L(e,t){if("string"!==typeof e)throw new w(t,"string",e)}function D(e,t,n=void 0,r){if("number"!==typeof e)throw new w(t,"number",e);if(null!=n&&e<n||null!=r&&e>r||(null!=n||null!=r)&&c(e))throw new _(t,`${null!=n?`>= ${n}`:""}${null!=n&&null!=r?" && ":""}${null!=r?`<= ${r}`:""}`,e)}const B=m(((e,t,n)=>{if(!i(n,e)){const r=o(s(n,(e=>"string"===typeof e?`'${e}'`:p(e))),", "),i="must be one of: "+r;throw new v(t,e,i)}}));function j(e,t){if("boolean"!==typeof e)throw new w(t,"boolean",e)}function U(e,t,n){return null!=e&&h(e,t)?e[t]:n}const K=m(((e,t,n=null)=>{const i=U(n,"allowArray",!1),o=U(n,"allowFunction",!1),s=U(n,"nullable",!1);if(!s&&null===e||!i&&r(e)||"object"!==typeof e&&(!o||"function"!==typeof e))throw new w(t,"Object",e)})),F=m(((e,t)=>{if(null!=e&&"object"!==typeof e&&"function"!==typeof e)throw new w(t,"a dictionary",e)})),W=m(((e,t,n=0)=>{if(!r(e))throw new w(t,"Array",e);if(e.length<n){const r=`must be longer than ${n}`;throw new v(t,e,r)}}));function $(e,t){W(e,t);for(let n=0;n<e.length;n++)L(e[n],`${t}[${n}]`)}function H(e,t){W(e,t);for(let n=0;n<e.length;n++)j(e[n],`${t}[${n}]`)}function V(e,t="signal"){if(L(e,t),void 0===P[e]){if(void 0!==P[g(e)])throw new S(e+" (signals must use all capital letters)");throw new S(e)}}const q=m(((e,t="buffer")=>{if(!T(e))throw new w(t,["Buffer","TypedArray","DataView"],e)}));function Z(e,t){const n=E(t),r=e.length;if("hex"===n&&r%2!==0)throw new v("encoding",t,`is invalid for data of length ${r}`)}function G(e,t="Port",n=!0){if("number"!==typeof e&&"string"!==typeof e||"string"===typeof e&&0===y(e).length||+e!==+e>>>0||e>65535||0===e&&!n)throw new b(t,e,n);return 0|e}const Y=m(((e,t)=>{if(void 0!==e&&(null===e||"object"!==typeof e||!("aborted"in e)))throw new w(t,"AbortSignal",e)})),J=m(((e,t)=>{if("function"!==typeof e)throw new w(t,"Function",e)})),z=m(((e,t)=>{if("function"!==typeof e||k(e))throw new w(t,"Function",e)})),X=m(((e,t)=>{if(void 0!==e)throw new w(t,"undefined",e)}));function Q(e,t,n){if(!i(n,e))throw new w(t,`('${o(n,"|")}')`,e)}const ee=/^(?:<[^>]*>)(?:\s*;\s*[^;"\s]+(?:=(")?[^;"\s]*\1)?)*$/;function te(e,t){if("undefined"===typeof e||!f(ee,e))throw new v(t,e,'must be an array or string of format "</styles.css>; rel=preload; as=style"')}function ne(e){if("string"===typeof e)return te(e,"hints"),e;if(r(e)){const t=e.length;let n="";if(0===t)return n;for(let r=0;r<t;r++){const i=e[r];te(i,"hints"),n+=i,r!==t-1&&(n+=", ")}return n}throw new v("hints",e,'must be an array or string of format "</styles.css>; rel=preload; as=style"')}e.exports={isInt32:R,isUint32:A,parseFileMode:C,validateArray:W,validateStringArray:$,validateBooleanArray:H,validateBoolean:j,validateBuffer:q,validateDictionary:F,validateEncoding:Z,validateFunction:J,validateInt32:x,validateInteger:I,validateNumber:D,validateObject:K,validateOneOf:B,validatePlainFunction:z,validatePort:G,validateSignalName:V,validateString:L,validateUint32:M,validateUndefined:X,validateUnion:Q,validateAbortSignal:Y,validateLinkHeaderValue:ne}},42140:(e,t,n)=>{"use strict";const r=n(57051),i=n(36895),o=r.Readable.destroy;e.exports=r.Readable,e.exports._uint8ArrayToBuffer=r._uint8ArrayToBuffer,e.exports._isUint8Array=r._isUint8Array,e.exports.isDisturbed=r.isDisturbed,e.exports.isErrored=r.isErrored,e.exports.isReadable=r.isReadable,e.exports.Readable=r.Readable,e.exports.Writable=r.Writable,e.exports.Duplex=r.Duplex,e.exports.Transform=r.Transform,e.exports.PassThrough=r.PassThrough,e.exports.addAbortSignal=r.addAbortSignal,e.exports.finished=r.finished,e.exports.destroy=r.destroy,e.exports.destroy=o,e.exports.pipeline=r.pipeline,e.exports.compose=r.compose,Object.defineProperty(r,"promises",{configurable:!0,enumerable:!0,get(){return i}}),e.exports.Stream=r.Stream,e.exports["default"]=e.exports},49293:(e,t,n)=>{"use strict";n(21703),n(9170),n(32120),n(35837),n(41817),n(74916),n(57658),n(26699);const{format:r,inspect:i,AggregateError:o}=n(81125),s=globalThis.AggregateError||o,a=Symbol("kIsNodeError"),c=["string","function","number","object","Function","Object","boolean","bigint","symbol"],l=/^([A-Z][a-z0-9]*)+$/,u="__node_internal_",d={};function h(e,t){if(!e)throw new d.ERR_INTERNAL_ASSERTION(t)}function f(e){let t="",n=e.length;const r="-"===e[0]?1:0;for(;n>=r+4;n-=3)t=`_${e.slice(n-3,n)}${t}`;return`${e.slice(0,n)}${t}`}function p(e,t,n){if("function"===typeof t)return h(t.length<=n.length,`Code: ${e}; The provided arguments length (${n.length}) does not match the required ones (${t.length}).`),t(...n);const i=(t.match(/%[dfijoOs]/g)||[]).length;return h(i===n.length,`Code: ${e}; The provided arguments length (${n.length}) does not match the required ones (${i}).`),0===n.length?t:r(t,...n)}function g(e,t,n){n||(n=Error);class r extends n{constructor(...n){super(p(e,t,n))}toString(){return`${this.name} [${e}]: ${this.message}`}}Object.defineProperties(r.prototype,{name:{value:n.name,writable:!0,enumerable:!1,configurable:!0},toString:{value(){return`${this.name} [${e}]: ${this.message}`},writable:!0,enumerable:!1,configurable:!0}}),r.prototype.code=e,r.prototype[a]=!0,d[e]=r}function y(e){const t=u+e.name;return Object.defineProperty(e,"name",{value:t}),e}function m(e,t){if(e&&t&&e!==t){if(Array.isArray(t.errors))return t.errors.push(e),t;const n=new s([t,e],t.message);return n.code=t.code,n}return e||t}class b extends Error{constructor(e="The operation was aborted",t=void 0){if(void 0!==t&&"object"!==typeof t)throw new d.ERR_INVALID_ARG_TYPE("options","Object",t);super(e,t),this.code="ABORT_ERR",this.name="AbortError"}}g("ERR_ASSERTION","%s",Error),g("ERR_INVALID_ARG_TYPE",((e,t,n)=>{h("string"===typeof e,"'name' must be a string"),Array.isArray(t)||(t=[t]);let r="The ";e.endsWith(" argument")?r+=`${e} `:r+=`"${e}" ${e.includes(".")?"property":"argument"} `,r+="must be ";const o=[],s=[],a=[];for(const i of t)h("string"===typeof i,"All expected entries have to be of type string"),c.includes(i)?o.push(i.toLowerCase()):l.test(i)?s.push(i):(h("object"!==i,'The value "object" should be written as "Object"'),a.push(i));if(s.length>0){const e=o.indexOf("object");-1!==e&&(o.splice(o,e,1),s.push("Object"))}if(o.length>0){switch(o.length){case 1:r+=`of type ${o[0]}`;break;case 2:r+=`one of type ${o[0]} or ${o[1]}`;break;default:{const e=o.pop();r+=`one of type ${o.join(", ")}, or ${e}`}}(s.length>0||a.length>0)&&(r+=" or ")}if(s.length>0){switch(s.length){case 1:r+=`an instance of ${s[0]}`;break;case 2:r+=`an instance of ${s[0]} or ${s[1]}`;break;default:{const e=s.pop();r+=`an instance of ${s.join(", ")}, or ${e}`}}a.length>0&&(r+=" or ")}switch(a.length){case 0:break;case 1:a[0].toLowerCase()!==a[0]&&(r+="an "),r+=`${a[0]}`;break;case 2:r+=`one of ${a[0]} or ${a[1]}`;break;default:{const e=a.pop();r+=`one of ${a.join(", ")}, or ${e}`}}if(null==n)r+=`. Received ${n}`;else if("function"===typeof n&&n.name)r+=`. Received function ${n.name}`;else if("object"===typeof n){var u;if(null!==(u=n.constructor)&&void 0!==u&&u.name)r+=`. Received an instance of ${n.constructor.name}`;else{const e=i(n,{depth:-1});r+=`. Received ${e}`}}else{let e=i(n,{colors:!1});e.length>25&&(e=`${e.slice(0,25)}...`),r+=`. Received type ${typeof n} (${e})`}return r}),TypeError),g("ERR_INVALID_ARG_VALUE",((e,t,n="is invalid")=>{let r=i(t);r.length>128&&(r=r.slice(0,128)+"...");const o=e.includes(".")?"property":"argument";return`The ${o} '${e}' ${n}. Received ${r}`}),TypeError),g("ERR_INVALID_RETURN_VALUE",((e,t,n)=>{var r;const i=null!==n&&void 0!==n&&null!==(r=n.constructor)&&void 0!==r&&r.name?`instance of ${n.constructor.name}`:"type "+typeof n;return`Expected ${e} to be returned from the "${t}" function but got ${i}.`}),TypeError),g("ERR_MISSING_ARGS",((...e)=>{let t;h(e.length>0,"At least one arg needs to be specified");const n=e.length;switch(e=(Array.isArray(e)?e:[e]).map((e=>`"${e}"`)).join(" or "),n){case 1:t+=`The ${e[0]} argument`;break;case 2:t+=`The ${e[0]} and ${e[1]} arguments`;break;default:{const n=e.pop();t+=`The ${e.join(", ")}, and ${n} arguments`}break}return`${t} must be specified`}),TypeError),g("ERR_OUT_OF_RANGE",((e,t,n)=>{let r;return h(t,'Missing "range" argument'),Number.isInteger(n)&&Math.abs(n)>2**32?r=f(String(n)):"bigint"===typeof n?(r=String(n),(n>2n**32n||n<-(2n**32n))&&(r=f(r)),r+="n"):r=i(n),`The value of "${e}" is out of range. It must be ${t}. Received ${r}`}),RangeError),g("ERR_MULTIPLE_CALLBACK","Callback called multiple times",Error),g("ERR_METHOD_NOT_IMPLEMENTED","The %s method is not implemented",Error),g("ERR_STREAM_ALREADY_FINISHED","Cannot call %s after a stream was finished",Error),g("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable",Error),g("ERR_STREAM_DESTROYED","Cannot call %s after a stream was destroyed",Error),g("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),g("ERR_STREAM_PREMATURE_CLOSE","Premature close",Error),g("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF",Error),g("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event",Error),g("ERR_STREAM_WRITE_AFTER_END","write after end",Error),g("ERR_UNKNOWN_ENCODING","Unknown encoding: %s",TypeError),e.exports={AbortError:b,aggregateTwoErrors:y(m),hideStackFrames:y,codes:d}},17594:(e,t,n)=>{"use strict";n(26699),n(57658),n(21703),n(41817),n(81299),n(74916),n(48675),n(33105),n(63408),n(14590),n(3462),n(33824),n(23767),n(8585),n(68696),e.exports={ArrayIsArray(e){return Array.isArray(e)},ArrayPrototypeIncludes(e,t){return e.includes(t)},ArrayPrototypeIndexOf(e,t){return e.indexOf(t)},ArrayPrototypeJoin(e,t){return e.join(t)},ArrayPrototypeMap(e,t){return e.map(t)},ArrayPrototypePop(e,t){return e.pop(t)},ArrayPrototypePush(e,t){return e.push(t)},ArrayPrototypeSlice(e,t,n){return e.slice(t,n)},Error,FunctionPrototypeCall(e,t,...n){return e.call(t,...n)},FunctionPrototypeSymbolHasInstance(e,t){return Function.prototype[Symbol.hasInstance].call(e,t)},MathFloor:Math.floor,Number,NumberIsInteger:Number.isInteger,NumberIsNaN:Number.isNaN,NumberMAX_SAFE_INTEGER:Number.MAX_SAFE_INTEGER,NumberMIN_SAFE_INTEGER:Number.MIN_SAFE_INTEGER,NumberParseInt:Number.parseInt,ObjectDefineProperties(e,t){return Object.defineProperties(e,t)},ObjectDefineProperty(e,t,n){return Object.defineProperty(e,t,n)},ObjectGetOwnPropertyDescriptor(e,t){return Object.getOwnPropertyDescriptor(e,t)},ObjectKeys(e){return Object.keys(e)},ObjectSetPrototypeOf(e,t){return Object.setPrototypeOf(e,t)},Promise,PromisePrototypeCatch(e,t){return e.catch(t)},PromisePrototypeThen(e,t,n){return e.then(t,n)},PromiseReject(e){return Promise.reject(e)},ReflectApply:Reflect.apply,RegExpPrototypeTest(e,t){return e.test(t)},SafeSet:Set,String,StringPrototypeSlice(e,t,n){return e.slice(t,n)},StringPrototypeToLowerCase(e){return e.toLowerCase()},StringPrototypeToUpperCase(e){return e.toUpperCase()},StringPrototypeTrim(e){return e.trim()},Symbol,SymbolFor:Symbol.for,SymbolAsyncIterator:Symbol.asyncIterator,SymbolHasInstance:Symbol.hasInstance,SymbolIterator:Symbol.iterator,TypedArrayPrototypeSet(e,t,n){return e.set(t,n)},Uint8Array}},81125:(e,t,n)=>{"use strict";n(35837),n(21703),n(74916),n(15306),n(38862),n(26699),n(41817);const r=n(15361),i=Object.getPrototypeOf((async function(){})).constructor,o=globalThis.Blob||r.Blob,s="undefined"!==typeof o?function(e){return e instanceof o}:function(e){return!1};class a extends Error{constructor(e){if(!Array.isArray(e))throw new TypeError("Expected input to be an Array, got "+typeof e);let t="";for(let n=0;n<e.length;n++)t+=`    ${e[n].stack}\n`;super(t),this.name="AggregateError",this.errors=e}}e.exports={AggregateError:a,kEmptyObject:Object.freeze({}),once(e){let t=!1;return function(...n){t||(t=!0,e.apply(this,n))}},createDeferredPromise:function(){let e,t;const n=new Promise(((n,r)=>{e=n,t=r}));return{promise:n,resolve:e,reject:t}},promisify(e){return new Promise(((t,n)=>{e(((e,...r)=>e?n(e):t(...r)))}))},debuglog(){return function(){}},format(e,...t){return e.replace(/%([sdifj])/g,(function(...[e,n]){const r=t.shift();if("f"===n)return r.toFixed(6);if("j"===n)return JSON.stringify(r);if("s"===n&&"object"===typeof r){const e=r.constructor!==Object?r.constructor.name:"";return`${e} {}`.trim()}return r.toString()}))},inspect(e){switch(typeof e){case"string":if(e.includes("'")){if(!e.includes('"'))return`"${e}"`;if(!e.includes("`")&&!e.includes("${"))return`\`${e}\``}return`'${e}'`;case"number":return isNaN(e)?"NaN":Object.is(e,-0)?String(e):e;case"bigint":return`${String(e)}n`;case"boolean":case"undefined":return String(e);case"object":return"{}"}},types:{isAsyncFunction(e){return e instanceof i},isArrayBufferView(e){return ArrayBuffer.isView(e)}},isBlob:s},e.exports.promisify.custom=Symbol.for("nodejs.util.promisify.custom")},57051:(e,t,n)=>{n(48675),n(33105),n(63408),n(14590),n(3462),n(33824),n(23767),n(8585),n(68696);const{Buffer:r}=n(15361),{ObjectDefineProperty:i,ObjectKeys:o,ReflectApply:s}=n(17594),{promisify:{custom:a}}=n(81125),{streamReturningOperators:c,promiseReturningOperators:l}=n(23196),{codes:{ERR_ILLEGAL_CONSTRUCTOR:u}}=n(49293),d=n(92431),{pipeline:h}=n(55918),{destroyer:f}=n(68818),p=n(40701),g=n(36895),y=n(49888),m=e.exports=n(2106).Stream;m.isDisturbed=y.isDisturbed,m.isErrored=y.isErrored,m.isReadable=y.isReadable,m.Readable=n(67180);for(const v of o(c)){const _=c[v];function b(...e){if(new.target)throw u();return m.Readable.from(s(_,this,e))}i(b,"name",{__proto__:null,value:_.name}),i(b,"length",{__proto__:null,value:_.length}),i(m.Readable.prototype,v,{__proto__:null,value:b,enumerable:!1,configurable:!0,writable:!0})}for(const S of o(l)){const E=l[S];function b(...e){if(new.target)throw u();return s(E,this,e)}i(b,"name",{__proto__:null,value:E.name}),i(b,"length",{__proto__:null,value:E.length}),i(m.Readable.prototype,S,{__proto__:null,value:b,enumerable:!1,configurable:!0,writable:!0})}m.Writable=n(76558),m.Duplex=n(59910),m.Transform=n(61917),m.PassThrough=n(80511),m.pipeline=h;const{addAbortSignal:w}=n(76665);m.addAbortSignal=w,m.finished=p,m.destroy=f,m.compose=d,i(m,"promises",{__proto__:null,configurable:!0,enumerable:!0,get(){return g}}),i(h,a,{__proto__:null,enumerable:!0,get(){return g.pipeline}}),i(p,a,{__proto__:null,enumerable:!0,get(){return g.finished}}),m.Stream=m,m._isUint8Array=function(e){return e instanceof Uint8Array},m._uint8ArrayToBuffer=function(e){return r.from(e.buffer,e.byteOffset,e.byteLength)}},36895:(e,t,n)=>{"use strict";const{ArrayPrototypePop:r,Promise:i}=n(17594),{isIterable:o,isNodeStream:s,isWebStream:a}=n(49888),{pipelineImpl:c}=n(55918),{finished:l}=n(40701);function u(...e){return new i(((t,n)=>{let i,l;const u=e[e.length-1];if(u&&"object"===typeof u&&!s(u)&&!o(u)&&!a(u)){const t=r(e);i=t.signal,l=t.end}c(e,((e,r)=>{e?n(e):t(r)}),{signal:i,end:l})}))}n(57051),e.exports={finished:l,pipeline:u}},33330:(e,t,n)=>{"use strict";n.r(t),n.d(t,{ObliviousSet:()=>r,now:()=>o,removeTooOldValues:()=>i});n(41817);var r=function(){function e(e){this.ttl=e,this.map=new Map,this._to=!1}return e.prototype.has=function(e){return this.map.has(e)},e.prototype.add=function(e){var t=this;this.map.set(e,o()),this._to||(this._to=!0,setTimeout((function(){t._to=!1,i(t)}),0))},e.prototype.clear=function(){this.map.clear()},e}();function i(e){var t=o()-e.ttl,n=e.map[Symbol.iterator]();while(1){var r=n.next().value;if(!r)return;var i=r[0],s=r[1];if(!(s<t))return;e.map.delete(i)}}function o(){return(new Date).getTime()}},25736:e=>{function t(e,t,n,r,i,o,s){try{var a=e[o](s),c=a.value}catch(l){return void n(l)}a.done?t(c):Promise.resolve(c).then(r,i)}function n(e){return function(){var n=this,r=arguments;return new Promise((function(i,o){var s=e.apply(n,r);function a(e){t(s,i,o,a,c,"next",e)}function c(e){t(s,i,o,a,c,"throw",e)}a(void 0)}))}}e.exports=n,e.exports.__esModule=!0,e.exports["default"]=e.exports},62047:e=>{function t(e){return e&&e.__esModule?e:{default:e}}e.exports=t,e.exports.__esModule=!0,e.exports["default"]=e.exports},53898:(e,t,n)=>{n(41817),n(21703),n(57658);var r=n(54614)["default"];function i(){"use strict";
/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */e.exports=i=function(){return n},e.exports.__esModule=!0,e.exports["default"]=e.exports;var t,n={},o=Object.prototype,s=o.hasOwnProperty,a=Object.defineProperty||function(e,t,n){e[t]=n.value},c="function"==typeof Symbol?Symbol:{},l=c.iterator||"@@iterator",u=c.asyncIterator||"@@asyncIterator",d=c.toStringTag||"@@toStringTag";function h(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{h({},"")}catch(t){h=function(e,t,n){return e[t]=n}}function f(e,t,n,r){var i=t&&t.prototype instanceof v?t:v,o=Object.create(i.prototype),s=new x(r||[]);return a(o,"_invoke",{value:O(e,n,s)}),o}function p(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}n.wrap=f;var g="suspendedStart",y="suspendedYield",m="executing",b="completed",w={};function v(){}function _(){}function S(){}var E={};h(E,l,(function(){return this}));var k=Object.getPrototypeOf,T=k&&k(k(M([])));T&&T!==o&&s.call(T,l)&&(E=T);var P=S.prototype=v.prototype=Object.create(E);function R(e){["next","throw","return"].forEach((function(t){h(e,t,(function(e){return this._invoke(t,e)}))}))}function A(e,t){function n(i,o,a,c){var l=p(e[i],e,o);if("throw"!==l.type){var u=l.arg,d=u.value;return d&&"object"==r(d)&&s.call(d,"__await")?t.resolve(d.__await).then((function(e){n("next",e,a,c)}),(function(e){n("throw",e,a,c)})):t.resolve(d).then((function(e){u.value=e,a(u)}),(function(e){return n("throw",e,a,c)}))}c(l.arg)}var i;a(this,"_invoke",{value:function(e,r){function o(){return new t((function(t,i){n(e,r,t,i)}))}return i=i?i.then(o,o):o()}})}function O(e,n,r){var i=g;return function(o,s){if(i===m)throw new Error("Generator is already running");if(i===b){if("throw"===o)throw s;return{value:t,done:!0}}for(r.method=o,r.arg=s;;){var a=r.delegate;if(a){var c=N(a,r);if(c){if(c===w)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(i===g)throw i=b,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i=m;var l=p(e,n,r);if("normal"===l.type){if(i=r.done?b:y,l.arg===w)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(i=b,r.method="throw",r.arg=l.arg)}}}function N(e,n){var r=n.method,i=e.iterator[r];if(i===t)return n.delegate=null,"throw"===r&&e.iterator["return"]&&(n.method="return",n.arg=t,N(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),w;var o=p(i,e.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,w;var s=o.arg;return s?s.done?(n[e.resultName]=s.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,w):s:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,w)}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function I(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function x(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(C,this),this.reset(!0)}function M(e){if(e||""===e){var n=e[l];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,o=function n(){for(;++i<e.length;)if(s.call(e,i))return n.value=e[i],n.done=!1,n;return n.value=t,n.done=!0,n};return o.next=o}}throw new TypeError(r(e)+" is not iterable")}return _.prototype=S,a(P,"constructor",{value:S,configurable:!0}),a(S,"constructor",{value:_,configurable:!0}),_.displayName=h(S,d,"GeneratorFunction"),n.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===_||"GeneratorFunction"===(t.displayName||t.name))},n.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,S):(e.__proto__=S,h(e,d,"GeneratorFunction")),e.prototype=Object.create(P),e},n.awrap=function(e){return{__await:e}},R(A.prototype),h(A.prototype,u,(function(){return this})),n.AsyncIterator=A,n.async=function(e,t,r,i,o){void 0===o&&(o=Promise);var s=new A(f(e,t,r,i),o);return n.isGeneratorFunction(t)?s:s.next().then((function(e){return e.done?e.value:s.next()}))},R(P),h(P,d,"Generator"),h(P,l,(function(){return this})),h(P,"toString",(function(){return"[object Generator]"})),n.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},n.values=M,x.prototype={constructor:x,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(I),!e)for(var n in this)"t"===n.charAt(0)&&s.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function r(r,i){return a.type="throw",a.arg=e,n.next=r,i&&(n.method="next",n.arg=t),!!i}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],a=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var c=s.call(o,"catchLoc"),l=s.call(o,"finallyLoc");if(c&&l){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(c){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&s.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var i=r;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var o=i?i.completion:{};return o.type=e,o.arg=t,i?(this.method="next",this.next=i.finallyLoc,w):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),w},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),I(n),w}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;I(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:M(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),w}},n}e.exports=i,e.exports.__esModule=!0,e.exports["default"]=e.exports},54614:(e,t,n)=>{function r(t){return e.exports=r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports["default"]=e.exports,r(t)}n(41817),e.exports=r,e.exports.__esModule=!0,e.exports["default"]=e.exports},78305:(e,t,n)=>{n(35837);var r=n(53898)();e.exports=r;try{regeneratorRuntime=r}catch(i){"object"===typeof globalThis?globalThis.regeneratorRuntime=r:Function("r","regeneratorRuntime = r")(r)}},50192:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.hasCORS=void 0;let n=!1;try{n="undefined"!==typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(r){}t.hasCORS=n},20172:(e,t)=>{"use strict";function n(e){let t="";for(let n in e)e.hasOwnProperty(n)&&(t.length&&(t+="&"),t+=encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t}function r(e){let t={},n=e.split("&");for(let r=0,i=n.length;r<i;r++){let e=n[r].split("=");t[decodeURIComponent(e[0])]=decodeURIComponent(e[1])}return t}Object.defineProperty(t,"__esModule",{value:!0}),t.decode=t.encode=void 0,t.encode=n,t.decode=r},91921:(e,t,n)=>{"use strict";n(74916),n(15306),Object.defineProperty(t,"__esModule",{value:!0}),t.parse=void 0;const r=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,i=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function o(e){const t=e,n=e.indexOf("["),o=e.indexOf("]");-1!=n&&-1!=o&&(e=e.substring(0,n)+e.substring(n,o).replace(/:/g,";")+e.substring(o,e.length));let c=r.exec(e||""),l={},u=14;while(u--)l[i[u]]=c[u]||"";return-1!=n&&-1!=o&&(l.source=t,l.host=l.host.substring(1,l.host.length-1).replace(/;/g,":"),l.authority=l.authority.replace("[","").replace("]","").replace(/;/g,":"),l.ipv6uri=!0),l.pathNames=s(l,l["path"]),l.queryKey=a(l,l["query"]),l}function s(e,t){const n=/\/{2,9}/g,r=t.replace(n,"/").split("/");return"/"!=t.slice(0,1)&&0!==t.length||r.splice(0,1),"/"==t.slice(-1)&&r.splice(r.length-1,1),r}function a(e,t){const n={};return t.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,(function(e,t,r){t&&(n[t]=r)})),n}t.parse=o},41894:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.yeast=t.decode=t.encode=void 0;const n="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),r=64,i={};let o,s=0,a=0;function c(e){let t="";do{t=n[e%r]+t,e=Math.floor(e/r)}while(e>0);return t}function l(e){let t=0;for(a=0;a<e.length;a++)t=t*r+i[e.charAt(a)];return t}function u(){const e=c(+new Date);return e!==o?(s=0,o=e):e+"."+c(s++)}for(t.encode=c,t.decode=l,t.yeast=u;a<r;a++)i[n[a]]=a},19408:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.globalThisShim=void 0,t.globalThisShim=(()=>"undefined"!==typeof self?self:"undefined"!==typeof window?window:Function("return this")())()},38396:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.nextTick=t.parse=t.installTimerFunctions=t.transports=t.Transport=t.protocol=t.Socket=void 0;const r=n(28390);Object.defineProperty(t,"Socket",{enumerable:!0,get:function(){return r.Socket}}),t.protocol=r.Socket.protocol;var i=n(42113);Object.defineProperty(t,"Transport",{enumerable:!0,get:function(){return i.Transport}});var o=n(93213);Object.defineProperty(t,"transports",{enumerable:!0,get:function(){return o.transports}});var s=n(97338);Object.defineProperty(t,"installTimerFunctions",{enumerable:!0,get:function(){return s.installTimerFunctions}});var a=n(91921);Object.defineProperty(t,"parse",{enumerable:!0,get:function(){return a.parse}});var c=n(93428);Object.defineProperty(t,"nextTick",{enumerable:!0,get:function(){return c.nextTick}})},28390:function(e,t,n){"use strict";n(74916),n(15306),n(21703),n(57658);var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Socket=void 0;const i=n(93213),o=n(97338),s=n(20172),a=n(91921),c=r(n(15652)),l=n(73906),u=n(19028),d=n(93428),h=(0,c.default)("engine.io-client:socket");class f extends l.Emitter{constructor(e,t={}){super(),this.binaryType=d.defaultBinaryType,this.writeBuffer=[],e&&"object"===typeof e&&(t=e,e=null),e?(e=(0,a.parse)(e),t.hostname=e.host,t.secure="https"===e.protocol||"wss"===e.protocol,t.port=e.port,e.query&&(t.query=e.query)):t.host&&(t.hostname=(0,a.parse)(t.host).host),(0,o.installTimerFunctions)(this,t),this.secure=null!=t.secure?t.secure:"undefined"!==typeof location&&"https:"===location.protocol,t.hostname&&!t.port&&(t.port=this.secure?"443":"80"),this.hostname=t.hostname||("undefined"!==typeof location?location.hostname:"localhost"),this.port=t.port||("undefined"!==typeof location&&location.port?location.port:this.secure?"443":"80"),this.transports=t.transports||["polling","websocket","webtransport"],this.writeBuffer=[],this.prevBufferLen=0,this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},t),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),"string"===typeof this.opts.query&&(this.opts.query=(0,s.decode)(this.opts.query)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingTimeoutTimer=null,"function"===typeof addEventListener&&(this.opts.closeOnBeforeunload&&(this.beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this.beforeunloadEventListener,!1)),"localhost"!==this.hostname&&(this.offlineEventListener=()=>{this.onClose("transport close",{description:"network connection lost"})},addEventListener("offline",this.offlineEventListener,!1))),this.open()}createTransport(e){h('creating transport "%s"',e);const t=Object.assign({},this.opts.query);t.EIO=u.protocol,t.transport=e,this.id&&(t.sid=this.id);const n=Object.assign({},this.opts,{query:t,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[e]);return h("options: %j",n),new i.transports[e](n)}open(){let e;if(this.opts.rememberUpgrade&&f.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket"))e="websocket";else{if(0===this.transports.length)return void this.setTimeoutFn((()=>{this.emitReserved("error","No transports available")}),0);e=this.transports[0]}this.readyState="opening";try{e=this.createTransport(e)}catch(t){return h("error while creating transport: %s",t),this.transports.shift(),void this.open()}e.open(),this.setTransport(e)}setTransport(e){h("setting transport %s",e.name),this.transport&&(h("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners()),this.transport=e,e.on("drain",this.onDrain.bind(this)).on("packet",this.onPacket.bind(this)).on("error",this.onError.bind(this)).on("close",(e=>this.onClose("transport close",e)))}probe(e){h('probing transport "%s"',e);let t=this.createTransport(e),n=!1;f.priorWebsocketSuccess=!1;const r=()=>{n||(h('probe transport "%s" opened',e),t.send([{type:"ping",data:"probe"}]),t.once("packet",(r=>{if(!n)if("pong"===r.type&&"probe"===r.data){if(h('probe transport "%s" pong',e),this.upgrading=!0,this.emitReserved("upgrading",t),!t)return;f.priorWebsocketSuccess="websocket"===t.name,h('pausing current transport "%s"',this.transport.name),this.transport.pause((()=>{n||"closed"!==this.readyState&&(h("changing transport and sending upgrade packet"),l(),this.setTransport(t),t.send([{type:"upgrade"}]),this.emitReserved("upgrade",t),t=null,this.upgrading=!1,this.flush())}))}else{h('probe transport "%s" failed',e);const n=new Error("probe error");n.transport=t.name,this.emitReserved("upgradeError",n)}})))};function i(){n||(n=!0,l(),t.close(),t=null)}const o=n=>{const r=new Error("probe error: "+n);r.transport=t.name,i(),h('probe transport "%s" failed because of error: %s',e,n),this.emitReserved("upgradeError",r)};function s(){o("transport closed")}function a(){o("socket closed")}function c(e){t&&e.name!==t.name&&(h('"%s" works - aborting "%s"',e.name,t.name),i())}const l=()=>{t.removeListener("open",r),t.removeListener("error",o),t.removeListener("close",s),this.off("close",a),this.off("upgrading",c)};t.once("open",r),t.once("error",o),t.once("close",s),this.once("close",a),this.once("upgrading",c),-1!==this.upgrades.indexOf("webtransport")&&"webtransport"!==e?this.setTimeoutFn((()=>{n||t.open()}),200):t.open()}onOpen(){if(h("socket open"),this.readyState="open",f.priorWebsocketSuccess="websocket"===this.transport.name,this.emitReserved("open"),this.flush(),"open"===this.readyState&&this.opts.upgrade){h("starting upgrade probes");let e=0;const t=this.upgrades.length;for(;e<t;e++)this.probe(this.upgrades[e])}}onPacket(e){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(h('socket receive: type "%s", data "%s"',e.type,e.data),this.emitReserved("packet",e),this.emitReserved("heartbeat"),this.resetPingTimeout(),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"ping":this.sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong");break;case"error":const t=new Error("server error");t.code=e.data,this.onError(t);break;case"message":this.emitReserved("data",e.data),this.emitReserved("message",e.data);break}else h('packet received with socket readyState "%s"',this.readyState)}onHandshake(e){this.emitReserved("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this.upgrades=this.filterUpgrades(e.upgrades),this.pingInterval=e.pingInterval,this.pingTimeout=e.pingTimeout,this.maxPayload=e.maxPayload,this.onOpen(),"closed"!==this.readyState&&this.resetPingTimeout()}resetPingTimeout(){this.clearTimeoutFn(this.pingTimeoutTimer),this.pingTimeoutTimer=this.setTimeoutFn((()=>{this.onClose("ping timeout")}),this.pingInterval+this.pingTimeout),this.opts.autoUnref&&this.pingTimeoutTimer.unref()}onDrain(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0===this.writeBuffer.length?this.emitReserved("drain"):this.flush()}flush(){if("closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const e=this.getWritablePackets();h("flushing %d packets in socket",e.length),this.transport.send(e),this.prevBufferLen=e.length,this.emitReserved("flush")}}getWritablePackets(){const e=this.maxPayload&&"polling"===this.transport.name&&this.writeBuffer.length>1;if(!e)return this.writeBuffer;let t=1;for(let n=0;n<this.writeBuffer.length;n++){const e=this.writeBuffer[n].data;if(e&&(t+=(0,o.byteLength)(e)),n>0&&t>this.maxPayload)return h("only send %d out of %d packets",n,this.writeBuffer.length),this.writeBuffer.slice(0,n);t+=2}return h("payload size is %d (max: %d)",t,this.maxPayload),this.writeBuffer}write(e,t,n){return this.sendPacket("message",e,t,n),this}send(e,t,n){return this.sendPacket("message",e,t,n),this}sendPacket(e,t,n,r){if("function"===typeof t&&(r=t,t=void 0),"function"===typeof n&&(r=n,n=null),"closing"===this.readyState||"closed"===this.readyState)return;n=n||{},n.compress=!1!==n.compress;const i={type:e,data:t,options:n};this.emitReserved("packetCreate",i),this.writeBuffer.push(i),r&&this.once("flush",r),this.flush()}close(){const e=()=>{this.onClose("forced close"),h("socket closing - telling transport to close"),this.transport.close()},t=()=>{this.off("upgrade",t),this.off("upgradeError",t),e()},n=()=>{this.once("upgrade",t),this.once("upgradeError",t)};return"opening"!==this.readyState&&"open"!==this.readyState||(this.readyState="closing",this.writeBuffer.length?this.once("drain",(()=>{this.upgrading?n():e()})):this.upgrading?n():e()),this}onError(e){h("socket error %j",e),f.priorWebsocketSuccess=!1,this.emitReserved("error",e),this.onClose("transport error",e)}onClose(e,t){"opening"!==this.readyState&&"open"!==this.readyState&&"closing"!==this.readyState||(h('socket close with reason: "%s"',e),this.clearTimeoutFn(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),"function"===typeof removeEventListener&&(removeEventListener("beforeunload",this.beforeunloadEventListener,!1),removeEventListener("offline",this.offlineEventListener,!1)),this.readyState="closed",this.id=null,this.emitReserved("close",e,t),this.writeBuffer=[],this.prevBufferLen=0)}filterUpgrades(e){const t=[];let n=0;const r=e.length;for(;n<r;n++)~this.transports.indexOf(e[n])&&t.push(e[n]);return t}}t.Socket=f,f.protocol=u.protocol},42113:function(e,t,n){"use strict";n(41817),n(21703);var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Transport=void 0;const i=n(19028),o=n(73906),s=n(97338),a=r(n(15652)),c=n(20172),l=(0,a.default)("engine.io-client:transport");class u extends Error{constructor(e,t,n){super(e),this.description=t,this.context=n,this.type="TransportError"}}class d extends o.Emitter{constructor(e){super(),this.writable=!1,(0,s.installTimerFunctions)(this,e),this.opts=e,this.query=e.query,this.socket=e.socket}onError(e,t,n){return super.emitReserved("error",new u(e,t,n)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this}send(e){"open"===this.readyState?this.write(e):l("transport is not open, discarding packets")}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(e){const t=(0,i.decodePacket)(e,this.socket.binaryType);this.onPacket(t)}onPacket(e){super.emitReserved("packet",e)}onClose(e){this.readyState="closed",super.emitReserved("close",e)}pause(e){}createUri(e,t={}){return e+"://"+this._hostname()+this._port()+this.opts.path+this._query(t)}_hostname(){const e=this.opts.hostname;return-1===e.indexOf(":")?e:"["+e+"]"}_port(){return this.opts.port&&(this.opts.secure&&Number(443!==this.opts.port)||!this.opts.secure&&80!==Number(this.opts.port))?":"+this.opts.port:""}_query(e){const t=(0,c.encode)(e);return t.length?"?"+t:""}}t.Transport=d},93213:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.transports=void 0;const r=n(96763),i=n(67093),o=n(74381);t.transports={websocket:i.WS,webtransport:o.WT,polling:r.Polling}},96763:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Request=t.Polling=void 0;const i=n(42113),o=r(n(15652)),s=n(41894),a=n(19028),c=n(22457),l=n(73906),u=n(97338),d=n(19408),h=(0,o.default)("engine.io-client:polling");function f(){}const p=function(){const e=new c.XHR({xdomain:!1});return null!=e.responseType}();class g extends i.Transport{constructor(e){if(super(e),this.polling=!1,"undefined"!==typeof location){const t="https:"===location.protocol;let n=location.port;n||(n=t?"443":"80"),this.xd="undefined"!==typeof location&&e.hostname!==location.hostname||n!==e.port}const t=e&&e.forceBase64;this.supportsBinary=p&&!t,this.opts.withCredentials&&(this.cookieJar=(0,c.createCookieJar)())}get name(){return"polling"}doOpen(){this.poll()}pause(e){this.readyState="pausing";const t=()=>{h("paused"),this.readyState="paused",e()};if(this.polling||!this.writable){let e=0;this.polling&&(h("we are currently polling - waiting to pause"),e++,this.once("pollComplete",(function(){h("pre-pause polling complete"),--e||t()}))),this.writable||(h("we are currently writing - waiting to pause"),e++,this.once("drain",(function(){h("pre-pause writing complete"),--e||t()})))}else t()}poll(){h("polling"),this.polling=!0,this.doPoll(),this.emitReserved("poll")}onData(e){h("polling got data %s",e);const t=e=>{if("opening"===this.readyState&&"open"===e.type&&this.onOpen(),"close"===e.type)return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(e)};(0,a.decodePayload)(e,this.socket.binaryType).forEach(t),"closed"!==this.readyState&&(this.polling=!1,this.emitReserved("pollComplete"),"open"===this.readyState?this.poll():h('ignoring poll - transport state "%s"',this.readyState))}doClose(){const e=()=>{h("writing close packet"),this.write([{type:"close"}])};"open"===this.readyState?(h("transport open - closing"),e()):(h("transport not open - deferring close"),this.once("open",e))}write(e){this.writable=!1,(0,a.encodePayload)(e,(e=>{this.doWrite(e,(()=>{this.writable=!0,this.emitReserved("drain")}))}))}uri(){const e=this.opts.secure?"https":"http",t=this.query||{};return!1!==this.opts.timestampRequests&&(t[this.opts.timestampParam]=(0,s.yeast)()),this.supportsBinary||t.sid||(t.b64=1),this.createUri(e,t)}request(e={}){return Object.assign(e,{xd:this.xd,cookieJar:this.cookieJar},this.opts),new y(this.uri(),e)}doWrite(e,t){const n=this.request({method:"POST",data:e});n.on("success",t),n.on("error",((e,t)=>{this.onError("xhr post error",e,t)}))}doPoll(){h("xhr poll");const e=this.request();e.on("data",this.onData.bind(this)),e.on("error",((e,t)=>{this.onError("xhr poll error",e,t)})),this.pollXhr=e}}t.Polling=g;class y extends l.Emitter{constructor(e,t){super(),(0,u.installTimerFunctions)(this,t),this.opts=t,this.method=t.method||"GET",this.uri=e,this.data=void 0!==t.data?t.data:null,this.create()}create(){var e;const t=(0,u.pick)(this.opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");t.xdomain=!!this.opts.xd;const n=this.xhr=new c.XHR(t);try{h("xhr open %s: %s",this.method,this.uri),n.open(this.method,this.uri,!0);try{if(this.opts.extraHeaders){n.setDisableHeaderCheck&&n.setDisableHeaderCheck(!0);for(let e in this.opts.extraHeaders)this.opts.extraHeaders.hasOwnProperty(e)&&n.setRequestHeader(e,this.opts.extraHeaders[e])}}catch(r){}if("POST"===this.method)try{n.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(r){}try{n.setRequestHeader("Accept","*/*")}catch(r){}null===(e=this.opts.cookieJar)||void 0===e||e.addCookies(n),"withCredentials"in n&&(n.withCredentials=this.opts.withCredentials),this.opts.requestTimeout&&(n.timeout=this.opts.requestTimeout),n.onreadystatechange=()=>{var e;3===n.readyState&&(null===(e=this.opts.cookieJar)||void 0===e||e.parseCookies(n)),4===n.readyState&&(200===n.status||1223===n.status?this.onLoad():this.setTimeoutFn((()=>{this.onError("number"===typeof n.status?n.status:0)}),0))},h("xhr data %s",this.data),n.send(this.data)}catch(r){return void this.setTimeoutFn((()=>{this.onError(r)}),0)}"undefined"!==typeof document&&(this.index=y.requestsCount++,y.requests[this.index]=this)}onError(e){this.emitReserved("error",e,this.xhr),this.cleanup(!0)}cleanup(e){if("undefined"!==typeof this.xhr&&null!==this.xhr){if(this.xhr.onreadystatechange=f,e)try{this.xhr.abort()}catch(t){}"undefined"!==typeof document&&delete y.requests[this.index],this.xhr=null}}onLoad(){const e=this.xhr.responseText;null!==e&&(this.emitReserved("data",e),this.emitReserved("success"),this.cleanup())}abort(){this.cleanup()}}if(t.Request=y,y.requestsCount=0,y.requests={},"undefined"!==typeof document)if("function"===typeof attachEvent)attachEvent("onunload",m);else if("function"===typeof addEventListener){const e="onpagehide"in d.globalThisShim?"pagehide":"unload";addEventListener(e,m,!1)}function m(){for(let e in y.requests)y.requests.hasOwnProperty(e)&&y.requests[e].abort()}},93428:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.defaultBinaryType=t.usingBrowserWebSocket=t.WebSocket=t.nextTick=void 0;const r=n(19408);t.nextTick=(()=>{const e="function"===typeof Promise&&"function"===typeof Promise.resolve;return e?e=>Promise.resolve().then(e):(e,t)=>t(e,0)})(),t.WebSocket=r.globalThisShim.WebSocket||r.globalThisShim.MozWebSocket,t.usingBrowserWebSocket=!0,t.defaultBinaryType="arraybuffer"},67093:function(e,t,n){"use strict";var r=n(15361)["Buffer"],i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.WS=void 0;const o=n(42113),s=n(41894),a=n(97338),c=n(93428),l=i(n(15652)),u=n(19028),d=(0,l.default)("engine.io-client:websocket"),h="undefined"!==typeof navigator&&"string"===typeof navigator.product&&"reactnative"===navigator.product.toLowerCase();class f extends o.Transport{constructor(e){super(e),this.supportsBinary=!e.forceBase64}get name(){return"websocket"}doOpen(){if(!this.check())return;const e=this.uri(),t=this.opts.protocols,n=h?{}:(0,a.pick)(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(n.headers=this.opts.extraHeaders);try{this.ws=c.usingBrowserWebSocket&&!h?t?new c.WebSocket(e,t):new c.WebSocket(e):new c.WebSocket(e,t,n)}catch(r){return this.emitReserved("error",r)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=e=>this.onClose({description:"websocket connection closed",context:e}),this.ws.onmessage=e=>this.onData(e.data),this.ws.onerror=e=>this.onError("websocket error",e)}write(e){this.writable=!1;for(let t=0;t<e.length;t++){const n=e[t],i=t===e.length-1;(0,u.encodePacket)(n,this.supportsBinary,(e=>{const t={};if(!c.usingBrowserWebSocket&&(n.options&&(t.compress=n.options.compress),this.opts.perMessageDeflate)){const n="string"===typeof e?r.byteLength(e):e.length;n<this.opts.perMessageDeflate.threshold&&(t.compress=!1)}try{c.usingBrowserWebSocket?this.ws.send(e):this.ws.send(e,t)}catch(o){d("websocket closed before onclose event")}i&&(0,c.nextTick)((()=>{this.writable=!0,this.emitReserved("drain")}),this.setTimeoutFn)}))}}doClose(){"undefined"!==typeof this.ws&&(this.ws.close(),this.ws=null)}uri(){const e=this.opts.secure?"wss":"ws",t=this.query||{};return this.opts.timestampRequests&&(t[this.opts.timestampParam]=(0,s.yeast)()),this.supportsBinary||(t.b64=1),this.createUri(e,t)}check(){return!!c.WebSocket}}t.WS=f},74381:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.WT=void 0;const i=n(42113),o=n(93428),s=n(19028),a=r(n(15652)),c=(0,a.default)("engine.io-client:webtransport");class l extends i.Transport{get name(){return"webtransport"}doOpen(){"function"===typeof WebTransport&&(this.transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name]),this.transport.closed.then((()=>{c("transport closed gracefully"),this.onClose()})).catch((e=>{c("transport closed due to %s",e),this.onError("webtransport error",e)})),this.transport.ready.then((()=>{this.transport.createBidirectionalStream().then((e=>{const t=(0,s.createPacketDecoderStream)(Number.MAX_SAFE_INTEGER,this.socket.binaryType),n=e.readable.pipeThrough(t).getReader(),r=(0,s.createPacketEncoderStream)();r.readable.pipeTo(e.writable),this.writer=r.writable.getWriter();const i=()=>{n.read().then((({done:e,value:t})=>{e?c("session is closed"):(c("received chunk: %o",t),this.onPacket(t),i())})).catch((e=>{c("an error occurred while reading: %s",e)}))};i();const o={type:"open"};this.query.sid&&(o.data=`{"sid":"${this.query.sid}"}`),this.writer.write(o).then((()=>this.onOpen()))}))})))}write(e){this.writable=!1;for(let t=0;t<e.length;t++){const n=e[t],r=t===e.length-1;this.writer.write(n).then((()=>{r&&(0,o.nextTick)((()=>{this.writable=!0,this.emitReserved("drain")}),this.setTimeoutFn)}))}}doClose(){var e;null===(e=this.transport)||void 0===e||e.close()}}t.WT=l},22457:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createCookieJar=t.XHR=void 0;const r=n(50192),i=n(19408);function o(e){const t=e.xdomain;try{if("undefined"!==typeof XMLHttpRequest&&(!t||r.hasCORS))return new XMLHttpRequest}catch(n){}if(!t)try{return new(i.globalThisShim[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(n){}}function s(){}t.XHR=o,t.createCookieJar=s},97338:(e,t,n)=>{"use strict";n(85827),Object.defineProperty(t,"__esModule",{value:!0}),t.byteLength=t.installTimerFunctions=t.pick=void 0;const r=n(19408);function i(e,...t){return t.reduce(((t,n)=>(e.hasOwnProperty(n)&&(t[n]=e[n]),t)),{})}t.pick=i;const o=r.globalThisShim.setTimeout,s=r.globalThisShim.clearTimeout;function a(e,t){t.useNativeTimers?(e.setTimeoutFn=o.bind(r.globalThisShim),e.clearTimeoutFn=s.bind(r.globalThisShim)):(e.setTimeoutFn=r.globalThisShim.setTimeout.bind(r.globalThisShim),e.clearTimeoutFn=r.globalThisShim.clearTimeout.bind(r.globalThisShim))}t.installTimerFunctions=a;const c=1.33;function l(e){return"string"===typeof e?u(e):Math.ceil((e.byteLength||e.size)*c)}function u(e){let t=0,n=0;for(let r=0,i=e.length;r<i;r++)t=e.charCodeAt(r),t<128?n+=1:t<2048?n+=2:t<55296||t>=57344?n+=3:(r++,n+=4);return n}t.byteLength=l},16755:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ERROR_PACKET=t.PACKET_TYPES_REVERSE=t.PACKET_TYPES=void 0;const n=Object.create(null);t.PACKET_TYPES=n,n["open"]="0",n["close"]="1",n["ping"]="2",n["pong"]="3",n["message"]="4",n["upgrade"]="5",n["noop"]="6";const r=Object.create(null);t.PACKET_TYPES_REVERSE=r,Object.keys(n).forEach((e=>{r[n[e]]=e}));const i={type:"error",data:"parser error"};t.ERROR_PACKET=i},93233:(e,t,n)=>{"use strict";n(48675),n(33105),n(63408),n(14590),n(3462),n(33824),n(23767),n(8585),n(68696),Object.defineProperty(t,"__esModule",{value:!0}),t.decode=t.encode=void 0;const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i="undefined"===typeof Uint8Array?[]:new Uint8Array(256);for(let a=0;a<r.length;a++)i[r.charCodeAt(a)]=a;const o=e=>{let t,n=new Uint8Array(e),i=n.length,o="";for(t=0;t<i;t+=3)o+=r[n[t]>>2],o+=r[(3&n[t])<<4|n[t+1]>>4],o+=r[(15&n[t+1])<<2|n[t+2]>>6],o+=r[63&n[t+2]];return i%3===2?o=o.substring(0,o.length-1)+"=":i%3===1&&(o=o.substring(0,o.length-2)+"=="),o};t.encode=o;const s=e=>{let t,n,r,o,s,a=.75*e.length,c=e.length,l=0;"="===e[e.length-1]&&(a--,"="===e[e.length-2]&&a--);const u=new ArrayBuffer(a),d=new Uint8Array(u);for(t=0;t<c;t+=4)n=i[e.charCodeAt(t)],r=i[e.charCodeAt(t+1)],o=i[e.charCodeAt(t+2)],s=i[e.charCodeAt(t+3)],d[l++]=n<<2|r>>4,d[l++]=(15&r)<<4|o>>2,d[l++]=(3&o)<<6|63&s;return u};t.decode=s},91248:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.decodePacket=void 0;const r=n(16755),i=n(93233),o="function"===typeof ArrayBuffer,s=(e,t)=>{if("string"!==typeof e)return{type:"message",data:c(e,t)};const n=e.charAt(0);if("b"===n)return{type:"message",data:a(e.substring(1),t)};const i=r.PACKET_TYPES_REVERSE[n];return i?e.length>1?{type:r.PACKET_TYPES_REVERSE[n],data:e.substring(1)}:{type:r.PACKET_TYPES_REVERSE[n]}:r.ERROR_PACKET};t.decodePacket=s;const a=(e,t)=>{if(o){const n=(0,i.decode)(e);return c(n,t)}return{base64:!0,data:e}},c=(e,t)=>{switch(t){case"blob":return e instanceof Blob?e:new Blob([e]);case"arraybuffer":default:return e instanceof ArrayBuffer?e:e.buffer}}},31884:(e,t,n)=>{"use strict";n(48675),n(33105),n(63408),n(14590),n(3462),n(33824),n(23767),n(8585),n(68696),Object.defineProperty(t,"__esModule",{value:!0}),t.encodePacket=t.encodePacketToBinary=void 0;const r=n(16755),i="function"===typeof Blob||"undefined"!==typeof Blob&&"[object BlobConstructor]"===Object.prototype.toString.call(Blob),o="function"===typeof ArrayBuffer,s=e=>"function"===typeof ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer instanceof ArrayBuffer,a=({type:e,data:t},n,a)=>i&&t instanceof Blob?n?a(t):c(t,a):o&&(t instanceof ArrayBuffer||s(t))?n?a(t):c(new Blob([t]),a):a(r.PACKET_TYPES[e]+(t||""));t.encodePacket=a;const c=(e,t)=>{const n=new FileReader;return n.onload=function(){const e=n.result.split(",")[1];t("b"+(e||""))},n.readAsDataURL(e)};function l(e){return e instanceof Uint8Array?e:e instanceof ArrayBuffer?new Uint8Array(e):new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}let u;function d(e,t){return i&&e.data instanceof Blob?e.data.arrayBuffer().then(l).then(t):o&&(e.data instanceof ArrayBuffer||s(e.data))?t(l(e.data)):void a(e,!1,(e=>{u||(u=new TextEncoder),t(u.encode(e))}))}t.encodePacketToBinary=d},19028:(e,t,n)=>{"use strict";n(74916),n(57658),n(48675),n(33105),n(63408),n(14590),n(3462),n(33824),n(23767),n(8585),n(68696),n(85827),Object.defineProperty(t,"__esModule",{value:!0}),t.decodePayload=t.decodePacket=t.encodePayload=t.encodePacket=t.protocol=t.createPacketDecoderStream=t.createPacketEncoderStream=void 0;const r=n(31884);Object.defineProperty(t,"encodePacket",{enumerable:!0,get:function(){return r.encodePacket}});const i=n(91248);Object.defineProperty(t,"decodePacket",{enumerable:!0,get:function(){return i.decodePacket}});const o=n(16755),s=String.fromCharCode(30),a=(e,t)=>{const n=e.length,i=new Array(n);let o=0;e.forEach(((e,a)=>{(0,r.encodePacket)(e,!1,(e=>{i[a]=e,++o===n&&t(i.join(s))}))}))};t.encodePayload=a;const c=(e,t)=>{const n=e.split(s),r=[];for(let o=0;o<n.length;o++){const e=(0,i.decodePacket)(n[o],t);if(r.push(e),"error"===e.type)break}return r};function l(){return new TransformStream({transform(e,t){(0,r.encodePacketToBinary)(e,(n=>{const r=n.length;let i;if(r<126)i=new Uint8Array(1),new DataView(i.buffer).setUint8(0,r);else if(r<65536){i=new Uint8Array(3);const e=new DataView(i.buffer);e.setUint8(0,126),e.setUint16(1,r)}else{i=new Uint8Array(9);const e=new DataView(i.buffer);e.setUint8(0,127),e.setBigUint64(1,BigInt(r))}e.data&&"string"!==typeof e.data&&(i[0]|=128),t.enqueue(i),t.enqueue(n)}))}})}let u;function d(e){return e.reduce(((e,t)=>e+t.length),0)}function h(e,t){if(e[0].length===t)return e.shift();const n=new Uint8Array(t);let r=0;for(let i=0;i<t;i++)n[i]=e[0][r++],r===e[0].length&&(e.shift(),r=0);return e.length&&r<e[0].length&&(e[0]=e[0].slice(r)),n}function f(e,t){u||(u=new TextDecoder);const n=[];let r=0,s=-1,a=!1;return new TransformStream({transform(c,l){n.push(c);while(1){if(0===r){if(d(n)<1)break;const e=h(n,1);a=128===(128&e[0]),s=127&e[0],r=s<126?3:126===s?1:2}else if(1===r){if(d(n)<2)break;const e=h(n,2);s=new DataView(e.buffer,e.byteOffset,e.length).getUint16(0),r=3}else if(2===r){if(d(n)<8)break;const e=h(n,8),t=new DataView(e.buffer,e.byteOffset,e.length),i=t.getUint32(0);if(i>Math.pow(2,21)-1){l.enqueue(o.ERROR_PACKET);break}s=i*Math.pow(2,32)+t.getUint32(4),r=3}else{if(d(n)<s)break;const e=h(n,s);l.enqueue((0,i.decodePacket)(a?e:u.decode(e),t)),r=0}if(0===s||s>e){l.enqueue(o.ERROR_PACKET);break}}}})}t.decodePayload=c,t.createPacketEncoderStream=l,t.createPacketDecoderStream=f,t.protocol=4},75685:(e,t)=>{"use strict";function n(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,this.attempts=0}Object.defineProperty(t,"__esModule",{value:!0}),t.Backoff=void 0,t.Backoff=n,n.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),n=Math.floor(t*this.jitter*e);e=0==(1&Math.floor(10*t))?e-n:e+n}return 0|Math.min(e,this.max)},n.prototype.reset=function(){this.attempts=0},n.prototype.setMin=function(e){this.ms=e},n.prototype.setMax=function(e){this.max=e},n.prototype.setJitter=function(e){this.jitter=e}},14718:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=t.connect=t.io=t.Socket=t.Manager=t.protocol=void 0;const i=n(67595),o=n(28346);Object.defineProperty(t,"Manager",{enumerable:!0,get:function(){return o.Manager}});const s=n(12661);Object.defineProperty(t,"Socket",{enumerable:!0,get:function(){return s.Socket}});const a=r(n(15652)),c=a.default("socket.io-client"),l={};function u(e,t){"object"===typeof e&&(t=e,e=void 0),t=t||{};const n=i.url(e,t.path||"/socket.io"),r=n.source,s=n.id,a=n.path,u=l[s]&&a in l[s]["nsps"],d=t.forceNew||t["force new connection"]||!1===t.multiplex||u;let h;return d?(c("ignoring socket cache for %s",r),h=new o.Manager(r,t)):(l[s]||(c("new io instance for %s",r),l[s]=new o.Manager(r,t)),h=l[s]),n.query&&!t.query&&(t.query=n.queryKey),h.socket(n.path,t)}t.io=u,t.connect=u,t["default"]=u,Object.assign(u,{Manager:o.Manager,Socket:s.Socket,io:u,connect:u});var d=n(81906);Object.defineProperty(t,"protocol",{enumerable:!0,get:function(){return d.protocol}}),e.exports=u},28346:function(e,t,n){"use strict";n(21703),n(57658);var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e["default"]=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Manager=void 0;const a=n(38396),c=n(12661),l=o(n(81906)),u=n(88947),d=n(75685),h=n(73906),f=s(n(15652)),p=f.default("socket.io-client:manager");class g extends h.Emitter{constructor(e,t){var n;super(),this.nsps={},this.subs=[],e&&"object"===typeof e&&(t=e,e=void 0),t=t||{},t.path=t.path||"/socket.io",this.opts=t,a.installTimerFunctions(this,t),this.reconnection(!1!==t.reconnection),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor(null!==(n=t.randomizationFactor)&&void 0!==n?n:.5),this.backoff=new d.Backoff({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==t.timeout?2e4:t.timeout),this._readyState="closed",this.uri=e;const r=t.parser||l;this.encoder=new r.Encoder,this.decoder=new r.Decoder,this._autoConnect=!1!==t.autoConnect,this._autoConnect&&this.open()}reconnection(e){return arguments.length?(this._reconnection=!!e,this):this._reconnection}reconnectionAttempts(e){return void 0===e?this._reconnectionAttempts:(this._reconnectionAttempts=e,this)}reconnectionDelay(e){var t;return void 0===e?this._reconnectionDelay:(this._reconnectionDelay=e,null===(t=this.backoff)||void 0===t||t.setMin(e),this)}randomizationFactor(e){var t;return void 0===e?this._randomizationFactor:(this._randomizationFactor=e,null===(t=this.backoff)||void 0===t||t.setJitter(e),this)}reconnectionDelayMax(e){var t;return void 0===e?this._reconnectionDelayMax:(this._reconnectionDelayMax=e,null===(t=this.backoff)||void 0===t||t.setMax(e),this)}timeout(e){return arguments.length?(this._timeout=e,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()}open(e){if(p("readyState %s",this._readyState),~this._readyState.indexOf("open"))return this;p("opening %s",this.uri),this.engine=new a.Socket(this.uri,this.opts);const t=this.engine,n=this;this._readyState="opening",this.skipReconnect=!1;const r=u.on(t,"open",(function(){n.onopen(),e&&e()})),i=t=>{p("error"),this.cleanup(),this._readyState="closed",this.emitReserved("error",t),e?e(t):this.maybeReconnectOnOpen()},o=u.on(t,"error",i);if(!1!==this._timeout){const e=this._timeout;p("connect attempt will timeout after %d",e);const n=this.setTimeoutFn((()=>{p("connect attempt timed out after %d",e),r(),i(new Error("timeout")),t.close()}),e);this.opts.autoUnref&&n.unref(),this.subs.push((()=>{this.clearTimeoutFn(n)}))}return this.subs.push(r),this.subs.push(o),this}connect(e){return this.open(e)}onopen(){p("open"),this.cleanup(),this._readyState="open",this.emitReserved("open");const e=this.engine;this.subs.push(u.on(e,"ping",this.onping.bind(this)),u.on(e,"data",this.ondata.bind(this)),u.on(e,"error",this.onerror.bind(this)),u.on(e,"close",this.onclose.bind(this)),u.on(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(e){try{this.decoder.add(e)}catch(t){this.onclose("parse error",t)}}ondecoded(e){a.nextTick((()=>{this.emitReserved("packet",e)}),this.setTimeoutFn)}onerror(e){p("error",e),this.emitReserved("error",e)}socket(e,t){let n=this.nsps[e];return n?this._autoConnect&&!n.active&&n.connect():(n=new c.Socket(this,e,t),this.nsps[e]=n),n}_destroy(e){const t=Object.keys(this.nsps);for(const n of t){const e=this.nsps[n];if(e.active)return void p("socket %s is still active, skipping close",n)}this._close()}_packet(e){p("writing packet %j",e);const t=this.encoder.encode(e);for(let n=0;n<t.length;n++)this.engine.write(t[n],e.options)}cleanup(){p("cleanup"),this.subs.forEach((e=>e())),this.subs.length=0,this.decoder.destroy()}_close(){p("disconnect"),this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close"),this.engine&&this.engine.close()}disconnect(){return this._close()}onclose(e,t){p("closed due to %s",e),this.cleanup(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",e,t),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const e=this;if(this.backoff.attempts>=this._reconnectionAttempts)p("reconnect failed"),this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const t=this.backoff.duration();p("will wait %dms before reconnect attempt",t),this._reconnecting=!0;const n=this.setTimeoutFn((()=>{e.skipReconnect||(p("attempting reconnect"),this.emitReserved("reconnect_attempt",e.backoff.attempts),e.skipReconnect||e.open((t=>{t?(p("reconnect attempt error"),e._reconnecting=!1,e.reconnect(),this.emitReserved("reconnect_error",t)):(p("reconnect success"),e.onreconnect())})))}),t);this.opts.autoUnref&&n.unref(),this.subs.push((()=>{this.clearTimeoutFn(n)}))}}onreconnect(){const e=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",e)}}t.Manager=g},88947:(e,t)=>{"use strict";function n(e,t,n){return e.on(t,n),function(){e.off(t,n)}}Object.defineProperty(t,"__esModule",{value:!0}),t.on=void 0,t.on=n},12661:function(e,t,n){"use strict";n(92087),n(30541),n(21703),n(57658);var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Socket=void 0;const i=n(81906),o=n(88947),s=n(73906),a=r(n(15652)),c=a.default("socket.io-client:socket"),l=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class u extends s.Emitter{constructor(e,t,n){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=e,this.nsp=t,n&&n.auth&&(this.auth=n.auth),this._opts=Object.assign({},n),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const e=this.io;this.subs=[o.on(e,"open",this.onopen.bind(this)),o.on(e,"packet",this.onpacket.bind(this)),o.on(e,"error",this.onerror.bind(this)),o.on(e,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected||(this.subEvents(),this.io["_reconnecting"]||this.io.open(),"open"===this.io._readyState&&this.onopen()),this}open(){return this.connect()}send(...e){return e.unshift("message"),this.emit.apply(this,e),this}emit(e,...t){if(l.hasOwnProperty(e))throw new Error('"'+e.toString()+'" is a reserved event name');if(t.unshift(e),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(t),this;const n={type:i.PacketType.EVENT,data:t,options:{}};if(n.options.compress=!1!==this.flags.compress,"function"===typeof t[t.length-1]){const e=this.ids++;c("emitting packet with ack id %d",e);const r=t.pop();this._registerAckCallback(e,r),n.id=e}const r=this.io.engine&&this.io.engine.transport&&this.io.engine.transport.writable,o=this.flags.volatile&&(!r||!this.connected);return o?c("discard packet as the transport is not currently writable"):this.connected?(this.notifyOutgoingListeners(n),this.packet(n)):this.sendBuffer.push(n),this.flags={},this}_registerAckCallback(e,t){var n;const r=null!==(n=this.flags.timeout)&&void 0!==n?n:this._opts.ackTimeout;if(void 0===r)return void(this.acks[e]=t);const i=this.io.setTimeoutFn((()=>{delete this.acks[e];for(let t=0;t<this.sendBuffer.length;t++)this.sendBuffer[t].id===e&&(c("removing packet with ack id %d from the buffer",e),this.sendBuffer.splice(t,1));c("event with ack id %d has timed out after %d ms",e,r),t.call(this,new Error("operation has timed out"))}),r);this.acks[e]=(...e)=>{this.io.clearTimeoutFn(i),t.apply(this,[null,...e])}}emitWithAck(e,...t){const n=void 0!==this.flags.timeout||void 0!==this._opts.ackTimeout;return new Promise(((r,i)=>{t.push(((e,t)=>n?e?i(e):r(t):r(e))),this.emit(e,...t)}))}_addToQueue(e){let t;"function"===typeof e[e.length-1]&&(t=e.pop());const n={id:this._queueSeq++,tryCount:0,pending:!1,args:e,flags:Object.assign({fromQueue:!0},this.flags)};e.push(((e,...r)=>{if(n!==this._queue[0])return;const i=null!==e;return i?n.tryCount>this._opts.retries&&(c("packet [%d] is discarded after %d tries",n.id,n.tryCount),this._queue.shift(),t&&t(e)):(c("packet [%d] was successfully sent",n.id),this._queue.shift(),t&&t(null,...r)),n.pending=!1,this._drainQueue()})),this._queue.push(n),this._drainQueue()}_drainQueue(e=!1){if(c("draining queue"),!this.connected||0===this._queue.length)return;const t=this._queue[0];!t.pending||e?(t.pending=!0,t.tryCount++,c("sending packet [%d] (try n%d)",t.id,t.tryCount),this.flags=t.flags,this.emit.apply(this,t.args)):c("packet [%d] has already been sent and is waiting for an ack",t.id)}packet(e){e.nsp=this.nsp,this.io._packet(e)}onopen(){c("transport is open - connecting"),"function"==typeof this.auth?this.auth((e=>{this._sendConnectPacket(e)})):this._sendConnectPacket(this.auth)}_sendConnectPacket(e){this.packet({type:i.PacketType.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},e):e})}onerror(e){this.connected||this.emitReserved("connect_error",e)}onclose(e,t){c("close (%s)",e),this.connected=!1,delete this.id,this.emitReserved("disconnect",e,t)}onpacket(e){const t=e.nsp===this.nsp;if(t)switch(e.type){case i.PacketType.CONNECT:e.data&&e.data.sid?this.onconnect(e.data.sid,e.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case i.PacketType.EVENT:case i.PacketType.BINARY_EVENT:this.onevent(e);break;case i.PacketType.ACK:case i.PacketType.BINARY_ACK:this.onack(e);break;case i.PacketType.DISCONNECT:this.ondisconnect();break;case i.PacketType.CONNECT_ERROR:this.destroy();const t=new Error(e.data.message);t.data=e.data.data,this.emitReserved("connect_error",t);break}}onevent(e){const t=e.data||[];c("emitting event %j",t),null!=e.id&&(c("attaching ack callback to event"),t.push(this.ack(e.id))),this.connected?this.emitEvent(t):this.receiveBuffer.push(Object.freeze(t))}emitEvent(e){if(this._anyListeners&&this._anyListeners.length){const t=this._anyListeners.slice();for(const n of t)n.apply(this,e)}super.emit.apply(this,e),this._pid&&e.length&&"string"===typeof e[e.length-1]&&(this._lastOffset=e[e.length-1])}ack(e){const t=this;let n=!1;return function(...r){n||(n=!0,c("sending ack %j",r),t.packet({type:i.PacketType.ACK,id:e,data:r}))}}onack(e){const t=this.acks[e.id];"function"===typeof t?(c("calling ack %s with %j",e.id,e.data),t.apply(this,e.data),delete this.acks[e.id]):c("bad ack %s",e.id)}onconnect(e,t){c("socket connected with id %s",e),this.id=e,this.recovered=t&&this._pid===t,this._pid=t,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach((e=>this.emitEvent(e))),this.receiveBuffer=[],this.sendBuffer.forEach((e=>{this.notifyOutgoingListeners(e),this.packet(e)})),this.sendBuffer=[]}ondisconnect(){c("server disconnect (%s)",this.nsp),this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach((e=>e())),this.subs=void 0),this.io["_destroy"](this)}disconnect(){return this.connected&&(c("performing disconnect (%s)",this.nsp),this.packet({type:i.PacketType.DISCONNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(e){return this.flags.compress=e,this}get volatile(){return this.flags.volatile=!0,this}timeout(e){return this.flags.timeout=e,this}onAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(e),this}prependAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(e),this}offAny(e){if(!this._anyListeners)return this;if(e){const t=this._anyListeners;for(let n=0;n<t.length;n++)if(e===t[n])return t.splice(n,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(e),this}prependAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(e),this}offAnyOutgoing(e){if(!this._anyOutgoingListeners)return this;if(e){const t=this._anyOutgoingListeners;for(let n=0;n<t.length;n++)if(e===t[n])return t.splice(n,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(e){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const t=this._anyOutgoingListeners.slice();for(const n of t)n.apply(this,e.data)}}}t.Socket=u},67595:function(e,t,n){"use strict";n(74916);var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.url=void 0;const i=n(38396),o=r(n(15652)),s=o.default("socket.io-client:url");function a(e,t="",n){let r=e;n=n||"undefined"!==typeof location&&location,null==e&&(e=n.protocol+"//"+n.host),"string"===typeof e&&("/"===e.charAt(0)&&(e="/"===e.charAt(1)?n.protocol+e:n.host+e),/^(https?|wss?):\/\//.test(e)||(s("protocol-less url %s",e),e="undefined"!==typeof n?n.protocol+"//"+e:"https://"+e),s("parse %s",e),r=i.parse(e)),r.port||(/^(http|ws)$/.test(r.protocol)?r.port="80":/^(http|ws)s$/.test(r.protocol)&&(r.port="443")),r.path=r.path||"/";const o=-1!==r.host.indexOf(":"),a=o?"["+r.host+"]":r.host;return r.id=r.protocol+"://"+a+":"+r.port+t,r.href=r.protocol+"://"+a+(n&&n.port===r.port?"":":"+r.port),r}t.url=a},65960:(e,t,n)=>{"use strict";n(57658),n(21703),Object.defineProperty(t,"__esModule",{value:!0}),t.reconstructPacket=t.deconstructPacket=void 0;const r=n(49496);function i(e){const t=[],n=e.data,r=e;return r.data=o(n,t),r.attachments=t.length,{packet:r,buffers:t}}function o(e,t){if(!e)return e;if((0,r.isBinary)(e)){const n={_placeholder:!0,num:t.length};return t.push(e),n}if(Array.isArray(e)){const n=new Array(e.length);for(let r=0;r<e.length;r++)n[r]=o(e[r],t);return n}if("object"===typeof e&&!(e instanceof Date)){const n={};for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=o(e[r],t));return n}return e}function s(e,t){return e.data=a(e.data,t),delete e.attachments,e}function a(e,t){if(!e)return e;if(e&&!0===e._placeholder){const n="number"===typeof e.num&&e.num>=0&&e.num<t.length;if(n)return t[e.num];throw new Error("illegal attachments")}if(Array.isArray(e))for(let n=0;n<e.length;n++)e[n]=a(e[n],t);else if("object"===typeof e)for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&(e[n]=a(e[n],t));return e}t.deconstructPacket=i,t.reconstructPacket=s},81906:(e,t,n)=>{"use strict";n(38862),n(30541),n(21703),n(57658),Object.defineProperty(t,"__esModule",{value:!0}),t.Decoder=t.Encoder=t.PacketType=t.protocol=void 0;const r=n(73906),i=n(65960),o=n(49496),s=n(15652),a=(0,s.default)("socket.io-parser"),c=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"];var l;t.protocol=5,function(e){e[e["CONNECT"]=0]="CONNECT",e[e["DISCONNECT"]=1]="DISCONNECT",e[e["EVENT"]=2]="EVENT",e[e["ACK"]=3]="ACK",e[e["CONNECT_ERROR"]=4]="CONNECT_ERROR",e[e["BINARY_EVENT"]=5]="BINARY_EVENT",e[e["BINARY_ACK"]=6]="BINARY_ACK"}(l=t.PacketType||(t.PacketType={}));class u{constructor(e){this.replacer=e}encode(e){return a("encoding packet %j",e),e.type!==l.EVENT&&e.type!==l.ACK||!(0,o.hasBinary)(e)?[this.encodeAsString(e)]:this.encodeAsBinary({type:e.type===l.EVENT?l.BINARY_EVENT:l.BINARY_ACK,nsp:e.nsp,data:e.data,id:e.id})}encodeAsString(e){let t=""+e.type;return e.type!==l.BINARY_EVENT&&e.type!==l.BINARY_ACK||(t+=e.attachments+"-"),e.nsp&&"/"!==e.nsp&&(t+=e.nsp+","),null!=e.id&&(t+=e.id),null!=e.data&&(t+=JSON.stringify(e.data,this.replacer)),a("encoded %j as %s",e,t),t}encodeAsBinary(e){const t=(0,i.deconstructPacket)(e),n=this.encodeAsString(t.packet),r=t.buffers;return r.unshift(n),r}}function d(e){return"[object Object]"===Object.prototype.toString.call(e)}t.Encoder=u;class h extends r.Emitter{constructor(e){super(),this.reviver=e}add(e){let t;if("string"===typeof e){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");t=this.decodeString(e);const n=t.type===l.BINARY_EVENT;n||t.type===l.BINARY_ACK?(t.type=n?l.EVENT:l.ACK,this.reconstructor=new f(t),0===t.attachments&&super.emitReserved("decoded",t)):super.emitReserved("decoded",t)}else{if(!(0,o.isBinary)(e)&&!e.base64)throw new Error("Unknown type: "+e);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");t=this.reconstructor.takeBinaryData(e),t&&(this.reconstructor=null,super.emitReserved("decoded",t))}}decodeString(e){let t=0;const n={type:Number(e.charAt(0))};if(void 0===l[n.type])throw new Error("unknown packet type "+n.type);if(n.type===l.BINARY_EVENT||n.type===l.BINARY_ACK){const r=t+1;while("-"!==e.charAt(++t)&&t!=e.length);const i=e.substring(r,t);if(i!=Number(i)||"-"!==e.charAt(t))throw new Error("Illegal attachments");n.attachments=Number(i)}if("/"===e.charAt(t+1)){const r=t+1;while(++t){const n=e.charAt(t);if(","===n)break;if(t===e.length)break}n.nsp=e.substring(r,t)}else n.nsp="/";const r=e.charAt(t+1);if(""!==r&&Number(r)==r){const r=t+1;while(++t){const n=e.charAt(t);if(null==n||Number(n)!=n){--t;break}if(t===e.length)break}n.id=Number(e.substring(r,t+1))}if(e.charAt(++t)){const r=this.tryParse(e.substr(t));if(!h.isPayloadValid(n.type,r))throw new Error("invalid payload");n.data=r}return a("decoded %s as %j",e,n),n}tryParse(e){try{return JSON.parse(e,this.reviver)}catch(t){return!1}}static isPayloadValid(e,t){switch(e){case l.CONNECT:return d(t);case l.DISCONNECT:return void 0===t;case l.CONNECT_ERROR:return"string"===typeof t||d(t);case l.EVENT:case l.BINARY_EVENT:return Array.isArray(t)&&("number"===typeof t[0]||"string"===typeof t[0]&&-1===c.indexOf(t[0]));case l.ACK:case l.BINARY_ACK:return Array.isArray(t)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}t.Decoder=h;class f{constructor(e){this.packet=e,this.buffers=[],this.reconPack=e}takeBinaryData(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){const e=(0,i.reconstructPacket)(this.reconPack,this.buffers);return this.finishedReconstruction(),e}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}},49496:(e,t,n)=>{"use strict";n(83753),Object.defineProperty(t,"__esModule",{value:!0}),t.hasBinary=t.isBinary=void 0;const r="function"===typeof ArrayBuffer,i=e=>"function"===typeof ArrayBuffer.isView?ArrayBuffer.isView(e):e.buffer instanceof ArrayBuffer,o=Object.prototype.toString,s="function"===typeof Blob||"undefined"!==typeof Blob&&"[object BlobConstructor]"===o.call(Blob),a="function"===typeof File||"undefined"!==typeof File&&"[object FileConstructor]"===o.call(File);function c(e){return r&&(e instanceof ArrayBuffer||i(e))||s&&e instanceof Blob||a&&e instanceof File}function l(e,t){if(!e||"object"!==typeof e)return!1;if(Array.isArray(e)){for(let t=0,n=e.length;t<n;t++)if(l(e[t]))return!0;return!1}if(c(e))return!0;if(e.toJSON&&"function"===typeof e.toJSON&&1===arguments.length)return l(e.toJSON(),!0);for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)&&l(e[n]))return!0;return!1}t.isBinary=c,t.hasBinary=l},73906:(e,t,n)=>{"use strict";n.r(t),n.d(t,{Emitter:()=>r});n(57658);function r(e){if(e)return i(e)}function i(e){for(var t in r.prototype)e[t]=r.prototype[t];return e}r.prototype.on=r.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this},r.prototype.once=function(e,t){function n(){this.off(e,n),t.apply(this,arguments)}return n.fn=t,this.on(e,n),this},r.prototype.off=r.prototype.removeListener=r.prototype.removeAllListeners=r.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n,r=this._callbacks["$"+e];if(!r)return this;if(1==arguments.length)return delete this._callbacks["$"+e],this;for(var i=0;i<r.length;i++)if(n=r[i],n===t||n.fn===t){r.splice(i,1);break}return 0===r.length&&delete this._callbacks["$"+e],this},r.prototype.emit=function(e){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),n=this._callbacks["$"+e],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(n){n=n.slice(0);r=0;for(var i=n.length;r<i;++r)n[r].apply(this,t)}return this},r.prototype.emitReserved=r.prototype.emit,r.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]},r.prototype.hasListeners=function(e){return!!this.listeners(e).length}}}]);
//# sourceMappingURL=258.15b56a32.js.map